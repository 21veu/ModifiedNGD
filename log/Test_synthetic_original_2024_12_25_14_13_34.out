/nishome/yui/ModifiedNGD/utils/readData.py:18: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  return torch.tensor(x, dtype=torch.float32), torch.tensor(y, dtype=torch.float32)
Train info: 
 train data shape: torch.Size([512, 1]), 
 train lable shape: torch.Size([512, 1]), 
 positive / negative: 0.014509063214063644 / 0.9854909181594849, 
 discrepancy norm error: 8.21854019165039
Test info: 
 test data shape: torch.Size([256, 1]), 
 test lable shape: torch.Size([256, 1]), , 
 positive / negative: -0.04019593074917793 / 1.0401959419250488, 
 discrepancy norm error: 5.910345554351807
Valid info: 
 valid data shape: torch.Size([256, 1]), valid lable shape: torch.Size([256, 1]), 
 positive / negative: 0.04114104062318802 / 0.9588589668273926, 
 discrepancy norm error: 5.461434364318848
torch.Size([512, 1]) torch.Size([512])
seed is  2191
---------------------------------------- NGD ----------------------------------------
<bound method Module.modules of Sequential(
  (0): Linear(in_features=1, out_features=512, bias=True)
  (1): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (2): ReLU()
  (3): Linear(in_features=512, out_features=512, bias=True)
  (4): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (5): ReLU()
  (6): Linear(in_features=512, out_features=512, bias=True)
  (7): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (8): ReLU()
  (9): Linear(in_features=512, out_features=512, bias=True)
  (10): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (11): ReLU()
  (12): Linear(in_features=512, out_features=1, bias=True)
)>
Learning rate is:  0.1
  0%|          | 0/1000 [00:00<?, ?it/s]/nishome/yui/anaconda3/envs/ng/lib/python3.12/site-packages/torch/autograd/graph.py:744: UserWarning: Using backward() with create_graph=True will create a reference cycle between the parameter and its gradient which can cause a memory leak. We recommend using autograd.grad when creating the graph to avoid this. If you have to use this function, make sure to reset the .grad fields of your parameters to None after use to break the cycle and avoid the leak. (Triggered internally at /opt/conda/conda-bld/pytorch_1716905971214/work/torch/csrc/autograd/engine.cpp:1203.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
Epoch:   1
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.5201, device='cuda:0') 
Std:  tensor(37.1448, device='cuda:0') 
ABS Max:  tensor(570.4353, device='cuda:0') 
ABS Min:  tensor(0.0011, device='cuda:0')
Criterion check:  tensor([1.0012, 1.0003, 1.0000, 0.9985, 1.0004, 0.9998, 1.0016, 1.0089, 0.9992,
        0.9977], device='cuda:0') tensor(223, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0024, device='cuda:0')
eigenvalues preserved:  512
Test train Loss:  0.25982871651649475
Test train Acc:  0.0
Test Loss:  0.26468369364738464
Test Acc:  0.0
Valid Loss:  0.232069194316864
Valid Acc:  0.0
max of grad d_p:  tensor(4.7787, device='cuda:0')
min of grad d_p:  tensor(-0.3868, device='cuda:0')
max|min: (J_L, Jta/N)  (4.778709411621094, 4.7787394523620605, ratio: 1.0000063180923462)|(-0.3867913782596588, -0.3867897093296051)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.8030e-05, device='cuda:0') mean:  tensor(-2.4766e-09, device='cuda:0') min:  tensor(-3.0041e-05, device='cuda:0') norm:  tensor(0.0003, device='cuda:0') MSE:  tensor(3.8010e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0043, device='cuda:0') mean:  tensor(2.4455e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0493, device='cuda:0') MSE:  tensor(6.2138e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0067, device='cuda:0')
min of d_p_list:  tensor(-0.0192, device='cuda:0')
Epoch:  1  
Training Loss: 0.26216021581785753
Test Loss:  0.2662889361381531
Test Acc:  0.0
Valid Loss:  0.23436185717582703
Valid Acc:  0.0
local minima detector shape:  (0,)
Preserved_eigens number check:  512
  0%|          | 1/1000 [00:54<15:02:26, 54.20s/it]Epoch:   2
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(-34.8436, device='cuda:0') 
Std:  tensor(328.8716, device='cuda:0') 
ABS Max:  tensor(3460.8003, device='cuda:0') 
ABS Min:  tensor(0.0521, device='cuda:0')
Criterion check:  tensor([0.9779, 1.0036, 1.0011, 1.0027, 1.0058, 1.0031, 0.9945, 0.9703, 0.9916,
        0.9970], device='cuda:0') tensor(264, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(3.6482e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.4709, device='cuda:0')
min of grad d_p:  tensor(-0.4256, device='cuda:0')
max|min: (J_L, Jta/N)  (0.47094520926475525, 0.47095027565956116, ratio: 1.0000107288360596)|(-0.42556458711624146, -0.42556968331336975)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.9653e-05, device='cuda:0') mean:  tensor(-4.9223e-09, device='cuda:0') min:  tensor(-2.0355e-05, device='cuda:0') norm:  tensor(0.0008, device='cuda:0') MSE:  tensor(1.0514e-09, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0099, device='cuda:0') mean:  tensor(0.0002, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.3341, device='cuda:0') MSE:  tensor(4.2095e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0129, device='cuda:0')
min of d_p_list:  tensor(-0.0027, device='cuda:0')
Epoch:  2  
Training Loss: 0.2637614607810974
Test Loss:  0.26809102296829224
Test Acc:  0.0
Valid Loss:  0.2367631196975708
Valid Acc:  0.0
local minima detector shape:  (1,)
Preserved_eigens number check:  512
  0%|          | 2/1000 [01:32<12:27:15, 44.93s/it]Epoch:   3
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.5101, device='cuda:0') 
Std:  tensor(88.5704, device='cuda:0') 
ABS Max:  tensor(1489.7792, device='cuda:0') 
ABS Min:  tensor(0.0017, device='cuda:0')
Criterion check:  tensor([0.9974, 1.0009, 1.0002, 0.9994, 1.0014, 1.0012, 1.0016, 1.0008, 1.0016,
        0.9986], device='cuda:0') tensor(265, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0029, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3601, device='cuda:0')
min of grad d_p:  tensor(-0.3537, device='cuda:0')
max|min: (J_L, Jta/N)  (0.36013585329055786, 0.36013391613960266, ratio: 0.9999946355819702)|(-0.35365229845046997, -0.3536522388458252)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.0962e-06, device='cuda:0') mean:  tensor(-1.5367e-09, device='cuda:0') min:  tensor(-9.7305e-06, device='cuda:0') norm:  tensor(0.0001, device='cuda:0') MSE:  tensor(1.7015e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(1.6399e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0271, device='cuda:0') MSE:  tensor(3.4148e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0066, device='cuda:0')
min of d_p_list:  tensor(-0.0020, device='cuda:0')
Epoch:  3  
Training Loss: 0.26175498962402344
Test Loss:  0.26536762714385986
Test Acc:  0.0
Valid Loss:  0.23531442880630493
Valid Acc:  0.0
local minima detector shape:  (2,)
Preserved_eigens number check:  512
  0%|          | 3/1000 [01:52<9:13:38, 33.32s/it] Epoch:   4
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-618.3449, device='cuda:0') 
Std:  tensor(14093.4805, device='cuda:0') 
ABS Max:  tensor(318643.3438, device='cuda:0') 
ABS Min:  tensor(0.0230, device='cuda:0')
Criterion check:  tensor([1.2507, 0.9739, 1.0022, 1.0851, 1.0661, 1.0202, 1.0385, 1.0139, 0.9163,
        1.0179], device='cuda:0') tensor(261, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0012, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3652, device='cuda:0')
min of grad d_p:  tensor(-0.2954, device='cuda:0')
max|min: (J_L, Jta/N)  (0.3651694059371948, 0.36516955494880676, ratio: 1.0000003576278687)|(-0.2954028844833374, -0.2954028844833374)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.4538e-06, device='cuda:0') mean:  tensor(1.2228e-09, device='cuda:0') min:  tensor(-1.1235e-05, device='cuda:0') norm:  tensor(6.6722e-05, device='cuda:0') MSE:  tensor(8.4075e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0093, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(1.0562e-13, device='cuda:0') norm:  tensor(0.1798, device='cuda:0') MSE:  tensor(2.2657e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0024, device='cuda:0')
min of d_p_list:  tensor(-0.0015, device='cuda:0')
Epoch:  4  
Training Loss: 0.25897637009620667
Test Loss:  0.26231375336647034
Test Acc:  0.0
Valid Loss:  0.23316419124603271
Valid Acc:  0.0
local minima detector shape:  (3,)
Preserved_eigens number check:  512
  0%|          | 4/1000 [02:17<8:21:09, 30.19s/it]Epoch:   5
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-20.9595, device='cuda:0') 
Std:  tensor(739.2813, device='cuda:0') 
ABS Max:  tensor(15062.5410, device='cuda:0') 
ABS Min:  tensor(0.0014, device='cuda:0')
Criterion check:  tensor([1.0405, 1.0020, 1.0002, 0.9962, 1.0121, 0.9491, 0.6239, 1.0101, 0.9942,
        1.0073], device='cuda:0') tensor(275, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0010, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3705, device='cuda:0')
min of grad d_p:  tensor(-0.2575, device='cuda:0')
max|min: (J_L, Jta/N)  (0.37052270770072937, 0.37084969878196716, ratio: 1.0008825063705444)|(-0.2574564516544342, -0.2574569284915924)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(-2.3677e-08, device='cuda:0') min:  tensor(-0.0003, device='cuda:0') norm:  tensor(0.0066, device='cuda:0') MSE:  tensor(8.2773e-09, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0141, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(1.2640e-13, device='cuda:0') norm:  tensor(0.2406, device='cuda:0') MSE:  tensor(3.0319e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0015, device='cuda:0')
min of d_p_list:  tensor(-0.0022, device='cuda:0')
Epoch:  5  
Training Loss: 0.2566782236099243
Test Loss:  0.25986558198928833
Test Acc:  0.0
Valid Loss:  0.23088854551315308
Valid Acc:  0.0
local minima detector shape:  (4,)
Preserved_eigens number check:  512
  0%|          | 5/1000 [02:37<7:17:27, 26.38s/it]Epoch:   6
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(4.7664, device='cuda:0') 
Std:  tensor(52.0010, device='cuda:0') 
ABS Max:  tensor(1009.2653, device='cuda:0') 
ABS Min:  tensor(0.0030, device='cuda:0')
Criterion check:  tensor([1.0071, 0.9996, 1.0003, 1.0003, 1.0024, 0.9976, 0.9993, 1.0008, 0.9975,
        0.9994], device='cuda:0') tensor(263, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0012, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.4453, device='cuda:0')
min of grad d_p:  tensor(-0.2375, device='cuda:0')
max|min: (J_L, Jta/N)  (0.4452553987503052, 0.4452541470527649, ratio: 0.9999971985816956)|(-0.23746731877326965, -0.23746547102928162)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.3411e-06, device='cuda:0') mean:  tensor(2.6552e-10, device='cuda:0') min:  tensor(-2.9057e-06, device='cuda:0') norm:  tensor(5.0854e-05, device='cuda:0') MSE:  tensor(6.4080e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0014, device='cuda:0') mean:  tensor(3.8621e-05, device='cuda:0') min:  tensor(2.3034e-14, device='cuda:0') norm:  tensor(0.0669, device='cuda:0') MSE:  tensor(8.4306e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0038, device='cuda:0')
min of d_p_list:  tensor(-0.0080, device='cuda:0')
Epoch:  6  
Training Loss: 0.2537904977798462
Test Loss:  0.2566256821155548
Test Acc:  0.0
Valid Loss:  0.22778081893920898
Valid Acc:  0.0
std:  0.0035437634840048545 
thres:  0.00025899230837821965
Preserved_eigens number check:  512
  1%|          | 6/1000 [02:59<6:56:51, 25.16s/it]Epoch:   7
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(9932.1270, device='cuda:0') 
Std:  tensor(223544.9844, device='cuda:0') 
ABS Max:  tensor(5058229., device='cuda:0') 
ABS Min:  tensor(0.0028, device='cuda:0')
Criterion check:  tensor([0.9967, 1.0000, 1.0016, 0.9996, 1.0003, 1.0000, 1.0006, 1.0014, 0.9991,
        0.9916], device='cuda:0') tensor(242, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0003, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2903, device='cuda:0')
min of grad d_p:  tensor(-0.2383, device='cuda:0')
max|min: (J_L, Jta/N)  (0.2902793288230896, 0.29027682542800903, ratio: 0.9999913573265076)|(-0.23834429681301117, -0.23834408819675446)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.0280e-05, device='cuda:0') mean:  tensor(8.5665e-09, device='cuda:0') min:  tensor(-4.5940e-05, device='cuda:0') norm:  tensor(0.0009, device='cuda:0') MSE:  tensor(1.1142e-09, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0021, device='cuda:0') mean:  tensor(2.7446e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0469, device='cuda:0') MSE:  tensor(5.9043e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0092, device='cuda:0')
min of d_p_list:  tensor(-0.0023, device='cuda:0')
Epoch:  7  
Training Loss: 0.24631217122077942
Test Loss:  0.24908995628356934
Test Acc:  0.0
Valid Loss:  0.2198462188243866
Valid Acc:  0.0
std:  0.005290308509160628 
thres:  0.000255502450466156
Preserved_eigens number check:  512
  1%|          | 7/1000 [03:19<6:26:02, 23.33s/it]Epoch:   8
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.9380, device='cuda:0') 
Std:  tensor(23.7127, device='cuda:0') 
ABS Max:  tensor(338.3924, device='cuda:0') 
ABS Min:  tensor(0.0006, device='cuda:0')
Criterion check:  tensor([0.9999, 1.0001, 1.0012, 0.9912, 1.0005, 0.9996, 0.9995, 0.9990, 0.9989,
        0.9994], device='cuda:0') tensor(243, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0016, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2283, device='cuda:0')
min of grad d_p:  tensor(-1.9136, device='cuda:0')
max|min: (J_L, Jta/N)  (0.2282588630914688, 0.22825773060321808, ratio: 0.9999950528144836)|(-1.913577675819397, -1.9135841131210327)

 check Jacobi res:  torch.Size([793601]) max:  tensor(6.4373e-06, device='cuda:0') mean:  tensor(-4.7002e-10, device='cuda:0') min:  tensor(-3.9041e-06, device='cuda:0') norm:  tensor(6.8691e-05, device='cuda:0') MSE:  tensor(8.6557e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0017, device='cuda:0') mean:  tensor(1.7810e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0280, device='cuda:0') MSE:  tensor(3.5248e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0010, device='cuda:0')
min of d_p_list:  tensor(-0.0028, device='cuda:0')
Epoch:  8  
Training Loss: 0.2371596395969391
Test Loss:  0.2389017939567566
Test Acc:  0.0
Valid Loss:  0.20943798124790192
Valid Acc:  0.0
std:  0.007953804582496653 
thres:  0.00025058338046073916
Preserved_eigens number check:  512
  1%|          | 8/1000 [03:41<6:17:04, 22.81s/it]Epoch:   9
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(2.3712, device='cuda:0') 
Std:  tensor(923.2990, device='cuda:0') 
ABS Max:  tensor(16709.1523, device='cuda:0') 
ABS Min:  tensor(6.4430e-05, device='cuda:0')
Criterion check:  tensor([1.0026, 1.0009, 1.0013, 1.0021, 0.9994, 1.0015, 0.9993, 1.0114, 0.9979,
        0.9800], device='cuda:0') tensor(245, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0015, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2240, device='cuda:0')
min of grad d_p:  tensor(-1.5626, device='cuda:0')
max|min: (J_L, Jta/N)  (0.2240217626094818, 0.22402189671993256, ratio: 1.0000005960464478)|(-1.562626838684082, -1.562626600265503)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.3560e-06, device='cuda:0') mean:  tensor(1.5630e-10, device='cuda:0') min:  tensor(-9.3877e-07, device='cuda:0') norm:  tensor(2.6680e-05, device='cuda:0') MSE:  tensor(3.3619e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0028, device='cuda:0') mean:  tensor(1.5224e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0276, device='cuda:0') MSE:  tensor(3.4834e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0017, device='cuda:0')
min of d_p_list:  tensor(-0.0032, device='cuda:0')
Epoch:  9  
Training Loss: 0.22608429193496704
Test Loss:  0.22593745589256287
Test Acc:  0.0
Valid Loss:  0.19695936143398285
Valid Acc:  0.0
std:  0.011222302251340917 
thres:  0.00024400496482849122
Preserved_eigens number check:  512
  1%|          | 9/1000 [04:01<6:01:21, 21.88s/it]Epoch:   10
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-65.5878, device='cuda:0') 
Std:  tensor(2445.6414, device='cuda:0') 
ABS Max:  tensor(47889.3203, device='cuda:0') 
ABS Min:  tensor(0.0029, device='cuda:0')
Criterion check:  tensor([ 1.0211,  1.0323,  1.0448,  1.0096, -0.8360,  1.0062,  1.0085,  1.0133,
         1.0534,  0.9422], device='cuda:0') tensor(271, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0002, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2007, device='cuda:0')
min of grad d_p:  tensor(-1.6660, device='cuda:0')
max|min: (J_L, Jta/N)  (0.20071941614151, 0.2006598860025406, ratio: 0.9997034072875977)|(-1.6660469770431519, -1.6670838594436646)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0010, device='cuda:0') mean:  tensor(-2.9107e-08, device='cuda:0') min:  tensor(-0.0001, device='cuda:0') norm:  tensor(0.0039, device='cuda:0') MSE:  tensor(4.9180e-09, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0262, device='cuda:0') mean:  tensor(0.0002, device='cuda:0') min:  tensor(2.2863e-13, device='cuda:0') norm:  tensor(0.3184, device='cuda:0') MSE:  tensor(4.0121e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0083, device='cuda:0')
min of d_p_list:  tensor(-0.0261, device='cuda:0')
Epoch:  10  
Training Loss: 0.2127038985490799
Test Loss:  0.21231667697429657
Test Acc:  0.0
Valid Loss:  0.18080201745033264
Valid Acc:  0.0
std:  0.014574617307345149 
thres:  0.00023521009981632233
Preserved_eigens number check:  512
  1%|          | 10/1000 [04:21<5:52:34, 21.37s/it]Epoch:   11
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(2.7125, device='cuda:0') 
Std:  tensor(91.2838, device='cuda:0') 
ABS Max:  tensor(1694.7742, device='cuda:0') 
ABS Min:  tensor(0.0009, device='cuda:0')
Criterion check:  tensor([1.0011, 0.9954, 0.9984, 1.0009, 0.9996, 1.0025, 1.0001, 1.0003, 0.9932,
        0.9983], device='cuda:0') tensor(249, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0005, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.8312, device='cuda:0')
min of grad d_p:  tensor(-1.6645, device='cuda:0')
max|min: (J_L, Jta/N)  (0.8311527371406555, 0.8311429619789124, ratio: 0.9999882578849792)|(-1.6645256280899048, -1.6639955043792725)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.7607e-05, device='cuda:0') mean:  tensor(3.1269e-08, device='cuda:0') min:  tensor(-0.0005, device='cuda:0') norm:  tensor(0.0022, device='cuda:0') MSE:  tensor(2.7404e-09, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0046, device='cuda:0') mean:  tensor(2.5766e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0413, device='cuda:0') MSE:  tensor(5.2067e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0452, device='cuda:0')
min of d_p_list:  tensor(-0.0341, device='cuda:0')
Epoch:  11  
Training Loss: 0.26383256912231445
Test Loss:  0.25691312551498413
Test Acc:  0.0
Valid Loss:  0.23375147581100464
Valid Acc:  0.0
std:  0.017412313284557678 
thres:  0.00023721851408481598
Preserved_eigens number check:  512
  1%|          | 11/1000 [04:44<6:00:12, 21.85s/it]Epoch:   12
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(-1.7108, device='cuda:0') 
Std:  tensor(46.6847, device='cuda:0') 
ABS Max:  tensor(639.5099, device='cuda:0') 
ABS Min:  tensor(0.0041, device='cuda:0')
Criterion check:  tensor([1.0003, 1.0001, 1.0001, 1.0001, 1.0000, 0.9849, 0.9999, 0.9973, 0.9988,
        0.9997], device='cuda:0') tensor(252, device='cuda:0')
max of Lambda2 tensor(961716.7500, device='cuda:0')
min of Lambda2 tensor(6.9789e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.0168, device='cuda:0')
min of grad d_p:  tensor(-0.4774, device='cuda:0')
max|min: (J_L, Jta/N)  (1.0167908668518066, 1.0167896747589111, ratio: 0.9999988079071045)|(-0.4774245023727417, -0.4774259328842163)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.1143e-06, device='cuda:0') mean:  tensor(6.6605e-10, device='cuda:0') min:  tensor(-1.1168e-05, device='cuda:0') norm:  tensor(4.6417e-05, device='cuda:0') MSE:  tensor(5.8488e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0010, device='cuda:0') mean:  tensor(1.2032e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0187, device='cuda:0') MSE:  tensor(2.3576e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0045, device='cuda:0')
min of d_p_list:  tensor(-0.0034, device='cuda:0')
Epoch:  12  
Training Loss: 0.26147371530532837
Test Loss:  0.2538924813270569
Test Acc:  0.0
Valid Loss:  0.22860613465309143
Valid Acc:  0.0
std:  0.0198775701328581 
thres:  0.00024025082290172578
Preserved_eigens number check:  512
  1%|          | 12/1000 [05:06<6:02:50, 22.03s/it]Epoch:   13
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-1.1395, device='cuda:0') 
Std:  tensor(29.7960, device='cuda:0') 
ABS Max:  tensor(610.5429, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([0.9995, 0.9999, 0.9999, 1.0001, 1.0001, 0.9976, 1.0005, 0.9998, 0.9981,
        0.9960], device='cuda:0') tensor(220, device='cuda:0')
max of Lambda2 tensor(948905.5625, device='cuda:0')
min of Lambda2 tensor(0.0002, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.9615, device='cuda:0')
min of grad d_p:  tensor(-0.4355, device='cuda:0')
max|min: (J_L, Jta/N)  (0.9615051746368408, 0.9614911675453186, ratio: 0.9999854564666748)|(-0.4355284869670868, -0.43552932143211365)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.4007e-05, device='cuda:0') mean:  tensor(2.3820e-11, device='cuda:0') min:  tensor(-7.2122e-06, device='cuda:0') norm:  tensor(3.3093e-05, device='cuda:0') MSE:  tensor(4.1700e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0006, device='cuda:0') mean:  tensor(1.0140e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0152, device='cuda:0') MSE:  tensor(1.9204e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0069, device='cuda:0')
min of d_p_list:  tensor(-0.0034, device='cuda:0')
Epoch:  13  
Training Loss: 0.2590412497520447
Test Loss:  0.2514927089214325
Test Acc:  0.0
Valid Loss:  0.22258314490318298
Valid Acc:  0.0
std:  0.021087212837787982 
thres:  0.00024462714493274693
Preserved_eigens number check:  512
  1%|▏         | 13/1000 [05:26<5:52:16, 21.41s/it]Epoch:   14
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(-2.9023, device='cuda:0') 
Std:  tensor(220.8813, device='cuda:0') 
ABS Max:  tensor(4152.6729, device='cuda:0') 
ABS Min:  tensor(0.0144, device='cuda:0')
Criterion check:  tensor([0.9959, 0.9998, 1.0000, 1.0005, 0.9994, 0.9972, 1.0000, 1.0065, 1.0074,
        0.9981], device='cuda:0') tensor(289, device='cuda:0')
max of Lambda2 tensor(885258.7500, device='cuda:0')
min of Lambda2 tensor(4.8507e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.9105, device='cuda:0')
min of grad d_p:  tensor(-0.3809, device='cuda:0')
max|min: (J_L, Jta/N)  (0.9105231761932373, 0.9105218648910522, ratio: 0.9999985694885254)|(-0.3808501958847046, -0.3808490037918091)

 check Jacobi res:  torch.Size([793601]) max:  tensor(6.4820e-06, device='cuda:0') mean:  tensor(2.0008e-10, device='cuda:0') min:  tensor(-3.9339e-06, device='cuda:0') norm:  tensor(4.0994e-05, device='cuda:0') MSE:  tensor(5.1655e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0056, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.2090, device='cuda:0') MSE:  tensor(2.6341e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0091, device='cuda:0')
min of d_p_list:  tensor(-0.0071, device='cuda:0')
Epoch:  14  
Training Loss: 0.28227555751800537
Test Loss:  0.27668121457099915
Test Acc:  0.0
Valid Loss:  0.242740198969841
Valid Acc:  0.0
std:  0.023088640642786738 
thres:  0.0002558653980493545
Preserved_eigens number check:  512
  1%|▏         | 14/1000 [05:50<6:01:54, 22.02s/it]Epoch:   15
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(3.6579, device='cuda:0') 
Std:  tensor(51.8730, device='cuda:0') 
ABS Max:  tensor(1033.9271, device='cuda:0') 
ABS Min:  tensor(0.0006, device='cuda:0')
Criterion check:  tensor([1.0004, 0.9998, 1.0001, 1.0027, 0.9997, 1.0002, 0.9993, 0.9999, 1.0006,
        1.0022], device='cuda:0') tensor(247, device='cuda:0')
max of Lambda2 tensor(786435.9375, device='cuda:0')
min of Lambda2 tensor(0.0001, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3858, device='cuda:0')
min of grad d_p:  tensor(-0.2472, device='cuda:0')
max|min: (J_L, Jta/N)  (0.38575252890586853, 0.38574543595314026, ratio: 0.9999816417694092)|(-0.2472488284111023, -0.2472471445798874)

 check Jacobi res:  torch.Size([793601]) max:  tensor(7.0930e-06, device='cuda:0') mean:  tensor(-4.5622e-10, device='cuda:0') min:  tensor(-2.9616e-06, device='cuda:0') norm:  tensor(4.2909e-05, device='cuda:0') MSE:  tensor(5.4069e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(7.1973e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0120, device='cuda:0') MSE:  tensor(1.5176e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0153, device='cuda:0')
min of d_p_list:  tensor(-0.0092, device='cuda:0')
Epoch:  15  
Training Loss: 0.2241094708442688
Test Loss:  0.2154158651828766
Test Acc:  0.0
Valid Loss:  0.18635526299476624
Valid Acc:  0.0
std:  0.01889408950611306 
thres:  0.00025814651250839234
Preserved_eigens number check:  512
  2%|▏         | 15/1000 [06:07<5:40:00, 20.71s/it]Epoch:   16
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(3.6325, device='cuda:0') 
Std:  tensor(60.6399, device='cuda:0') 
ABS Max:  tensor(1254.4598, device='cuda:0') 
ABS Min:  tensor(0.0007, device='cuda:0')
Criterion check:  tensor([1.0005, 0.9997, 0.9998, 1.0001, 1.0008, 0.9999, 0.9997, 1.0122, 0.9993,
        0.9975], device='cuda:0') tensor(244, device='cuda:0')
max of Lambda2 tensor(829976.1250, device='cuda:0')
min of Lambda2 tensor(0.0002, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.4291, device='cuda:0')
min of grad d_p:  tensor(-0.2444, device='cuda:0')
max|min: (J_L, Jta/N)  (1.42909836769104, 1.4290952682495117, ratio: 0.9999978542327881)|(-0.2444334477186203, -0.2444334775209427)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.1888e-06, device='cuda:0') mean:  tensor(-3.5226e-10, device='cuda:0') min:  tensor(-3.7029e-06, device='cuda:0') norm:  tensor(7.0456e-05, device='cuda:0') MSE:  tensor(8.8780e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0007, device='cuda:0') mean:  tensor(2.0098e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0303, device='cuda:0') MSE:  tensor(3.8209e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0047, device='cuda:0')
min of d_p_list:  tensor(-0.0060, device='cuda:0')
Epoch:  16  
Training Loss: 0.22058746218681335
Test Loss:  0.21192757785320282
Test Acc:  0.0
Valid Loss:  0.18469443917274475
Valid Acc:  0.0
std:  0.023618874900361565 
thres:  0.0002494974911212921
Preserved_eigens number check:  512
  2%|▏         | 16/1000 [06:24<5:22:22, 19.66s/it]Epoch:   17
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  510
Criterion check: 
Mean:  tensor(-3.8692, device='cuda:0') 
Std:  tensor(103.2445, device='cuda:0') 
ABS Max:  tensor(2268.4048, device='cuda:0') 
ABS Min:  tensor(0.0120, device='cuda:0')
Criterion check:  tensor([0.9990, 1.0001, 0.9996, 1.0000, 0.9978, 1.0013, 0.9995, 1.0011, 1.0008,
        1.0020], device='cuda:0') tensor(251, device='cuda:0')
max of Lambda2 tensor(716008., device='cuda:0')
min of Lambda2 tensor(4.8840e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3754, device='cuda:0')
min of grad d_p:  tensor(-0.2213, device='cuda:0')
max|min: (J_L, Jta/N)  (0.37538814544677734, 0.37540069222450256, ratio: 1.0000333786010742)|(-0.2213437259197235, -0.22134366631507874)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.1431e-06, device='cuda:0') mean:  tensor(2.1304e-10, device='cuda:0') min:  tensor(-1.2547e-05, device='cuda:0') norm:  tensor(2.0075e-05, device='cuda:0') MSE:  tensor(2.5297e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(8.4272e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0132, device='cuda:0') MSE:  tensor(1.6677e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0463, device='cuda:0')
min of d_p_list:  tensor(-0.0224, device='cuda:0')
Epoch:  17  
Training Loss: 0.19242754578590393
Test Loss:  0.1924302577972412
Test Acc:  0.0
Valid Loss:  0.15533161163330078
Valid Acc:  0.0
std:  0.0314621368238444 
thres:  0.00023568825721740722
Preserved_eigens number check:  512
  2%|▏         | 17/1000 [06:42<5:13:21, 19.13s/it]Epoch:   18
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-6.6515, device='cuda:0') 
Std:  tensor(177.3645, device='cuda:0') 
ABS Max:  tensor(3350.2446, device='cuda:0') 
ABS Min:  tensor(0.0012, device='cuda:0')
Criterion check:  tensor([1.0017, 1.0001, 1.0016, 0.9985, 0.9999, 0.9998, 1.0022, 0.9989, 1.0043,
        0.9979], device='cuda:0') tensor(262, device='cuda:0')
max of Lambda2 tensor(557641.2500, device='cuda:0')
min of Lambda2 tensor(0.0003, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2971, device='cuda:0')
min of grad d_p:  tensor(-6.0356, device='cuda:0')
max|min: (J_L, Jta/N)  (0.297111839056015, 0.2971118092536926, ratio: 0.9999998807907104)|(-6.035555362701416, -6.035560607910156)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.8736e-06, device='cuda:0') mean:  tensor(2.6990e-10, device='cuda:0') min:  tensor(-5.0664e-07, device='cuda:0') norm:  tensor(1.9361e-05, device='cuda:0') MSE:  tensor(2.4396e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0199, device='cuda:0') mean:  tensor(2.6936e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0448, device='cuda:0') MSE:  tensor(5.6463e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0254, device='cuda:0')
min of d_p_list:  tensor(-0.0194, device='cuda:0')
Epoch:  18  
Training Loss: 0.24198371171951294
Test Loss:  0.23848114907741547
Test Acc:  0.0
Valid Loss:  0.2008861005306244
Valid Acc:  0.0
std:  0.029615566291835534 
thres:  0.0002322767496109009
Preserved_eigens number check:  512
  2%|▏         | 18/1000 [06:59<5:03:17, 18.53s/it]Epoch:   19
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(46.0117, device='cuda:0') 
Std:  tensor(1806.0535, device='cuda:0') 
ABS Max:  tensor(39177.0586, device='cuda:0') 
ABS Min:  tensor(0.0022, device='cuda:0')
Criterion check:  tensor([0.9993, 0.9987, 0.9714, 1.0001, 1.0302, 0.9955, 1.0084, 0.9900, 1.0259,
        0.9960], device='cuda:0') tensor(273, device='cuda:0')
max of Lambda2 tensor(505009.2812, device='cuda:0')
min of Lambda2 tensor(1.4108e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3790, device='cuda:0')
min of grad d_p:  tensor(-1.5309, device='cuda:0')
max|min: (J_L, Jta/N)  (0.37902501225471497, 0.3789801001548767, ratio: 0.9998815059661865)|(-1.5309252738952637, -1.530393123626709)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(-6.1188e-08, device='cuda:0') min:  tensor(-0.0005, device='cuda:0') norm:  tensor(0.0050, device='cuda:0') MSE:  tensor(6.3183e-09, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0022, device='cuda:0') mean:  tensor(8.3154e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1252, device='cuda:0') MSE:  tensor(1.5773e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0112, device='cuda:0')
min of d_p_list:  tensor(-0.0088, device='cuda:0')
Epoch:  19  
Training Loss: 0.21083645522594452
Test Loss:  0.21052667498588562
Test Acc:  0.0
Valid Loss:  0.1747816801071167
Valid Acc:  0.0
std:  0.01627578076685402 
thres:  0.00021798892915248871
Preserved_eigens number check:  512
  2%|▏         | 19/1000 [07:17<4:58:29, 18.26s/it]Epoch:   20
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(2.0540, device='cuda:0') 
Std:  tensor(119.8935, device='cuda:0') 
ABS Max:  tensor(1895.8171, device='cuda:0') 
ABS Min:  tensor(0.0086, device='cuda:0')
Criterion check:  tensor([1.0007, 0.9989, 0.9944, 0.9997, 0.9993, 0.9983, 1.0007, 0.9993, 1.0024,
        1.0013], device='cuda:0') tensor(261, device='cuda:0')
max of Lambda2 tensor(666959.1875, device='cuda:0')
min of Lambda2 tensor(0.0005, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.6823, device='cuda:0')
min of grad d_p:  tensor(-0.1953, device='cuda:0')
max|min: (J_L, Jta/N)  (0.6822935342788696, 0.6823017597198486, ratio: 1.0000120401382446)|(-0.19528061151504517, -0.19528153538703918)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.3362e-06, device='cuda:0') mean:  tensor(-1.8341e-10, device='cuda:0') min:  tensor(-8.2254e-06, device='cuda:0') norm:  tensor(2.5046e-05, device='cuda:0') MSE:  tensor(3.1561e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(9.1976e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0142, device='cuda:0') MSE:  tensor(1.7896e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0083, device='cuda:0')
min of d_p_list:  tensor(-0.0048, device='cuda:0')
Epoch:  20  
Training Loss: 0.16556063294410706
Test Loss:  0.16597898304462433
Test Acc:  0.0
Valid Loss:  0.13885974884033203
Valid Acc:  0.0
std:  0.025885042502088267 
thres:  0.00020627916157245636
Preserved_eigens number check:  512
  2%|▏         | 20/1000 [07:35<4:54:37, 18.04s/it]Epoch:   21
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(41.0176, device='cuda:0') 
Std:  tensor(1078.9583, device='cuda:0') 
ABS Max:  tensor(21747.6426, device='cuda:0') 
ABS Min:  tensor(0.0688, device='cuda:0')
Criterion check:  tensor([0.9990, 1.0129, 1.2818, 0.9975, 1.0111, 1.0081, 0.9987, 1.0486, 1.0146,
        1.0130], device='cuda:0') tensor(278, device='cuda:0')
max of Lambda2 tensor(616406.8125, device='cuda:0')
min of Lambda2 tensor(0.0003, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.5210, device='cuda:0')
min of grad d_p:  tensor(-0.1664, device='cuda:0')
max|min: (J_L, Jta/N)  (0.5209632515907288, 0.5209560990333557, ratio: 0.9999862909317017)|(-0.16636797785758972, -0.16636809706687927)

 check Jacobi res:  torch.Size([793601]) max:  tensor(7.1526e-06, device='cuda:0') mean:  tensor(-1.8475e-10, device='cuda:0') min:  tensor(-4.9323e-06, device='cuda:0') norm:  tensor(7.8437e-05, device='cuda:0') MSE:  tensor(9.8837e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0067, device='cuda:0') mean:  tensor(0.0002, device='cuda:0') min:  tensor(2.6858e-13, device='cuda:0') norm:  tensor(0.3033, device='cuda:0') MSE:  tensor(3.8221e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0114, device='cuda:0')
min of d_p_list:  tensor(-0.0267, device='cuda:0')
Epoch:  21  
Training Loss: 0.16687676310539246
Test Loss:  0.1680264174938202
Test Acc:  0.0
Valid Loss:  0.1431519091129303
Valid Acc:  0.0
std:  0.028708991016746174 
thres:  0.0001955370217561722
Preserved_eigens number check:  512
  2%|▏         | 21/1000 [07:53<4:54:14, 18.03s/it]Epoch:   22
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(-0.8548, device='cuda:0') 
Std:  tensor(124.7353, device='cuda:0') 
ABS Max:  tensor(2550.6912, device='cuda:0') 
ABS Min:  tensor(0.0029, device='cuda:0')
Criterion check:  tensor([0.9977, 1.0027, 1.0004, 0.9988, 1.0049, 0.9999, 0.9853, 0.9992, 0.9973,
        0.9947], device='cuda:0') tensor(285, device='cuda:0')
max of Lambda2 tensor(561878.2500, device='cuda:0')
min of Lambda2 tensor(3.8091e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.9007, device='cuda:0')
min of grad d_p:  tensor(-0.1691, device='cuda:0')
max|min: (J_L, Jta/N)  (1.9007279872894287, 1.9007329940795898, ratio: 1.0000026226043701)|(-0.16906750202178955, -0.16906751692295074)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.0934e-06, device='cuda:0') mean:  tensor(9.8037e-11, device='cuda:0') min:  tensor(-5.0068e-06, device='cuda:0') norm:  tensor(1.4405e-05, device='cuda:0') MSE:  tensor(1.8151e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(4.7739e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0072, device='cuda:0') MSE:  tensor(9.0751e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0183, device='cuda:0')
min of d_p_list:  tensor(-0.0156, device='cuda:0')
Epoch:  22  
Training Loss: 0.14298732578754425
Test Loss:  0.1460576206445694
Test Acc:  0.0
Valid Loss:  0.13712207973003387
Valid Acc:  0.0
std:  0.03573224163381406 
thres:  0.00018564897775650026
Preserved_eigens number check:  512
  2%|▏         | 22/1000 [08:10<4:51:38, 17.89s/it]Epoch:   23
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-5.9215, device='cuda:0') 
Std:  tensor(269.7356, device='cuda:0') 
ABS Max:  tensor(3396.0337, device='cuda:0') 
ABS Min:  tensor(0.1473, device='cuda:0')
Criterion check:  tensor([ 0.9962,  1.0043,  0.9992,  0.9992, -2.5982,  0.9929,  1.0100,  1.0143,
         1.0027,  1.0175], device='cuda:0') tensor(281, device='cuda:0')
max of Lambda2 tensor(382382.6875, device='cuda:0')
min of Lambda2 tensor(0.0002, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.6122, device='cuda:0')
min of grad d_p:  tensor(-0.1828, device='cuda:0')
max|min: (J_L, Jta/N)  (0.6122136116027832, 0.6122161746025085, ratio: 1.0000041723251343)|(-0.18278171122074127, -0.1827816218137741)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.6058e-06, device='cuda:0') mean:  tensor(1.4282e-10, device='cuda:0') min:  tensor(-2.5630e-06, device='cuda:0') norm:  tensor(1.1249e-05, device='cuda:0') MSE:  tensor(1.4174e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0013, device='cuda:0') mean:  tensor(7.0722e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0107, device='cuda:0') MSE:  tensor(1.3541e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0026, device='cuda:0')
min of d_p_list:  tensor(-0.0034, device='cuda:0')
Epoch:  23  
Training Loss: 0.1361548751592636
Test Loss:  0.1366460919380188
Test Acc:  0.0
Valid Loss:  0.12314685434103012
Valid Acc:  0.0
std:  0.026153702883414245 
thres:  0.00016448321044445038
Preserved_eigens number check:  512
  2%|▏         | 23/1000 [08:28<4:49:16, 17.76s/it]Epoch:   24
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(2.7009, device='cuda:0') 
Std:  tensor(124.8138, device='cuda:0') 
ABS Max:  tensor(1661.3481, device='cuda:0') 
ABS Min:  tensor(0.0089, device='cuda:0')
Criterion check:  tensor([1.0005, 1.0000, 0.9858, 1.0005, 1.0079, 0.9991, 1.0035, 1.0107, 0.9997,
        1.0063], device='cuda:0') tensor(291, device='cuda:0')
max of Lambda2 tensor(367392.6562, device='cuda:0')
min of Lambda2 tensor(0.0001, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1884, device='cuda:0')
min of grad d_p:  tensor(-0.1667, device='cuda:0')
max|min: (J_L, Jta/N)  (0.18837420642375946, 0.18837419152259827, ratio: 0.9999999403953552)|(-0.16674605011940002, -0.16674597561359406)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.4916e-07, device='cuda:0') mean:  tensor(1.0094e-10, device='cuda:0') min:  tensor(-2.2650e-06, device='cuda:0') norm:  tensor(1.1126e-05, device='cuda:0') MSE:  tensor(1.4020e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0032, device='cuda:0') mean:  tensor(3.9642e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0569, device='cuda:0') MSE:  tensor(7.1759e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0086, device='cuda:0')
min of d_p_list:  tensor(-0.0102, device='cuda:0')
Epoch:  24  
Training Loss: 0.16148781776428223
Test Loss:  0.16337749361991882
Test Acc:  0.0
Valid Loss:  0.1468336284160614
Valid Acc:  0.0
std:  0.012596605449408412 
thres:  0.00015461348295211792
Preserved_eigens number check:  512
  2%|▏         | 24/1000 [08:45<4:47:38, 17.68s/it]Epoch:   25
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(-23.3191, device='cuda:0') 
Std:  tensor(320.0484, device='cuda:0') 
ABS Max:  tensor(6324.7471, device='cuda:0') 
ABS Min:  tensor(0.0004, device='cuda:0')
Criterion check:  tensor([0.9985, 0.9976, 1.0003, 0.9984, 1.0002, 0.9989, 0.9992, 1.0139, 1.0063,
        0.9973], device='cuda:0') tensor(262, device='cuda:0')
max of Lambda2 tensor(528249.0625, device='cuda:0')
min of Lambda2 tensor(2.9828e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1889, device='cuda:0')
min of grad d_p:  tensor(-0.6051, device='cuda:0')
max|min: (J_L, Jta/N)  (0.18885046243667603, 0.18885043263435364, ratio: 0.9999998211860657)|(-0.6051292419433594, -0.6051387786865234)

 check Jacobi res:  torch.Size([793601]) max:  tensor(9.5367e-06, device='cuda:0') mean:  tensor(8.7915e-11, device='cuda:0') min:  tensor(-9.2119e-07, device='cuda:0') norm:  tensor(1.6537e-05, device='cuda:0') MSE:  tensor(2.0837e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0012, device='cuda:0') mean:  tensor(2.4202e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0368, device='cuda:0') MSE:  tensor(4.6424e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0066, device='cuda:0')
min of d_p_list:  tensor(-0.0071, device='cuda:0')
Epoch:  25  
Training Loss: 0.11495606601238251
Test Loss:  0.112668976187706
Test Acc:  0.0
Valid Loss:  0.10479674488306046
Valid Acc:  0.0
std:  0.01862298864713049 
thres:  0.000144492569565773
Preserved_eigens number check:  512
  2%|▎         | 25/1000 [09:03<4:48:10, 17.73s/it]Epoch:   26
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(53.9099, device='cuda:0') 
Std:  tensor(746.7897, device='cuda:0') 
ABS Max:  tensor(13618.0488, device='cuda:0') 
ABS Min:  tensor(0.0006, device='cuda:0')
Criterion check:  tensor([1.0014, 1.0006, 1.0008, 1.0023, 1.0004, 0.9836, 0.9990, 0.9928, 1.1352,
        0.9962], device='cuda:0') tensor(262, device='cuda:0')
max of Lambda2 tensor(359994.2812, device='cuda:0')
min of Lambda2 tensor(0.0001, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1705, device='cuda:0')
min of grad d_p:  tensor(-0.1575, device='cuda:0')
max|min: (J_L, Jta/N)  (0.17053169012069702, 0.1705315262079239, ratio: 0.9999990463256836)|(-0.15752454102039337, -0.15752457082271576)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.9919e-06, device='cuda:0') mean:  tensor(-1.4680e-10, device='cuda:0') min:  tensor(-1.0878e-06, device='cuda:0') norm:  tensor(1.0370e-05, device='cuda:0') MSE:  tensor(1.3066e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0043, device='cuda:0') mean:  tensor(4.3107e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0631, device='cuda:0') MSE:  tensor(7.9519e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0295, device='cuda:0')
min of d_p_list:  tensor(-0.0150, device='cuda:0')
Epoch:  26  
Training Loss: 0.12218672037124634
Test Loss:  0.11625868082046509
Test Acc:  0.0
Valid Loss:  0.10407468676567078
Valid Acc:  0.0
std:  0.01631647838664716 
thres:  0.00013555456101894378
Preserved_eigens number check:  512
  3%|▎         | 26/1000 [09:20<4:45:22, 17.58s/it]Epoch:   27
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(0.1365, device='cuda:0') 
Std:  tensor(40.1667, device='cuda:0') 
ABS Max:  tensor(618.5093, device='cuda:0') 
ABS Min:  tensor(0.0016, device='cuda:0')
Criterion check:  tensor([1.0000, 0.9983, 0.9996, 1.0001, 0.9995, 0.9993, 0.9990, 0.9999, 1.0000,
        1.0038], device='cuda:0') tensor(258, device='cuda:0')
max of Lambda2 tensor(305680.8750, device='cuda:0')
min of Lambda2 tensor(3.5059e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(2.0321, device='cuda:0')
min of grad d_p:  tensor(-0.1852, device='cuda:0')
max|min: (J_L, Jta/N)  (2.032062292098999, 2.0320627689361572, ratio: 1.000000238418579)|(-0.1852288842201233, -0.1852288693189621)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.8477e-06, device='cuda:0') mean:  tensor(9.0792e-11, device='cuda:0') min:  tensor(-8.0338e-07, device='cuda:0') norm:  tensor(8.8589e-06, device='cuda:0') MSE:  tensor(1.1163e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0015, device='cuda:0') mean:  tensor(2.0580e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0302, device='cuda:0') MSE:  tensor(3.8040e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0112, device='cuda:0')
min of d_p_list:  tensor(-0.0089, device='cuda:0')
Epoch:  27  
Training Loss: 0.10086585581302643
Test Loss:  0.09572845697402954
Test Acc:  0.0
Valid Loss:  0.08960829675197601
Valid Acc:  0.0
std:  0.020612394159361832 
thres:  0.00012713026702404023
Preserved_eigens number check:  512
  3%|▎         | 27/1000 [09:37<4:42:30, 17.42s/it]Epoch:   28
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(-1.0536, device='cuda:0') 
Std:  tensor(25.5757, device='cuda:0') 
ABS Max:  tensor(329.3579, device='cuda:0') 
ABS Min:  tensor(0.0027, device='cuda:0')
Criterion check:  tensor([0.9999, 0.9997, 0.9995, 0.9999, 1.0000, 1.0002, 0.9999, 1.0002, 1.0005,
        0.9993], device='cuda:0') tensor(244, device='cuda:0')
max of Lambda2 tensor(296721.3125, device='cuda:0')
min of Lambda2 tensor(3.7864e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.8434, device='cuda:0')
min of grad d_p:  tensor(-0.1764, device='cuda:0')
max|min: (J_L, Jta/N)  (0.8433739542961121, 0.8433749675750732, ratio: 1.0000011920928955)|(-0.17639701068401337, -0.17639701068401337)

 check Jacobi res:  torch.Size([793601]) max:  tensor(6.7115e-07, device='cuda:0') mean:  tensor(2.9353e-11, device='cuda:0') min:  tensor(-3.3118e-06, device='cuda:0') norm:  tensor(7.6242e-06, device='cuda:0') MSE:  tensor(9.6071e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(3.3892e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0049, device='cuda:0') MSE:  tensor(6.1788e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0068, device='cuda:0')
min of d_p_list:  tensor(-0.0052, device='cuda:0')
Epoch:  28  
Training Loss: 0.09151522070169449
Test Loss:  0.08897541463375092
Test Acc:  0.0
Valid Loss:  0.08091356605291367
Valid Acc:  0.0
std:  0.024136288809320817 
thres:  0.0001182023361325264
Preserved_eigens number check:  512
  3%|▎         | 28/1000 [09:55<4:42:59, 17.47s/it]Epoch:   29
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.3461, device='cuda:0') 
Std:  tensor(11.0486, device='cuda:0') 
ABS Max:  tensor(160.0448, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([1.0000, 0.9999, 0.9995, 1.0000, 1.0002, 0.9996, 0.9999, 0.9999, 1.0001,
        1.0000], device='cuda:0') tensor(246, device='cuda:0')
max of Lambda2 tensor(316555.3750, device='cuda:0')
min of Lambda2 tensor(0.0002, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.5075, device='cuda:0')
min of grad d_p:  tensor(-0.1720, device='cuda:0')
max|min: (J_L, Jta/N)  (0.5074571371078491, 0.5074571371078491, ratio: 1.0)|(-0.17197152972221375, -0.17197157442569733)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.5425e-06, device='cuda:0') mean:  tensor(-4.4966e-11, device='cuda:0') min:  tensor(-7.0035e-07, device='cuda:0') norm:  tensor(1.2157e-05, device='cuda:0') MSE:  tensor(1.5319e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(6.8225e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0097, device='cuda:0') MSE:  tensor(1.2241e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0046, device='cuda:0')
min of d_p_list:  tensor(-0.0027, device='cuda:0')
Epoch:  29  
Training Loss: 0.07993265986442566
Test Loss:  0.07790686190128326
Test Acc:  0.0
Valid Loss:  0.07115956395864487
Valid Acc:  0.0
std:  0.015319847473083934 
thres:  0.0001018913045525551
Preserved_eigens number check:  512
  3%|▎         | 29/1000 [10:12<4:41:29, 17.39s/it]Epoch:   30
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(25.0387, device='cuda:0') 
Std:  tensor(2011.6230, device='cuda:0') 
ABS Max:  tensor(28428.9668, device='cuda:0') 
ABS Min:  tensor(0.0228, device='cuda:0')
Criterion check:  tensor([0.9923, 0.9987, 0.9249, 1.0063, 1.0088, 0.9913, 0.9879, 0.9956, 0.9822,
        1.0030], device='cuda:0') tensor(266, device='cuda:0')
max of Lambda2 tensor(342823.7500, device='cuda:0')
min of Lambda2 tensor(3.0566e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.6366, device='cuda:0')
min of grad d_p:  tensor(-0.1552, device='cuda:0')
max|min: (J_L, Jta/N)  (0.6366147994995117, 0.636613667011261, ratio: 0.9999982118606567)|(-0.1552458256483078, -0.15524591505527496)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.1325e-06, device='cuda:0') mean:  tensor(-1.5022e-10, device='cuda:0') min:  tensor(-1.4447e-06, device='cuda:0') norm:  tensor(8.9196e-06, device='cuda:0') MSE:  tensor(1.1239e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0141, device='cuda:0') mean:  tensor(0.0003, device='cuda:0') min:  tensor(2.5849e-13, device='cuda:0') norm:  tensor(0.3845, device='cuda:0') MSE:  tensor(4.8448e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0133, device='cuda:0')
min of d_p_list:  tensor(-0.0036, device='cuda:0')
Epoch:  30  
Training Loss: 0.08104131370782852
Test Loss:  0.07848533987998962
Test Acc:  0.0
Valid Loss:  0.07203541696071625
Valid Acc:  0.0
std:  0.015540145909481804 
thres:  9.510835409164428e-05
Preserved_eigens number check:  512
  3%|▎         | 30/1000 [10:30<4:45:43, 17.67s/it]Epoch:   31
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-11.1383, device='cuda:0') 
Std:  tensor(136.7654, device='cuda:0') 
ABS Max:  tensor(1926.1331, device='cuda:0') 
ABS Min:  tensor(0.0036, device='cuda:0')
Criterion check:  tensor([1.0001, 0.9932, 0.9831, 1.0006, 1.0052, 0.9971, 0.9905, 1.0029, 0.9932,
        1.0045], device='cuda:0') tensor(254, device='cuda:0')
max of Lambda2 tensor(357701.8125, device='cuda:0')
min of Lambda2 tensor(0.0001, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.4354, device='cuda:0')
min of grad d_p:  tensor(-0.1426, device='cuda:0')
max|min: (J_L, Jta/N)  (1.4354455471038818, 1.4354479312896729, ratio: 1.0000016689300537)|(-0.14259310066699982, -0.14259321987628937)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.9349e-07, device='cuda:0') mean:  tensor(-6.5442e-11, device='cuda:0') min:  tensor(-2.3842e-06, device='cuda:0') norm:  tensor(8.6031e-06, device='cuda:0') MSE:  tensor(1.0841e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0031, device='cuda:0') mean:  tensor(2.2034e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0335, device='cuda:0') MSE:  tensor(4.2259e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0155, device='cuda:0')
min of d_p_list:  tensor(-0.0098, device='cuda:0')
Epoch:  31  
Training Loss: 0.0677056610584259
Test Loss:  0.0675855502486229
Test Acc:  0.0
Valid Loss:  0.06118699535727501
Valid Acc:  0.0
std:  0.011238444507768987 
thres:  8.421214222908021e-05
Preserved_eigens number check:  512
  3%|▎         | 31/1000 [10:48<4:45:36, 17.68s/it]Epoch:   32
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-1.3727, device='cuda:0') 
Std:  tensor(101.5519, device='cuda:0') 
ABS Max:  tensor(1780.5256, device='cuda:0') 
ABS Min:  tensor(0.0012, device='cuda:0')
Criterion check:  tensor([1.0000, 0.9993, 0.9996, 0.9996, 0.9998, 0.9992, 0.9953, 0.9999, 1.0013,
        0.9975], device='cuda:0') tensor(234, device='cuda:0')
max of Lambda2 tensor(342743.5625, device='cuda:0')
min of Lambda2 tensor(0.0003, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.5991, device='cuda:0')
min of grad d_p:  tensor(-0.1500, device='cuda:0')
max|min: (J_L, Jta/N)  (1.599060297012329, 1.5990736484527588, ratio: 1.0000083446502686)|(-0.15003672242164612, -0.1500367373228073)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.4133e-06, device='cuda:0') mean:  tensor(-1.4121e-10, device='cuda:0') min:  tensor(-1.3351e-05, device='cuda:0') norm:  tensor(1.5600e-05, device='cuda:0') MSE:  tensor(1.9657e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(7.2421e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0108, device='cuda:0') MSE:  tensor(1.3546e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0021, device='cuda:0')
min of d_p_list:  tensor(-0.0013, device='cuda:0')
Epoch:  32  
Training Loss: 0.0545535646378994
Test Loss:  0.054177217185497284
Test Acc:  0.0
Valid Loss:  0.04911860078573227
Valid Acc:  0.0
std:  0.012687257864401131 
thres:  7.49496839940548e-05
Preserved_eigens number check:  512
  3%|▎         | 32/1000 [11:06<4:48:22, 17.87s/it]Epoch:   33
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(-0.8042, device='cuda:0') 
Std:  tensor(21.2436, device='cuda:0') 
ABS Max:  tensor(222.6922, device='cuda:0') 
ABS Min:  tensor(0.0040, device='cuda:0')
Criterion check:  tensor([0.9999, 1.0005, 0.9999, 0.9996, 0.9994, 0.9981, 0.9991, 1.0002, 0.9989,
        1.0013], device='cuda:0') tensor(247, device='cuda:0')
max of Lambda2 tensor(315187.6562, device='cuda:0')
min of Lambda2 tensor(5.4040e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.5557, device='cuda:0')
min of grad d_p:  tensor(-0.1351, device='cuda:0')
max|min: (J_L, Jta/N)  (1.55574631690979, 1.5557454824447632, ratio: 0.999999463558197)|(-0.13510358333587646, -0.1351035237312317)

 check Jacobi res:  torch.Size([793601]) max:  tensor(9.9442e-07, device='cuda:0') mean:  tensor(1.2603e-10, device='cuda:0') min:  tensor(-1.9095e-07, device='cuda:0') norm:  tensor(5.3653e-06, device='cuda:0') MSE:  tensor(6.7608e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(6.0439e-05, device='cuda:0') mean:  tensor(2.5989e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0039, device='cuda:0') MSE:  tensor(4.8860e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0021, device='cuda:0')
min of d_p_list:  tensor(-0.0016, device='cuda:0')
Epoch:  33  
Training Loss: 0.04734543710947037
Test Loss:  0.04673578590154648
Test Acc:  0.0
Valid Loss:  0.04285069555044174
Valid Acc:  0.0
std:  0.013432915124612305 
thres:  6.611572727560996e-05
Preserved_eigens number check:  512
  3%|▎         | 33/1000 [11:24<4:48:07, 17.88s/it]Epoch:   34
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(-9.2800, device='cuda:0') 
Std:  tensor(154.4749, device='cuda:0') 
ABS Max:  tensor(2497.7393, device='cuda:0') 
ABS Min:  tensor(0.0022, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0079, 0.9997, 1.0002, 0.9986, 0.9991, 0.9969, 1.0002, 0.9987,
        1.0045], device='cuda:0') tensor(255, device='cuda:0')
max of Lambda2 tensor(317688.7500, device='cuda:0')
min of Lambda2 tensor(1.3919e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.6516, device='cuda:0')
min of grad d_p:  tensor(-0.1220, device='cuda:0')
max|min: (J_L, Jta/N)  (1.6516352891921997, 1.6516343355178833, ratio: 0.9999994039535522)|(-0.122029148042202, -0.12202920764684677)

 check Jacobi res:  torch.Size([793601]) max:  tensor(9.5367e-07, device='cuda:0') mean:  tensor(1.2912e-10, device='cuda:0') min:  tensor(-5.3949e-07, device='cuda:0') norm:  tensor(5.4269e-06, device='cuda:0') MSE:  tensor(6.8383e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0008, device='cuda:0') mean:  tensor(1.2187e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0176, device='cuda:0') MSE:  tensor(2.2184e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0136, device='cuda:0')
min of d_p_list:  tensor(-0.0161, device='cuda:0')
Epoch:  34  
Training Loss: 0.08237829804420471
Test Loss:  0.07994739711284637
Test Acc:  0.0
Valid Loss:  0.07599236071109772
Valid Acc:  0.0
std:  0.013961256364264549 
thres:  6.660485491156579e-05
Preserved_eigens number check:  512
  3%|▎         | 34/1000 [11:42<4:44:51, 17.69s/it]Epoch:   35
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(2.4562, device='cuda:0') 
Std:  tensor(62.6847, device='cuda:0') 
ABS Max:  tensor(728.8574, device='cuda:0') 
ABS Min:  tensor(0.0054, device='cuda:0')
Criterion check:  tensor([1.0022, 1.0000, 1.0001, 1.0008, 1.0020, 0.9989, 0.9991, 0.9996, 0.9992,
        0.9927], device='cuda:0') tensor(276, device='cuda:0')
max of Lambda2 tensor(343340.8750, device='cuda:0')
min of Lambda2 tensor(1.4930e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.4779, device='cuda:0')
min of grad d_p:  tensor(-0.1377, device='cuda:0')
max|min: (J_L, Jta/N)  (1.4778740406036377, 1.4778715372085571, ratio: 0.9999983310699463)|(-0.13769696652889252, -0.13769692182540894)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.5034e-06, device='cuda:0') mean:  tensor(1.3330e-10, device='cuda:0') min:  tensor(-1.6019e-07, device='cuda:0') norm:  tensor(7.3244e-06, device='cuda:0') MSE:  tensor(9.2294e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0023, device='cuda:0') mean:  tensor(3.9507e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0569, device='cuda:0') MSE:  tensor(7.1668e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0051, device='cuda:0')
min of d_p_list:  tensor(-0.0045, device='cuda:0')
Epoch:  35  
Training Loss: 0.06660524010658264
Test Loss:  0.06630860269069672
Test Acc:  0.0
Valid Loss:  0.0608622170984745
Valid Acc:  0.0
std:  0.01203737520983418 
thres:  6.371764019131661e-05
Preserved_eigens number check:  512
  4%|▎         | 35/1000 [12:00<4:45:55, 17.78s/it]Epoch:   36
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(4.4813, device='cuda:0') 
Std:  tensor(110.8167, device='cuda:0') 
ABS Max:  tensor(2461.7227, device='cuda:0') 
ABS Min:  tensor(5.8558e-05, device='cuda:0')
Criterion check:  tensor([0.9947, 1.0000, 0.9998, 1.0000, 0.9998, 1.0000, 1.0016, 1.0010, 1.0000,
        1.0000], device='cuda:0') tensor(235, device='cuda:0')
max of Lambda2 tensor(310269.0312, device='cuda:0')
min of Lambda2 tensor(0.0001, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.3510, device='cuda:0')
min of grad d_p:  tensor(-0.1266, device='cuda:0')
max|min: (J_L, Jta/N)  (1.351041555404663, 1.3510427474975586, ratio: 1.0000008344650269)|(-0.12664958834648132, -0.12664960324764252)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.5451e-06, device='cuda:0') mean:  tensor(-2.7683e-11, device='cuda:0') min:  tensor(-1.5367e-06, device='cuda:0') norm:  tensor(6.6938e-06, device='cuda:0') MSE:  tensor(8.4347e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0010, device='cuda:0') mean:  tensor(5.1261e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0075, device='cuda:0') MSE:  tensor(9.5135e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0076, device='cuda:0')
min of d_p_list:  tensor(-0.0066, device='cuda:0')
Epoch:  36  
Training Loss: 0.04414958506822586
Test Loss:  0.04332186281681061
Test Acc:  0.0
Valid Loss:  0.04000774770975113
Valid Acc:  0.0
std:  0.014003704776695741 
thres:  5.90064249932766e-05
Preserved_eigens number check:  512
  4%|▎         | 36/1000 [12:17<4:42:35, 17.59s/it]Epoch:   37
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-3.7549, device='cuda:0') 
Std:  tensor(39.3668, device='cuda:0') 
ABS Max:  tensor(656.3333, device='cuda:0') 
ABS Min:  tensor(0.0033, device='cuda:0')
Criterion check:  tensor([0.9982, 1.0058, 0.9990, 0.9999, 1.0013, 0.9952, 1.0082, 0.9981, 1.0047,
        1.0007], device='cuda:0') tensor(243, device='cuda:0')
max of Lambda2 tensor(729464.6875, device='cuda:0')
min of Lambda2 tensor(0.0003, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1117, device='cuda:0')
min of grad d_p:  tensor(-1.9080, device='cuda:0')
max|min: (J_L, Jta/N)  (0.11166840046644211, 0.11166844516992569, ratio: 1.0000003576278687)|(-1.9079614877700806, -1.9079639911651611)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.5034e-06, device='cuda:0') mean:  tensor(-5.7160e-11, device='cuda:0') min:  tensor(-3.3872e-07, device='cuda:0') norm:  tensor(7.6414e-06, device='cuda:0') MSE:  tensor(9.6287e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0071, device='cuda:0') mean:  tensor(1.3309e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0218, device='cuda:0') MSE:  tensor(2.7519e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0054, device='cuda:0')
min of d_p_list:  tensor(-0.0079, device='cuda:0')
Epoch:  37  
Training Loss: 0.04433627054095268
Test Loss:  0.04466523602604866
Test Acc:  0.0
Valid Loss:  0.03849510848522186
Valid Acc:  0.0
std:  0.015198852482619233 
thres:  5.6962966173887255e-05
Preserved_eigens number check:  512
  4%|▎         | 37/1000 [12:34<4:40:57, 17.51s/it]Epoch:   38
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(1.1997, device='cuda:0') 
Std:  tensor(52.5665, device='cuda:0') 
ABS Max:  tensor(536.8998, device='cuda:0') 
ABS Min:  tensor(0.0001, device='cuda:0')
Criterion check:  tensor([1.0001, 0.9997, 1.0002, 1.0000, 1.0009, 0.9896, 0.9248, 1.0004, 1.0000,
        0.9991], device='cuda:0') tensor(254, device='cuda:0')
max of Lambda2 tensor(413510.3750, device='cuda:0')
min of Lambda2 tensor(0.0002, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(2.7308, device='cuda:0')
min of grad d_p:  tensor(-0.1168, device='cuda:0')
max|min: (J_L, Jta/N)  (2.7307868003845215, 2.7307851314544678, ratio: 0.9999994039535522)|(-0.11681649088859558, -0.1168164536356926)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.6689e-06, device='cuda:0') mean:  tensor(-4.7289e-11, device='cuda:0') min:  tensor(-1.1818e-06, device='cuda:0') norm:  tensor(6.3666e-06, device='cuda:0') MSE:  tensor(8.0224e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(5.4880e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0078, device='cuda:0') MSE:  tensor(9.8719e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0017, device='cuda:0')
min of d_p_list:  tensor(-0.0016, device='cuda:0')
Epoch:  38  
Training Loss: 0.03469507396221161
Test Loss:  0.03487793356180191
Test Acc:  0.0
Valid Loss:  0.0299302376806736
Valid Acc:  0.0
std:  0.01747215730604839 
thres:  5.44328935444355e-05
Preserved_eigens number check:  512
  4%|▍         | 38/1000 [12:51<4:38:57, 17.40s/it]Epoch:   39
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(214.4729, device='cuda:0') 
Std:  tensor(10406.6455, device='cuda:0') 
ABS Max:  tensor(189630.4375, device='cuda:0') 
ABS Min:  tensor(0.0451, device='cuda:0')
Criterion check:  tensor([0.9706, 0.9706, 1.0680, 0.9981, 0.9305, 1.0044, 0.9360, 1.0343, 1.0192,
        0.9763], device='cuda:0') tensor(269, device='cuda:0')
max of Lambda2 tensor(381681.3125, device='cuda:0')
min of Lambda2 tensor(0.0003, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(2.1281, device='cuda:0')
min of grad d_p:  tensor(-0.1084, device='cuda:0')
max|min: (J_L, Jta/N)  (2.128136157989502, 2.128136157989502, ratio: 1.0)|(-0.10839046537876129, -0.10839042067527771)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.5273e-07, device='cuda:0') mean:  tensor(1.5181e-11, device='cuda:0') min:  tensor(-1.8396e-07, device='cuda:0') norm:  tensor(3.9808e-06, device='cuda:0') MSE:  tensor(5.0161e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0059, device='cuda:0') mean:  tensor(2.9193e-05, device='cuda:0') min:  tensor(1.1301e-13, device='cuda:0') norm:  tensor(0.0432, device='cuda:0') MSE:  tensor(5.4435e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0052, device='cuda:0')
min of d_p_list:  tensor(-0.0086, device='cuda:0')
Epoch:  39  
Training Loss: 0.025342443957924843
Test Loss:  0.025292985141277313
Test Acc:  0.0
Valid Loss:  0.021971000358462334
Valid Acc:  0.0
std:  0.013719127514939252 
thres:  4.302572272717953e-05
Preserved_eigens number check:  512
  4%|▍         | 39/1000 [13:08<4:37:56, 17.35s/it]Epoch:   40
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-27.2748, device='cuda:0') 
Std:  tensor(381.1682, device='cuda:0') 
ABS Max:  tensor(6785.3262, device='cuda:0') 
ABS Min:  tensor(0.0051, device='cuda:0')
Criterion check:  tensor([1.0011, 0.9954, 0.9964, 0.9946, 1.0239, 1.0130, 1.0052, 1.0070, 1.0035,
        1.0019], device='cuda:0') tensor(265, device='cuda:0')
max of Lambda2 tensor(670407.0625, device='cuda:0')
min of Lambda2 tensor(0.0003, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(2.6203, device='cuda:0')
min of grad d_p:  tensor(-0.1060, device='cuda:0')
max|min: (J_L, Jta/N)  (2.620260000228882, 2.620267152786255, ratio: 1.0000027418136597)|(-0.10599397122859955, -0.10599413514137268)

 check Jacobi res:  torch.Size([793601]) max:  tensor(6.2538e-07, device='cuda:0') mean:  tensor(-1.0512e-10, device='cuda:0') min:  tensor(-7.1526e-06, device='cuda:0') norm:  tensor(1.4170e-05, device='cuda:0') MSE:  tensor(1.7855e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0044, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1555, device='cuda:0') MSE:  tensor(1.9589e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0023, device='cuda:0')
min of d_p_list:  tensor(-0.0017, device='cuda:0')
Epoch:  40  
Training Loss: 0.02221965417265892
Test Loss:  0.02246783673763275
Test Acc:  0.0
Valid Loss:  0.019616449251770973
Valid Acc:  0.0
std:  0.009208203950457532 
thres:  3.414860554039478e-05
Preserved_eigens number check:  512
  4%|▍         | 40/1000 [13:26<4:37:32, 17.35s/it]Epoch:   41
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-111.8096, device='cuda:0') 
Std:  tensor(2535.4988, device='cuda:0') 
ABS Max:  tensor(57365.6055, device='cuda:0') 
ABS Min:  tensor(0.0028, device='cuda:0')
Criterion check:  tensor([1.0030, 1.0006, 1.0006, 1.0002, 0.9992, 1.0007, 0.9999, 1.0004, 1.0004,
        0.9997], device='cuda:0') tensor(235, device='cuda:0')
max of Lambda2 tensor(760860.5000, device='cuda:0')
min of Lambda2 tensor(0.0001, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(2.0739, device='cuda:0')
min of grad d_p:  tensor(-0.0972, device='cuda:0')
max|min: (J_L, Jta/N)  (2.073892831802368, 2.0738954544067383, ratio: 1.000001311302185)|(-0.09718064963817596, -0.09718067198991776)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.8312e-07, device='cuda:0') mean:  tensor(3.7548e-11, device='cuda:0') min:  tensor(-2.6226e-06, device='cuda:0') norm:  tensor(6.2173e-06, device='cuda:0') MSE:  tensor(7.8344e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0143, device='cuda:0') mean:  tensor(1.3044e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0256, device='cuda:0') MSE:  tensor(3.2309e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0023, device='cuda:0')
min of d_p_list:  tensor(-0.0019, device='cuda:0')
Epoch:  41  
Training Loss: 0.020755868405103683
Test Loss:  0.02064862847328186
Test Acc:  0.0
Valid Loss:  0.017817411571741104
Valid Acc:  0.0
std:  0.00887522079231981 
thres:  2.9469862207770348e-05
Preserved_eigens number check:  512
  4%|▍         | 41/1000 [13:43<4:37:25, 17.36s/it]Epoch:   42
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(17.0221, device='cuda:0') 
Std:  tensor(341.5760, device='cuda:0') 
ABS Max:  tensor(7580.6172, device='cuda:0') 
ABS Min:  tensor(0.0017, device='cuda:0')
Criterion check:  tensor([0.9934, 1.0008, 0.9988, 1.0015, 0.9962, 0.9957, 1.0027, 1.0002, 1.0001,
        1.0013], device='cuda:0') tensor(232, device='cuda:0')
max of Lambda2 tensor(631965.8125, device='cuda:0')
min of Lambda2 tensor(1.1781e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.7315, device='cuda:0')
min of grad d_p:  tensor(-0.0865, device='cuda:0')
max|min: (J_L, Jta/N)  (1.7314763069152832, 1.731472373008728, ratio: 0.9999977350234985)|(-0.0864606574177742, -0.08646061271429062)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.9339e-06, device='cuda:0') mean:  tensor(9.4626e-11, device='cuda:0') min:  tensor(-2.7195e-07, device='cuda:0') norm:  tensor(9.9241e-06, device='cuda:0') MSE:  tensor(1.2505e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0018, device='cuda:0') mean:  tensor(5.1568e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0080, device='cuda:0') MSE:  tensor(1.0110e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0021, device='cuda:0')
min of d_p_list:  tensor(-0.0021, device='cuda:0')
Epoch:  42  
Training Loss: 0.016810478642582893
Test Loss:  0.01685224659740925
Test Acc:  0.0
Valid Loss:  0.014517849311232567
Valid Acc:  0.0
std:  0.006026006507750924 
thres:  2.396470382809639e-05
Preserved_eigens number check:  512
  4%|▍         | 42/1000 [14:00<4:35:57, 17.28s/it]Epoch:   43
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(-14.0564, device='cuda:0') 
Std:  tensor(278.6160, device='cuda:0') 
ABS Max:  tensor(5203.2236, device='cuda:0') 
ABS Min:  tensor(0.0152, device='cuda:0')
Criterion check:  tensor([0.9960, 0.9997, 1.0002, 0.9996, 1.4835, 1.0143, 1.0019, 1.0023, 0.9973,
        1.0011], device='cuda:0') tensor(270, device='cuda:0')
max of Lambda2 tensor(750503.1875, device='cuda:0')
min of Lambda2 tensor(9.2180e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.5851, device='cuda:0')
min of grad d_p:  tensor(-0.0790, device='cuda:0')
max|min: (J_L, Jta/N)  (1.5851001739501953, 1.58510160446167, ratio: 1.0000009536743164)|(-0.07899286597967148, -0.07899285852909088)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.6391e-07, device='cuda:0') mean:  tensor(-5.6623e-11, device='cuda:0') min:  tensor(-1.4305e-06, device='cuda:0') norm:  tensor(4.6904e-06, device='cuda:0') MSE:  tensor(5.9103e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0022, device='cuda:0') mean:  tensor(1.4411e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0219, device='cuda:0') MSE:  tensor(2.7583e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0037, device='cuda:0')
min of d_p_list:  tensor(-0.0041, device='cuda:0')
Epoch:  43  
Training Loss: 0.017735019326210022
Test Loss:  0.018670469522476196
Test Acc:  0.0
Valid Loss:  0.015876460820436478
Valid Acc:  0.0
std:  0.003088792880203591 
thres:  2.0572692900896072e-05
Preserved_eigens number check:  512
  4%|▍         | 43/1000 [14:18<4:35:39, 17.28s/it]Epoch:   44
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-2.0760, device='cuda:0') 
Std:  tensor(33.6578, device='cuda:0') 
ABS Max:  tensor(461.6864, device='cuda:0') 
ABS Min:  tensor(0.0038, device='cuda:0')
Criterion check:  tensor([0.9995, 0.9995, 0.9998, 1.0004, 1.0082, 1.0017, 0.9988, 1.0000, 1.0008,
        0.9999], device='cuda:0') tensor(248, device='cuda:0')
max of Lambda2 tensor(558515.8750, device='cuda:0')
min of Lambda2 tensor(0.0003, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.5866, device='cuda:0')
min of grad d_p:  tensor(-0.0753, device='cuda:0')
max|min: (J_L, Jta/N)  (1.5866444110870361, 1.5866446495056152, ratio: 1.0000001192092896)|(-0.07532399892807007, -0.07532408088445663)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.6910e-07, device='cuda:0') mean:  tensor(-6.5476e-11, device='cuda:0') min:  tensor(-6.8918e-07, device='cuda:0') norm:  tensor(6.3098e-06, device='cuda:0') MSE:  tensor(7.9509e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0018, device='cuda:0') mean:  tensor(7.9541e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0121, device='cuda:0') MSE:  tensor(1.5291e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0086, device='cuda:0')
min of d_p_list:  tensor(-0.0089, device='cuda:0')
Epoch:  44  
Training Loss: 0.0208359993994236
Test Loss:  0.02125718630850315
Test Acc:  0.0
Valid Loss:  0.01912403479218483
Valid Acc:  0.0
std:  0.002047457151607947 
thres:  1.9671403989195824e-05
Preserved_eigens number check:  512
  4%|▍         | 44/1000 [14:35<4:36:05, 17.33s/it]Epoch:   45
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(-16.7618, device='cuda:0') 
Std:  tensor(361.2648, device='cuda:0') 
ABS Max:  tensor(4624.7710, device='cuda:0') 
ABS Min:  tensor(0.0004, device='cuda:0')
Criterion check:  tensor([1.0025, 0.9994, 1.0016, 0.9904, 1.0142, 1.0122, 0.9881, 0.9978, 0.9978,
        1.0001], device='cuda:0') tensor(263, device='cuda:0')
max of Lambda2 tensor(384942.5312, device='cuda:0')
min of Lambda2 tensor(1.9923e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(2.2381, device='cuda:0')
min of grad d_p:  tensor(-0.0961, device='cuda:0')
max|min: (J_L, Jta/N)  (2.2380948066711426, 2.2380950450897217, ratio: 1.0000001192092896)|(-0.09611313045024872, -0.09611313045024872)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.6193e-07, device='cuda:0') mean:  tensor(2.8496e-11, device='cuda:0') min:  tensor(-2.3842e-07, device='cuda:0') norm:  tensor(3.5619e-06, device='cuda:0') MSE:  tensor(4.4882e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0066, device='cuda:0') mean:  tensor(2.0503e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0304, device='cuda:0') MSE:  tensor(3.8264e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0020, device='cuda:0')
min of d_p_list:  tensor(-0.0021, device='cuda:0')
Epoch:  45  
Training Loss: 0.01710064336657524
Test Loss:  0.017297782003879547
Test Acc:  0.0
Valid Loss:  0.01553133875131607
Valid Acc:  0.0
std:  0.0017795943803625138 
thres:  1.8647601827979087e-05
Preserved_eigens number check:  512
  4%|▍         | 45/1000 [14:53<4:36:50, 17.39s/it]Epoch:   46
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(0.1265, device='cuda:0') 
Std:  tensor(10.0924, device='cuda:0') 
ABS Max:  tensor(168.1367, device='cuda:0') 
ABS Min:  tensor(0.0016, device='cuda:0')
Criterion check:  tensor([0.9999, 1.0001, 0.9997, 0.9882, 1.0002, 1.0006, 0.9997, 1.0159, 1.0002,
        1.0010], device='cuda:0') tensor(257, device='cuda:0')
max of Lambda2 tensor(331784.0938, device='cuda:0')
min of Lambda2 tensor(6.6478e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.8739, device='cuda:0')
min of grad d_p:  tensor(-0.0865, device='cuda:0')
max|min: (J_L, Jta/N)  (1.873944640159607, 1.8739445209503174, ratio: 0.9999999403953552)|(-0.08645510673522949, -0.08645505458116531)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.9884e-07, device='cuda:0') mean:  tensor(-1.3491e-11, device='cuda:0') min:  tensor(-1.0998e-07, device='cuda:0') norm:  tensor(3.8391e-06, device='cuda:0') MSE:  tensor(4.8376e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0015, device='cuda:0') mean:  tensor(3.8153e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0060, device='cuda:0') MSE:  tensor(7.5312e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0018, device='cuda:0')
min of d_p_list:  tensor(-0.0022, device='cuda:0')
Epoch:  46  
Training Loss: 0.017448250204324722
Test Loss:  0.01752011477947235
Test Acc:  0.0
Valid Loss:  0.01483226753771305
Valid Acc:  0.0
std:  0.001458791932909286 
thres:  1.7986078187823295e-05
Preserved_eigens number check:  512
  5%|▍         | 46/1000 [15:10<4:37:39, 17.46s/it]Epoch:   47
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.6547, device='cuda:0') 
Std:  tensor(92.1459, device='cuda:0') 
ABS Max:  tensor(1317.5428, device='cuda:0') 
ABS Min:  tensor(0.0095, device='cuda:0')
Criterion check:  tensor([1.0050, 1.0024, 1.0024, 1.0127, 1.0125, 1.0363, 0.9915, 0.9913, 0.9944,
        0.8834], device='cuda:0') tensor(277, device='cuda:0')
max of Lambda2 tensor(387716.1250, device='cuda:0')
min of Lambda2 tensor(0.0003, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.8732, device='cuda:0')
min of grad d_p:  tensor(-0.0805, device='cuda:0')
max|min: (J_L, Jta/N)  (1.8732316493988037, 1.8732280731201172, ratio: 0.9999980926513672)|(-0.0805148109793663, -0.0805148035287857)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.5763e-06, device='cuda:0') mean:  tensor(-1.2460e-11, device='cuda:0') min:  tensor(-1.3493e-07, device='cuda:0') norm:  tensor(4.6579e-06, device='cuda:0') MSE:  tensor(5.8693e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0083, device='cuda:0') mean:  tensor(1.3851e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0227, device='cuda:0') MSE:  tensor(2.8636e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0029, device='cuda:0')
min of d_p_list:  tensor(-0.0032, device='cuda:0')
Epoch:  47  
Training Loss: 0.018939539790153503
Test Loss:  0.0187874473631382
Test Acc:  0.0
Valid Loss:  0.015432262793183327
Valid Acc:  0.0
std:  0.0013609440826085222 
thres:  1.8411890417337417e-05
Preserved_eigens number check:  512
  5%|▍         | 47/1000 [15:28<4:37:38, 17.48s/it]Epoch:   48
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  510
Criterion check: 
Mean:  tensor(2.1551, device='cuda:0') 
Std:  tensor(127.5209, device='cuda:0') 
ABS Max:  tensor(1676.8390, device='cuda:0') 
ABS Min:  tensor(0.0186, device='cuda:0')
Criterion check:  tensor([0.9991, 1.0040, 0.9999, 1.0002, 0.9983, 1.0001, 1.0034, 0.9984, 0.9999,
        0.9992], device='cuda:0') tensor(264, device='cuda:0')
max of Lambda2 tensor(373215.5938, device='cuda:0')
min of Lambda2 tensor(6.4788e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0636, device='cuda:0')
min of grad d_p:  tensor(-0.4384, device='cuda:0')
max|min: (J_L, Jta/N)  (0.06356526166200638, 0.06356532126665115, ratio: 1.0000009536743164)|(-0.4383615255355835, -0.4383615553379059)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.5460e-07, device='cuda:0') mean:  tensor(5.7938e-11, device='cuda:0') min:  tensor(-3.9587e-07, device='cuda:0') norm:  tensor(4.7821e-06, device='cuda:0') MSE:  tensor(6.0258e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0008, device='cuda:0') mean:  tensor(4.6335e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0069, device='cuda:0') MSE:  tensor(8.6488e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0016, device='cuda:0')
min of d_p_list:  tensor(-0.0012, device='cuda:0')
Epoch:  48  
Training Loss: 0.015700234100222588
Test Loss:  0.015625275671482086
Test Acc:  0.0
Valid Loss:  0.012843135744333267
Valid Acc:  0.0
std:  0.001750868316287732 
thres:  1.8004933372139932e-05
Preserved_eigens number check:  512
  5%|▍         | 48/1000 [15:45<4:38:27, 17.55s/it]Epoch:   49
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(2.4468, device='cuda:0') 
Std:  tensor(392.6228, device='cuda:0') 
ABS Max:  tensor(7231.4497, device='cuda:0') 
ABS Min:  tensor(0.0037, device='cuda:0')
Criterion check:  tensor([1.0005, 0.9998, 1.0028, 1.0009, 0.9990, 1.0007, 1.0010, 1.0006, 0.9999,
        0.9999], device='cuda:0') tensor(254, device='cuda:0')
max of Lambda2 tensor(393252.4375, device='cuda:0')
min of Lambda2 tensor(1.6481e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0586, device='cuda:0')
min of grad d_p:  tensor(-0.5906, device='cuda:0')
max|min: (J_L, Jta/N)  (0.05863412097096443, 0.058634091168642044, ratio: 0.999999463558197)|(-0.5906401872634888, -0.5910869240760803)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(-2.6042e-08, device='cuda:0') min:  tensor(-0.0001, device='cuda:0') norm:  tensor(0.0028, device='cuda:0') MSE:  tensor(3.4734e-09, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(1.3756e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0198, device='cuda:0') MSE:  tensor(2.4906e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0028, device='cuda:0')
min of d_p_list:  tensor(-0.0029, device='cuda:0')
Epoch:  49  
Training Loss: 0.012779219076037407
Test Loss:  0.013097995892167091
Test Acc:  0.0
Valid Loss:  0.010849576443433762
Valid Acc:  0.0
std:  0.002080313078490407 
thres:  1.6393577307462693e-05
Preserved_eigens number check:  512
  5%|▍         | 49/1000 [16:03<4:37:31, 17.51s/it]Epoch:   50
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(2.6292, device='cuda:0') 
Std:  tensor(61.9134, device='cuda:0') 
ABS Max:  tensor(1279.1639, device='cuda:0') 
ABS Min:  tensor(0.0009, device='cuda:0')
Criterion check:  tensor([1.0010, 0.9996, 1.0173, 0.9999, 0.9995, 0.9999, 1.0003, 0.9995, 1.0005,
        1.0004], device='cuda:0') tensor(256, device='cuda:0')
max of Lambda2 tensor(369256.2812, device='cuda:0')
min of Lambda2 tensor(0.0001, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0546, device='cuda:0')
min of grad d_p:  tensor(-0.7067, device='cuda:0')
max|min: (J_L, Jta/N)  (0.054593708366155624, 0.05459367111325264, ratio: 0.9999993443489075)|(-0.7067481875419617, -0.7067460417747498)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.0245e-07, device='cuda:0') mean:  tensor(1.8285e-11, device='cuda:0') min:  tensor(-2.1458e-06, device='cuda:0') norm:  tensor(3.2794e-06, device='cuda:0') MSE:  tensor(4.1323e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0008, device='cuda:0') mean:  tensor(1.5765e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0025, device='cuda:0') MSE:  tensor(3.1424e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0010, device='cuda:0')
min of d_p_list:  tensor(-0.0010, device='cuda:0')
Epoch:  50  
Training Loss: 0.010020443238317966
Test Loss:  0.010249289683997631
Test Acc:  0.0
Valid Loss:  0.008571945130825043
Valid Acc:  0.0
std:  0.00321650621646533 
thres:  1.4977537281811238e-05
Preserved_eigens number check:  512
  5%|▌         | 50/1000 [16:20<4:35:16, 17.39s/it]Epoch:   51
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(2.6349, device='cuda:0') 
Std:  tensor(21.8356, device='cuda:0') 
ABS Max:  tensor(242.6488, device='cuda:0') 
ABS Min:  tensor(0.0030, device='cuda:0')
Criterion check:  tensor([0.9988, 0.9985, 1.0373, 0.9993, 0.9985, 1.0001, 1.0008, 1.0010, 0.9988,
        1.0001], device='cuda:0') tensor(266, device='cuda:0')
max of Lambda2 tensor(362935.2500, device='cuda:0')
min of Lambda2 tensor(9.6627e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0492, device='cuda:0')
min of grad d_p:  tensor(-0.5423, device='cuda:0')
max|min: (J_L, Jta/N)  (0.0492001473903656, 0.04920005053281784, ratio: 0.9999980330467224)|(-0.5422890782356262, -0.5422888994216919)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.1087e-07, device='cuda:0') mean:  tensor(6.3798e-11, device='cuda:0') min:  tensor(-2.0468e-07, device='cuda:0') norm:  tensor(5.9968e-06, device='cuda:0') MSE:  tensor(7.5564e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0024, device='cuda:0') mean:  tensor(1.0261e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0154, device='cuda:0') MSE:  tensor(1.9356e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0073, device='cuda:0')
min of d_p_list:  tensor(-0.0065, device='cuda:0')
Epoch:  51  
Training Loss: 0.01655406877398491
Test Loss:  0.017723917961120605
Test Acc:  0.0
Valid Loss:  0.014418628066778183
Valid Acc:  0.0
std:  0.003096794417363473 
thres:  1.4798700995743274e-05
Preserved_eigens number check:  512
  5%|▌         | 51/1000 [16:37<4:35:37, 17.43s/it]Epoch:   52
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-3.7074, device='cuda:0') 
Std:  tensor(208.5961, device='cuda:0') 
ABS Max:  tensor(4442.1255, device='cuda:0') 
ABS Min:  tensor(0.0020, device='cuda:0')
Criterion check:  tensor([0.9980, 0.9995, 1.0007, 1.0006, 0.9999, 0.9961, 0.9997, 1.0003, 0.9985,
        0.9962], device='cuda:0') tensor(253, device='cuda:0')
max of Lambda2 tensor(387756.5625, device='cuda:0')
min of Lambda2 tensor(0.0001, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0530, device='cuda:0')
min of grad d_p:  tensor(-0.7521, device='cuda:0')
max|min: (J_L, Jta/N)  (0.05301884561777115, 0.05301894247531891, ratio: 1.0000017881393433)|(-0.7520776987075806, -0.7520797252655029)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.0266e-06, device='cuda:0') mean:  tensor(-4.6076e-11, device='cuda:0') min:  tensor(-3.4831e-07, device='cuda:0') norm:  tensor(5.3423e-06, device='cuda:0') MSE:  tensor(6.7317e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0022, device='cuda:0') mean:  tensor(6.4489e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0096, device='cuda:0') MSE:  tensor(1.2040e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0019, device='cuda:0')
min of d_p_list:  tensor(-0.0015, device='cuda:0')
Epoch:  52  
Training Loss: 0.01337854191660881
Test Loss:  0.014279697090387344
Test Acc:  0.0
Valid Loss:  0.01214294508099556
Valid Acc:  0.0
std:  0.0023080747273825186 
thres:  1.3686501421034336e-05
Preserved_eigens number check:  512
  5%|▌         | 52/1000 [16:55<4:36:05, 17.47s/it]Epoch:   53
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-2.1889, device='cuda:0') 
Std:  tensor(202.3778, device='cuda:0') 
ABS Max:  tensor(3303.9048, device='cuda:0') 
ABS Min:  tensor(0.0016, device='cuda:0')
Criterion check:  tensor([0.9942, 1.0015, 0.9983, 1.0005, 0.9969, 0.9952, 1.0011, 1.0021, 0.9962,
        1.0053], device='cuda:0') tensor(263, device='cuda:0')
max of Lambda2 tensor(398351.8125, device='cuda:0')
min of Lambda2 tensor(0.0001, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0492, device='cuda:0')
min of grad d_p:  tensor(-0.4874, device='cuda:0')
max|min: (J_L, Jta/N)  (0.049170952290296555, 0.04917081445455551, ratio: 0.9999971985816956)|(-0.48735615611076355, -0.48735859990119934)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.4438e-06, device='cuda:0') mean:  tensor(3.5383e-11, device='cuda:0') min:  tensor(-1.9511e-07, device='cuda:0') norm:  tensor(5.9233e-06, device='cuda:0') MSE:  tensor(7.4638e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0029, device='cuda:0') mean:  tensor(5.1116e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0080, device='cuda:0') MSE:  tensor(1.0082e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0070, device='cuda:0')
min of d_p_list:  tensor(-0.0052, device='cuda:0')
Epoch:  53  
Training Loss: 0.015318404883146286
Test Loss:  0.016398122534155846
Test Acc:  0.0
Valid Loss:  0.015097912400960922
Valid Acc:  0.0
std:  0.0022456569476270905 
thres:  1.3610135577619076e-05
Preserved_eigens number check:  512
  5%|▌         | 53/1000 [17:13<4:36:36, 17.53s/it]Epoch:   54
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  510
Criterion check: 
Mean:  tensor(-15.7353, device='cuda:0') 
Std:  tensor(580.6029, device='cuda:0') 
ABS Max:  tensor(7223.1401, device='cuda:0') 
ABS Min:  tensor(0.0071, device='cuda:0')
Criterion check:  tensor([1.0042, 0.9974, 1.0068, 1.0046, 0.9833, 1.0046, 0.9759, 0.9903, 1.0323,
        0.9981], device='cuda:0') tensor(286, device='cuda:0')
max of Lambda2 tensor(289752.3750, device='cuda:0')
min of Lambda2 tensor(3.6524e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0588, device='cuda:0')
min of grad d_p:  tensor(-1.2795, device='cuda:0')
max|min: (J_L, Jta/N)  (0.058810632675886154, 0.05881059169769287, ratio: 0.9999992847442627)|(-1.2795171737670898, -1.2795181274414062)

 check Jacobi res:  torch.Size([793601]) max:  tensor(9.5367e-07, device='cuda:0') mean:  tensor(-4.9091e-11, device='cuda:0') min:  tensor(-6.2212e-07, device='cuda:0') norm:  tensor(5.2865e-06, device='cuda:0') MSE:  tensor(6.6614e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0029, device='cuda:0') mean:  tensor(2.9749e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0438, device='cuda:0') MSE:  tensor(5.5204e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0408, device='cuda:0')
min of d_p_list:  tensor(-0.0233, device='cuda:0')
Epoch:  54  
Training Loss: 0.040207989513874054
Test Loss:  0.043869923800230026
Test Acc:  0.0
Valid Loss:  0.03890937194228172
Valid Acc:  0.0
std:  0.010784273715624753 
thres:  1.9095889665186403e-05
Preserved_eigens number check:  512
  5%|▌         | 54/1000 [17:30<4:37:05, 17.57s/it]Epoch:   55
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  510
Criterion check: 
Mean:  tensor(-215.0739, device='cuda:0') 
Std:  tensor(3562.1504, device='cuda:0') 
ABS Max:  tensor(79017.9609, device='cuda:0') 
ABS Min:  tensor(0.0452, device='cuda:0')
Criterion check:  tensor([1.0122, 1.0076, 0.9997, 1.0072, 1.0039, 1.0031, 1.1183, 0.9998, 0.9967,
        0.9997], device='cuda:0') tensor(257, device='cuda:0')
max of Lambda2 tensor(300895.2188, device='cuda:0')
min of Lambda2 tensor(9.5510e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0804, device='cuda:0')
min of grad d_p:  tensor(-0.0783, device='cuda:0')
max|min: (J_L, Jta/N)  (0.08042116463184357, 0.08042111992835999, ratio: 0.999999463558197)|(-0.07829879224300385, -0.07829872518777847)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.4692e-07, device='cuda:0') mean:  tensor(1.0068e-10, device='cuda:0') min:  tensor(-5.4040e-07, device='cuda:0') norm:  tensor(5.1011e-06, device='cuda:0') MSE:  tensor(6.4277e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0009, device='cuda:0') mean:  tensor(4.5514e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0672, device='cuda:0') MSE:  tensor(8.4694e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0068, device='cuda:0')
min of d_p_list:  tensor(-0.0067, device='cuda:0')
Epoch:  55  
Training Loss: 0.035644419491291046
Test Loss:  0.03874051198363304
Test Acc:  0.0
Valid Loss:  0.030841602012515068
Valid Acc:  0.0
std:  0.01132850632363777 
thres:  2.422068491578102e-05
Preserved_eigens number check:  512
  6%|▌         | 55/1000 [17:48<4:35:22, 17.48s/it]Epoch:   56
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(16.2908, device='cuda:0') 
Std:  tensor(505.5785, device='cuda:0') 
ABS Max:  tensor(11100.9766, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([1.0029, 1.0007, 0.9997, 0.9997, 0.9997, 0.9905, 1.7746, 0.9996, 0.9999,
        1.0004], device='cuda:0') tensor(256, device='cuda:0')
max of Lambda2 tensor(285416.1562, device='cuda:0')
min of Lambda2 tensor(3.1458e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0773, device='cuda:0')
min of grad d_p:  tensor(-0.0754, device='cuda:0')
max|min: (J_L, Jta/N)  (0.07727676630020142, 0.0772767886519432, ratio: 1.000000238418579)|(-0.07541035115718842, -0.07541035115718842)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.3039e-07, device='cuda:0') mean:  tensor(-1.8946e-11, device='cuda:0') min:  tensor(-6.1444e-07, device='cuda:0') norm:  tensor(2.5559e-06, device='cuda:0') MSE:  tensor(3.2206e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(3.8897e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0057, device='cuda:0') MSE:  tensor(7.1413e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0092, device='cuda:0')
min of d_p_list:  tensor(-0.0084, device='cuda:0')
Epoch:  56  
Training Loss: 0.030176540836691856
Test Loss:  0.03180661424994469
Test Acc:  0.0
Valid Loss:  0.023901082575321198
Valid Acc:  0.0
std:  0.010781986322460796 
thres:  2.694517932832241e-05
Preserved_eigens number check:  512
  6%|▌         | 56/1000 [18:05<4:34:43, 17.46s/it]Epoch:   57
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(-0.1406, device='cuda:0') 
Std:  tensor(129.5293, device='cuda:0') 
ABS Max:  tensor(2590.3345, device='cuda:0') 
ABS Min:  tensor(0.0027, device='cuda:0')
Criterion check:  tensor([1.0089, 1.0012, 0.9995, 0.9998, 0.9998, 1.0060, 1.0005, 1.0003, 0.9996,
        1.0007], device='cuda:0') tensor(246, device='cuda:0')
max of Lambda2 tensor(330578.7812, device='cuda:0')
min of Lambda2 tensor(4.9353e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0744, device='cuda:0')
min of grad d_p:  tensor(-0.0714, device='cuda:0')
max|min: (J_L, Jta/N)  (0.0744468942284584, 0.07444692403078079, ratio: 1.0000003576278687)|(-0.07137402892112732, -0.07137403637170792)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.1958e-06, device='cuda:0') mean:  tensor(-4.8126e-11, device='cuda:0') min:  tensor(-5.6784e-07, device='cuda:0') norm:  tensor(5.0834e-06, device='cuda:0') MSE:  tensor(6.4055e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(1.2572e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0192, device='cuda:0') MSE:  tensor(2.4194e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.2292, device='cuda:0')
min of d_p_list:  tensor(-0.1025, device='cuda:0')
Epoch:  57  
Training Loss: 0.41819319128990173
Test Loss:  0.486746221780777
Test Acc:  0.0
Valid Loss:  0.3930512070655823
Valid Acc:  0.0
std:  0.15536874157247427 
thres:  0.00010790810920298099
Preserved_eigens number check:  512
  6%|▌         | 57/1000 [18:23<4:36:20, 17.58s/it]Epoch:   58
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  508
Criterion check: 
Mean:  tensor(-1.3297, device='cuda:0') 
Std:  tensor(47.7368, device='cuda:0') 
ABS Max:  tensor(812.5551, device='cuda:0') 
ABS Min:  tensor(0.0077, device='cuda:0')
Criterion check:  tensor([0.9999, 1.0001, 1.0011, 0.9999, 1.0001, 1.0000, 1.0001, 0.9997, 0.9999,
        1.0001], device='cuda:0') tensor(249, device='cuda:0')
max of Lambda2 tensor(160369.8750, device='cuda:0')
min of Lambda2 tensor(1.3943e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2659, device='cuda:0')
min of grad d_p:  tensor(-0.3033, device='cuda:0')
max|min: (J_L, Jta/N)  (0.26592761278152466, 0.26592767238616943, ratio: 1.000000238418579)|(-0.30327489972114563, -0.30327489972114563)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.2387e-07, device='cuda:0') mean:  tensor(5.9624e-12, device='cuda:0') min:  tensor(-2.0862e-07, device='cuda:0') norm:  tensor(4.6121e-06, device='cuda:0') MSE:  tensor(5.8115e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(6.6779e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0096, device='cuda:0') MSE:  tensor(1.2133e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0038, device='cuda:0')
min of d_p_list:  tensor(-0.0044, device='cuda:0')
Epoch:  58  
Training Loss: 0.1568242609500885
Test Loss:  0.17815206944942474
Test Acc:  0.0
Valid Loss:  0.13942110538482666
Valid Acc:  0.0
std:  0.14866901787832962 
thres:  0.00013620928041636944
Preserved_eigens number check:  512
  6%|▌         | 58/1000 [18:40<4:34:40, 17.50s/it]Epoch:   59
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  510
Criterion check: 
Mean:  tensor(5.5173, device='cuda:0') 
Std:  tensor(276.0814, device='cuda:0') 
ABS Max:  tensor(3939.3062, device='cuda:0') 
ABS Min:  tensor(0.0156, device='cuda:0')
Criterion check:  tensor([1.0001, 0.9987, 1.0015, 0.9997, 0.9995, 0.9991, 0.9983, 0.9996, 1.0018,
        1.0001], device='cuda:0') tensor(277, device='cuda:0')
max of Lambda2 tensor(152566.4219, device='cuda:0')
min of Lambda2 tensor(2.5673e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2428, device='cuda:0')
min of grad d_p:  tensor(-0.2769, device='cuda:0')
max|min: (J_L, Jta/N)  (0.24275971949100494, 0.2427597939968109, ratio: 1.0000003576278687)|(-0.2769167423248291, -0.2769166827201843)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.2037e-07, device='cuda:0') mean:  tensor(3.6382e-11, device='cuda:0') min:  tensor(-2.8059e-07, device='cuda:0') norm:  tensor(4.9058e-06, device='cuda:0') MSE:  tensor(6.1817e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(2.2146e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0321, device='cuda:0') MSE:  tensor(4.0505e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0159, device='cuda:0')
min of d_p_list:  tensor(-0.0191, device='cuda:0')
Epoch:  59  
Training Loss: 0.1830243617296219
Test Loss:  0.20404282212257385
Test Acc:  0.0
Valid Loss:  0.1607782542705536
Valid Acc:  0.0
std:  0.14100247170413924 
thres:  0.000164772554859519
Preserved_eigens number check:  512
  6%|▌         | 59/1000 [18:57<4:32:57, 17.40s/it]Epoch:   60
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  510
Criterion check: 
Mean:  tensor(35.2812, device='cuda:0') 
Std:  tensor(1496.8506, device='cuda:0') 
ABS Max:  tensor(15715.6279, device='cuda:0') 
ABS Min:  tensor(0.0032, device='cuda:0')
Criterion check:  tensor([0.9919, 1.0027, 0.9919, 0.9922, 1.2666, 1.0041, 0.9704, 1.0317, 0.9985,
        0.9927], device='cuda:0') tensor(261, device='cuda:0')
max of Lambda2 tensor(173731.2188, device='cuda:0')
min of Lambda2 tensor(3.1910e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2479, device='cuda:0')
min of grad d_p:  tensor(-0.2517, device='cuda:0')
max|min: (J_L, Jta/N)  (0.2479429841041565, 0.2479429841041565, ratio: 1.0)|(-0.25166618824005127, -0.2516661584377289)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.1292e-07, device='cuda:0') mean:  tensor(-2.1129e-11, device='cuda:0') min:  tensor(-2.6429e-07, device='cuda:0') norm:  tensor(4.4472e-06, device='cuda:0') MSE:  tensor(5.6038e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0064, device='cuda:0') mean:  tensor(0.0003, device='cuda:0') min:  tensor(1.3305e-12, device='cuda:0') norm:  tensor(0.4389, device='cuda:0') MSE:  tensor(5.5306e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0050, device='cuda:0')
min of d_p_list:  tensor(-0.0048, device='cuda:0')
Epoch:  60  
Training Loss: 0.15700167417526245
Test Loss:  0.1729608178138733
Test Acc:  0.0
Valid Loss:  0.13486996293067932
Valid Acc:  0.0
std:  0.12637189539089017 
thres:  0.00018904400579631327
Preserved_eigens number check:  512
  6%|▌         | 60/1000 [19:15<4:32:35, 17.40s/it]Epoch:   61
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  510
Criterion check: 
Mean:  tensor(0.9639, device='cuda:0') 
Std:  tensor(26.4758, device='cuda:0') 
ABS Max:  tensor(474.4403, device='cuda:0') 
ABS Min:  tensor(0.0015, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0002, 1.0000, 1.0009, 1.0000, 1.0000,
        1.0003], device='cuda:0') tensor(251, device='cuda:0')
max of Lambda2 tensor(165125.3281, device='cuda:0')
min of Lambda2 tensor(9.6374e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2252, device='cuda:0')
min of grad d_p:  tensor(-0.2306, device='cuda:0')
max|min: (J_L, Jta/N)  (0.22523421049118042, 0.225234255194664, ratio: 1.000000238418579)|(-0.2306329905986786, -0.23063300549983978)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.1362e-07, device='cuda:0') mean:  tensor(3.3171e-11, device='cuda:0') min:  tensor(-2.1957e-07, device='cuda:0') norm:  tensor(4.2576e-06, device='cuda:0') MSE:  tensor(5.3650e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(3.8758e-05, device='cuda:0') mean:  tensor(1.1919e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0018, device='cuda:0') MSE:  tensor(2.2508e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1741, device='cuda:0')
min of d_p_list:  tensor(-0.1885, device='cuda:0')
Epoch:  61  
Training Loss: 0.696361243724823
Test Loss:  0.7872883677482605
Test Acc:  0.0
Valid Loss:  0.7139756083488464
Valid Acc:  0.0
std:  0.21129163567340592 
thres:  0.0003222809463739395
Preserved_eigens number check:  512
  6%|▌         | 61/1000 [19:33<4:34:34, 17.55s/it]Epoch:   62
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  509
Criterion check: 
Mean:  tensor(-0.3518, device='cuda:0') 
Std:  tensor(29.5919, device='cuda:0') 
ABS Max:  tensor(600.1237, device='cuda:0') 
ABS Min:  tensor(0.0016, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0000, 1.0005, 1.0001, 1.0000, 0.9999, 1.0001, 1.0001,
        1.0003], device='cuda:0') tensor(232, device='cuda:0')
max of Lambda2 tensor(166686.2656, device='cuda:0')
min of Lambda2 tensor(4.4695e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3194, device='cuda:0')
min of grad d_p:  tensor(-1.7869, device='cuda:0')
max|min: (J_L, Jta/N)  (0.3194485902786255, 0.3194485604763031, ratio: 0.9999998807907104)|(-1.7868551015853882, -1.7868562936782837)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.1921e-06, device='cuda:0') mean:  tensor(4.6944e-11, device='cuda:0') min:  tensor(-4.4703e-07, device='cuda:0') norm:  tensor(6.3043e-06, device='cuda:0') MSE:  tensor(7.9440e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(3.6951e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0054, device='cuda:0') MSE:  tensor(6.8420e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0180, device='cuda:0')
min of d_p_list:  tensor(-0.0140, device='cuda:0')
Epoch:  62  
Training Loss: 0.4664086699485779
Test Loss:  0.5334529280662537
Test Acc:  0.0
Valid Loss:  0.48181581497192383
Valid Acc:  0.0
std:  0.21648532145586558 
thres:  0.00033192404210567473
Preserved_eigens number check:  512
  6%|▌         | 62/1000 [19:50<4:32:29, 17.43s/it]Epoch:   63
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  509
Criterion check: 
Mean:  tensor(-0.0155, device='cuda:0') 
Std:  tensor(19.7848, device='cuda:0') 
ABS Max:  tensor(223.6934, device='cuda:0') 
ABS Min:  tensor(0.0004, device='cuda:0')
Criterion check:  tensor([1.0001, 1.0000, 1.0001, 1.0000, 1.0002, 1.0000, 1.0000, 1.0001, 1.0007,
        0.9878], device='cuda:0') tensor(235, device='cuda:0')
max of Lambda2 tensor(148828.9375, device='cuda:0')
min of Lambda2 tensor(3.4521e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(2.9790, device='cuda:0')
min of grad d_p:  tensor(-0.5711, device='cuda:0')
max|min: (J_L, Jta/N)  (2.9790172576904297, 2.9790172576904297, ratio: 1.0)|(-0.5711233615875244, -0.5711233615875244)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.3842e-07, device='cuda:0') mean:  tensor(3.8146e-11, device='cuda:0') min:  tensor(-5.5460e-07, device='cuda:0') norm:  tensor(5.4502e-06, device='cuda:0') MSE:  tensor(6.8677e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(4.2547e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0064, device='cuda:0') MSE:  tensor(8.0662e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0105, device='cuda:0')
min of d_p_list:  tensor(-0.0086, device='cuda:0')
Epoch:  63  
Training Loss: 0.3493541479110718
Test Loss:  0.3919697105884552
Test Acc:  0.0
Valid Loss:  0.34548649191856384
Valid Acc:  0.0
std:  0.19827243670377315 
thres:  0.0003704300194978714
Preserved_eigens number check:  512
  6%|▋         | 63/1000 [20:07<4:32:51, 17.47s/it]Epoch:   64
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  510
Criterion check: 
Mean:  tensor(-18.4338, device='cuda:0') 
Std:  tensor(5897.4668, device='cuda:0') 
ABS Max:  tensor(112794.2734, device='cuda:0') 
ABS Min:  tensor(0.0597, device='cuda:0')
Criterion check:  tensor([1.0001, 1.0022, 1.0014, 0.9976, 0.9992, 0.9959, 0.9860, 1.0053, 0.7162,
        1.0209], device='cuda:0') tensor(268, device='cuda:0')
max of Lambda2 tensor(163242.9844, device='cuda:0')
min of Lambda2 tensor(1.1621e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.8113, device='cuda:0')
min of grad d_p:  tensor(-0.5138, device='cuda:0')
max|min: (J_L, Jta/N)  (1.8113142251968384, 1.8113147020339966, ratio: 1.000000238418579)|(-0.5138136148452759, -0.5138135552406311)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.8999e-07, device='cuda:0') mean:  tensor(-5.7365e-11, device='cuda:0') min:  tensor(-4.7684e-07, device='cuda:0') norm:  tensor(5.5013e-06, device='cuda:0') MSE:  tensor(6.9321e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0064, device='cuda:0') mean:  tensor(0.0002, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.2502, device='cuda:0') MSE:  tensor(3.1531e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0111, device='cuda:0')
min of d_p_list:  tensor(-0.0098, device='cuda:0')
Epoch:  64  
Training Loss: 0.27568483352661133
Test Loss:  0.305999755859375
Test Acc:  0.0
Valid Loss:  0.2648645043373108
Valid Acc:  0.0
std:  0.1836836263125861 
thres:  0.00038896211385726934
Preserved_eigens number check:  512
  6%|▋         | 64/1000 [20:25<4:32:52, 17.49s/it]Epoch:   65
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  510
Criterion check: 
Mean:  tensor(-5.1115, device='cuda:0') 
Std:  tensor(133.7946, device='cuda:0') 
ABS Max:  tensor(2734.2163, device='cuda:0') 
ABS Min:  tensor(0.0117, device='cuda:0')
Criterion check:  tensor([1.0001, 0.9998, 0.9999, 0.9999, 0.9972, 0.9998, 0.9999, 1.0000, 0.9977,
        0.9959], device='cuda:0') tensor(273, device='cuda:0')
max of Lambda2 tensor(157085.6406, device='cuda:0')
min of Lambda2 tensor(1.8926e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.0922, device='cuda:0')
min of grad d_p:  tensor(-0.4653, device='cuda:0')
max|min: (J_L, Jta/N)  (1.0921604633331299, 1.092159628868103, ratio: 0.9999992251396179)|(-0.46527403593063354, -0.465273916721344)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.3447e-07, device='cuda:0') mean:  tensor(-4.1312e-11, device='cuda:0') min:  tensor(-9.0897e-07, device='cuda:0') norm:  tensor(5.2883e-06, device='cuda:0') MSE:  tensor(6.6637e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(2.4060e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0349, device='cuda:0') MSE:  tensor(4.4017e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0067, device='cuda:0')
min of d_p_list:  tensor(-0.0103, device='cuda:0')
Epoch:  65  
Training Loss: 0.20892783999443054
Test Loss:  0.22764182090759277
Test Acc:  0.0
Valid Loss:  0.19260695576667786
Valid Acc:  0.0
std:  0.1713276403416697 
thres:  0.0003993473470211029
Preserved_eigens number check:  512
  6%|▋         | 65/1000 [20:43<4:33:55, 17.58s/it]Epoch:   66
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  508
Criterion check: 
Mean:  tensor(0.7823, device='cuda:0') 
Std:  tensor(31.5223, device='cuda:0') 
ABS Max:  tensor(335.7338, device='cuda:0') 
ABS Min:  tensor(0.0015, device='cuda:0')
Criterion check:  tensor([1.0001, 1.0000, 1.0000, 1.0000, 0.9997, 1.0000, 1.0002, 1.0001, 1.0001,
        1.0003], device='cuda:0') tensor(228, device='cuda:0')
max of Lambda2 tensor(166307.3281, device='cuda:0')
min of Lambda2 tensor(4.9633e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.7204, device='cuda:0')
min of grad d_p:  tensor(-0.4309, device='cuda:0')
max|min: (J_L, Jta/N)  (1.7204015254974365, 1.7204010486602783, ratio: 0.9999997019767761)|(-0.43093180656433105, -0.43093180656433105)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.3583e-07, device='cuda:0') mean:  tensor(-1.5625e-11, device='cuda:0') min:  tensor(-2.5332e-07, device='cuda:0') norm:  tensor(4.9839e-06, device='cuda:0') MSE:  tensor(6.2801e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(9.7394e-05, device='cuda:0') mean:  tensor(2.3667e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0036, device='cuda:0') MSE:  tensor(4.5371e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0167, device='cuda:0')
min of d_p_list:  tensor(-0.0142, device='cuda:0')
Epoch:  66  
Training Loss: 0.17496877908706665
Test Loss:  0.18863700330257416
Test Acc:  0.0
Valid Loss:  0.15549665689468384
Valid Acc:  0.0
std:  0.10442630722381852 
thres:  0.0002950688540935517
Preserved_eigens number check:  512
  7%|▋         | 66/1000 [21:00<4:32:26, 17.50s/it]Epoch:   67
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  508
Criterion check: 
Mean:  tensor(0.2210, device='cuda:0') 
Std:  tensor(66.6515, device='cuda:0') 
ABS Max:  tensor(1178.8967, device='cuda:0') 
ABS Min:  tensor(0.0027, device='cuda:0')
Criterion check:  tensor([1.0000, 0.9998, 1.0000, 1.0003, 1.0021, 1.0001, 1.0001, 1.0000, 0.9998,
        1.0004], device='cuda:0') tensor(242, device='cuda:0')
max of Lambda2 tensor(201165.9844, device='cuda:0')
min of Lambda2 tensor(2.7077e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1924, device='cuda:0')
min of grad d_p:  tensor(-1.7676, device='cuda:0')
max|min: (J_L, Jta/N)  (0.19236713647842407, 0.19236710667610168, ratio: 0.9999998211860657)|(-1.7675814628601074, -1.7675837278366089)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.2650e-06, device='cuda:0') mean:  tensor(1.8737e-11, device='cuda:0') min:  tensor(-2.3842e-07, device='cuda:0') norm:  tensor(5.2120e-06, device='cuda:0') MSE:  tensor(6.5675e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0011, device='cuda:0') mean:  tensor(2.8480e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0444, device='cuda:0') MSE:  tensor(5.5956e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0130, device='cuda:0')
min of d_p_list:  tensor(-0.0083, device='cuda:0')
Epoch:  67  
Training Loss: 0.16226494312286377
Test Loss:  0.1756105124950409
Test Acc:  0.0
Valid Loss:  0.14704880118370056
Valid Acc:  0.0
std:  0.06971819441208416 
thres:  0.00023424010872840882
Preserved_eigens number check:  512
  7%|▋         | 67/1000 [21:17<4:31:49, 17.48s/it]Epoch:   68
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  508
Criterion check: 
Mean:  tensor(-0.2662, device='cuda:0') 
Std:  tensor(23.4839, device='cuda:0') 
ABS Max:  tensor(283.9579, device='cuda:0') 
ABS Min:  tensor(0.0013, device='cuda:0')
Criterion check:  tensor([0.9999, 1.0001, 1.0001, 1.0000, 1.0000, 1.0000, 1.0005, 0.9999, 0.9999,
        0.9951], device='cuda:0') tensor(219, device='cuda:0')
max of Lambda2 tensor(163933.2656, device='cuda:0')
min of Lambda2 tensor(3.2744e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1795, device='cuda:0')
min of grad d_p:  tensor(-0.5526, device='cuda:0')
max|min: (J_L, Jta/N)  (0.1794528365135193, 0.17945285141468048, ratio: 1.0000001192092896)|(-0.5526214241981506, -0.5526229739189148)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.5497e-06, device='cuda:0') mean:  tensor(-5.0622e-11, device='cuda:0') min:  tensor(-5.7137e-07, device='cuda:0') norm:  tensor(4.6633e-06, device='cuda:0') MSE:  tensor(5.8761e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(3.0116e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0044, device='cuda:0') MSE:  tensor(5.5259e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(1.0381, device='cuda:0')
min of d_p_list:  tensor(-0.9361, device='cuda:0')
Epoch:  68  
Training Loss: 301.84844970703125
Test Loss:  320.7832946777344
Test Acc:  0.0
Valid Loss:  317.75006103515625
Valid Acc:  0.0
std:  120.65720165734541 
thres:  0.060534059220552446
Preserved_eigens number check:  512
  7%|▋         | 68/1000 [21:35<4:32:16, 17.53s/it]Epoch:   69
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  507
Criterion check: 
Mean:  tensor(-1110.0522, device='cuda:0') 
Std:  tensor(76971.2031, device='cuda:0') 
ABS Max:  tensor(1431905., device='cuda:0') 
ABS Min:  tensor(0.0115, device='cuda:0')
Criterion check:  tensor([0.9951, 1.0087, 1.0051, 1.0042, 0.9961, 1.0026, 0.9851, 0.8507, 1.0169,
        1.0056], device='cuda:0') tensor(276, device='cuda:0')
max of Lambda2 tensor(142237.8906, device='cuda:0')
min of Lambda2 tensor(3.1378e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1897, device='cuda:0')
min of grad d_p:  tensor(-0.7549, device='cuda:0')
max|min: (J_L, Jta/N)  (0.18969938158988953, 0.18969941139221191, ratio: 1.0000001192092896)|(-0.7548686265945435, -0.7548685073852539)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.6822e-07, device='cuda:0') mean:  tensor(-7.3270e-11, device='cuda:0') min:  tensor(-3.2045e-07, device='cuda:0') norm:  tensor(4.5858e-06, device='cuda:0') MSE:  tensor(5.7784e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0276, device='cuda:0') mean:  tensor(0.0011, device='cuda:0') min:  tensor(1.9617e-12, device='cuda:0') norm:  tensor(1.7812, device='cuda:0') MSE:  tensor(2.2444e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0087, device='cuda:0')
min of d_p_list:  tensor(-0.0128, device='cuda:0')
Epoch:  69  
Training Loss: 2.388298273086548
Test Loss:  2.6337578296661377
Test Acc:  0.0
Valid Loss:  2.6551899909973145
Valid Acc:  0.0
std:  120.44896576076565 
thres:  0.06095658190846443
Preserved_eigens number check:  512
  7%|▋         | 69/1000 [21:52<4:29:51, 17.39s/it]Epoch:   70
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  507
Criterion check: 
Mean:  tensor(-1.1007, device='cuda:0') 
Std:  tensor(35.4483, device='cuda:0') 
ABS Max:  tensor(671.9435, device='cuda:0') 
ABS Min:  tensor(0.0024, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0001, 1.0000, 1.0000,
        1.0001], device='cuda:0') tensor(226, device='cuda:0')
max of Lambda2 tensor(146360.3125, device='cuda:0')
min of Lambda2 tensor(3.3006e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1761, device='cuda:0')
min of grad d_p:  tensor(-0.6418, device='cuda:0')
max|min: (J_L, Jta/N)  (0.17610090970993042, 0.17610067129135132, ratio: 0.9999986290931702)|(-0.6417590975761414, -0.6417589783668518)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.8312e-07, device='cuda:0') mean:  tensor(4.5091e-11, device='cuda:0') min:  tensor(-8.0466e-07, device='cuda:0') norm:  tensor(4.2576e-06, device='cuda:0') MSE:  tensor(5.3649e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(2.3295e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0036, device='cuda:0') MSE:  tensor(4.5181e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0054, device='cuda:0')
min of d_p_list:  tensor(-0.0097, device='cuda:0')
Epoch:  70  
Training Loss: 0.941337525844574
Test Loss:  1.0118038654327393
Test Acc:  0.0
Valid Loss:  1.0102688074111938
Valid Acc:  0.0
std:  120.37542237756342 
thres:  0.06110306384563446
Preserved_eigens number check:  512
  7%|▋         | 70/1000 [22:10<4:29:19, 17.38s/it]Epoch:   71
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  505
Criterion check: 
Mean:  tensor(-22.0122, device='cuda:0') 
Std:  tensor(731.7905, device='cuda:0') 
ABS Max:  tensor(14801.0488, device='cuda:0') 
ABS Min:  tensor(0.0011, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 0.9999, 1.0008, 1.0003, 1.0001,
        1.0004], device='cuda:0') tensor(226, device='cuda:0')
max of Lambda2 tensor(138924.6406, device='cuda:0')
min of Lambda2 tensor(1.6255e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1351, device='cuda:0')
min of grad d_p:  tensor(-0.5835, device='cuda:0')
max|min: (J_L, Jta/N)  (0.13507896661758423, 0.1350788027048111, ratio: 0.9999988079071045)|(-0.5834552049636841, -0.5834549069404602)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.2783e-07, device='cuda:0') mean:  tensor(3.5788e-11, device='cuda:0') min:  tensor(-2.9802e-07, device='cuda:0') norm:  tensor(3.5883e-06, device='cuda:0') MSE:  tensor(4.5216e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(4.9755e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0081, device='cuda:0') MSE:  tensor(1.0175e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0194, device='cuda:0')
min of d_p_list:  tensor(-0.0225, device='cuda:0')
Epoch:  71  
Training Loss: 0.5715150833129883
Test Loss:  0.5943467617034912
Test Acc:  0.0
Valid Loss:  0.5883387327194214
Valid Acc:  0.0
std:  120.33537779075344 
thres:  0.06118237310647964
Preserved_eigens number check:  512
  7%|▋         | 71/1000 [22:27<4:30:29, 17.47s/it]Epoch:   72
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  508
Criterion check: 
Mean:  tensor(-6.8916, device='cuda:0') 
Std:  tensor(112.5754, device='cuda:0') 
ABS Max:  tensor(2169.6199, device='cuda:0') 
ABS Min:  tensor(0.0058, device='cuda:0')
Criterion check:  tensor([0.9999, 1.0002, 1.0000, 1.0000, 0.9999, 1.0001, 1.0003, 1.0001, 1.0011,
        1.0004], device='cuda:0') tensor(238, device='cuda:0')
max of Lambda2 tensor(134357.6875, device='cuda:0')
min of Lambda2 tensor(1.8550e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1001, device='cuda:0')
min of grad d_p:  tensor(-0.5248, device='cuda:0')
max|min: (J_L, Jta/N)  (0.1000990942120552, 0.1000991240143776, ratio: 1.000000238418579)|(-0.5247820615768433, -0.524782121181488)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.9605e-07, device='cuda:0') mean:  tensor(2.2115e-11, device='cuda:0') min:  tensor(-2.6822e-07, device='cuda:0') norm:  tensor(3.2685e-06, device='cuda:0') MSE:  tensor(4.1185e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(1.1623e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0185, device='cuda:0') MSE:  tensor(2.3344e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0088, device='cuda:0')
min of d_p_list:  tensor(-0.0083, device='cuda:0')
Epoch:  72  
Training Loss: 0.4430793821811676
Test Loss:  0.45311570167541504
Test Acc:  0.0
Valid Loss:  0.44384950399398804
Valid Acc:  0.0
std:  120.30694757222109 
thres:  0.061238535994291306
Preserved_eigens number check:  512
  7%|▋         | 72/1000 [22:45<4:29:32, 17.43s/it]Epoch:   73
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  507
Criterion check: 
Mean:  tensor(0.3553, device='cuda:0') 
Std:  tensor(27.3485, device='cuda:0') 
ABS Max:  tensor(410.1505, device='cuda:0') 
ABS Min:  tensor(0., device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 0.9999, 1.0000,
        0.9999], device='cuda:0') tensor(237, device='cuda:0')
max of Lambda2 tensor(141786.6250, device='cuda:0')
min of Lambda2 tensor(1.8111e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0869, device='cuda:0')
min of grad d_p:  tensor(-0.9207, device='cuda:0')
max|min: (J_L, Jta/N)  (0.08685443550348282, 0.08685453236103058, ratio: 1.000001072883606)|(-0.9206961989402771, -0.920697033405304)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.3447e-07, device='cuda:0') mean:  tensor(6.6986e-12, device='cuda:0') min:  tensor(-2.0862e-07, device='cuda:0') norm:  tensor(3.2281e-06, device='cuda:0') MSE:  tensor(4.0676e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(2.1802e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0037, device='cuda:0') MSE:  tensor(4.6040e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0077, device='cuda:0')
min of d_p_list:  tensor(-0.0090, device='cuda:0')
Epoch:  73  
Training Loss: 0.3316953182220459
Test Loss:  0.33676639199256897
Test Acc:  0.0
Valid Loss:  0.3303966224193573
Valid Acc:  0.0
std:  0.7550098782663641 
thres:  0.0009351851165294647
Preserved_eigens number check:  512
  7%|▋         | 73/1000 [23:02<4:29:23, 17.44s/it]Epoch:   74
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  507
Criterion check: 
Mean:  tensor(0.1614, device='cuda:0') 
Std:  tensor(49.5239, device='cuda:0') 
ABS Max:  tensor(963.3830, device='cuda:0') 
ABS Min:  tensor(0.0010, device='cuda:0')
Criterion check:  tensor([0.9998, 1.0003, 1.0001, 1.0000, 1.0000, 0.9999, 1.0000, 1.0001, 1.0005,
        0.9997], device='cuda:0') tensor(214, device='cuda:0')
max of Lambda2 tensor(151227.8750, device='cuda:0')
min of Lambda2 tensor(2.4149e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2473, device='cuda:0')
min of grad d_p:  tensor(-0.4336, device='cuda:0')
max|min: (J_L, Jta/N)  (0.24727806448936462, 0.24727827310562134, ratio: 1.0000008344650269)|(-0.43358200788497925, -0.433582067489624)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.3842e-07, device='cuda:0') mean:  tensor(1.7038e-12, device='cuda:0') min:  tensor(-2.2352e-07, device='cuda:0') norm:  tensor(3.0009e-06, device='cuda:0') MSE:  tensor(3.7814e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(5.0464e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0085, device='cuda:0') MSE:  tensor(1.0669e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0096, device='cuda:0')
min of d_p_list:  tensor(-0.0110, device='cuda:0')
Epoch:  74  
Training Loss: 0.25527048110961914
Test Loss:  0.2577928304672241
Test Acc:  0.0
Valid Loss:  0.2537943124771118
Valid Acc:  0.0
std:  0.24124018522152013 
thres:  0.000508579558134079
Preserved_eigens number check:  512
  7%|▋         | 74/1000 [23:20<4:29:33, 17.47s/it]Epoch:   75
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  506
Criterion check: 
Mean:  tensor(3.4331, device='cuda:0') 
Std:  tensor(218.7301, device='cuda:0') 
ABS Max:  tensor(4310.8633, device='cuda:0') 
ABS Min:  tensor(0.0132, device='cuda:0')
Criterion check:  tensor([0.9997, 1.0007, 0.9999, 0.9997, 1.0004, 1.0004, 0.9998, 1.0001, 1.0012,
        1.0007], device='cuda:0') tensor(267, device='cuda:0')
max of Lambda2 tensor(150417.6719, device='cuda:0')
min of Lambda2 tensor(1.9650e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1021, device='cuda:0')
min of grad d_p:  tensor(-0.4775, device='cuda:0')
max|min: (J_L, Jta/N)  (0.10214611142873764, 0.10214601457118988, ratio: 0.9999990463256836)|(-0.47747552394866943, -0.4774751365184784)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.7881e-07, device='cuda:0') mean:  tensor(4.7052e-11, device='cuda:0') min:  tensor(-3.8743e-07, device='cuda:0') norm:  tensor(3.0995e-06, device='cuda:0') MSE:  tensor(3.9057e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0007, device='cuda:0') mean:  tensor(1.3327e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0224, device='cuda:0') MSE:  tensor(2.8228e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0027, device='cuda:0')
min of d_p_list:  tensor(-0.0058, device='cuda:0')
Epoch:  75  
Training Loss: 0.19696930050849915
Test Loss:  0.19659192860126495
Test Acc:  0.0
Valid Loss:  0.19381847977638245
Valid Acc:  0.0
std:  0.1341557437392329 
thres:  0.000359705913066864
Preserved_eigens number check:  512
  8%|▊         | 75/1000 [23:37<4:31:32, 17.61s/it]Epoch:   76
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  507
Criterion check: 
Mean:  tensor(53.3112, device='cuda:0') 
Std:  tensor(1213.6497, device='cuda:0') 
ABS Max:  tensor(27242.5703, device='cuda:0') 
ABS Min:  tensor(0.0204, device='cuda:0')
Criterion check:  tensor([0.9995, 1.0000, 1.0002, 0.9997, 1.0004, 1.0006, 1.0002, 0.9950, 1.0008,
        0.9998], device='cuda:0') tensor(252, device='cuda:0')
max of Lambda2 tensor(148977.9219, device='cuda:0')
min of Lambda2 tensor(2.5430e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0740, device='cuda:0')
min of grad d_p:  tensor(-0.3875, device='cuda:0')
max|min: (J_L, Jta/N)  (0.0739533081650734, 0.07395327091217041, ratio: 0.9999995231628418)|(-0.3875332474708557, -0.3875334858894348)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.3842e-07, device='cuda:0') mean:  tensor(-2.5800e-11, device='cuda:0') min:  tensor(-2.0862e-07, device='cuda:0') norm:  tensor(2.4494e-06, device='cuda:0') MSE:  tensor(3.0864e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0013, device='cuda:0') mean:  tensor(2.9266e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0519, device='cuda:0') MSE:  tensor(6.5415e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0194, device='cuda:0')
min of d_p_list:  tensor(-0.0222, device='cuda:0')
Epoch:  76  
Training Loss: 0.154875710606575
Test Loss:  0.15491461753845215
Test Acc:  0.0
Valid Loss:  0.1491125226020813
Valid Acc:  0.0
std:  0.10233614391100168 
thres:  0.00027637803852558135
Preserved_eigens number check:  512
  8%|▊         | 76/1000 [23:55<4:31:06, 17.60s/it]Epoch:   77
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  505
Criterion check: 
Mean:  tensor(0.4988, device='cuda:0') 
Std:  tensor(19.2901, device='cuda:0') 
ABS Max:  tensor(195.7489, device='cuda:0') 
ABS Min:  tensor(0.0056, device='cuda:0')
Criterion check:  tensor([0.9999, 1.0000, 1.0000, 1.0000, 1.0000, 1.0001, 1.0003, 1.0003, 1.0002,
        1.0001], device='cuda:0') tensor(241, device='cuda:0')
max of Lambda2 tensor(134787.3438, device='cuda:0')
min of Lambda2 tensor(4.4808e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2281, device='cuda:0')
min of grad d_p:  tensor(-0.3283, device='cuda:0')
max|min: (J_L, Jta/N)  (0.22811824083328247, 0.22811836004257202, ratio: 1.0000004768371582)|(-0.32825160026550293, -0.32825160026550293)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.0862e-07, device='cuda:0') mean:  tensor(3.1038e-11, device='cuda:0') min:  tensor(-1.5436e-07, device='cuda:0') norm:  tensor(2.4787e-06, device='cuda:0') MSE:  tensor(3.1234e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(2.2371e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0036, device='cuda:0') MSE:  tensor(4.5404e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0218, device='cuda:0')
min of d_p_list:  tensor(-0.0489, device='cuda:0')
Epoch:  77  
Training Loss: 0.13345541059970856
Test Loss:  0.13428711891174316
Test Acc:  0.0
Valid Loss:  0.12625566124916077
Valid Acc:  0.0
std:  0.07187151117647468 
thres:  0.00021445324420928954
Preserved_eigens number check:  512
  8%|▊         | 77/1000 [24:13<4:30:52, 17.61s/it]Epoch:   78
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  506
Criterion check: 
Mean:  tensor(-59.1429, device='cuda:0') 
Std:  tensor(982.1776, device='cuda:0') 
ABS Max:  tensor(20946.1387, device='cuda:0') 
ABS Min:  tensor(0.0067, device='cuda:0')
Criterion check:  tensor([0.9999, 1.0000, 1.0002, 1.0000, 1.0000, 1.0000, 0.9997, 1.0026, 1.0001,
        0.9964], device='cuda:0') tensor(237, device='cuda:0')
max of Lambda2 tensor(154000.3594, device='cuda:0')
min of Lambda2 tensor(1.9441e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1624, device='cuda:0')
min of grad d_p:  tensor(-0.2959, device='cuda:0')
max|min: (J_L, Jta/N)  (0.16240808367729187, 0.16240836679935455, ratio: 1.0000017881393433)|(-0.29587048292160034, -0.29587048292160034)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.0408e-07, device='cuda:0') mean:  tensor(-1.1874e-10, device='cuda:0') min:  tensor(-5.0664e-07, device='cuda:0') norm:  tensor(5.3461e-06, device='cuda:0') MSE:  tensor(6.7365e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(8.9196e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0142, device='cuda:0') MSE:  tensor(1.7861e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0040, device='cuda:0')
min of d_p_list:  tensor(-0.0053, device='cuda:0')
Epoch:  78  
Training Loss: 0.11900608241558075
Test Loss:  0.11960135400295258
Test Acc:  0.0
Valid Loss:  0.11318286508321762
Valid Acc:  0.0
std:  0.049284247308901415 
thres:  0.00017191539704799653
Preserved_eigens number check:  512
  8%|▊         | 78/1000 [24:30<4:28:28, 17.47s/it]Epoch:   79
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  507
Criterion check: 
Mean:  tensor(1.5988, device='cuda:0') 
Std:  tensor(192.2841, device='cuda:0') 
ABS Max:  tensor(3322.7874, device='cuda:0') 
ABS Min:  tensor(0.0008, device='cuda:0')
Criterion check:  tensor([1.0003, 1.0000, 0.9999, 1.0000, 1.0000, 1.0000, 1.0004, 0.9991, 1.0002,
        1.0005], device='cuda:0') tensor(222, device='cuda:0')
max of Lambda2 tensor(162657.6562, device='cuda:0')
min of Lambda2 tensor(2.2546e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1387, device='cuda:0')
min of grad d_p:  tensor(-0.2689, device='cuda:0')
max|min: (J_L, Jta/N)  (0.13869847357273102, 0.13869823515415192, ratio: 0.9999982714653015)|(-0.2689477205276489, -0.2689479887485504)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.7369e-07, device='cuda:0') mean:  tensor(5.4287e-11, device='cuda:0') min:  tensor(-1.3411e-07, device='cuda:0') norm:  tensor(3.0764e-06, device='cuda:0') MSE:  tensor(3.8765e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(2.9319e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0049, device='cuda:0') MSE:  tensor(6.1984e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0061, device='cuda:0')
min of d_p_list:  tensor(-0.0085, device='cuda:0')
Epoch:  79  
Training Loss: 0.09714847058057785
Test Loss:  0.09568552672863007
Test Acc:  0.0
Valid Loss:  0.09073318541049957
Valid Acc:  0.0
std:  0.03401821387356999 
thres:  0.0001402909949421883
Preserved_eigens number check:  512
  8%|▊         | 79/1000 [24:47<4:28:35, 17.50s/it]Epoch:   80
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  507
Criterion check: 
Mean:  tensor(-24.2807, device='cuda:0') 
Std:  tensor(853.8210, device='cuda:0') 
ABS Max:  tensor(14197.9688, device='cuda:0') 
ABS Min:  tensor(0.1011, device='cuda:0')
Criterion check:  tensor([1.0005, 0.9988, 0.9989, 1.0002, 0.9999, 0.9998, 0.9979, 0.9971, 1.0018,
        0.9641], device='cuda:0') tensor(273, device='cuda:0')
max of Lambda2 tensor(166714.6562, device='cuda:0')
min of Lambda2 tensor(1.3118e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1184, device='cuda:0')
min of grad d_p:  tensor(-0.2448, device='cuda:0')
max|min: (J_L, Jta/N)  (0.11843494325876236, 0.11843496561050415, ratio: 1.000000238418579)|(-0.24477791786193848, -0.24477793276309967)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.0431e-07, device='cuda:0') mean:  tensor(-1.2078e-11, device='cuda:0') min:  tensor(-5.0291e-07, device='cuda:0') norm:  tensor(2.3513e-06, device='cuda:0') MSE:  tensor(2.9628e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0014, device='cuda:0') mean:  tensor(4.4601e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0717, device='cuda:0') MSE:  tensor(9.0373e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0049, device='cuda:0')
min of d_p_list:  tensor(-0.0062, device='cuda:0')
Epoch:  80  
Training Loss: 0.08430804312229156
Test Loss:  0.08287305384874344
Test Acc:  0.0
Valid Loss:  0.07841809093952179
Valid Acc:  0.0
std:  0.025176747864536657 
thres:  0.00011775874346494674
Preserved_eigens number check:  512
  8%|▊         | 80/1000 [25:05<4:28:36, 17.52s/it]Epoch:   81
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  506
Criterion check: 
Mean:  tensor(10.0945, device='cuda:0') 
Std:  tensor(288.3986, device='cuda:0') 
ABS Max:  tensor(5643.5508, device='cuda:0') 
ABS Min:  tensor(0.0016, device='cuda:0')
Criterion check:  tensor([0.9995, 1.0000, 1.0002, 0.9998, 1.0001, 0.9999, 1.0002, 1.0056, 1.0003,
        0.9947], device='cuda:0') tensor(268, device='cuda:0')
max of Lambda2 tensor(182857.5469, device='cuda:0')
min of Lambda2 tensor(2.6669e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1162, device='cuda:0')
min of grad d_p:  tensor(-0.2231, device='cuda:0')
max|min: (J_L, Jta/N)  (0.11619765311479568, 0.11619777977466583, ratio: 1.000001072883606)|(-0.22312936186790466, -0.22312933206558228)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.4156e-07, device='cuda:0') mean:  tensor(1.8554e-11, device='cuda:0') min:  tensor(-1.4901e-07, device='cuda:0') norm:  tensor(2.5275e-06, device='cuda:0') MSE:  tensor(3.1848e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(1.0404e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0180, device='cuda:0') MSE:  tensor(2.2646e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0033, device='cuda:0')
min of d_p_list:  tensor(-0.0061, device='cuda:0')
Epoch:  81  
Training Loss: 0.0726931095123291
Test Loss:  0.07164538651704788
Test Acc:  0.0
Valid Loss:  0.06734512746334076
Valid Acc:  0.0
std:  0.022234159729603804 
thres:  0.00010132222324609757
Preserved_eigens number check:  512
  8%|▊         | 81/1000 [25:23<4:28:57, 17.56s/it]Epoch:   82
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  505
Criterion check: 
Mean:  tensor(2.9137, device='cuda:0') 
Std:  tensor(33.4809, device='cuda:0') 
ABS Max:  tensor(502.7446, device='cuda:0') 
ABS Min:  tensor(0.0005, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 0.9999, 1.0008, 0.9998,
        1.0008], device='cuda:0') tensor(241, device='cuda:0')
max of Lambda2 tensor(181100.1250, device='cuda:0')
min of Lambda2 tensor(4.4358e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1075, device='cuda:0')
min of grad d_p:  tensor(-0.2027, device='cuda:0')
max|min: (J_L, Jta/N)  (0.10753393173217773, 0.10753397643566132, ratio: 1.0000003576278687)|(-0.20271381735801697, -0.20271363854408264)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.8228e-08, device='cuda:0') mean:  tensor(-2.8637e-11, device='cuda:0') min:  tensor(-3.6508e-07, device='cuda:0') norm:  tensor(1.9989e-06, device='cuda:0') MSE:  tensor(2.5188e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(5.6685e-05, device='cuda:0') mean:  tensor(2.3309e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0037, device='cuda:0') MSE:  tensor(4.6599e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0211, device='cuda:0')
min of d_p_list:  tensor(-0.0123, device='cuda:0')
Epoch:  82  
Training Loss: 0.06575226783752441
Test Loss:  0.06577207148075104
Test Acc:  0.0
Valid Loss:  0.061342753469944
Valid Acc:  0.0
std:  0.01890886662229102 
thres:  8.778159469366074e-05
Preserved_eigens number check:  512
  8%|▊         | 82/1000 [25:40<4:26:47, 17.44s/it]Epoch:   83
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  505
Criterion check: 
Mean:  tensor(8.8755, device='cuda:0') 
Std:  tensor(404.6472, device='cuda:0') 
ABS Max:  tensor(7944.6221, device='cuda:0') 
ABS Min:  tensor(0.0017, device='cuda:0')
Criterion check:  tensor([0.9993, 0.9999, 1.0000, 1.0001, 1.0001, 1.0001, 0.9994, 1.0008, 0.9999,
        0.9968], device='cuda:0') tensor(230, device='cuda:0')
max of Lambda2 tensor(158844.8750, device='cuda:0')
min of Lambda2 tensor(2.6916e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0604, device='cuda:0')
min of grad d_p:  tensor(-0.1867, device='cuda:0')
max|min: (J_L, Jta/N)  (0.06036848947405815, 0.06036844849586487, ratio: 0.9999993443489075)|(-0.1867225617170334, -0.1867225021123886)

 check Jacobi res:  torch.Size([793601]) max:  tensor(7.4506e-08, device='cuda:0') mean:  tensor(-2.5413e-11, device='cuda:0') min:  tensor(-1.1921e-07, device='cuda:0') norm:  tensor(1.6441e-06, device='cuda:0') MSE:  tensor(2.0717e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(6.8351e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0110, device='cuda:0') MSE:  tensor(1.3841e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0053, device='cuda:0')
min of d_p_list:  tensor(-0.0037, device='cuda:0')
Epoch:  83  
Training Loss: 0.05430913716554642
Test Loss:  0.05427344888448715
Test Acc:  0.0
Valid Loss:  0.05074412375688553
Valid Acc:  0.0
std:  0.014805566650661182 
thres:  7.484220564365388e-05
Preserved_eigens number check:  512
  8%|▊         | 83/1000 [25:57<4:26:43, 17.45s/it]Epoch:   84
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  507
Criterion check: 
Mean:  tensor(-20.1686, device='cuda:0') 
Std:  tensor(706.2020, device='cuda:0') 
ABS Max:  tensor(15479.2959, device='cuda:0') 
ABS Min:  tensor(0.0009, device='cuda:0')
Criterion check:  tensor([1.0002, 1.0000, 1.0000, 1.0000, 1.0001, 1.0000, 1.0001, 0.9998, 1.0000,
        1.0000], device='cuda:0') tensor(223, device='cuda:0')
max of Lambda2 tensor(150098.5781, device='cuda:0')
min of Lambda2 tensor(2.5540e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0535, device='cuda:0')
min of grad d_p:  tensor(-0.1706, device='cuda:0')
max|min: (J_L, Jta/N)  (0.05354832857847214, 0.053548313677310944, ratio: 0.9999997019767761)|(-0.17055249214172363, -0.1705525815486908)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.3702e-07, device='cuda:0') mean:  tensor(-1.4300e-11, device='cuda:0') min:  tensor(-1.0431e-07, device='cuda:0') norm:  tensor(2.0449e-06, device='cuda:0') MSE:  tensor(2.5768e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(6.4775e-05, device='cuda:0') mean:  tensor(1.5213e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0025, device='cuda:0') MSE:  tensor(3.0952e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0369, device='cuda:0')
min of d_p_list:  tensor(-0.0422, device='cuda:0')
Epoch:  84  
Training Loss: 0.05294296517968178
Test Loss:  0.055230386555194855
Test Acc:  0.0
Valid Loss:  0.04871513694524765
Valid Acc:  0.0
std:  0.011723531508455553 
thres:  6.600110456347467e-05
Preserved_eigens number check:  512
  8%|▊         | 84/1000 [26:14<4:25:21, 17.38s/it]Epoch:   85
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  505
Criterion check: 
Mean:  tensor(1.1899, device='cuda:0') 
Std:  tensor(55.8549, device='cuda:0') 
ABS Max:  tensor(1010.7134, device='cuda:0') 
ABS Min:  tensor(0.0040, device='cuda:0')
Criterion check:  tensor([1.0001, 0.9999, 1.0000, 1.0000, 0.9998, 0.9999, 1.0000, 1.0001, 1.0003,
        1.0001], device='cuda:0') tensor(226, device='cuda:0')
max of Lambda2 tensor(134121.4062, device='cuda:0')
min of Lambda2 tensor(8.4512e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0583, device='cuda:0')
min of grad d_p:  tensor(-0.1603, device='cuda:0')
max|min: (J_L, Jta/N)  (0.05827140063047409, 0.05827140063047409, ratio: 1.0)|(-0.16032259166240692, -0.1603226661682129)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.0640e-07, device='cuda:0') mean:  tensor(4.1159e-12, device='cuda:0') min:  tensor(-6.7055e-08, device='cuda:0') norm:  tensor(1.2549e-06, device='cuda:0') MSE:  tensor(1.5813e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(4.9748e-05, device='cuda:0') mean:  tensor(1.7759e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0029, device='cuda:0') MSE:  tensor(3.5928e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0038, device='cuda:0')
min of d_p_list:  tensor(-0.0046, device='cuda:0')
Epoch:  85  
Training Loss: 0.04042589291930199
Test Loss:  0.04154247045516968
Test Acc:  0.0
Valid Loss:  0.036945924162864685
Valid Acc:  0.0
std:  0.011144727767954955 
thres:  5.722467452287674e-05
Preserved_eigens number check:  512
  8%|▊         | 85/1000 [26:32<4:25:26, 17.41s/it]Epoch:   86
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  505
Criterion check: 
Mean:  tensor(-754.6719, device='cuda:0') 
Std:  tensor(16950.1797, device='cuda:0') 
ABS Max:  tensor(383539., device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 0.9999, 0.9998, 1.0013, 1.0001, 1.0000, 1.0005, 1.0008,
        1.0015], device='cuda:0') tensor(227, device='cuda:0')
max of Lambda2 tensor(137085.2188, device='cuda:0')
min of Lambda2 tensor(2.5821e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0533, device='cuda:0')
min of grad d_p:  tensor(-0.1456, device='cuda:0')
max|min: (J_L, Jta/N)  (0.05333464592695236, 0.05333466827869415, ratio: 1.0000004768371582)|(-0.1456088274717331, -0.1456088125705719)

 check Jacobi res:  torch.Size([793601]) max:  tensor(6.0536e-08, device='cuda:0') mean:  tensor(-2.2585e-11, device='cuda:0') min:  tensor(-8.1956e-08, device='cuda:0') norm:  tensor(1.2370e-06, device='cuda:0') MSE:  tensor(1.5587e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(8.0478e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0133, device='cuda:0') MSE:  tensor(1.6754e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0027, device='cuda:0')
min of d_p_list:  tensor(-0.0042, device='cuda:0')
Epoch:  86  
Training Loss: 0.03325063735246658
Test Loss:  0.03365083038806915
Test Acc:  0.0
Valid Loss:  0.030190791934728622
Valid Acc:  0.0
std:  0.01136103023777438 
thres:  4.9336180090904236e-05
Preserved_eigens number check:  512
  9%|▊         | 86/1000 [26:49<4:25:01, 17.40s/it]Epoch:   87
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  504
Criterion check: 
Mean:  tensor(0.3523, device='cuda:0') 
Std:  tensor(27.8776, device='cuda:0') 
ABS Max:  tensor(421.6346, device='cuda:0') 
ABS Min:  tensor(6.9183e-05, device='cuda:0')
Criterion check:  tensor([1.0001, 0.9999, 0.9999, 1.0000, 0.9989, 1.0000, 1.0000, 0.9998, 0.9999,
        0.9998], device='cuda:0') tensor(229, device='cuda:0')
max of Lambda2 tensor(137271.4375, device='cuda:0')
min of Lambda2 tensor(8.6591e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0483, device='cuda:0')
min of grad d_p:  tensor(-0.1329, device='cuda:0')
max|min: (J_L, Jta/N)  (0.048269983381032944, 0.04826996102929115, ratio: 0.9999995231628418)|(-0.13292644917964935, -0.132926344871521)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.2154e-08, device='cuda:0') mean:  tensor(-1.1522e-11, device='cuda:0') min:  tensor(-1.1176e-07, device='cuda:0') norm:  tensor(1.7795e-06, device='cuda:0') MSE:  tensor(2.2423e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(5.9188e-05, device='cuda:0') mean:  tensor(1.6989e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0028, device='cuda:0') MSE:  tensor(3.5899e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.6992, device='cuda:0')
min of d_p_list:  tensor(-0.3820, device='cuda:0')
Epoch:  87  
Training Loss: 1.3063106536865234
Test Loss:  1.4420167207717896
Test Acc:  0.0
Valid Loss:  1.3797392845153809
Valid Acc:  0.0
std:  0.504492553490008 
thres:  0.00029744785726070405
Preserved_eigens number check:  512
  9%|▊         | 87/1000 [27:07<4:24:16, 17.37s/it]Epoch:   88
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  500
Criterion check: 
Mean:  tensor(-12.3401, device='cuda:0') 
Std:  tensor(246.9877, device='cuda:0') 
ABS Max:  tensor(5226.6602, device='cuda:0') 
ABS Min:  tensor(0.0007, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 0.9999, 1.0000, 1.0000, 1.0000, 0.9991, 1.0000, 1.0001,
        1.0001], device='cuda:0') tensor(199, device='cuda:0')
max of Lambda2 tensor(84295.5234, device='cuda:0')
min of Lambda2 tensor(1.1008e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.4450, device='cuda:0')
min of grad d_p:  tensor(-0.3223, device='cuda:0')
max|min: (J_L, Jta/N)  (0.44501686096191406, 0.4450169503688812, ratio: 1.000000238418579)|(-0.3222665786743164, -0.3222666084766388)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.7881e-07, device='cuda:0') mean:  tensor(-2.9168e-11, device='cuda:0') min:  tensor(-2.4587e-07, device='cuda:0') norm:  tensor(2.4899e-06, device='cuda:0') MSE:  tensor(3.1374e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(6.6370e-05, device='cuda:0') mean:  tensor(1.8593e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0030, device='cuda:0') MSE:  tensor(3.7374e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0166, device='cuda:0')
min of d_p_list:  tensor(-0.0136, device='cuda:0')
Epoch:  88  
Training Loss: 0.7702823281288147
Test Loss:  0.8255575895309448
Test Acc:  0.0
Valid Loss:  0.7159783244132996
Valid Acc:  0.0
std:  0.5166229108799439 
thres:  0.00044064249545335774
Preserved_eigens number check:  512
  9%|▉         | 88/1000 [27:25<4:27:16, 17.58s/it]Epoch:   89
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  499
Criterion check: 
Mean:  tensor(11.3835, device='cuda:0') 
Std:  tensor(167.7799, device='cuda:0') 
ABS Max:  tensor(2980.8030, device='cuda:0') 
ABS Min:  tensor(0.0004, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 0.9999, 1.0000, 1.0000, 1.0000, 1.0003, 1.0001, 1.0000,
        0.9996], device='cuda:0') tensor(219, device='cuda:0')
max of Lambda2 tensor(86302.3828, device='cuda:0')
min of Lambda2 tensor(2.7191e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.4027, device='cuda:0')
min of grad d_p:  tensor(-0.2772, device='cuda:0')
max|min: (J_L, Jta/N)  (0.40271806716918945, 0.4027179181575775, ratio: 0.9999996423721313)|(-0.2772209942340851, -0.27722105383872986)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.0862e-07, device='cuda:0') mean:  tensor(4.2184e-11, device='cuda:0') min:  tensor(-2.3842e-07, device='cuda:0') norm:  tensor(2.3324e-06, device='cuda:0') MSE:  tensor(2.9390e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(8.4300e-05, device='cuda:0') mean:  tensor(3.1205e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0049, device='cuda:0') MSE:  tensor(6.2006e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0197, device='cuda:0')
min of d_p_list:  tensor(-0.0179, device='cuda:0')
Epoch:  89  
Training Loss: 0.49119889736175537
Test Loss:  0.5129600763320923
Test Acc:  0.0
Valid Loss:  0.44450441002845764
Valid Acc:  0.0
std:  0.4792342917219658 
thres:  0.0005282936818897724
Preserved_eigens number check:  512
  9%|▉         | 89/1000 [27:42<4:24:36, 17.43s/it]Epoch:   90
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  498
Criterion check: 
Mean:  tensor(-3.1048, device='cuda:0') 
Std:  tensor(118.3783, device='cuda:0') 
ABS Max:  tensor(2427.5818, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([1.0001, 1.0000, 0.9999, 1.0000, 1.0000, 1.0000, 1.0365, 1.0000, 1.0025,
        1.0016], device='cuda:0') tensor(213, device='cuda:0')
max of Lambda2 tensor(87159.0391, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3727, device='cuda:0')
min of grad d_p:  tensor(-0.2789, device='cuda:0')
max|min: (J_L, Jta/N)  (0.3726881742477417, 0.37268805503845215, ratio: 0.9999997019767761)|(-0.27891361713409424, -0.27891355752944946)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.7881e-07, device='cuda:0') mean:  tensor(-2.4276e-11, device='cuda:0') min:  tensor(-1.4901e-07, device='cuda:0') norm:  tensor(2.0760e-06, device='cuda:0') MSE:  tensor(2.6159e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(6.4537e-05, device='cuda:0') mean:  tensor(2.0293e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0035, device='cuda:0') MSE:  tensor(4.3475e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0228, device='cuda:0')
min of d_p_list:  tensor(-0.0156, device='cuda:0')
Epoch:  90  
Training Loss: 0.367938756942749
Test Loss:  0.3759416341781616
Test Acc:  0.0
Valid Loss:  0.3318689465522766
Valid Acc:  0.0
std:  0.42768523917267315 
thres:  0.0005937962546944619
Preserved_eigens number check:  512
  9%|▉         | 90/1000 [27:59<4:24:11, 17.42s/it]Epoch:   91
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  499
Criterion check: 
Mean:  tensor(-8.6376, device='cuda:0') 
Std:  tensor(182.5725, device='cuda:0') 
ABS Max:  tensor(4072.5747, device='cuda:0') 
ABS Min:  tensor(0.0004, device='cuda:0')
Criterion check:  tensor([1.0001, 1.0000, 0.9999, 1.0000, 1.0001, 1.0000, 1.0001, 1.0001, 1.0001,
        1.0004], device='cuda:0') tensor(211, device='cuda:0')
max of Lambda2 tensor(87033.5938, device='cuda:0')
min of Lambda2 tensor(2.5709e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3426, device='cuda:0')
min of grad d_p:  tensor(-0.2450, device='cuda:0')
max|min: (J_L, Jta/N)  (0.3425828218460083, 0.3425825834274292, ratio: 0.9999992847442627)|(-0.24496397376060486, -0.24496398866176605)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.3842e-07, device='cuda:0') mean:  tensor(-1.3255e-11, device='cuda:0') min:  tensor(-1.4901e-07, device='cuda:0') norm:  tensor(1.8003e-06, device='cuda:0') MSE:  tensor(2.2685e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(9.3393e-05, device='cuda:0') mean:  tensor(2.6351e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0041, device='cuda:0') MSE:  tensor(5.1594e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0197, device='cuda:0')
min of d_p_list:  tensor(-0.0171, device='cuda:0')
Epoch:  91  
Training Loss: 0.2974742352962494
Test Loss:  0.30143046379089355
Test Acc:  0.0
Valid Loss:  0.26739501953125
Valid Acc:  0.0
std:  0.3672072567768174 
thres:  0.0006466409742832184
Preserved_eigens number check:  512
  9%|▉         | 91/1000 [28:17<4:25:32, 17.53s/it]Epoch:   92
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  500
Criterion check: 
Mean:  tensor(-3.6727, device='cuda:0') 
Std:  tensor(94.5695, device='cuda:0') 
ABS Max:  tensor(1720.3929, device='cuda:0') 
ABS Min:  tensor(0.0006, device='cuda:0')
Criterion check:  tensor([1.0001, 1.0000, 1.0001, 0.9999, 1.0001, 1.0001, 0.9986, 1.0004, 1.0002,
        1.0003], device='cuda:0') tensor(215, device='cuda:0')
max of Lambda2 tensor(88634.4844, device='cuda:0')
min of Lambda2 tensor(5.5304e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3069, device='cuda:0')
min of grad d_p:  tensor(-0.2201, device='cuda:0')
max|min: (J_L, Jta/N)  (0.30693161487579346, 0.3069314956665039, ratio: 0.9999995827674866)|(-0.22005516290664673, -0.22005517780780792)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.6391e-07, device='cuda:0') mean:  tensor(2.8748e-12, device='cuda:0') min:  tensor(-8.9407e-08, device='cuda:0') norm:  tensor(1.8758e-06, device='cuda:0') MSE:  tensor(2.3637e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(5.7253e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0094, device='cuda:0') MSE:  tensor(1.1881e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0156, device='cuda:0')
min of d_p_list:  tensor(-0.0143, device='cuda:0')
Epoch:  92  
Training Loss: 0.23384258151054382
Test Loss:  0.2350318729877472
Test Acc:  0.0
Valid Loss:  0.21200701594352722
Valid Acc:  0.0
std:  0.18942371611392758 
thres:  0.00043214735984802244
Preserved_eigens number check:  512
  9%|▉         | 92/1000 [28:35<4:25:37, 17.55s/it]Epoch:   93
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  499
Criterion check: 
Mean:  tensor(-0.6065, device='cuda:0') 
Std:  tensor(23.6489, device='cuda:0') 
ABS Max:  tensor(413.9227, device='cuda:0') 
ABS Min:  tensor(0.0033, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0001, 1.0000, 1.0000, 1.0000, 1.0000, 0.9999, 1.0001,
        1.0001], device='cuda:0') tensor(197, device='cuda:0')
max of Lambda2 tensor(89503.2188, device='cuda:0')
min of Lambda2 tensor(8.2876e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2828, device='cuda:0')
min of grad d_p:  tensor(-0.1925, device='cuda:0')
max|min: (J_L, Jta/N)  (0.2828473150730133, 0.2828472852706909, ratio: 0.9999998807907104)|(-0.19251547753810883, -0.19251541793346405)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.0431e-07, device='cuda:0') mean:  tensor(-7.7277e-13, device='cuda:0') min:  tensor(-1.1921e-07, device='cuda:0') norm:  tensor(1.5146e-06, device='cuda:0') MSE:  tensor(1.9085e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(9.9262e-05, device='cuda:0') mean:  tensor(2.9624e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0049, device='cuda:0') MSE:  tensor(6.2226e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0213, device='cuda:0')
min of d_p_list:  tensor(-0.0256, device='cuda:0')
Epoch:  93  
Training Loss: 0.19814284145832062
Test Loss:  0.1969103217124939
Test Acc:  0.0
Valid Loss:  0.18316742777824402
Valid Acc:  0.0
std:  0.10426970849012461 
thres:  0.00031771946251392364
Preserved_eigens number check:  512
  9%|▉         | 93/1000 [28:52<4:25:26, 17.56s/it]Epoch:   94
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  501
Criterion check: 
Mean:  tensor(0.6647, device='cuda:0') 
Std:  tensor(85.5154, device='cuda:0') 
ABS Max:  tensor(1304.8849, device='cuda:0') 
ABS Min:  tensor(0.0011, device='cuda:0')
Criterion check:  tensor([0.9999, 1.0001, 0.9997, 1.0000, 1.0000, 1.0000, 1.0002, 1.0000, 1.0001,
        1.0004], device='cuda:0') tensor(195, device='cuda:0')
max of Lambda2 tensor(87893.1406, device='cuda:0')
min of Lambda2 tensor(6.5798e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2585, device='cuda:0')
min of grad d_p:  tensor(-0.1673, device='cuda:0')
max|min: (J_L, Jta/N)  (0.25849905610084534, 0.25849905610084534, ratio: 1.0)|(-0.16725470125675201, -0.16725465655326843)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.3842e-07, device='cuda:0') mean:  tensor(2.2877e-11, device='cuda:0') min:  tensor(-1.0431e-07, device='cuda:0') norm:  tensor(1.6262e-06, device='cuda:0') MSE:  tensor(2.0491e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(6.7260e-05, device='cuda:0') mean:  tensor(1.8357e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0032, device='cuda:0') MSE:  tensor(4.0780e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0188, device='cuda:0')
min of d_p_list:  tensor(-0.0150, device='cuda:0')
Epoch:  94  
Training Loss: 0.1610736846923828
Test Loss:  0.16055580973625183
Test Acc:  0.0
Valid Loss:  0.1459406018257141
Valid Acc:  0.0
std:  0.07349437356596841 
thres:  0.00025169441998004917
Preserved_eigens number check:  512
  9%|▉         | 94/1000 [29:10<4:25:28, 17.58s/it]Epoch:   95
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  500
Criterion check: 
Mean:  tensor(-48.1966, device='cuda:0') 
Std:  tensor(1499.7201, device='cuda:0') 
ABS Max:  tensor(33056.8477, device='cuda:0') 
ABS Min:  tensor(0.0076, device='cuda:0')
Criterion check:  tensor([1.0006, 0.9999, 1.0001, 0.9999, 1.0007, 0.9996, 0.9970, 0.9969, 1.0004,
        0.9952], device='cuda:0') tensor(264, device='cuda:0')
max of Lambda2 tensor(88830.8672, device='cuda:0')
min of Lambda2 tensor(6.8898e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2402, device='cuda:0')
min of grad d_p:  tensor(-0.1644, device='cuda:0')
max|min: (J_L, Jta/N)  (0.24016793072223663, 0.24016794562339783, ratio: 1.0000001192092896)|(-0.16438095271587372, -0.16438095271587372)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.3411e-07, device='cuda:0') mean:  tensor(-7.4149e-12, device='cuda:0') min:  tensor(-1.1921e-07, device='cuda:0') norm:  tensor(1.4250e-06, device='cuda:0') MSE:  tensor(1.7956e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0011, device='cuda:0') mean:  tensor(2.3320e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0385, device='cuda:0') MSE:  tensor(4.8473e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0872, device='cuda:0')
min of d_p_list:  tensor(-0.0508, device='cuda:0')
Epoch:  95  
Training Loss: 0.15122854709625244
Test Loss:  0.15436041355133057
Test Acc:  0.0
Valid Loss:  0.13374516367912292
Valid Acc:  0.0
std:  0.0532824501263475 
thres:  0.00020835237801074982
Preserved_eigens number check:  512
 10%|▉         | 95/1000 [29:27<4:23:59, 17.50s/it]Epoch:   96
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  500
Criterion check: 
Mean:  tensor(2.9419, device='cuda:0') 
Std:  tensor(59.8426, device='cuda:0') 
ABS Max:  tensor(1273.8892, device='cuda:0') 
ABS Min:  tensor(0.0010, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 0.9999, 1.0000, 1.0000, 1.0000, 0.9999, 1.0001, 1.0000,
        1.0001], device='cuda:0') tensor(188, device='cuda:0')
max of Lambda2 tensor(80161.2500, device='cuda:0')
min of Lambda2 tensor(2.4630e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2083, device='cuda:0')
min of grad d_p:  tensor(-0.1789, device='cuda:0')
max|min: (J_L, Jta/N)  (0.20830443501472473, 0.2083044946193695, ratio: 1.000000238418579)|(-0.1788761019706726, -0.1788761019706726)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.1921e-07, device='cuda:0') mean:  tensor(7.0338e-12, device='cuda:0') min:  tensor(-1.2876e-07, device='cuda:0') norm:  tensor(1.2597e-06, device='cuda:0') MSE:  tensor(1.5873e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(7.8373e-05, device='cuda:0') mean:  tensor(1.3414e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0022, device='cuda:0') MSE:  tensor(2.7546e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0195, device='cuda:0')
min of d_p_list:  tensor(-0.0178, device='cuda:0')
Epoch:  96  
Training Loss: 0.12327944487333298
Test Loss:  0.12618708610534668
Test Acc:  0.0
Valid Loss:  0.10856448858976364
Valid Acc:  0.0
std:  0.038525396719107846 
thres:  0.00017351341992616654
Preserved_eigens number check:  512
 10%|▉         | 96/1000 [29:45<4:23:38, 17.50s/it]Epoch:   97
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  501
Criterion check: 
Mean:  tensor(-0.8851, device='cuda:0') 
Std:  tensor(44.9933, device='cuda:0') 
ABS Max:  tensor(482.3621, device='cuda:0') 
ABS Min:  tensor(0.0005, device='cuda:0')
Criterion check:  tensor([0.9998, 1.0000, 0.9983, 1.0000, 1.0000, 1.0000, 0.9998, 0.9994, 1.0002,
        1.0000], device='cuda:0') tensor(221, device='cuda:0')
max of Lambda2 tensor(85052.8438, device='cuda:0')
min of Lambda2 tensor(1.4651e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1987, device='cuda:0')
min of grad d_p:  tensor(-0.1678, device='cuda:0')
max|min: (J_L, Jta/N)  (0.1986907720565796, 0.19869080185890198, ratio: 1.0000001192092896)|(-0.16782553493976593, -0.16782553493976593)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.6880e-07, device='cuda:0') mean:  tensor(-9.1378e-12, device='cuda:0') min:  tensor(-1.1176e-07, device='cuda:0') norm:  tensor(1.3098e-06, device='cuda:0') MSE:  tensor(1.6505e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(6.5054e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0103, device='cuda:0') MSE:  tensor(1.3021e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0165, device='cuda:0')
min of d_p_list:  tensor(-0.0174, device='cuda:0')
Epoch:  97  
Training Loss: 0.10345626622438431
Test Loss:  0.10516244173049927
Test Acc:  0.0
Valid Loss:  0.09109672904014587
Valid Acc:  0.0
std:  0.03252478982672787 
thres:  0.00014743615686893465
Preserved_eigens number check:  512
 10%|▉         | 97/1000 [30:02<4:22:19, 17.43s/it]Epoch:   98
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  500
Criterion check: 
Mean:  tensor(3.3246, device='cuda:0') 
Std:  tensor(210.6630, device='cuda:0') 
ABS Max:  tensor(2678.5840, device='cuda:0') 
ABS Min:  tensor(0.0073, device='cuda:0')
Criterion check:  tensor([1.0007, 0.9998, 1.0028, 1.0003, 1.0001, 0.9998, 1.0002, 1.0018, 0.9998,
        1.0010], device='cuda:0') tensor(251, device='cuda:0')
max of Lambda2 tensor(87145.3672, device='cuda:0')
min of Lambda2 tensor(1.7982e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1839, device='cuda:0')
min of grad d_p:  tensor(-0.1603, device='cuda:0')
max|min: (J_L, Jta/N)  (0.18393203616142273, 0.18393197655677795, ratio: 0.9999997019767761)|(-0.16031980514526367, -0.16031986474990845)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.9407e-08, device='cuda:0') mean:  tensor(-1.5254e-12, device='cuda:0') min:  tensor(-9.0877e-08, device='cuda:0') norm:  tensor(1.2160e-06, device='cuda:0') MSE:  tensor(1.5322e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(9.2957e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0151, device='cuda:0') MSE:  tensor(1.8971e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0838, device='cuda:0')
min of d_p_list:  tensor(-0.1138, device='cuda:0')
Epoch:  98  
Training Loss: 0.19224070012569427
Test Loss:  0.20522001385688782
Test Acc:  0.0
Valid Loss:  0.16652259230613708
Valid Acc:  0.0
std:  0.030720097481295255 
thres:  0.00014625572860240936
Preserved_eigens number check:  512
 10%|▉         | 98/1000 [30:19<4:20:37, 17.34s/it]Epoch:   99
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  502
Criterion check: 
Mean:  tensor(6.7528, device='cuda:0') 
Std:  tensor(110.7956, device='cuda:0') 
ABS Max:  tensor(2458.3523, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 0.9994, 1.0000, 1.0000, 1.0000, 1.0000, 0.9999, 1.0001,
        0.9998], device='cuda:0') tensor(221, device='cuda:0')
max of Lambda2 tensor(83477.7656, device='cuda:0')
min of Lambda2 tensor(2.8316e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2109, device='cuda:0')
min of grad d_p:  tensor(-0.1993, device='cuda:0')
max|min: (J_L, Jta/N)  (0.21088501811027527, 0.21088503301143646, ratio: 1.0000001192092896)|(-0.1992958039045334, -0.19929569959640503)

 check Jacobi res:  torch.Size([793601]) max:  tensor(7.4506e-08, device='cuda:0') mean:  tensor(-7.1872e-12, device='cuda:0') min:  tensor(-1.0431e-07, device='cuda:0') norm:  tensor(1.3557e-06, device='cuda:0') MSE:  tensor(1.7083e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(6.9998e-05, device='cuda:0') mean:  tensor(2.0845e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0033, device='cuda:0') MSE:  tensor(4.1538e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0303, device='cuda:0')
min of d_p_list:  tensor(-0.0258, device='cuda:0')
Epoch:  99  
Training Loss: 0.1459992527961731
Test Loss:  0.15510043501853943
Test Acc:  0.0
Valid Loss:  0.1295093297958374
Valid Acc:  0.0
std:  0.02984516109541889 
thres:  0.00014324084222316742
Preserved_eigens number check:  512
 10%|▉         | 99/1000 [30:37<4:21:34, 17.42s/it]Epoch:   100
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  498
Criterion check: 
Mean:  tensor(10.2426, device='cuda:0') 
Std:  tensor(207.4073, device='cuda:0') 
ABS Max:  tensor(3092.5547, device='cuda:0') 
ABS Min:  tensor(0.0069, device='cuda:0')
Criterion check:  tensor([1.0005, 1.0002, 0.6231, 1.0001, 1.0000, 1.0000, 1.0001, 1.0008, 1.0009,
        1.0014], device='cuda:0') tensor(243, device='cuda:0')
max of Lambda2 tensor(95734.6719, device='cuda:0')
min of Lambda2 tensor(4.8342e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1846, device='cuda:0')
min of grad d_p:  tensor(-0.1891, device='cuda:0')
max|min: (J_L, Jta/N)  (0.1845971643924713, 0.1845972090959549, ratio: 1.000000238418579)|(-0.1890679895877838, -0.18906794488430023)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.9407e-08, device='cuda:0') mean:  tensor(-2.8941e-11, device='cuda:0') min:  tensor(-8.9407e-08, device='cuda:0') norm:  tensor(1.2623e-06, device='cuda:0') MSE:  tensor(1.5906e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(7.1063e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0122, device='cuda:0') MSE:  tensor(1.5384e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0115, device='cuda:0')
min of d_p_list:  tensor(-0.0170, device='cuda:0')
Epoch:  100  
Training Loss: 0.11500188708305359
Test Loss:  0.12144586443901062
Test Acc:  0.0
Valid Loss:  0.1016075387597084
Valid Acc:  0.0
std:  0.03138416538058962 
thres:  0.00013599551022052764
Preserved_eigens number check:  512
 10%|█         | 100/1000 [30:55<4:24:20, 17.62s/it]Epoch:   101
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  501
Criterion check: 
Mean:  tensor(-4.6457, device='cuda:0') 
Std:  tensor(82.4202, device='cuda:0') 
ABS Max:  tensor(1493.6140, device='cuda:0') 
ABS Min:  tensor(0.0005, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0001, 1.0008, 1.0000, 1.0001, 1.0000, 0.9999, 0.9998, 0.9999,
        0.9994], device='cuda:0') tensor(213, device='cuda:0')
max of Lambda2 tensor(90677.3438, device='cuda:0')
min of Lambda2 tensor(9.2852e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1768, device='cuda:0')
min of grad d_p:  tensor(-0.1737, device='cuda:0')
max|min: (J_L, Jta/N)  (0.17676880955696106, 0.17676879465579987, ratio: 0.9999999403953552)|(-0.17368586361408234, -0.17368587851524353)

 check Jacobi res:  torch.Size([793601]) max:  tensor(7.4506e-08, device='cuda:0') mean:  tensor(-1.5437e-11, device='cuda:0') min:  tensor(-6.7055e-08, device='cuda:0') norm:  tensor(1.0679e-06, device='cuda:0') MSE:  tensor(1.3456e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(7.3380e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0120, device='cuda:0') MSE:  tensor(1.5078e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0098, device='cuda:0')
min of d_p_list:  tensor(-0.0116, device='cuda:0')
Epoch:  101  
Training Loss: 0.09368231892585754
Test Loss:  0.09806740283966064
Test Acc:  0.0
Valid Loss:  0.0836893692612648
Valid Acc:  0.0
std:  0.03571649212880816 
thres:  0.00013007608503103258
Preserved_eigens number check:  512
 10%|█         | 101/1000 [31:12<4:21:18, 17.44s/it]Epoch:   102
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  497
Criterion check: 
Mean:  tensor(18.2804, device='cuda:0') 
Std:  tensor(333.3287, device='cuda:0') 
ABS Max:  tensor(7318.9766, device='cuda:0') 
ABS Min:  tensor(8.0839e-05, device='cuda:0')
Criterion check:  tensor([1.0000, 0.9999, 0.9760, 1.0000, 1.0000, 1.0000, 1.0000, 0.9998, 0.9999,
        0.9865], device='cuda:0') tensor(220, device='cuda:0')
max of Lambda2 tensor(97464.9375, device='cuda:0')
min of Lambda2 tensor(6.6651e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1688, device='cuda:0')
min of grad d_p:  tensor(-0.1559, device='cuda:0')
max|min: (J_L, Jta/N)  (0.16879738867282867, 0.16879741847515106, ratio: 1.0000001192092896)|(-0.15589496493339539, -0.1558949053287506)

 check Jacobi res:  torch.Size([793601]) max:  tensor(7.4506e-08, device='cuda:0') mean:  tensor(-1.1588e-11, device='cuda:0') min:  tensor(-8.9407e-08, device='cuda:0') norm:  tensor(1.2480e-06, device='cuda:0') MSE:  tensor(1.5725e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(3.2044e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0054, device='cuda:0') MSE:  tensor(6.8310e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0142, device='cuda:0')
min of d_p_list:  tensor(-0.0194, device='cuda:0')
Epoch:  102  
Training Loss: 0.07731568068265915
Test Loss:  0.0796898603439331
Test Acc:  0.0
Valid Loss:  0.069093719124794
Valid Acc:  0.0
std:  0.04078411092851799 
thres:  0.00012484796792268754
Preserved_eigens number check:  512
 10%|█         | 102/1000 [31:29<4:21:56, 17.50s/it]Epoch:   103
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  499
Criterion check: 
Mean:  tensor(-2.4439, device='cuda:0') 
Std:  tensor(66.4514, device='cuda:0') 
ABS Max:  tensor(700.5786, device='cuda:0') 
ABS Min:  tensor(0.0047, device='cuda:0')
Criterion check:  tensor([1.0007, 0.9994, 1.1560, 1.0000, 1.0001, 1.0011, 1.0003, 1.0022, 1.0006,
        1.0026], device='cuda:0') tensor(205, device='cuda:0')
max of Lambda2 tensor(101326.5859, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1582, device='cuda:0')
min of grad d_p:  tensor(-0.1438, device='cuda:0')
max|min: (J_L, Jta/N)  (0.15815657377243042, 0.15815652906894684, ratio: 0.9999997019767761)|(-0.1438196301460266, -0.143819659948349)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.9407e-08, device='cuda:0') mean:  tensor(6.3570e-12, device='cuda:0') min:  tensor(-9.0105e-08, device='cuda:0') norm:  tensor(1.1184e-06, device='cuda:0') MSE:  tensor(1.4092e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(7.8747e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0140, device='cuda:0') MSE:  tensor(1.7607e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0117, device='cuda:0')
min of d_p_list:  tensor(-0.0106, device='cuda:0')
Epoch:  103  
Training Loss: 0.06109890714287758
Test Loss:  0.0625012218952179
Test Acc:  0.0
Valid Loss:  0.055238720029592514
Valid Acc:  0.0
std:  0.029662255289577808 
thres:  9.86196093261242e-05
Preserved_eigens number check:  512
 10%|█         | 103/1000 [31:47<4:20:47, 17.44s/it]Epoch:   104
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  499
Criterion check: 
Mean:  tensor(-0.1408, device='cuda:0') 
Std:  tensor(37.3998, device='cuda:0') 
ABS Max:  tensor(484.8641, device='cuda:0') 
ABS Min:  tensor(3.2185e-05, device='cuda:0')
Criterion check:  tensor([1.0001, 1.0000, 1.0009, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000,
        0.9995], device='cuda:0') tensor(185, device='cuda:0')
max of Lambda2 tensor(94230.8828, device='cuda:0')
min of Lambda2 tensor(6.4291e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1429, device='cuda:0')
min of grad d_p:  tensor(-0.1333, device='cuda:0')
max|min: (J_L, Jta/N)  (0.14294132590293884, 0.14294137060642242, ratio: 1.0000003576278687)|(-0.13325178623199463, -0.13325180113315582)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.4703e-08, device='cuda:0') mean:  tensor(-1.9238e-11, device='cuda:0') min:  tensor(-9.9186e-08, device='cuda:0') norm:  tensor(9.5891e-07, device='cuda:0') MSE:  tensor(1.2083e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(9.2071e-05, device='cuda:0') mean:  tensor(1.5485e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0028, device='cuda:0') MSE:  tensor(3.5606e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0067, device='cuda:0')
min of d_p_list:  tensor(-0.0073, device='cuda:0')
Epoch:  104  
Training Loss: 0.049616195261478424
Test Loss:  0.05017819255590439
Test Acc:  0.0
Valid Loss:  0.04527280479669571
Valid Acc:  0.0
std:  0.02322848321787437 
thres:  7.934299781918526e-05
Preserved_eigens number check:  512
 10%|█         | 104/1000 [32:04<4:20:10, 17.42s/it]Epoch:   105
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  501
Criterion check: 
Mean:  tensor(4.3027, device='cuda:0') 
Std:  tensor(323.6227, device='cuda:0') 
ABS Max:  tensor(5517.1284, device='cuda:0') 
ABS Min:  tensor(0.0006, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0003, 0.9941, 1.0000, 1.0000, 1.0003, 1.0001, 1.0023, 1.0000,
        1.0003], device='cuda:0') tensor(230, device='cuda:0')
max of Lambda2 tensor(98631.0391, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1290, device='cuda:0')
min of grad d_p:  tensor(-0.1209, device='cuda:0')
max|min: (J_L, Jta/N)  (0.12904766201972961, 0.1290476769208908, ratio: 1.0000001192092896)|(-0.12087380141019821, -0.12087377905845642)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.2154e-08, device='cuda:0') mean:  tensor(-6.2352e-12, device='cuda:0') min:  tensor(-6.7055e-08, device='cuda:0') norm:  tensor(9.4718e-07, device='cuda:0') MSE:  tensor(1.1935e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(7.3529e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0123, device='cuda:0') MSE:  tensor(1.5492e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0063, device='cuda:0')
min of d_p_list:  tensor(-0.0065, device='cuda:0')
Epoch:  105  
Training Loss: 0.04055022448301315
Test Loss:  0.040495727211236954
Test Acc:  0.0
Valid Loss:  0.037538859993219376
Valid Acc:  0.0
std:  0.019092014193437555 
thres:  6.445266529917717e-05
Preserved_eigens number check:  512
 10%|█         | 105/1000 [32:22<4:20:38, 17.47s/it]Epoch:   106
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  497
Criterion check: 
Mean:  tensor(18.7734, device='cuda:0') 
Std:  tensor(391.1703, device='cuda:0') 
ABS Max:  tensor(8232.2354, device='cuda:0') 
ABS Min:  tensor(0.0014, device='cuda:0')
Criterion check:  tensor([1.0005, 0.9999, 0.9914, 0.9999, 0.9995, 1.0001, 1.0002, 0.9908, 1.0010,
        1.0078], device='cuda:0') tensor(234, device='cuda:0')
max of Lambda2 tensor(96591.5859, device='cuda:0')
min of Lambda2 tensor(4.4871e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1166, device='cuda:0')
min of grad d_p:  tensor(-0.1108, device='cuda:0')
max|min: (J_L, Jta/N)  (0.1165873110294342, 0.11658728122711182, ratio: 0.9999997615814209)|(-0.11077086627483368, -0.11077088117599487)

 check Jacobi res:  torch.Size([793601]) max:  tensor(6.3330e-08, device='cuda:0') mean:  tensor(8.8681e-12, device='cuda:0') min:  tensor(-5.8033e-08, device='cuda:0') norm:  tensor(8.8141e-07, device='cuda:0') MSE:  tensor(1.1106e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(9.3811e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0168, device='cuda:0') MSE:  tensor(2.1219e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0127, device='cuda:0')
min of d_p_list:  tensor(-0.0092, device='cuda:0')
Epoch:  106  
Training Loss: 0.034689221531152725
Test Loss:  0.034980617463588715
Test Acc:  0.0
Valid Loss:  0.031942665576934814
Valid Acc:  0.0
std:  0.015218264392265786 
thres:  5.265404582023621e-05
Preserved_eigens number check:  512
 11%|█         | 106/1000 [32:39<4:19:03, 17.39s/it]Epoch:   107
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  500
Criterion check: 
Mean:  tensor(-3.8087, device='cuda:0') 
Std:  tensor(82.7463, device='cuda:0') 
ABS Max:  tensor(1857.1067, device='cuda:0') 
ABS Min:  tensor(0.0009, device='cuda:0')
Criterion check:  tensor([0.9999, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 0.9996, 1.0000,
        0.9987], device='cuda:0') tensor(177, device='cuda:0')
max of Lambda2 tensor(99193.7969, device='cuda:0')
min of Lambda2 tensor(6.9684e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1068, device='cuda:0')
min of grad d_p:  tensor(-0.1032, device='cuda:0')
max|min: (J_L, Jta/N)  (0.10682356357574463, 0.10682354867458344, ratio: 0.9999998807907104)|(-0.10317400097846985, -0.10317401587963104)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.9605e-08, device='cuda:0') mean:  tensor(1.4828e-11, device='cuda:0') min:  tensor(-4.8778e-08, device='cuda:0') norm:  tensor(8.1479e-07, device='cuda:0') MSE:  tensor(1.0267e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(5.2289e-05, device='cuda:0') mean:  tensor(7.2985e-07, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0014, device='cuda:0') MSE:  tensor(1.8226e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0207, device='cuda:0')
min of d_p_list:  tensor(-0.0206, device='cuda:0')
Epoch:  107  
Training Loss: 0.031669098883867264
Test Loss:  0.03176369145512581
Test Acc:  0.0
Valid Loss:  0.029199860990047455
Valid Acc:  0.0
std:  0.01070913192949372 
thres:  4.3524729460477826e-05
Preserved_eigens number check:  512
 11%|█         | 107/1000 [32:56<4:19:56, 17.47s/it]Epoch:   108
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  498
Criterion check: 
Mean:  tensor(4.4671, device='cuda:0') 
Std:  tensor(63.6658, device='cuda:0') 
ABS Max:  tensor(1273.9039, device='cuda:0') 
ABS Min:  tensor(0.0007, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0006, 1.0000, 1.0001, 1.0000, 1.0000, 1.0010, 0.9997,
        1.0003], device='cuda:0') tensor(205, device='cuda:0')
max of Lambda2 tensor(102803.5938, device='cuda:0')
min of Lambda2 tensor(1.1037e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1018, device='cuda:0')
min of grad d_p:  tensor(-0.0981, device='cuda:0')
max|min: (J_L, Jta/N)  (0.10179103165864944, 0.10179105401039124, ratio: 1.000000238418579)|(-0.09814406931400299, -0.0981440618634224)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.4703e-08, device='cuda:0') mean:  tensor(2.7270e-12, device='cuda:0') min:  tensor(-4.6915e-08, device='cuda:0') norm:  tensor(7.3667e-07, device='cuda:0') MSE:  tensor(9.2826e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(3.5062e-05, device='cuda:0') mean:  tensor(1.0749e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0018, device='cuda:0') MSE:  tensor(2.2857e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0082, device='cuda:0')
min of d_p_list:  tensor(-0.0079, device='cuda:0')
Epoch:  108  
Training Loss: 0.02756408043205738
Test Loss:  0.02733146958053112
Test Acc:  0.0
Valid Loss:  0.025865603238344193
Valid Acc:  0.0
std:  0.007673346194554534 
thres:  3.681776411831379e-05
Preserved_eigens number check:  512
 11%|█         | 108/1000 [33:14<4:20:57, 17.55s/it]Epoch:   109
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  498
Criterion check: 
Mean:  tensor(-0.0108, device='cuda:0') 
Std:  tensor(32.2162, device='cuda:0') 
ABS Max:  tensor(556.9930, device='cuda:0') 
ABS Min:  tensor(9.6159e-06, device='cuda:0')
Criterion check:  tensor([1.0001, 1.0002, 1.0005, 1.0001, 1.0001, 1.0000, 1.0000, 0.9999, 1.0002,
        1.0001], device='cuda:0') tensor(185, device='cuda:0')
max of Lambda2 tensor(106489.0781, device='cuda:0')
min of Lambda2 tensor(3.5430e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0909, device='cuda:0')
min of grad d_p:  tensor(-0.0908, device='cuda:0')
max|min: (J_L, Jta/N)  (0.09087462723255157, 0.09087466448545456, ratio: 1.0000003576278687)|(-0.09077303111553192, -0.09077303111553192)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.4703e-08, device='cuda:0') mean:  tensor(-5.7422e-12, device='cuda:0') min:  tensor(-5.9605e-08, device='cuda:0') norm:  tensor(7.1253e-07, device='cuda:0') MSE:  tensor(8.9784e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(4.8809e-05, device='cuda:0') mean:  tensor(1.1787e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0019, device='cuda:0') MSE:  tensor(2.3710e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0066, device='cuda:0')
min of d_p_list:  tensor(-0.0071, device='cuda:0')
Epoch:  109  
Training Loss: 0.02350452169775963
Test Loss:  0.023487016558647156
Test Acc:  0.0
Valid Loss:  0.02191772125661373
Valid Acc:  0.0
std:  0.005856276869648444 
thres:  3.159542940557003e-05
Preserved_eigens number check:  512
 11%|█         | 109/1000 [33:31<4:19:00, 17.44s/it]Epoch:   110
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  501
Criterion check: 
Mean:  tensor(-9.3603, device='cuda:0') 
Std:  tensor(170.1921, device='cuda:0') 
ABS Max:  tensor(3776.5273, device='cuda:0') 
ABS Min:  tensor(0.0007, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 0.9998, 1.0000, 1.0000, 1.0001, 1.0000, 1.0014, 0.9997,
        1.0003], device='cuda:0') tensor(199, device='cuda:0')
max of Lambda2 tensor(108336.8672, device='cuda:0')
min of Lambda2 tensor(1.9191e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0822, device='cuda:0')
min of grad d_p:  tensor(-0.0825, device='cuda:0')
max|min: (J_L, Jta/N)  (0.08219605684280396, 0.08219602704048157, ratio: 0.9999996423721313)|(-0.08249282836914062, -0.08249285072088242)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.8861e-08, device='cuda:0') mean:  tensor(-6.3065e-12, device='cuda:0') min:  tensor(-4.8429e-08, device='cuda:0') norm:  tensor(6.8277e-07, device='cuda:0') MSE:  tensor(8.6034e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(4.8533e-05, device='cuda:0') mean:  tensor(1.2388e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0020, device='cuda:0') MSE:  tensor(2.5082e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0098, device='cuda:0')
min of d_p_list:  tensor(-0.0106, device='cuda:0')
Epoch:  110  
Training Loss: 0.019882388412952423
Test Loss:  0.020164623856544495
Test Acc:  0.0
Valid Loss:  0.018633440136909485
Valid Acc:  0.0
std:  0.005348924727865538 
thres:  2.7461862191557885e-05
Preserved_eigens number check:  512
 11%|█         | 110/1000 [33:49<4:19:21, 17.49s/it]Epoch:   111
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  500
Criterion check: 
Mean:  tensor(-10.4431, device='cuda:0') 
Std:  tensor(360.0269, device='cuda:0') 
ABS Max:  tensor(7997.1343, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([1.0000, 0.9996, 1.0005, 1.0003, 1.0003, 0.9998, 1.0001, 0.9475, 0.9993,
        0.9997], device='cuda:0') tensor(223, device='cuda:0')
max of Lambda2 tensor(110215.9141, device='cuda:0')
min of Lambda2 tensor(5.3377e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0776, device='cuda:0')
min of grad d_p:  tensor(-0.0770, device='cuda:0')
max|min: (J_L, Jta/N)  (0.07757915556430817, 0.07757911831140518, ratio: 0.9999995231628418)|(-0.07702095806598663, -0.07702097296714783)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.0978e-08, device='cuda:0') mean:  tensor(4.6598e-12, device='cuda:0') min:  tensor(-2.9802e-08, device='cuda:0') norm:  tensor(5.4581e-07, device='cuda:0') MSE:  tensor(6.8777e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(9.3527e-05, device='cuda:0') mean:  tensor(2.2532e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0038, device='cuda:0') MSE:  tensor(4.7984e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0071, device='cuda:0')
min of d_p_list:  tensor(-0.0097, device='cuda:0')
Epoch:  111  
Training Loss: 0.01745450496673584
Test Loss:  0.0177038311958313
Test Acc:  0.0
Valid Loss:  0.016301866620779037
Valid Acc:  0.0
std:  0.005129529477686412 
thres:  2.401491887867451e-05
Preserved_eigens number check:  512
 11%|█         | 111/1000 [34:06<4:18:10, 17.42s/it]Epoch:   112
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  502
Criterion check: 
Mean:  tensor(90.2530, device='cuda:0') 
Std:  tensor(1495.2212, device='cuda:0') 
ABS Max:  tensor(30167.6660, device='cuda:0') 
ABS Min:  tensor(0.0033, device='cuda:0')
Criterion check:  tensor([1.0034, 0.9898, 1.0071, 0.9984, 1.0005, 0.9998, 1.0009, 0.8223, 0.9921,
        0.9834], device='cuda:0') tensor(262, device='cuda:0')
max of Lambda2 tensor(116801.9766, device='cuda:0')
min of Lambda2 tensor(7.0907e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0721, device='cuda:0')
min of grad d_p:  tensor(-0.0699, device='cuda:0')
max|min: (J_L, Jta/N)  (0.07212216407060623, 0.07212213426828384, ratio: 0.9999995827674866)|(-0.06993789970874786, -0.06993785500526428)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.8429e-08, device='cuda:0') mean:  tensor(-1.5554e-11, device='cuda:0') min:  tensor(-7.8231e-08, device='cuda:0') norm:  tensor(1.1127e-06, device='cuda:0') MSE:  tensor(1.4021e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0027, device='cuda:0') mean:  tensor(3.9032e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0710, device='cuda:0') MSE:  tensor(8.9467e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0159, device='cuda:0')
min of d_p_list:  tensor(-0.0223, device='cuda:0')
Epoch:  112  
Training Loss: 0.015427539125084877
Test Loss:  0.015344874933362007
Test Acc:  0.0
Valid Loss:  0.014591006562113762
Valid Acc:  0.0
std:  0.004334958595260578 
thres:  2.076660692691803e-05
Preserved_eigens number check:  512
 11%|█         | 112/1000 [34:23<4:17:07, 17.37s/it]Epoch:   113
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  501
Criterion check: 
Mean:  tensor(23.2045, device='cuda:0') 
Std:  tensor(333.9343, device='cuda:0') 
ABS Max:  tensor(6336.3325, device='cuda:0') 
ABS Min:  tensor(0.0021, device='cuda:0')
Criterion check:  tensor([0.9997, 1.0003, 0.9993, 0.9999, 0.9998, 1.0000, 1.0002, 1.0003, 0.9999,
        1.0001], device='cuda:0') tensor(215, device='cuda:0')
max of Lambda2 tensor(118152.8281, device='cuda:0')
min of Lambda2 tensor(1.7878e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0696, device='cuda:0')
min of grad d_p:  tensor(-0.0632, device='cuda:0')
max|min: (J_L, Jta/N)  (0.06962432712316513, 0.06962432712316513, ratio: 1.0)|(-0.06323221325874329, -0.06323220580816269)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.8429e-08, device='cuda:0') mean:  tensor(-2.3065e-13, device='cuda:0') min:  tensor(-5.9605e-08, device='cuda:0') norm:  tensor(7.5006e-07, device='cuda:0') MSE:  tensor(9.4514e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(7.3415e-05, device='cuda:0') mean:  tensor(2.1809e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0036, device='cuda:0') MSE:  tensor(4.5684e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0066, device='cuda:0')
min of d_p_list:  tensor(-0.0059, device='cuda:0')
Epoch:  113  
Training Loss: 0.012889819219708443
Test Loss:  0.012878530658781528
Test Acc:  0.0
Valid Loss:  0.012131826020777225
Valid Acc:  0.0
std:  0.003653236379399633 
thres:  1.7831754684448244e-05
Preserved_eigens number check:  512
 11%|█▏        | 113/1000 [34:41<4:19:35, 17.56s/it]Epoch:   114
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  500
Criterion check: 
Mean:  tensor(17.1981, device='cuda:0') 
Std:  tensor(371.7691, device='cuda:0') 
ABS Max:  tensor(8390.1377, device='cuda:0') 
ABS Min:  tensor(8.6214e-05, device='cuda:0')
Criterion check:  tensor([0.9999, 0.9996, 1.0002, 0.9999, 1.0002, 1.0000, 1.0000, 0.9997, 1.0003,
        1.0000], device='cuda:0') tensor(197, device='cuda:0')
max of Lambda2 tensor(128866.0234, device='cuda:0')
min of Lambda2 tensor(7.6918e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0633, device='cuda:0')
min of grad d_p:  tensor(-0.0581, device='cuda:0')
max|min: (J_L, Jta/N)  (0.0632658451795578, 0.06326586753129959, ratio: 1.0000003576278687)|(-0.05812793970108032, -0.058127935975790024)

 check Jacobi res:  torch.Size([793601]) max:  tensor(7.0781e-08, device='cuda:0') mean:  tensor(2.3306e-12, device='cuda:0') min:  tensor(-5.9605e-08, device='cuda:0') norm:  tensor(9.5434e-07, device='cuda:0') MSE:  tensor(1.2025e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(5.7197e-05, device='cuda:0') mean:  tensor(1.3520e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0023, device='cuda:0') MSE:  tensor(2.8532e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0039, device='cuda:0')
min of d_p_list:  tensor(-0.0029, device='cuda:0')
Epoch:  114  
Training Loss: 0.010816828347742558
Test Loss:  0.010731058195233345
Test Acc:  0.0
Valid Loss:  0.010412605479359627
Valid Acc:  0.0
std:  0.003211357147130306 
thres:  1.529421601444483e-05
Preserved_eigens number check:  512
 11%|█▏        | 114/1000 [34:59<4:19:44, 17.59s/it]Epoch:   115
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  499
Criterion check: 
Mean:  tensor(1.0359, device='cuda:0') 
Std:  tensor(49.4954, device='cuda:0') 
ABS Max:  tensor(681.4158, device='cuda:0') 
ABS Min:  tensor(0.0004, device='cuda:0')
Criterion check:  tensor([1.0001, 1.0001, 1.0000, 0.9999, 0.9996, 1.0000, 0.9999, 1.0003, 1.0006,
        1.0004], device='cuda:0') tensor(186, device='cuda:0')
max of Lambda2 tensor(130850.3203, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0579, device='cuda:0')
min of grad d_p:  tensor(-0.0529, device='cuda:0')
max|min: (J_L, Jta/N)  (0.057873062789440155, 0.057873036712408066, ratio: 0.9999995231628418)|(-0.05288706719875336, -0.052887097001075745)

 check Jacobi res:  torch.Size([793601]) max:  tensor(7.8231e-08, device='cuda:0') mean:  tensor(1.3150e-11, device='cuda:0') min:  tensor(-3.9632e-08, device='cuda:0') norm:  tensor(1.1531e-06, device='cuda:0') MSE:  tensor(1.4530e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(5.9426e-05, device='cuda:0') mean:  tensor(1.4924e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0025, device='cuda:0') MSE:  tensor(3.1087e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0028, device='cuda:0')
min of d_p_list:  tensor(-0.0036, device='cuda:0')
Epoch:  115  
Training Loss: 0.009401354007422924
Test Loss:  0.009273817762732506
Test Acc:  0.0
Valid Loss:  0.00904993899166584
Valid Acc:  0.0
std:  0.0029417054191581164 
thres:  1.3198009133338928e-05
Preserved_eigens number check:  512
 12%|█▏        | 115/1000 [35:17<4:19:49, 17.62s/it]Epoch:   116
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  500
Criterion check: 
Mean:  tensor(11.0129, device='cuda:0') 
Std:  tensor(212.5266, device='cuda:0') 
ABS Max:  tensor(4741.7192, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([1.0000, 0.9999, 1.0000, 1.0000, 1.0001, 1.0000, 1.0000, 1.0001, 0.9998,
        1.0002], device='cuda:0') tensor(190, device='cuda:0')
max of Lambda2 tensor(135406.1875, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0523, device='cuda:0')
min of grad d_p:  tensor(-0.0484, device='cuda:0')
max|min: (J_L, Jta/N)  (0.052324965596199036, 0.052324965596199036, ratio: 1.0)|(-0.048408590257167816, -0.04840858280658722)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.7253e-08, device='cuda:0') mean:  tensor(-1.9930e-11, device='cuda:0') min:  tensor(-7.0781e-08, device='cuda:0') norm:  tensor(8.8003e-07, device='cuda:0') MSE:  tensor(1.1089e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(3.4936e-05, device='cuda:0') mean:  tensor(6.6436e-07, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0011, device='cuda:0') MSE:  tensor(1.4029e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0186, device='cuda:0')
min of d_p_list:  tensor(-0.0241, device='cuda:0')
Epoch:  116  
Training Loss: 0.011420240625739098
Test Loss:  0.01152687706053257
Test Acc:  0.0
Valid Loss:  0.010639222338795662
Valid Acc:  0.0
std:  0.002050774913295198 
thres:  1.199115626513958e-05
Preserved_eigens number check:  512
 12%|█▏        | 116/1000 [35:34<4:19:34, 17.62s/it]Epoch:   117
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  503
Criterion check: 
Mean:  tensor(-0.2327, device='cuda:0') 
Std:  tensor(27.7854, device='cuda:0') 
ABS Max:  tensor(470.7525, device='cuda:0') 
ABS Min:  tensor(1.9634e-05, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0001, 0.9999, 1.0000, 1.0001, 1.0000, 1.0000, 0.9998, 1.0003,
        1.0000], device='cuda:0') tensor(202, device='cuda:0')
max of Lambda2 tensor(150876.8906, device='cuda:0')
min of Lambda2 tensor(1.2624e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0564, device='cuda:0')
min of grad d_p:  tensor(-0.0443, device='cuda:0')
max|min: (J_L, Jta/N)  (0.05635979399085045, 0.05635978654026985, ratio: 0.9999998807907104)|(-0.04434384033083916, -0.04434385523200035)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.8429e-08, device='cuda:0') mean:  tensor(2.3241e-12, device='cuda:0') min:  tensor(-4.8429e-08, device='cuda:0') norm:  tensor(7.2318e-07, device='cuda:0') MSE:  tensor(9.1127e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(6.1160e-05, device='cuda:0') mean:  tensor(1.0359e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0018, device='cuda:0') MSE:  tensor(2.2469e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1606, device='cuda:0')
min of d_p_list:  tensor(-0.1156, device='cuda:0')
Epoch:  117  
Training Loss: 0.09295333921909332
Test Loss:  0.1020655483007431
Test Acc:  0.0
Valid Loss:  0.08037815243005753
Valid Acc:  0.0
std:  0.03274765577622656 
thres:  2.749631628394127e-05
Preserved_eigens number check:  512
 12%|█▏        | 117/1000 [35:52<4:19:59, 17.67s/it]Epoch:   118
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  500
Criterion check: 
Mean:  tensor(5.3908, device='cuda:0') 
Std:  tensor(99.2501, device='cuda:0') 
ABS Max:  tensor(2231.2957, device='cuda:0') 
ABS Min:  tensor(0.0011, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0052, 1.0000, 1.0000, 1.0003, 1.0000, 1.0001, 0.9999, 0.9996,
        1.0006], device='cuda:0') tensor(199, device='cuda:0')
max of Lambda2 tensor(105299.0391, device='cuda:0')
min of Lambda2 tensor(3.1068e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1442, device='cuda:0')
min of grad d_p:  tensor(-0.1132, device='cuda:0')
max|min: (J_L, Jta/N)  (0.14422541856765747, 0.14422543346881866, ratio: 1.0000001192092896)|(-0.11321015655994415, -0.11321014910936356)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.2154e-08, device='cuda:0') mean:  tensor(-2.5455e-11, device='cuda:0') min:  tensor(-1.6601e-07, device='cuda:0') norm:  tensor(1.0263e-06, device='cuda:0') MSE:  tensor(1.2932e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(5.5282e-05, device='cuda:0') mean:  tensor(1.2413e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0021, device='cuda:0') MSE:  tensor(2.6566e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0444, device='cuda:0')
min of d_p_list:  tensor(-0.0443, device='cuda:0')
Epoch:  118  
Training Loss: 0.056981511414051056
Test Loss:  0.0617094561457634
Test Acc:  0.0
Valid Loss:  0.04951263219118118
Valid Acc:  0.0
std:  0.03355370711397535 
thres:  3.631465472280979e-05
Preserved_eigens number check:  512
 12%|█▏        | 118/1000 [36:10<4:18:15, 17.57s/it]Epoch:   119
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  498
Criterion check: 
Mean:  tensor(-0.3180, device='cuda:0') 
Std:  tensor(54.5431, device='cuda:0') 
ABS Max:  tensor(1005.7372, device='cuda:0') 
ABS Min:  tensor(0.0004, device='cuda:0')
Criterion check:  tensor([0.9998, 1.0007, 1.0000, 1.0000, 1.0001, 1.0000, 1.0000, 1.0001, 0.9994,
        1.0002], device='cuda:0') tensor(186, device='cuda:0')
max of Lambda2 tensor(93731.5625, device='cuda:0')
min of Lambda2 tensor(4.3805e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1502, device='cuda:0')
min of grad d_p:  tensor(-0.1069, device='cuda:0')
max|min: (J_L, Jta/N)  (0.15018081665039062, 0.150180846452713, ratio: 1.000000238418579)|(-0.10691583156585693, -0.10691584646701813)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.5879e-08, device='cuda:0') mean:  tensor(2.7351e-12, device='cuda:0') min:  tensor(-7.4506e-08, device='cuda:0') norm:  tensor(9.3458e-07, device='cuda:0') MSE:  tensor(1.1776e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(5.3938e-05, device='cuda:0') mean:  tensor(1.2654e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0022, device='cuda:0') MSE:  tensor(2.8005e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.7472, device='cuda:0')
min of d_p_list:  tensor(-0.7400, device='cuda:0')
Epoch:  119  
Training Loss: 1.0577850341796875
Test Loss:  1.1317615509033203
Test Acc:  0.0
Valid Loss:  1.1000392436981201
Valid Acc:  0.0
std:  0.40722287962706233 
thres:  0.0002457082958891988
Preserved_eigens number check:  512
 12%|█▏        | 119/1000 [36:27<4:18:58, 17.64s/it]Epoch:   120
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  495
Criterion check: 
Mean:  tensor(0.5860, device='cuda:0') 
Std:  tensor(682.9191, device='cuda:0') 
ABS Max:  tensor(10414.4336, device='cuda:0') 
ABS Min:  tensor(0.0228, device='cuda:0')
Criterion check:  tensor([0.9972, 1.0014, 1.0071, 1.0007, 0.9998, 1.0031, 1.0009, 1.0094, 1.0771,
        1.0968], device='cuda:0') tensor(254, device='cuda:0')
max of Lambda2 tensor(62989.6406, device='cuda:0')
min of Lambda2 tensor(7.4791e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3497, device='cuda:0')
min of grad d_p:  tensor(-0.3408, device='cuda:0')
max|min: (J_L, Jta/N)  (0.34972715377807617, 0.3497270345687866, ratio: 0.9999996423721313)|(-0.34080177545547485, -0.34080180525779724)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.4901e-07, device='cuda:0') mean:  tensor(3.4782e-12, device='cuda:0') min:  tensor(-1.4901e-07, device='cuda:0') norm:  tensor(1.1773e-06, device='cuda:0') MSE:  tensor(1.4835e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0045, device='cuda:0') mean:  tensor(9.3022e-05, device='cuda:0') min:  tensor(1.6917e-14, device='cuda:0') norm:  tensor(0.1577, device='cuda:0') MSE:  tensor(1.9877e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0325, device='cuda:0')
min of d_p_list:  tensor(-0.0354, device='cuda:0')
Epoch:  120  
Training Loss: 0.2531149089336395
Test Loss:  0.23550154268741608
Test Acc:  0.0
Valid Loss:  0.24882563948631287
Valid Acc:  0.0
std:  0.3902529938957811 
thres:  0.0002944510068744421
Preserved_eigens number check:  512
 12%|█▏        | 120/1000 [36:45<4:18:00, 17.59s/it]Epoch:   121
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  492
Criterion check: 
Mean:  tensor(-1.1197, device='cuda:0') 
Std:  tensor(31.2876, device='cuda:0') 
ABS Max:  tensor(443.5659, device='cuda:0') 
ABS Min:  tensor(0.0001, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0001, 1.0002, 0.9999,
        1.0021], device='cuda:0') tensor(162, device='cuda:0')
max of Lambda2 tensor(63436.6250, device='cuda:0')
min of Lambda2 tensor(3.1434e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3112, device='cuda:0')
min of grad d_p:  tensor(-0.2769, device='cuda:0')
max|min: (J_L, Jta/N)  (0.3112398386001587, 0.31123989820480347, ratio: 1.000000238418579)|(-0.27694082260131836, -0.2769407331943512)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.4901e-07, device='cuda:0') mean:  tensor(7.1981e-12, device='cuda:0') min:  tensor(-1.3411e-07, device='cuda:0') norm:  tensor(1.0556e-06, device='cuda:0') MSE:  tensor(1.3302e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(1.8646e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0032, device='cuda:0') MSE:  tensor(4.0769e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0212, device='cuda:0')
min of d_p_list:  tensor(-0.0177, device='cuda:0')
Epoch:  121  
Training Loss: 0.18961656093597412
Test Loss:  0.17409153282642365
Test Acc:  0.0
Valid Loss:  0.18778499960899353
Valid Acc:  0.0
std:  0.37041059836904744 
thres:  0.0003300902709364891
Preserved_eigens number check:  512
 12%|█▏        | 121/1000 [37:02<4:17:08, 17.55s/it]Epoch:   122
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  491
Criterion check: 
Mean:  tensor(45.7068, device='cuda:0') 
Std:  tensor(1468.2583, device='cuda:0') 
ABS Max:  tensor(30072.1309, device='cuda:0') 
ABS Min:  tensor(0.0020, device='cuda:0')
Criterion check:  tensor([0.9988, 0.9993, 0.9978, 1.0001, 1.0002, 1.0002, 0.9994, 1.0001, 0.9992,
        1.0180], device='cuda:0') tensor(231, device='cuda:0')
max of Lambda2 tensor(63235.6484, device='cuda:0')
min of Lambda2 tensor(2.4679e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2768, device='cuda:0')
min of grad d_p:  tensor(-0.2561, device='cuda:0')
max|min: (J_L, Jta/N)  (0.2767816185951233, 0.2767816483974457, ratio: 1.0000001192092896)|(-0.2560622990131378, -0.256062388420105)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.9407e-08, device='cuda:0') mean:  tensor(-5.6071e-12, device='cuda:0') min:  tensor(-1.1921e-07, device='cuda:0') norm:  tensor(9.5751e-07, device='cuda:0') MSE:  tensor(1.2065e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0009, device='cuda:0') mean:  tensor(1.9758e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0331, device='cuda:0') MSE:  tensor(4.1672e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0235, device='cuda:0')
min of d_p_list:  tensor(-0.0239, device='cuda:0')
Epoch:  122  
Training Loss: 0.1568661630153656
Test Loss:  0.14508458971977234
Test Acc:  0.0
Valid Loss:  0.15643469989299774
Valid Acc:  0.0
std:  0.3630360186791895 
thres:  0.00034287283569574354
Preserved_eigens number check:  512
 12%|█▏        | 122/1000 [37:19<4:15:16, 17.44s/it]Epoch:   123
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  492
Criterion check: 
Mean:  tensor(57.9329, device='cuda:0') 
Std:  tensor(923.1868, device='cuda:0') 
ABS Max:  tensor(17307.0859, device='cuda:0') 
ABS Min:  tensor(0., device='cuda:0')
Criterion check:  tensor([0.9998, 1.0002, 0.9995, 1.0000, 1.0000, 1.0000, 1.0000, 0.9997, 1.0002,
        0.9996], device='cuda:0') tensor(226, device='cuda:0')
max of Lambda2 tensor(63593.2617, device='cuda:0')
min of Lambda2 tensor(3.2396e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2480, device='cuda:0')
min of grad d_p:  tensor(-0.2419, device='cuda:0')
max|min: (J_L, Jta/N)  (0.24795874953269958, 0.24795882403850555, ratio: 1.0000003576278687)|(-0.24194248020648956, -0.24194255471229553)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.0431e-07, device='cuda:0') mean:  tensor(-5.3541e-12, device='cuda:0') min:  tensor(-1.1921e-07, device='cuda:0') norm:  tensor(9.2001e-07, device='cuda:0') MSE:  tensor(1.1593e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(5.6651e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0092, device='cuda:0') MSE:  tensor(1.1619e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0197, device='cuda:0')
min of d_p_list:  tensor(-0.0206, device='cuda:0')
Epoch:  123  
Training Loss: 0.1305599957704544
Test Loss:  0.12216509878635406
Test Acc:  0.0
Valid Loss:  0.13058514893054962
Valid Acc:  0.0
std:  0.3524871312027572 
thres:  0.0003575885325670242
Preserved_eigens number check:  512
 12%|█▏        | 123/1000 [37:37<4:17:02, 17.59s/it]Epoch:   124
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  494
Criterion check: 
Mean:  tensor(-17.5992, device='cuda:0') 
Std:  tensor(363.0883, device='cuda:0') 
ABS Max:  tensor(6401.1665, device='cuda:0') 
ABS Min:  tensor(0.0028, device='cuda:0')
Criterion check:  tensor([1.0013, 0.9989, 1.0004, 0.9999, 0.9999, 1.0000, 1.0002, 1.0006, 0.9990,
        1.0028], device='cuda:0') tensor(219, device='cuda:0')
max of Lambda2 tensor(63834.3594, device='cuda:0')
min of Lambda2 tensor(3.3512e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2205, device='cuda:0')
min of grad d_p:  tensor(-0.2231, device='cuda:0')
max|min: (J_L, Jta/N)  (0.22051526606082916, 0.22051531076431274, ratio: 1.000000238418579)|(-0.22314363718032837, -0.22314363718032837)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.9605e-08, device='cuda:0') mean:  tensor(-9.5678e-12, device='cuda:0') min:  tensor(-8.9407e-08, device='cuda:0') norm:  tensor(7.8606e-07, device='cuda:0') MSE:  tensor(9.9050e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(5.4502e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0097, device='cuda:0') MSE:  tensor(1.2183e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0171, device='cuda:0')
min of d_p_list:  tensor(-0.0236, device='cuda:0')
Epoch:  124  
Training Loss: 0.10964402556419373
Test Loss:  0.10362272709608078
Test Acc:  0.0
Valid Loss:  0.10956397652626038
Valid Acc:  0.0
std:  0.050285090347601036 
thres:  0.00016796033084392548
Preserved_eigens number check:  512
 12%|█▏        | 124/1000 [37:55<4:14:58, 17.46s/it]Epoch:   125
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  492
Criterion check: 
Mean:  tensor(-10.3929, device='cuda:0') 
Std:  tensor(207.6431, device='cuda:0') 
ABS Max:  tensor(4638.6387, device='cuda:0') 
ABS Min:  tensor(0.0004, device='cuda:0')
Criterion check:  tensor([0.9999, 0.9996, 1.0001, 1.0000, 1.0000, 1.0000, 1.0000, 1.0001, 0.9978,
        1.0000], device='cuda:0') tensor(187, device='cuda:0')
max of Lambda2 tensor(63842.5703, device='cuda:0')
min of Lambda2 tensor(7.6493e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1973, device='cuda:0')
min of grad d_p:  tensor(-0.2006, device='cuda:0')
max|min: (J_L, Jta/N)  (0.19725459814071655, 0.19725459814071655, ratio: 1.0)|(-0.20058774948120117, -0.20058779418468475)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.9407e-08, device='cuda:0') mean:  tensor(-6.1882e-12, device='cuda:0') min:  tensor(-5.9605e-08, device='cuda:0') norm:  tensor(7.2770e-07, device='cuda:0') MSE:  tensor(9.1696e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(2.5874e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0042, device='cuda:0') MSE:  tensor(5.2436e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0172, device='cuda:0')
min of d_p_list:  tensor(-0.0230, device='cuda:0')
Epoch:  125  
Training Loss: 0.09331626445055008
Test Loss:  0.08914099633693695
Test Acc:  0.0
Valid Loss:  0.09312573075294495
Valid Acc:  0.0
std:  0.03422357280795463 
thres:  0.0001360006019473076
Preserved_eigens number check:  512
 12%|█▎        | 125/1000 [38:12<4:15:21, 17.51s/it]Epoch:   126
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  493
Criterion check: 
Mean:  tensor(2.1712, device='cuda:0') 
Std:  tensor(129.7897, device='cuda:0') 
ABS Max:  tensor(1551.2373, device='cuda:0') 
ABS Min:  tensor(0.0010, device='cuda:0')
Criterion check:  tensor([0.9998, 1.0001, 0.9998, 1.0000, 1.0002, 0.9999, 1.0001, 1.0007, 1.0001,
        0.9981], device='cuda:0') tensor(219, device='cuda:0')
max of Lambda2 tensor(63958.3984, device='cuda:0')
min of Lambda2 tensor(2.9678e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1887, device='cuda:0')
min of grad d_p:  tensor(-0.1755, device='cuda:0')
max|min: (J_L, Jta/N)  (0.1887044757604599, 0.1887045055627823, ratio: 1.0000001192092896)|(-0.17553721368312836, -0.17553725838661194)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.1956e-08, device='cuda:0') mean:  tensor(-2.0453e-12, device='cuda:0') min:  tensor(-5.9605e-08, device='cuda:0') norm:  tensor(7.4695e-07, device='cuda:0') MSE:  tensor(9.4122e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(8.2758e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0145, device='cuda:0') MSE:  tensor(1.8249e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0159, device='cuda:0')
min of d_p_list:  tensor(-0.0193, device='cuda:0')
Epoch:  126  
Training Loss: 0.07681498676538467
Test Loss:  0.07368539273738861
Test Acc:  0.0
Valid Loss:  0.07707780599594116
Valid Acc:  0.0
std:  0.028070239178968715 
thres:  0.0001134402871131897
Preserved_eigens number check:  512
 13%|█▎        | 126/1000 [38:30<4:17:31, 17.68s/it]Epoch:   127
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  492
Criterion check: 
Mean:  tensor(-96.6906, device='cuda:0') 
Std:  tensor(2274.3708, device='cuda:0') 
ABS Max:  tensor(51425.0664, device='cuda:0') 
ABS Min:  tensor(0.0014, device='cuda:0')
Criterion check:  tensor([0.9997, 1.0001, 1.0003, 1.0000, 1.0001, 1.0000, 1.0002, 0.9999, 0.9938,
        0.9910], device='cuda:0') tensor(216, device='cuda:0')
max of Lambda2 tensor(64593.3320, device='cuda:0')
min of Lambda2 tensor(1.0837e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1690, device='cuda:0')
min of grad d_p:  tensor(-0.1599, device='cuda:0')
max|min: (J_L, Jta/N)  (0.16895264387130737, 0.16895264387130737, ratio: 1.0)|(-0.15992361307144165, -0.15992362797260284)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.2154e-08, device='cuda:0') mean:  tensor(-6.8363e-12, device='cuda:0') min:  tensor(-6.7055e-08, device='cuda:0') norm:  tensor(6.8810e-07, device='cuda:0') MSE:  tensor(8.6707e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(5.4129e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0089, device='cuda:0') MSE:  tensor(1.1262e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0153, device='cuda:0')
min of d_p_list:  tensor(-0.0148, device='cuda:0')
Epoch:  127  
Training Loss: 0.06532154232263565
Test Loss:  0.06333506107330322
Test Acc:  0.0
Valid Loss:  0.06588312983512878
Valid Acc:  0.0
std:  0.02320868382573506 
thres:  9.513136297464372e-05
Preserved_eigens number check:  512
 13%|█▎        | 127/1000 [38:48<4:16:52, 17.66s/it]Epoch:   128
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  493
Criterion check: 
Mean:  tensor(-43.8223, device='cuda:0') 
Std:  tensor(2017.7693, device='cuda:0') 
ABS Max:  tensor(41884.1875, device='cuda:0') 
ABS Min:  tensor(0.0005, device='cuda:0')
Criterion check:  tensor([1.0038, 1.0017, 0.9983, 1.0007, 0.9990, 1.0006, 1.0015, 1.0008, 0.9467,
        0.9727], device='cuda:0') tensor(266, device='cuda:0')
max of Lambda2 tensor(65029.0703, device='cuda:0')
min of Lambda2 tensor(8.0118e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1515, device='cuda:0')
min of grad d_p:  tensor(-0.1452, device='cuda:0')
max|min: (J_L, Jta/N)  (0.15151554346084595, 0.15151554346084595, ratio: 1.0)|(-0.1452046036720276, -0.14520461857318878)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.2154e-08, device='cuda:0') mean:  tensor(-4.1704e-12, device='cuda:0') min:  tensor(-6.7055e-08, device='cuda:0') norm:  tensor(6.4072e-07, device='cuda:0') MSE:  tensor(8.0736e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0028, device='cuda:0') mean:  tensor(3.8768e-05, device='cuda:0') min:  tensor(1.9975e-14, device='cuda:0') norm:  tensor(0.0645, device='cuda:0') MSE:  tensor(8.1250e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0519, device='cuda:0')
min of d_p_list:  tensor(-0.0572, device='cuda:0')
Epoch:  128  
Training Loss: 0.06436389684677124
Test Loss:  0.06354419142007828
Test Acc:  0.0
Valid Loss:  0.062005896121263504
Valid Acc:  0.0
std:  0.017368242698795167 
thres:  8.189214318990708e-05
Preserved_eigens number check:  512
 13%|█▎        | 128/1000 [39:05<4:13:52, 17.47s/it]Epoch:   129
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  493
Criterion check: 
Mean:  tensor(-2.1427, device='cuda:0') 
Std:  tensor(58.2929, device='cuda:0') 
ABS Max:  tensor(834.2920, device='cuda:0') 
ABS Min:  tensor(0.0012, device='cuda:0')
Criterion check:  tensor([0.9999, 0.9999, 1.0001, 1.0000, 1.0000, 0.9999, 1.0000, 0.9997, 0.9999,
        1.0070], device='cuda:0') tensor(192, device='cuda:0')
max of Lambda2 tensor(63090.5703, device='cuda:0')
min of Lambda2 tensor(2.8358e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1413, device='cuda:0')
min of grad d_p:  tensor(-0.1249, device='cuda:0')
max|min: (J_L, Jta/N)  (0.14126832783222198, 0.1412682682275772, ratio: 0.9999995827674866)|(-0.1249130368232727, -0.12491302937269211)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.9605e-08, device='cuda:0') mean:  tensor(-9.9282e-12, device='cuda:0') min:  tensor(-5.2154e-08, device='cuda:0') norm:  tensor(6.5331e-07, device='cuda:0') MSE:  tensor(8.2322e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(3.3526e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0056, device='cuda:0') MSE:  tensor(6.9994e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.8335, device='cuda:0')
min of d_p_list:  tensor(-0.5665, device='cuda:0')
Epoch:  129  
Training Loss: 0.7813212871551514
Test Loss:  0.7639551758766174
Test Acc:  0.0
Valid Loss:  0.6827059984207153
Valid Acc:  0.0
std:  0.2827398701906733 
thres:  0.0002162275955080986
Preserved_eigens number check:  512
 13%|█▎        | 129/1000 [39:22<4:13:26, 17.46s/it]Epoch:   130
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  486
Criterion check: 
Mean:  tensor(3.4143, device='cuda:0') 
Std:  tensor(73.0945, device='cuda:0') 
ABS Max:  tensor(1505.8232, device='cuda:0') 
ABS Min:  tensor(0.0005, device='cuda:0')
Criterion check:  tensor([1.0003, 1.0008, 1.0004, 1.0000, 1.0003, 1.0000, 1.0004, 0.9997, 1.0032,
        0.9984], device='cuda:0') tensor(191, device='cuda:0')
max of Lambda2 tensor(62662.0547, device='cuda:0')
min of Lambda2 tensor(1.8662e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2171, device='cuda:0')
min of grad d_p:  tensor(-0.2790, device='cuda:0')
max|min: (J_L, Jta/N)  (0.21712003648281097, 0.21712005138397217, ratio: 1.0000001192092896)|(-0.2790036201477051, -0.27900370955467224)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.9407e-08, device='cuda:0') mean:  tensor(-6.1640e-13, device='cuda:0') min:  tensor(-1.6391e-07, device='cuda:0') norm:  tensor(9.6005e-07, device='cuda:0') MSE:  tensor(1.2097e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(5.8900e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0105, device='cuda:0') MSE:  tensor(1.3289e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.3699, device='cuda:0')
min of d_p_list:  tensor(-0.5606, device='cuda:0')
Epoch:  130  
Training Loss: 0.3948914706707001
Test Loss:  0.3947794735431671
Test Acc:  0.0
Valid Loss:  0.3641631007194519
Valid Acc:  0.0
std:  0.28225280688121707 
thres:  0.0002765426367521286
Preserved_eigens number check:  512
 13%|█▎        | 130/1000 [39:40<4:13:25, 17.48s/it]Epoch:   131
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  486
Criterion check: 
Mean:  tensor(-0.6612, device='cuda:0') 
Std:  tensor(28.2745, device='cuda:0') 
ABS Max:  tensor(327.9588, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([1.0002, 1.0000, 1.0001, 1.0000, 0.9999, 1.0001, 1.0000, 1.0002, 1.0001,
        1.0012], device='cuda:0') tensor(174, device='cuda:0')
max of Lambda2 tensor(63326.5898, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2724, device='cuda:0')
min of grad d_p:  tensor(-0.2304, device='cuda:0')
max|min: (J_L, Jta/N)  (0.2724144458770752, 0.27241450548171997, ratio: 1.000000238418579)|(-0.2304416000843048, -0.23044170439243317)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.3411e-07, device='cuda:0') mean:  tensor(-3.5372e-12, device='cuda:0') min:  tensor(-1.4901e-07, device='cuda:0') norm:  tensor(1.0873e-06, device='cuda:0') MSE:  tensor(1.3701e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(9.3982e-05, device='cuda:0') mean:  tensor(1.6640e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0030, device='cuda:0') MSE:  tensor(3.8132e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0304, device='cuda:0')
min of d_p_list:  tensor(-0.0311, device='cuda:0')
Epoch:  131  
Training Loss: 0.24673810601234436
Test Loss:  0.24309539794921875
Test Acc:  0.0
Valid Loss:  0.22831735014915466
Valid Acc:  0.0
std:  0.26591563983868877 
thres:  0.0003105272606015205
Preserved_eigens number check:  512
 13%|█▎        | 131/1000 [39:57<4:13:37, 17.51s/it]Epoch:   132
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  488
Criterion check: 
Mean:  tensor(-1.3714, device='cuda:0') 
Std:  tensor(36.5682, device='cuda:0') 
ABS Max:  tensor(523.7849, device='cuda:0') 
ABS Min:  tensor(0.0007, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0003, 1.0000, 1.0002, 1.0000, 1.0001, 1.0000, 0.9998,
        1.0013], device='cuda:0') tensor(192, device='cuda:0')
max of Lambda2 tensor(63368.0039, device='cuda:0')
min of Lambda2 tensor(5.9229e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2462, device='cuda:0')
min of grad d_p:  tensor(-0.1985, device='cuda:0')
max|min: (J_L, Jta/N)  (0.24618878960609436, 0.24618880450725555, ratio: 1.0000001192092896)|(-0.19854825735092163, -0.19854816794395447)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.3411e-07, device='cuda:0') mean:  tensor(6.4054e-12, device='cuda:0') min:  tensor(-8.9407e-08, device='cuda:0') norm:  tensor(7.9701e-07, device='cuda:0') MSE:  tensor(1.0043e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(3.5307e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0060, device='cuda:0') MSE:  tensor(7.5343e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0428, device='cuda:0')
min of d_p_list:  tensor(-0.0463, device='cuda:0')
Epoch:  132  
Training Loss: 0.19779880344867706
Test Loss:  0.1952744722366333
Test Acc:  0.0
Valid Loss:  0.18527500331401825
Valid Acc:  0.0
std:  0.24601928923822267 
thres:  0.0003370227128267288
Preserved_eigens number check:  512
 13%|█▎        | 132/1000 [40:15<4:12:02, 17.42s/it]Epoch:   133
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  483
Criterion check: 
Mean:  tensor(-1.0212, device='cuda:0') 
Std:  tensor(24.0031, device='cuda:0') 
ABS Max:  tensor(334.7400, device='cuda:0') 
ABS Min:  tensor(0.0017, device='cuda:0')
Criterion check:  tensor([0.9997, 1.0000, 0.9998, 1.0000, 1.0001, 0.9999, 1.0000, 0.9992, 1.0004,
        0.9921], device='cuda:0') tensor(166, device='cuda:0')
max of Lambda2 tensor(63703.0195, device='cuda:0')
min of Lambda2 tensor(1.1417e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2151, device='cuda:0')
min of grad d_p:  tensor(-0.2009, device='cuda:0')
max|min: (J_L, Jta/N)  (0.21509897708892822, 0.21509894728660583, ratio: 0.9999998807907104)|(-0.20087501406669617, -0.20087504386901855)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.9605e-08, device='cuda:0') mean:  tensor(-8.9716e-12, device='cuda:0') min:  tensor(-1.0431e-07, device='cuda:0') norm:  tensor(7.6522e-07, device='cuda:0') MSE:  tensor(9.6424e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(2.0662e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0039, device='cuda:0') MSE:  tensor(4.8527e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0343, device='cuda:0')
min of d_p_list:  tensor(-0.0371, device='cuda:0')
Epoch:  133  
Training Loss: 0.16522206366062164
Test Loss:  0.1644614189863205
Test Acc:  0.0
Valid Loss:  0.1551782190799713
Valid Acc:  0.0
std:  0.226170560659912 
thres:  0.0003571943461894989
Preserved_eigens number check:  512
 13%|█▎        | 133/1000 [40:32<4:12:35, 17.48s/it]Epoch:   134
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  484
Criterion check: 
Mean:  tensor(10.2427, device='cuda:0') 
Std:  tensor(202.9891, device='cuda:0') 
ABS Max:  tensor(4249.4453, device='cuda:0') 
ABS Min:  tensor(0.0054, device='cuda:0')
Criterion check:  tensor([0.9985, 0.9997, 0.9994, 0.9999, 1.0004, 0.9999, 1.0002, 0.9993, 0.9996,
        1.0055], device='cuda:0') tensor(217, device='cuda:0')
max of Lambda2 tensor(63513.7422, device='cuda:0')
min of Lambda2 tensor(2.8686e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1963, device='cuda:0')
min of grad d_p:  tensor(-0.1906, device='cuda:0')
max|min: (J_L, Jta/N)  (0.19633883237838745, 0.19633886218070984, ratio: 1.0000001192092896)|(-0.19056424498558044, -0.19056427478790283)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.9407e-08, device='cuda:0') mean:  tensor(1.0543e-11, device='cuda:0') min:  tensor(-7.4506e-08, device='cuda:0') norm:  tensor(6.8960e-07, device='cuda:0') MSE:  tensor(8.6894e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(4.2363e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0075, device='cuda:0') MSE:  tensor(9.4613e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0474, device='cuda:0')
min of d_p_list:  tensor(-0.0485, device='cuda:0')
Epoch:  134  
Training Loss: 0.1379527747631073
Test Loss:  0.1381504386663437
Test Acc:  0.0
Valid Loss:  0.12925979495048523
Valid Acc:  0.0
std:  0.09073500822418641 
thres:  0.00022852064371109012
Preserved_eigens number check:  512
 13%|█▎        | 134/1000 [40:50<4:14:35, 17.64s/it]Epoch:   135
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  484
Criterion check: 
Mean:  tensor(-35.7737, device='cuda:0') 
Std:  tensor(627.3672, device='cuda:0') 
ABS Max:  tensor(12817.0469, device='cuda:0') 
ABS Min:  tensor(0.0037, device='cuda:0')
Criterion check:  tensor([1.0018, 0.9994, 0.9983, 1.0003, 0.9996, 0.9978, 0.9965, 0.9894, 0.9839,
        0.9500], device='cuda:0') tensor(247, device='cuda:0')
max of Lambda2 tensor(63433.4844, device='cuda:0')
min of Lambda2 tensor(1.4549e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1981, device='cuda:0')
min of grad d_p:  tensor(-0.1588, device='cuda:0')
max|min: (J_L, Jta/N)  (0.19812318682670593, 0.1981232464313507, ratio: 1.0000003576278687)|(-0.15883386135101318, -0.1588338017463684)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.0431e-07, device='cuda:0') mean:  tensor(-1.4330e-11, device='cuda:0') min:  tensor(-1.0431e-07, device='cuda:0') norm:  tensor(7.6351e-07, device='cuda:0') MSE:  tensor(9.6209e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0013, device='cuda:0') mean:  tensor(2.2130e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0411, device='cuda:0') MSE:  tensor(5.1825e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.2044, device='cuda:0')
min of d_p_list:  tensor(-0.1773, device='cuda:0')
Epoch:  135  
Training Loss: 0.12582960724830627
Test Loss:  0.1270507127046585
Test Acc:  0.0
Valid Loss:  0.14233146607875824
Valid Acc:  0.0
std:  0.04370708918270812 
thres:  0.00017470827102661132
Preserved_eigens number check:  512
 14%|█▎        | 135/1000 [41:08<4:13:54, 17.61s/it]Epoch:   136
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  485
Criterion check: 
Mean:  tensor(-3.0822, device='cuda:0') 
Std:  tensor(137.8067, device='cuda:0') 
ABS Max:  tensor(1529.7620, device='cuda:0') 
ABS Min:  tensor(0.0062, device='cuda:0')
Criterion check:  tensor([0.9846, 1.0001, 1.0005, 1.0008, 1.0050, 1.0009, 1.0010, 1.0008, 0.9991,
        0.9626], device='cuda:0') tensor(254, device='cuda:0')
max of Lambda2 tensor(64105.7969, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2289, device='cuda:0')
min of grad d_p:  tensor(-0.1442, device='cuda:0')
max|min: (J_L, Jta/N)  (0.22885292768478394, 0.2288530021905899, ratio: 1.0000003576278687)|(-0.144243985414505, -0.14424392580986023)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.9407e-08, device='cuda:0') mean:  tensor(-1.4477e-12, device='cuda:0') min:  tensor(-1.1921e-07, device='cuda:0') norm:  tensor(7.0724e-07, device='cuda:0') MSE:  tensor(8.9117e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0013, device='cuda:0') mean:  tensor(1.9725e-05, device='cuda:0') min:  tensor(3.8001e-15, device='cuda:0') norm:  tensor(0.0354, device='cuda:0') MSE:  tensor(4.4637e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1359, device='cuda:0')
min of d_p_list:  tensor(-0.0701, device='cuda:0')
Epoch:  136  
Training Loss: 0.10210979729890823
Test Loss:  0.10128472000360489
Test Acc:  0.0
Valid Loss:  0.10572758316993713
Valid Acc:  0.0
std:  0.033016117116899966 
thres:  0.00014578260928392413
Preserved_eigens number check:  512
 14%|█▎        | 136/1000 [41:25<4:11:39, 17.48s/it]Epoch:   137
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  478
Criterion check: 
Mean:  tensor(7.1167, device='cuda:0') 
Std:  tensor(158.9040, device='cuda:0') 
ABS Max:  tensor(2588.5259, device='cuda:0') 
ABS Min:  tensor(0.0036, device='cuda:0')
Criterion check:  tensor([0.9971, 0.9998, 0.9999, 1.0000, 0.9992, 1.0006, 0.9997, 1.0025, 0.9905,
        1.0142], device='cuda:0') tensor(220, device='cuda:0')
max of Lambda2 tensor(64826.7383, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2308, device='cuda:0')
min of grad d_p:  tensor(-0.1498, device='cuda:0')
max|min: (J_L, Jta/N)  (0.2307530641555786, 0.2307531237602234, ratio: 1.000000238418579)|(-0.14975887537002563, -0.14975884556770325)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.9407e-08, device='cuda:0') mean:  tensor(-1.7616e-13, device='cuda:0') min:  tensor(-8.9407e-08, device='cuda:0') norm:  tensor(6.6471e-07, device='cuda:0') MSE:  tensor(8.3758e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(7.7601e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0141, device='cuda:0') MSE:  tensor(1.7804e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0249, device='cuda:0')
min of d_p_list:  tensor(-0.0409, device='cuda:0')
Epoch:  137  
Training Loss: 0.08407092839479446
Test Loss:  0.08323253691196442
Test Acc:  0.0
Valid Loss:  0.0833982527256012
Valid Acc:  0.0
std:  0.02816437869830065 
thres:  0.00012303703427314757
Preserved_eigens number check:  512
 14%|█▎        | 137/1000 [41:43<4:13:15, 17.61s/it]Epoch:   138
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  480
Criterion check: 
Mean:  tensor(-2.7068, device='cuda:0') 
Std:  tensor(71.4485, device='cuda:0') 
ABS Max:  tensor(769.3507, device='cuda:0') 
ABS Min:  tensor(0.0024, device='cuda:0')
Criterion check:  tensor([0.9883, 1.0000, 0.9998, 1.0002, 0.9973, 1.0008, 0.9993, 0.9984, 1.0071,
        0.9913], device='cuda:0') tensor(220, device='cuda:0')
max of Lambda2 tensor(65139.7773, device='cuda:0')
min of Lambda2 tensor(1.0599e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2088, device='cuda:0')
min of grad d_p:  tensor(-0.1389, device='cuda:0')
max|min: (J_L, Jta/N)  (0.20878440141677856, 0.2087843418121338, ratio: 0.9999997019767761)|(-0.13893155753612518, -0.13893155753612518)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.0431e-07, device='cuda:0') mean:  tensor(1.1877e-12, device='cuda:0') min:  tensor(-1.0431e-07, device='cuda:0') norm:  tensor(6.4937e-07, device='cuda:0') MSE:  tensor(8.1826e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0007, device='cuda:0') mean:  tensor(1.4419e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0276, device='cuda:0') MSE:  tensor(3.4811e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0277, device='cuda:0')
min of d_p_list:  tensor(-0.0356, device='cuda:0')
Epoch:  138  
Training Loss: 0.0731973946094513
Test Loss:  0.07273517549037933
Test Acc:  0.0
Valid Loss:  0.06974496692419052
Valid Acc:  0.0
std:  0.024400271194788017 
thres:  0.00010463210046291353
Preserved_eigens number check:  512
 14%|█▍        | 138/1000 [42:00<4:10:53, 17.46s/it]Epoch:   139
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  482
Criterion check: 
Mean:  tensor(108.0399, device='cuda:0') 
Std:  tensor(5855.5698, device='cuda:0') 
ABS Max:  tensor(124441.8750, device='cuda:0') 
ABS Min:  tensor(0.0370, device='cuda:0')
Criterion check:  tensor([1.0165, 1.0012, 0.9990, 0.9990, 1.0248, 0.9961, 1.0017, 0.9712, 1.0349,
        0.9487], device='cuda:0') tensor(246, device='cuda:0')
max of Lambda2 tensor(65110.2617, device='cuda:0')
min of Lambda2 tensor(3.7045e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1905, device='cuda:0')
min of grad d_p:  tensor(-0.1294, device='cuda:0')
max|min: (J_L, Jta/N)  (0.19052761793136597, 0.19052764773368835, ratio: 1.0000001192092896)|(-0.1294088065624237, -0.1294088065624237)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.1921e-07, device='cuda:0') mean:  tensor(1.6676e-11, device='cuda:0') min:  tensor(-5.9605e-08, device='cuda:0') norm:  tensor(8.8286e-07, device='cuda:0') MSE:  tensor(1.1125e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0125, device='cuda:0') mean:  tensor(0.0002, device='cuda:0') min:  tensor(6.6279e-14, device='cuda:0') norm:  tensor(0.3229, device='cuda:0') MSE:  tensor(4.0694e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0889, device='cuda:0')
min of d_p_list:  tensor(-0.0603, device='cuda:0')
Epoch:  139  
Training Loss: 0.07767631113529205
Test Loss:  0.07792599499225616
Test Acc:  0.0
Valid Loss:  0.0726906880736351
Valid Acc:  0.0
std:  0.01932129913259695 
thres:  9.257680773735046e-05
Preserved_eigens number check:  512
 14%|█▍        | 139/1000 [42:18<4:10:40, 17.47s/it]Epoch:   140
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  481
Criterion check: 
Mean:  tensor(-1.4266, device='cuda:0') 
Std:  tensor(37.0183, device='cuda:0') 
ABS Max:  tensor(792.6857, device='cuda:0') 
ABS Min:  tensor(0.0001, device='cuda:0')
Criterion check:  tensor([1.0164, 1.0000, 1.0000, 1.0000, 1.0002, 1.0000, 1.0000, 1.0003, 1.0003,
        1.0006], device='cuda:0') tensor(152, device='cuda:0')
max of Lambda2 tensor(65710.7578, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1805, device='cuda:0')
min of grad d_p:  tensor(-0.1379, device='cuda:0')
max|min: (J_L, Jta/N)  (0.1804960072040558, 0.180495947599411, ratio: 0.9999996423721313)|(-0.1379384696483612, -0.1379385143518448)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.0431e-07, device='cuda:0') mean:  tensor(6.6549e-12, device='cuda:0') min:  tensor(-3.3528e-08, device='cuda:0') norm:  tensor(7.4648e-07, device='cuda:0') MSE:  tensor(9.4063e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(5.6386e-05, device='cuda:0') mean:  tensor(6.9545e-07, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0013, device='cuda:0') MSE:  tensor(1.6833e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0395, device='cuda:0')
min of d_p_list:  tensor(-0.0468, device='cuda:0')
Epoch:  140  
Training Loss: 0.06797037273645401
Test Loss:  0.0682998076081276
Test Acc:  0.0
Valid Loss:  0.06230296567082405
Valid Acc:  0.0
std:  0.011804683522521679 
thres:  8.100496083498002e-05
Preserved_eigens number check:  512
 14%|█▍        | 140/1000 [42:35<4:12:17, 17.60s/it]Epoch:   141
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  486
Criterion check: 
Mean:  tensor(11.4602, device='cuda:0') 
Std:  tensor(227.1237, device='cuda:0') 
ABS Max:  tensor(3552.2261, device='cuda:0') 
ABS Min:  tensor(0.0034, device='cuda:0')
Criterion check:  tensor([1.0648, 1.0004, 0.9994, 1.0000, 1.0028, 0.9997, 0.9995, 0.9988, 1.0016,
        1.0098], device='cuda:0') tensor(224, device='cuda:0')
max of Lambda2 tensor(65270.1484, device='cuda:0')
min of Lambda2 tensor(4.3846e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1646, device='cuda:0')
min of grad d_p:  tensor(-0.1215, device='cuda:0')
max|min: (J_L, Jta/N)  (0.16459764540195465, 0.16459764540195465, ratio: 1.0)|(-0.12148154526948929, -0.12148154526948929)

 check Jacobi res:  torch.Size([793601]) max:  tensor(7.4506e-08, device='cuda:0') mean:  tensor(-4.3649e-12, device='cuda:0') min:  tensor(-7.4506e-08, device='cuda:0') norm:  tensor(6.0537e-07, device='cuda:0') MSE:  tensor(7.6281e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(7.3032e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0137, device='cuda:0') MSE:  tensor(1.7243e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1336, device='cuda:0')
min of d_p_list:  tensor(-0.1852, device='cuda:0')
Epoch:  141  
Training Loss: 0.06797359883785248
Test Loss:  0.06671182811260223
Test Acc:  0.0
Valid Loss:  0.06331901252269745
Valid Acc:  0.0
std:  0.006133498668639007 
thres:  7.417772114276885e-05
Preserved_eigens number check:  512
 14%|█▍        | 141/1000 [42:52<4:09:33, 17.43s/it]Epoch:   142
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  479
Criterion check: 
Mean:  tensor(3.6024, device='cuda:0') 
Std:  tensor(73.0130, device='cuda:0') 
ABS Max:  tensor(1012.0733, device='cuda:0') 
ABS Min:  tensor(0.0010, device='cuda:0')
Criterion check:  tensor([1.0004, 1.0000, 1.0000, 1.0000, 0.9980, 0.9998, 1.0004, 0.9985, 0.9958,
        0.9985], device='cuda:0') tensor(180, device='cuda:0')
max of Lambda2 tensor(65713.5234, device='cuda:0')
min of Lambda2 tensor(5.3327e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2041, device='cuda:0')
min of grad d_p:  tensor(-0.1402, device='cuda:0')
max|min: (J_L, Jta/N)  (0.2040649950504303, 0.2040649801492691, ratio: 0.9999999403953552)|(-0.14020559191703796, -0.14020557701587677)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.1921e-07, device='cuda:0') mean:  tensor(5.5526e-12, device='cuda:0') min:  tensor(-7.4506e-08, device='cuda:0') norm:  tensor(6.2981e-07, device='cuda:0') MSE:  tensor(7.9361e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(2.1841e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0043, device='cuda:0') MSE:  tensor(5.3674e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0212, device='cuda:0')
min of d_p_list:  tensor(-0.0159, device='cuda:0')
Epoch:  142  
Training Loss: 0.06508532166481018
Test Loss:  0.06432740390300751
Test Acc:  0.0
Valid Loss:  0.05990925431251526
Valid Acc:  0.0
std:  0.004490090323036023 
thres:  7.0380599796772e-05
Preserved_eigens number check:  512
 14%|█▍        | 142/1000 [43:10<4:08:14, 17.36s/it]Epoch:   143
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  482
Criterion check: 
Mean:  tensor(118.0847, device='cuda:0') 
Std:  tensor(2468.5107, device='cuda:0') 
ABS Max:  tensor(48655.2969, device='cuda:0') 
ABS Min:  tensor(0.0034, device='cuda:0')
Criterion check:  tensor([1.0068, 0.9988, 1.0019, 0.9990, 1.0379, 1.0037, 0.9936, 1.0722, 0.9058,
        1.0851], device='cuda:0') tensor(270, device='cuda:0')
max of Lambda2 tensor(65826.7969, device='cuda:0')
min of Lambda2 tensor(1.5934e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1862, device='cuda:0')
min of grad d_p:  tensor(-0.1276, device='cuda:0')
max|min: (J_L, Jta/N)  (0.18616679310798645, 0.18616679310798645, ratio: 1.0)|(-0.12764310836791992, -0.12764312326908112)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.9605e-08, device='cuda:0') mean:  tensor(-1.1552e-12, device='cuda:0') min:  tensor(-8.9407e-08, device='cuda:0') norm:  tensor(5.6228e-07, device='cuda:0') MSE:  tensor(7.0851e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0033, device='cuda:0') mean:  tensor(7.9516e-05, device='cuda:0') min:  tensor(1.1993e-14, device='cuda:0') norm:  tensor(0.1483, device='cuda:0') MSE:  tensor(1.8686e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0254, device='cuda:0')
min of d_p_list:  tensor(-0.0201, device='cuda:0')
Epoch:  143  
Training Loss: 0.0570652149617672
Test Loss:  0.05654071643948555
Test Acc:  0.0
Valid Loss:  0.05208982527256012
Valid Acc:  0.0
std:  0.006604850517545679 
thres:  6.715416386723518e-05
Preserved_eigens number check:  512
 14%|█▍        | 143/1000 [43:28<4:10:19, 17.53s/it]Epoch:   144
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  480
Criterion check: 
Mean:  tensor(57.5109, device='cuda:0') 
Std:  tensor(939.5928, device='cuda:0') 
ABS Max:  tensor(18498.9531, device='cuda:0') 
ABS Min:  tensor(0.0039, device='cuda:0')
Criterion check:  tensor([1.0043, 1.0002, 0.9997, 0.9999, 1.0001, 1.0002, 1.0005, 0.9983, 1.0462,
        0.9767], device='cuda:0') tensor(219, device='cuda:0')
max of Lambda2 tensor(66190.6250, device='cuda:0')
min of Lambda2 tensor(3.4846e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1692, device='cuda:0')
min of grad d_p:  tensor(-0.1161, device='cuda:0')
max|min: (J_L, Jta/N)  (0.16915342211723328, 0.16915340721607208, ratio: 0.9999999403953552)|(-0.11613613367080688, -0.11613612622022629)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.9407e-08, device='cuda:0') mean:  tensor(5.1588e-12, device='cuda:0') min:  tensor(-5.9605e-08, device='cuda:0') norm:  tensor(6.2387e-07, device='cuda:0') MSE:  tensor(7.8613e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0006, device='cuda:0') mean:  tensor(1.4230e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0247, device='cuda:0') MSE:  tensor(3.1144e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0218, device='cuda:0')
min of d_p_list:  tensor(-0.0204, device='cuda:0')
Epoch:  144  
Training Loss: 0.04912061244249344
Test Loss:  0.04872189462184906
Test Acc:  0.0
Valid Loss:  0.04477783292531967
Valid Acc:  0.0
std:  0.007342044130716805 
thres:  6.144302412867546e-05
Preserved_eigens number check:  512
 14%|█▍        | 144/1000 [43:45<4:09:25, 17.48s/it]Epoch:   145
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  481
Criterion check: 
Mean:  tensor(-6.7584, device='cuda:0') 
Std:  tensor(104.9408, device='cuda:0') 
ABS Max:  tensor(2000.1226, device='cuda:0') 
ABS Min:  tensor(0.0023, device='cuda:0')
Criterion check:  tensor([0.9985, 1.0001, 1.0003, 1.0001, 1.0009, 0.9998, 1.0001, 0.9975, 0.9969,
        0.9928], device='cuda:0') tensor(188, device='cuda:0')
max of Lambda2 tensor(66701.0312, device='cuda:0')
min of Lambda2 tensor(3.2803e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1544, device='cuda:0')
min of grad d_p:  tensor(-0.1060, device='cuda:0')
max|min: (J_L, Jta/N)  (0.15440315008163452, 0.15440316498279572, ratio: 1.0000001192092896)|(-0.10599672049283981, -0.10599668323993683)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.9802e-08, device='cuda:0') mean:  tensor(-1.7226e-11, device='cuda:0') min:  tensor(-7.8231e-08, device='cuda:0') norm:  tensor(9.2164e-07, device='cuda:0') MSE:  tensor(1.1613e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0006, device='cuda:0') mean:  tensor(5.9943e-06, device='cuda:0') min:  tensor(8.3267e-16, device='cuda:0') norm:  tensor(0.0117, device='cuda:0') MSE:  tensor(1.4745e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0232, device='cuda:0')
min of d_p_list:  tensor(-0.0198, device='cuda:0')
Epoch:  145  
Training Loss: 0.04209177941083908
Test Loss:  0.04210221394896507
Test Acc:  0.0
Valid Loss:  0.03855489194393158
Valid Acc:  0.0
std:  0.009669044770468021 
thres:  5.626730546355248e-05
Preserved_eigens number check:  512
 14%|█▍        | 145/1000 [44:02<4:07:30, 17.37s/it]Epoch:   146
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  482
Criterion check: 
Mean:  tensor(-0.3203, device='cuda:0') 
Std:  tensor(21.2598, device='cuda:0') 
ABS Max:  tensor(324.8499, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([1.0002, 1.0000, 1.0000, 1.0000, 0.9997, 0.9999, 0.9998, 1.0002, 0.9972,
        1.0004], device='cuda:0') tensor(158, device='cuda:0')
max of Lambda2 tensor(67571.6328, device='cuda:0')
min of Lambda2 tensor(1.1371e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1403, device='cuda:0')
min of grad d_p:  tensor(-0.0973, device='cuda:0')
max|min: (J_L, Jta/N)  (0.1402692049741745, 0.1402691900730133, ratio: 0.9999998807907104)|(-0.09728433936834335, -0.09728433191776276)

 check Jacobi res:  torch.Size([793601]) max:  tensor(6.7055e-08, device='cuda:0') mean:  tensor(-1.9092e-12, device='cuda:0') min:  tensor(-7.4506e-08, device='cuda:0') norm:  tensor(5.3726e-07, device='cuda:0') MSE:  tensor(6.7699e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(9.9208e-05, device='cuda:0') mean:  tensor(1.1021e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0023, device='cuda:0') MSE:  tensor(2.8889e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0186, device='cuda:0')
min of d_p_list:  tensor(-0.0212, device='cuda:0')
Epoch:  146  
Training Loss: 0.03635277599096298
Test Loss:  0.03651972860097885
Test Acc:  0.0
Valid Loss:  0.03320275992155075
Valid Acc:  0.0
std:  0.010266723195968191 
thres:  4.994314089417458e-05
Preserved_eigens number check:  512
 15%|█▍        | 146/1000 [44:20<4:08:22, 17.45s/it]Epoch:   147
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  482
Criterion check: 
Mean:  tensor(0.1993, device='cuda:0') 
Std:  tensor(9.1879, device='cuda:0') 
ABS Max:  tensor(114.7253, device='cuda:0') 
ABS Min:  tensor(0.0005, device='cuda:0')
Criterion check:  tensor([1.0000, 0.9999, 1.0000, 0.9999, 1.0008, 1.0001, 1.0001, 1.0008, 0.9970,
        1.0022], device='cuda:0') tensor(172, device='cuda:0')
max of Lambda2 tensor(67486.7656, device='cuda:0')
min of Lambda2 tensor(1.9879e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1270, device='cuda:0')
min of grad d_p:  tensor(-0.0891, device='cuda:0')
max|min: (J_L, Jta/N)  (0.12704099714756012, 0.1270410269498825, ratio: 1.000000238418579)|(-0.08914712071418762, -0.08914711326360703)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.7253e-08, device='cuda:0') mean:  tensor(-8.3350e-12, device='cuda:0') min:  tensor(-9.6858e-08, device='cuda:0') norm:  tensor(5.1575e-07, device='cuda:0') MSE:  tensor(6.4988e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(9.8403e-05, device='cuda:0') mean:  tensor(1.6389e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0028, device='cuda:0') MSE:  tensor(3.5514e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0191, device='cuda:0')
min of d_p_list:  tensor(-0.0174, device='cuda:0')
Epoch:  147  
Training Loss: 0.03170812875032425
Test Loss:  0.03172703832387924
Test Acc:  0.0
Valid Loss:  0.02896811254322529
Valid Acc:  0.0
std:  0.00902718842097313 
thres:  4.326770231127739e-05
Preserved_eigens number check:  512
 15%|█▍        | 147/1000 [44:37<4:07:52, 17.44s/it]Epoch:   148
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  483
Criterion check: 
Mean:  tensor(7.4895, device='cuda:0') 
Std:  tensor(192.1371, device='cuda:0') 
ABS Max:  tensor(4141.2935, device='cuda:0') 
ABS Min:  tensor(0.0007, device='cuda:0')
Criterion check:  tensor([0.9980, 1.0002, 1.0003, 1.0001, 1.0017, 0.9996, 1.0001, 0.9968, 0.9954,
        0.9924], device='cuda:0') tensor(176, device='cuda:0')
max of Lambda2 tensor(68129.7188, device='cuda:0')
min of Lambda2 tensor(1.3318e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1151, device='cuda:0')
min of grad d_p:  tensor(-0.0829, device='cuda:0')
max|min: (J_L, Jta/N)  (0.1151309460401535, 0.11513093113899231, ratio: 0.9999998807907104)|(-0.08293750882148743, -0.08293753862380981)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.9605e-08, device='cuda:0') mean:  tensor(2.4320e-12, device='cuda:0') min:  tensor(-3.7253e-08, device='cuda:0') norm:  tensor(3.9944e-07, device='cuda:0') MSE:  tensor(5.0332e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(3.4204e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0064, device='cuda:0') MSE:  tensor(8.0470e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0683, device='cuda:0')
min of d_p_list:  tensor(-0.0763, device='cuda:0')
Epoch:  148  
Training Loss: 0.03016035631299019
Test Loss:  0.030107202008366585
Test Acc:  0.0
Valid Loss:  0.02686527743935585
Valid Acc:  0.0
std:  0.006987238852866157 
thres:  3.788673058152199e-05
Preserved_eigens number check:  512
 15%|█▍        | 148/1000 [44:55<4:08:07, 17.47s/it]Epoch:   149
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  483
Criterion check: 
Mean:  tensor(4.0574, device='cuda:0') 
Std:  tensor(81.2373, device='cuda:0') 
ABS Max:  tensor(1808.0659, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([0.9988, 1.0002, 1.0000, 1.0000, 1.0001, 1.0001, 1.0001, 1.0008, 1.0062,
        1.0022], device='cuda:0') tensor(158, device='cuda:0')
max of Lambda2 tensor(67149.5703, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1120, device='cuda:0')
min of grad d_p:  tensor(-0.0807, device='cuda:0')
max|min: (J_L, Jta/N)  (0.11203747987747192, 0.11203747242689133, ratio: 0.9999999403953552)|(-0.08071362972259521, -0.080713652074337)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.9605e-08, device='cuda:0') mean:  tensor(7.6451e-12, device='cuda:0') min:  tensor(-4.4703e-08, device='cuda:0') norm:  tensor(3.9451e-07, device='cuda:0') MSE:  tensor(4.9711e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(9.1262e-05, device='cuda:0') mean:  tensor(1.3099e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0022, device='cuda:0') MSE:  tensor(2.8270e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0096, device='cuda:0')
min of d_p_list:  tensor(-0.0099, device='cuda:0')
Epoch:  149  
Training Loss: 0.02524767443537712
Test Loss:  0.02525012381374836
Test Acc:  0.0
Valid Loss:  0.02288517914712429
Valid Acc:  0.0
std:  0.005721358907039953 
thres:  3.311214298009872e-05
Preserved_eigens number check:  512
 15%|█▍        | 149/1000 [45:12<4:07:28, 17.45s/it]Epoch:   150
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  486
Criterion check: 
Mean:  tensor(13.0985, device='cuda:0') 
Std:  tensor(388.9516, device='cuda:0') 
ABS Max:  tensor(8277.9609, device='cuda:0') 
ABS Min:  tensor(0.0023, device='cuda:0')
Criterion check:  tensor([0.9921, 1.0006, 1.0002, 1.0000, 0.9994, 1.0001, 1.0002, 1.0002, 1.0668,
        1.0026], device='cuda:0') tensor(228, device='cuda:0')
max of Lambda2 tensor(67251.6094, device='cuda:0')
min of Lambda2 tensor(2.6862e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1020, device='cuda:0')
min of grad d_p:  tensor(-0.0736, device='cuda:0')
max|min: (J_L, Jta/N)  (0.10195818543434143, 0.10195817053318024, ratio: 0.9999998807907104)|(-0.07359234988689423, -0.07359239459037781)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.4703e-08, device='cuda:0') mean:  tensor(1.1112e-12, device='cuda:0') min:  tensor(-5.9605e-08, device='cuda:0') norm:  tensor(4.0181e-07, device='cuda:0') MSE:  tensor(5.0631e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0010, device='cuda:0') mean:  tensor(1.1664e-05, device='cuda:0') min:  tensor(5.4123e-16, device='cuda:0') norm:  tensor(0.0217, device='cuda:0') MSE:  tensor(2.7330e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0213, device='cuda:0')
min of d_p_list:  tensor(-0.0171, device='cuda:0')
Epoch:  150  
Training Loss: 0.023146923631429672
Test Loss:  0.02331044152379036
Test Acc:  0.0
Valid Loss:  0.021201618015766144
Valid Acc:  0.0
std:  0.004702338840494404 
thres:  2.9323171824216842e-05
Preserved_eigens number check:  512
 15%|█▌        | 150/1000 [45:30<4:09:00, 17.58s/it]Epoch:   151
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  484
Criterion check: 
Mean:  tensor(4.2704, device='cuda:0') 
Std:  tensor(97.9259, device='cuda:0') 
ABS Max:  tensor(1919.7275, device='cuda:0') 
ABS Min:  tensor(0.0004, device='cuda:0')
Criterion check:  tensor([0.9985, 1.0003, 1.0003, 1.0000, 1.0004, 1.0002, 0.9996, 1.0029, 0.9904,
        1.0089], device='cuda:0') tensor(176, device='cuda:0')
max of Lambda2 tensor(67339.5938, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0925, device='cuda:0')
min of grad d_p:  tensor(-0.0686, device='cuda:0')
max|min: (J_L, Jta/N)  (0.0925293117761612, 0.09252934157848358, ratio: 1.0000003576278687)|(-0.06859318912029266, -0.06859318912029266)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.9802e-08, device='cuda:0') mean:  tensor(-2.5787e-12, device='cuda:0') min:  tensor(-4.4703e-08, device='cuda:0') norm:  tensor(3.4940e-07, device='cuda:0') MSE:  tensor(4.4027e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(9.8329e-05, device='cuda:0') mean:  tensor(1.6752e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0028, device='cuda:0') MSE:  tensor(3.4778e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0635, device='cuda:0')
min of d_p_list:  tensor(-0.0767, device='cuda:0')
Epoch:  151  
Training Loss: 0.04289892315864563
Test Loss:  0.04455740004777908
Test Acc:  0.0
Valid Loss:  0.03602663055062294
Valid Acc:  0.0
std:  0.006882953346624247 
thres:  3.063240125775337e-05
Preserved_eigens number check:  512
 15%|█▌        | 151/1000 [45:47<4:07:15, 17.47s/it]Epoch:   152
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  483
Criterion check: 
Mean:  tensor(1.5947, device='cuda:0') 
Std:  tensor(22.9487, device='cuda:0') 
ABS Max:  tensor(402.8870, device='cuda:0') 
ABS Min:  tensor(0.0005, device='cuda:0')
Criterion check:  tensor([1.0001, 1.0000, 1.0000, 1.0000, 0.9999, 1.0000, 0.9997, 1.0002, 0.9965,
        1.0000], device='cuda:0') tensor(157, device='cuda:0')
max of Lambda2 tensor(65286.1523, device='cuda:0')
min of Lambda2 tensor(1.7479e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0941, device='cuda:0')
min of grad d_p:  tensor(-0.0865, device='cuda:0')
max|min: (J_L, Jta/N)  (0.09414660930633545, 0.09414660185575485, ratio: 0.9999999403953552)|(-0.08648887276649475, -0.08648888766765594)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.9605e-08, device='cuda:0') mean:  tensor(1.1952e-11, device='cuda:0') min:  tensor(-1.8626e-08, device='cuda:0') norm:  tensor(5.3031e-07, device='cuda:0') MSE:  tensor(6.6823e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(1.4236e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0025, device='cuda:0') MSE:  tensor(3.1087e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0111, device='cuda:0')
min of d_p_list:  tensor(-0.0096, device='cuda:0')
Epoch:  152  
Training Loss: 0.03235501050949097
Test Loss:  0.0332551971077919
Test Acc:  0.0
Valid Loss:  0.027336936444044113
Valid Acc:  0.0
std:  0.006907991541003221 
thres:  3.076177760958671e-05
Preserved_eigens number check:  512
 15%|█▌        | 152/1000 [46:04<4:06:14, 17.42s/it]Epoch:   153
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  479
Criterion check: 
Mean:  tensor(-3.1343, device='cuda:0') 
Std:  tensor(61.7153, device='cuda:0') 
ABS Max:  tensor(1080.1213, device='cuda:0') 
ABS Min:  tensor(9.9656e-05, device='cuda:0')
Criterion check:  tensor([1.0029, 0.9999, 0.9997, 1.0000, 1.0003, 0.9998, 0.9979, 1.0004, 0.9842,
        1.0174], device='cuda:0') tensor(196, device='cuda:0')
max of Lambda2 tensor(65445.8359, device='cuda:0')
min of Lambda2 tensor(2.6581e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0859, device='cuda:0')
min of grad d_p:  tensor(-0.0785, device='cuda:0')
max|min: (J_L, Jta/N)  (0.08591108024120331, 0.08591105788946152, ratio: 0.9999997615814209)|(-0.07853253185749054, -0.07853251695632935)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.1776e-05, device='cuda:0') mean:  tensor(5.9737e-09, device='cuda:0') min:  tensor(-1.1880e-05, device='cuda:0') norm:  tensor(0.0005, device='cuda:0') MSE:  tensor(6.0734e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(8.4031e-05, device='cuda:0') mean:  tensor(9.5284e-07, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0019, device='cuda:0') MSE:  tensor(2.4091e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0147, device='cuda:0')
min of d_p_list:  tensor(-0.0126, device='cuda:0')
Epoch:  153  
Training Loss: 0.026118792593479156
Test Loss:  0.02661322057247162
Test Acc:  0.0
Valid Loss:  0.022413918748497963
Valid Acc:  0.0
std:  0.007162827520984798 
thres:  2.995346486568451e-05
Preserved_eigens number check:  512
 15%|█▌        | 153/1000 [46:21<4:04:17, 17.31s/it]Epoch:   154
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  477
Criterion check: 
Mean:  tensor(4.8647, device='cuda:0') 
Std:  tensor(83.4514, device='cuda:0') 
ABS Max:  tensor(1552.4419, device='cuda:0') 
ABS Min:  tensor(0.0012, device='cuda:0')
Criterion check:  tensor([1.0002, 1.0000, 1.0003, 1.0001, 0.9998, 0.9999, 0.9996, 0.9992, 0.9940,
        1.0041], device='cuda:0') tensor(185, device='cuda:0')
max of Lambda2 tensor(65561.7422, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0800, device='cuda:0')
min of grad d_p:  tensor(-0.0716, device='cuda:0')
max|min: (J_L, Jta/N)  (0.08003413677215576, 0.08003415167331696, ratio: 1.000000238418579)|(-0.07164672762155533, -0.07164675742387772)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.9605e-08, device='cuda:0') mean:  tensor(1.3733e-12, device='cuda:0') min:  tensor(-5.2154e-08, device='cuda:0') norm:  tensor(4.9819e-07, device='cuda:0') MSE:  tensor(6.2775e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(3.0222e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0053, device='cuda:0') MSE:  tensor(6.6720e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0183, device='cuda:0')
min of d_p_list:  tensor(-0.0213, device='cuda:0')
Epoch:  154  
Training Loss: 0.022411905229091644
Test Loss:  0.02257288619875908
Test Acc:  0.0
Valid Loss:  0.019376156851649284
Valid Acc:  0.0
std:  0.007611213191823454 
thres:  2.9386311024427414e-05
Preserved_eigens number check:  512
 15%|█▌        | 154/1000 [46:39<4:05:22, 17.40s/it]Epoch:   155
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  482
Criterion check: 
Mean:  tensor(-14.3300, device='cuda:0') 
Std:  tensor(889.4759, device='cuda:0') 
ABS Max:  tensor(12827.4199, device='cuda:0') 
ABS Min:  tensor(0.0152, device='cuda:0')
Criterion check:  tensor([0.9736, 1.0032, 1.0088, 0.9991, 1.0017, 1.0022, 0.9634, 1.0119, 1.0937,
        1.0027], device='cuda:0') tensor(254, device='cuda:0')
max of Lambda2 tensor(65314.3086, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0728, device='cuda:0')
min of grad d_p:  tensor(-0.0662, device='cuda:0')
max|min: (J_L, Jta/N)  (0.07283367216587067, 0.07283364236354828, ratio: 0.9999995827674866)|(-0.06624004989862442, -0.06624004989862442)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.2154e-08, device='cuda:0') mean:  tensor(6.8988e-12, device='cuda:0') min:  tensor(-2.9802e-08, device='cuda:0') norm:  tensor(4.3420e-07, device='cuda:0') MSE:  tensor(5.4713e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0054, device='cuda:0') mean:  tensor(8.2045e-05, device='cuda:0') min:  tensor(3.6993e-16, device='cuda:0') norm:  tensor(0.1491, device='cuda:0') MSE:  tensor(1.8787e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0554, device='cuda:0')
min of d_p_list:  tensor(-0.0711, device='cuda:0')
Epoch:  155  
Training Loss: 0.025046564638614655
Test Loss:  0.02651190012693405
Test Acc:  0.0
Valid Loss:  0.02172737568616867
Valid Acc:  0.0
std:  0.007332592279937251 
thres:  2.976623922586441e-05
Preserved_eigens number check:  512
 16%|█▌        | 155/1000 [46:57<4:06:21, 17.49s/it]Epoch:   156
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  481
Criterion check: 
Mean:  tensor(-1.6298, device='cuda:0') 
Std:  tensor(103.4164, device='cuda:0') 
ABS Max:  tensor(1343.8717, device='cuda:0') 
ABS Min:  tensor(0.0038, device='cuda:0')
Criterion check:  tensor([0.9998, 1.0010, 1.0005, 1.0002, 0.9999, 1.0000, 0.9994, 0.9996, 0.9874,
        0.9893], device='cuda:0') tensor(212, device='cuda:0')
max of Lambda2 tensor(67757.1875, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0822, device='cuda:0')
min of grad d_p:  tensor(-0.0577, device='cuda:0')
max|min: (J_L, Jta/N)  (0.0821649506688118, 0.0821649506688118, ratio: 1.0)|(-0.05766287446022034, -0.057662855833768845)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.9802e-08, device='cuda:0') mean:  tensor(-5.8052e-12, device='cuda:0') min:  tensor(-4.0978e-08, device='cuda:0') norm:  tensor(3.7306e-07, device='cuda:0') MSE:  tensor(4.7008e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(5.1401e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0093, device='cuda:0') MSE:  tensor(1.1735e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0329, device='cuda:0')
min of d_p_list:  tensor(-0.0223, device='cuda:0')
Epoch:  156  
Training Loss: 0.02038903906941414
Test Loss:  0.020710192620754242
Test Acc:  0.0
Valid Loss:  0.01794249564409256
Valid Acc:  0.0
std:  0.004073329519512274 
thres:  2.5264262408018113e-05
Preserved_eigens number check:  512
 16%|█▌        | 156/1000 [47:15<4:06:59, 17.56s/it]Epoch:   157
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  482
Criterion check: 
Mean:  tensor(-5.9476, device='cuda:0') 
Std:  tensor(114.9877, device='cuda:0') 
ABS Max:  tensor(2552.3193, device='cuda:0') 
ABS Min:  tensor(0.0008, device='cuda:0')
Criterion check:  tensor([1.0006, 1.0001, 1.0001, 1.0001, 1.0000, 1.0002, 0.9994, 1.0014, 0.9952,
        1.0014], device='cuda:0') tensor(165, device='cuda:0')
max of Lambda2 tensor(68255.2344, device='cuda:0')
min of Lambda2 tensor(2.8590e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0767, device='cuda:0')
min of grad d_p:  tensor(-0.0563, device='cuda:0')
max|min: (J_L, Jta/N)  (0.07666607946157455, 0.07666609436273575, ratio: 1.000000238418579)|(-0.05629012733697891, -0.056290097534656525)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.4901e-08, device='cuda:0') mean:  tensor(-2.0229e-11, device='cuda:0') min:  tensor(-7.4506e-08, device='cuda:0') norm:  tensor(7.6862e-07, device='cuda:0') MSE:  tensor(9.6853e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(6.7947e-05, device='cuda:0') mean:  tensor(1.1238e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0020, device='cuda:0') MSE:  tensor(2.5363e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0537, device='cuda:0')
min of d_p_list:  tensor(-0.0627, device='cuda:0')
Epoch:  157  
Training Loss: 0.02015560492873192
Test Loss:  0.020877646282315254
Test Acc:  0.0
Valid Loss:  0.017588375136256218
Valid Acc:  0.0
std:  0.0024089267390273754 
thres:  2.2824381291866302e-05
Preserved_eigens number check:  512
 16%|█▌        | 157/1000 [47:32<4:04:52, 17.43s/it]Epoch:   158
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  488
Criterion check: 
Mean:  tensor(-0.4765, device='cuda:0') 
Std:  tensor(19.9729, device='cuda:0') 
ABS Max:  tensor(398.4013, device='cuda:0') 
ABS Min:  tensor(9.0348e-05, device='cuda:0')
Criterion check:  tensor([1.0002, 1.0000, 1.0000, 1.0000, 1.0002, 1.0000, 0.9999, 1.0003, 1.0076,
        1.0024], device='cuda:0') tensor(152, device='cuda:0')
max of Lambda2 tensor(68072.5703, device='cuda:0')
min of Lambda2 tensor(2.6722e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0817, device='cuda:0')
min of grad d_p:  tensor(-0.0710, device='cuda:0')
max|min: (J_L, Jta/N)  (0.08165255188941956, 0.08165258169174194, ratio: 1.0000003576278687)|(-0.07098133862018585, -0.07098132371902466)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.9802e-08, device='cuda:0') mean:  tensor(-5.9813e-12, device='cuda:0') min:  tensor(-5.2154e-08, device='cuda:0') norm:  tensor(4.1472e-07, device='cuda:0') MSE:  tensor(5.2258e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(2.5630e-05, device='cuda:0') mean:  tensor(5.6831e-07, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0010, device='cuda:0') MSE:  tensor(1.2613e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0749, device='cuda:0')
min of d_p_list:  tensor(-0.1096, device='cuda:0')
Epoch:  158  
Training Loss: 0.027469966560602188
Test Loss:  0.02828795835375786
Test Acc:  0.0
Valid Loss:  0.026032257825136185
Valid Acc:  0.0
std:  0.0028063436217619715 
thres:  2.309461608529091e-05
Preserved_eigens number check:  512
 16%|█▌        | 158/1000 [47:49<4:04:53, 17.45s/it]Epoch:   159
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  484
Criterion check: 
Mean:  tensor(2.7128, device='cuda:0') 
Std:  tensor(38.7614, device='cuda:0') 
ABS Max:  tensor(678.7794, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([0.9997, 0.9999, 1.0002, 1.0000, 0.9996, 1.0002, 0.9999, 1.0012, 0.9984,
        0.9988], device='cuda:0') tensor(160, device='cuda:0')
max of Lambda2 tensor(69180.5000, device='cuda:0')
min of Lambda2 tensor(1.3339e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0887, device='cuda:0')
min of grad d_p:  tensor(-0.0721, device='cuda:0')
max|min: (J_L, Jta/N)  (0.08869126439094543, 0.08869125694036484, ratio: 0.9999999403953552)|(-0.0720742866396904, -0.0720742717385292)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.7253e-08, device='cuda:0') mean:  tensor(1.5569e-13, device='cuda:0') min:  tensor(-4.4703e-08, device='cuda:0') norm:  tensor(3.5687e-07, device='cuda:0') MSE:  tensor(4.4968e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(1.7205e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0030, device='cuda:0') MSE:  tensor(3.8023e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0331, device='cuda:0')
min of d_p_list:  tensor(-0.0229, device='cuda:0')
Epoch:  159  
Training Loss: 0.022186249494552612
Test Loss:  0.02192693017423153
Test Acc:  0.0
Valid Loss:  0.020795181393623352
Valid Acc:  0.0
std:  0.002818747036004175 
thres:  2.3049484938383102e-05
Preserved_eigens number check:  512
 16%|█▌        | 159/1000 [48:06<4:03:55, 17.40s/it]Epoch:   160
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  481
Criterion check: 
Mean:  tensor(0.1101, device='cuda:0') 
Std:  tensor(58.9225, device='cuda:0') 
ABS Max:  tensor(873.1828, device='cuda:0') 
ABS Min:  tensor(0.0035, device='cuda:0')
Criterion check:  tensor([1.0002, 0.9997, 1.0001, 1.0000, 1.0005, 1.0008, 0.9992, 1.0017, 0.9979,
        1.0068], device='cuda:0') tensor(170, device='cuda:0')
max of Lambda2 tensor(68518.9375, device='cuda:0')
min of Lambda2 tensor(2.8912e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0811, device='cuda:0')
min of grad d_p:  tensor(-0.0650, device='cuda:0')
max|min: (J_L, Jta/N)  (0.08113332837820053, 0.08113332837820053, ratio: 1.0)|(-0.06497427821159363, -0.06497430056333542)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.7253e-08, device='cuda:0') mean:  tensor(4.5364e-12, device='cuda:0') min:  tensor(-4.0978e-08, device='cuda:0') norm:  tensor(4.1499e-07, device='cuda:0') MSE:  tensor(5.2291e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(3.4424e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0058, device='cuda:0') MSE:  tensor(7.3354e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0093, device='cuda:0')
min of d_p_list:  tensor(-0.0105, device='cuda:0')
Epoch:  160  
Training Loss: 0.01872004196047783
Test Loss:  0.01821868121623993
Test Acc:  0.0
Valid Loss:  0.017436876893043518
Valid Acc:  0.0
std:  0.0030488504586277114 
thres:  2.178418040275574e-05
Preserved_eigens number check:  512
 16%|█▌        | 160/1000 [48:24<4:04:11, 17.44s/it]Epoch:   161
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  481
Criterion check: 
Mean:  tensor(-1.2480, device='cuda:0') 
Std:  tensor(29.4633, device='cuda:0') 
ABS Max:  tensor(455.4034, device='cuda:0') 
ABS Min:  tensor(0.0004, device='cuda:0')
Criterion check:  tensor([1.0013, 1.0003, 0.9997, 1.0001, 0.9997, 0.9994, 1.0003, 0.9996, 1.0017,
        0.9846], device='cuda:0') tensor(162, device='cuda:0')
max of Lambda2 tensor(69224.0234, device='cuda:0')
min of Lambda2 tensor(5.6406e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0737, device='cuda:0')
min of grad d_p:  tensor(-0.0592, device='cuda:0')
max|min: (J_L, Jta/N)  (0.07365624606609344, 0.07365626841783524, ratio: 1.0000003576278687)|(-0.059206653386354446, -0.05920664221048355)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.4901e-08, device='cuda:0') mean:  tensor(-1.6056e-11, device='cuda:0') min:  tensor(-5.2154e-08, device='cuda:0') norm:  tensor(5.8305e-07, device='cuda:0') MSE:  tensor(7.3469e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(2.2877e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0041, device='cuda:0') MSE:  tensor(5.1062e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0161, device='cuda:0')
min of d_p_list:  tensor(-0.0309, device='cuda:0')
Epoch:  161  
Training Loss: 0.015515141189098358
Test Loss:  0.014998247846961021
Test Acc:  0.0
Valid Loss:  0.014383329078555107
Valid Acc:  0.0
std:  0.0039769561930752635 
thres:  2.080940082669258e-05
Preserved_eigens number check:  512
 16%|█▌        | 161/1000 [48:42<4:04:54, 17.51s/it]Epoch:   162
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  480
Criterion check: 
Mean:  tensor(3.9589, device='cuda:0') 
Std:  tensor(71.1336, device='cuda:0') 
ABS Max:  tensor(1543.2225, device='cuda:0') 
ABS Min:  tensor(0.0005, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 0.9999, 1.0000, 1.0000, 1.0003, 1.0004, 1.0012, 1.0001,
        0.9975], device='cuda:0') tensor(147, device='cuda:0')
max of Lambda2 tensor(70793.6328, device='cuda:0')
min of Lambda2 tensor(1.3778e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0652, device='cuda:0')
min of grad d_p:  tensor(-0.0537, device='cuda:0')
max|min: (J_L, Jta/N)  (0.06524929404258728, 0.06524927914142609, ratio: 0.9999997615814209)|(-0.05372877046465874, -0.053728774189949036)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.3528e-08, device='cuda:0') mean:  tensor(3.5864e-13, device='cuda:0') min:  tensor(-3.7253e-08, device='cuda:0') norm:  tensor(3.4133e-07, device='cuda:0') MSE:  tensor(4.3010e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(1.3780e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0026, device='cuda:0') MSE:  tensor(3.2563e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0257, device='cuda:0')
min of d_p_list:  tensor(-0.0313, device='cuda:0')
Epoch:  162  
Training Loss: 0.012743443250656128
Test Loss:  0.012051546946167946
Test Acc:  0.0
Valid Loss:  0.012151358649134636
Valid Acc:  0.0
std:  0.005152185889543215 
thres:  1.9326968491077423e-05
Preserved_eigens number check:  512
 16%|█▌        | 162/1000 [48:59<4:03:41, 17.45s/it]Epoch:   163
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  480
Criterion check: 
Mean:  tensor(-89.8866, device='cuda:0') 
Std:  tensor(1122.5732, device='cuda:0') 
ABS Max:  tensor(18270.5684, device='cuda:0') 
ABS Min:  tensor(0.0007, device='cuda:0')
Criterion check:  tensor([1.0059, 0.9950, 0.9895, 0.9986, 1.0103, 1.0048, 1.0047, 1.0185, 1.0659,
        1.2588], device='cuda:0') tensor(259, device='cuda:0')
max of Lambda2 tensor(71466.3594, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0584, device='cuda:0')
min of grad d_p:  tensor(-0.0497, device='cuda:0')
max|min: (J_L, Jta/N)  (0.05838914215564728, 0.05838911980390549, ratio: 0.9999996423721313)|(-0.049737896770238876, -0.049737900495529175)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.8429e-08, device='cuda:0') mean:  tensor(9.5702e-12, device='cuda:0') min:  tensor(-1.4265e-08, device='cuda:0') norm:  tensor(5.2615e-07, device='cuda:0') MSE:  tensor(6.6299e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0025, device='cuda:0') mean:  tensor(5.0482e-05, device='cuda:0') min:  tensor(1.8028e-15, device='cuda:0') norm:  tensor(0.0916, device='cuda:0') MSE:  tensor(1.1539e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0312, device='cuda:0')
min of d_p_list:  tensor(-0.0378, device='cuda:0')
Epoch:  163  
Training Loss: 0.012629261240363121
Test Loss:  0.012353014200925827
Test Acc:  0.0
Valid Loss:  0.011269966140389442
Valid Acc:  0.0
std:  0.0036667875634564247 
thres:  1.6358827427029608e-05
Preserved_eigens number check:  512
 16%|█▋        | 163/1000 [49:16<4:02:40, 17.40s/it]Epoch:   164
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  484
Criterion check: 
Mean:  tensor(-5.9352, device='cuda:0') 
Std:  tensor(160.0660, device='cuda:0') 
ABS Max:  tensor(3602.2744, device='cuda:0') 
ABS Min:  tensor(0.0005, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0000, 1.0001, 0.9999, 0.9996, 0.9999, 0.9964, 0.9996,
        0.9961], device='cuda:0') tensor(179, device='cuda:0')
max of Lambda2 tensor(69232.8906, device='cuda:0')
min of Lambda2 tensor(3.4802e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0518, device='cuda:0')
min of grad d_p:  tensor(-0.0498, device='cuda:0')
max|min: (J_L, Jta/N)  (0.05177503079175949, 0.051775045692920685, ratio: 1.000000238418579)|(-0.049789659678936005, -0.0497896708548069)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.6077e-08, device='cuda:0') mean:  tensor(-1.4617e-11, device='cuda:0') min:  tensor(-8.1956e-08, device='cuda:0') norm:  tensor(9.0882e-07, device='cuda:0') MSE:  tensor(1.1452e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(1.2278e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0023, device='cuda:0') MSE:  tensor(2.8649e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0120, device='cuda:0')
min of d_p_list:  tensor(-0.0133, device='cuda:0')
Epoch:  164  
Training Loss: 0.01148468442261219
Test Loss:  0.011086402460932732
Test Acc:  0.0
Valid Loss:  0.010245606303215027
Valid Acc:  0.0
std:  0.0026122931785791457 
thres:  1.4218514412641525e-05
Preserved_eigens number check:  512
 16%|█▋        | 164/1000 [49:34<4:05:15, 17.60s/it]Epoch:   165
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  481
Criterion check: 
Mean:  tensor(-1.0814, device='cuda:0') 
Std:  tensor(92.7163, device='cuda:0') 
ABS Max:  tensor(1949.0850, device='cuda:0') 
ABS Min:  tensor(0.0004, device='cuda:0')
Criterion check:  tensor([0.9999, 0.9998, 0.9998, 0.9999, 0.9994, 0.9998, 1.0010, 0.9981, 1.0012,
        1.0088], device='cuda:0') tensor(171, device='cuda:0')
max of Lambda2 tensor(69743.7734, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0477, device='cuda:0')
min of grad d_p:  tensor(-0.0457, device='cuda:0')
max|min: (J_L, Jta/N)  (0.0476628839969635, 0.04766291379928589, ratio: 1.0000005960464478)|(-0.045729659497737885, -0.04572965204715729)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.3819e-09, device='cuda:0') mean:  tensor(-1.1512e-11, device='cuda:0') min:  tensor(-4.4703e-08, device='cuda:0') norm:  tensor(4.7278e-07, device='cuda:0') MSE:  tensor(5.9574e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(8.6781e-05, device='cuda:0') mean:  tensor(1.8486e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0034, device='cuda:0') MSE:  tensor(4.2478e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0112, device='cuda:0')
min of d_p_list:  tensor(-0.0166, device='cuda:0')
Epoch:  165  
Training Loss: 0.01005554385483265
Test Loss:  0.009662069380283356
Test Acc:  0.0
Valid Loss:  0.009078874252736568
Valid Acc:  0.0
std:  0.0017984574707767941 
thres:  1.248561479151249e-05
Preserved_eigens number check:  512
 16%|█▋        | 165/1000 [49:52<4:03:13, 17.48s/it]Epoch:   166
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  482
Criterion check: 
Mean:  tensor(0.7353, device='cuda:0') 
Std:  tensor(30.4360, device='cuda:0') 
ABS Max:  tensor(337.6221, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([0.9991, 1.0005, 1.0003, 1.0000, 1.0001, 0.9995, 1.0001, 0.9998, 0.9952,
        1.0010], device='cuda:0') tensor(175, device='cuda:0')
max of Lambda2 tensor(69466.7891, device='cuda:0')
min of Lambda2 tensor(4.1077e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0443, device='cuda:0')
min of grad d_p:  tensor(-0.0431, device='cuda:0')
max|min: (J_L, Jta/N)  (0.044330306351184845, 0.04433029145002365, ratio: 0.9999996423721313)|(-0.04312149062752724, -0.04312148317694664)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.6077e-08, device='cuda:0') mean:  tensor(-5.2625e-12, device='cuda:0') min:  tensor(-2.6077e-08, device='cuda:0') norm:  tensor(2.9312e-07, device='cuda:0') MSE:  tensor(3.6936e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(6.7703e-05, device='cuda:0') mean:  tensor(1.4938e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0024, device='cuda:0') MSE:  tensor(2.9901e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0099, device='cuda:0')
min of d_p_list:  tensor(-0.0107, device='cuda:0')
Epoch:  166  
Training Loss: 0.008399264886975288
Test Loss:  0.008151737973093987
Test Acc:  0.0
Valid Loss:  0.007747283671051264
Valid Acc:  0.0
std:  0.0016471388897225732 
thres:  1.1062439531087875e-05
Preserved_eigens number check:  512
 17%|█▋        | 166/1000 [50:09<4:02:24, 17.44s/it]Epoch:   167
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  479
Criterion check: 
Mean:  tensor(1.4374, device='cuda:0') 
Std:  tensor(89.6268, device='cuda:0') 
ABS Max:  tensor(1213.6803, device='cuda:0') 
ABS Min:  tensor(0.0036, device='cuda:0')
Criterion check:  tensor([0.9999, 0.9997, 0.9995, 0.9999, 0.9996, 1.0008, 0.9981, 0.9993, 0.9344,
        1.0041], device='cuda:0') tensor(196, device='cuda:0')
max of Lambda2 tensor(69609.1250, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0405, device='cuda:0')
min of grad d_p:  tensor(-0.0398, device='cuda:0')
max|min: (J_L, Jta/N)  (0.040500037372112274, 0.04050004482269287, ratio: 1.000000238418579)|(-0.039842888712882996, -0.039842892438173294)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.7940e-08, device='cuda:0') mean:  tensor(-2.4008e-12, device='cuda:0') min:  tensor(-4.6566e-08, device='cuda:0') norm:  tensor(4.9219e-07, device='cuda:0') MSE:  tensor(6.2020e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(3.1910e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0053, device='cuda:0') MSE:  tensor(6.6198e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0273, device='cuda:0')
min of d_p_list:  tensor(-0.0167, device='cuda:0')
Epoch:  167  
Training Loss: 0.0075149619951844215
Test Loss:  0.007322971243411303
Test Acc:  0.0
Valid Loss:  0.007002556696534157
Valid Acc:  0.0
std:  0.001889801721078489 
thres:  1.0016743279993533e-05
Preserved_eigens number check:  512
 17%|█▋        | 167/1000 [50:26<4:00:41, 17.34s/it]Epoch:   168
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  483
Criterion check: 
Mean:  tensor(3.4429, device='cuda:0') 
Std:  tensor(131.6819, device='cuda:0') 
ABS Max:  tensor(1878.0773, device='cuda:0') 
ABS Min:  tensor(0.0018, device='cuda:0')
Criterion check:  tensor([1.0004, 0.9996, 1.0002, 1.0000, 0.9992, 1.0001, 1.0026, 1.0026, 1.0014,
        0.9952], device='cuda:0') tensor(197, device='cuda:0')
max of Lambda2 tensor(70997.9453, device='cuda:0')
min of Lambda2 tensor(3.0501e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0378, device='cuda:0')
min of grad d_p:  tensor(-0.0359, device='cuda:0')
max|min: (J_L, Jta/N)  (0.037791553884744644, 0.03779156878590584, ratio: 1.0000003576278687)|(-0.03587278723716736, -0.035872746258974075)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.2352e-08, device='cuda:0') mean:  tensor(-1.1550e-11, device='cuda:0') min:  tensor(-4.5635e-08, device='cuda:0') norm:  tensor(5.8693e-07, device='cuda:0') MSE:  tensor(7.3957e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(3.6563e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0064, device='cuda:0') MSE:  tensor(8.0254e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0207, device='cuda:0')
min of d_p_list:  tensor(-0.0147, device='cuda:0')
Epoch:  168  
Training Loss: 0.006564992945641279
Test Loss:  0.006236521992832422
Test Acc:  0.0
Valid Loss:  0.006006944924592972
Valid Acc:  0.0
std:  0.0017658433119804046 
thres:  8.803889621049165e-06
Preserved_eigens number check:  512
 17%|█▋        | 168/1000 [50:43<4:00:41, 17.36s/it]Epoch:   169
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  483
Criterion check: 
Mean:  tensor(200.4643, device='cuda:0') 
Std:  tensor(5076.7358, device='cuda:0') 
ABS Max:  tensor(114675.3125, device='cuda:0') 
ABS Min:  tensor(0.0036, device='cuda:0')
Criterion check:  tensor([1.0067, 0.9980, 1.0028, 1.0000, 0.9986, 1.0050, 0.9909, 1.0351, 0.9987,
        1.0175], device='cuda:0') tensor(216, device='cuda:0')
max of Lambda2 tensor(71049.1562, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0347, device='cuda:0')
min of grad d_p:  tensor(-0.0320, device='cuda:0')
max|min: (J_L, Jta/N)  (0.034747302532196045, 0.03474731370806694, ratio: 1.0000003576278687)|(-0.03198566287755966, -0.03198567032814026)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.1176e-08, device='cuda:0') mean:  tensor(-1.0149e-11, device='cuda:0') min:  tensor(-3.9116e-08, device='cuda:0') norm:  tensor(4.3862e-07, device='cuda:0') MSE:  tensor(5.5270e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0010, device='cuda:0') mean:  tensor(2.5281e-05, device='cuda:0') min:  tensor(2.6934e-14, device='cuda:0') norm:  tensor(0.0424, device='cuda:0') MSE:  tensor(5.3469e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0118, device='cuda:0')
min of d_p_list:  tensor(-0.0095, device='cuda:0')
Epoch:  169  
Training Loss: 0.005610856227576733
Test Loss:  0.00536855636164546
Test Acc:  0.0
Valid Loss:  0.00518515519797802
Valid Acc:  0.0
std:  0.0015296694390039744 
thres:  7.629123982042074e-06
Preserved_eigens number check:  512
 17%|█▋        | 169/1000 [51:01<4:00:17, 17.35s/it]Epoch:   170
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  482
Criterion check: 
Mean:  tensor(-0.6030, device='cuda:0') 
Std:  tensor(124.5336, device='cuda:0') 
ABS Max:  tensor(1516.6025, device='cuda:0') 
ABS Min:  tensor(0.0001, device='cuda:0')
Criterion check:  tensor([1.0003, 0.9997, 1.0033, 0.9999, 0.9965, 1.0004, 0.9986, 1.0055, 0.9943,
        1.0020], device='cuda:0') tensor(200, device='cuda:0')
max of Lambda2 tensor(70919.3125, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0319, device='cuda:0')
min of grad d_p:  tensor(-0.0297, device='cuda:0')
max|min: (J_L, Jta/N)  (0.031883396208286285, 0.03188338875770569, ratio: 0.9999997615814209)|(-0.029659884050488472, -0.029659884050488472)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.4901e-08, device='cuda:0') mean:  tensor(-1.5046e-12, device='cuda:0') min:  tensor(-2.4214e-08, device='cuda:0') norm:  tensor(2.3885e-07, device='cuda:0') MSE:  tensor(3.0097e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0006, device='cuda:0') mean:  tensor(6.6658e-06, device='cuda:0') min:  tensor(6.0490e-15, device='cuda:0') norm:  tensor(0.0123, device='cuda:0') MSE:  tensor(1.5453e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0164, device='cuda:0')
min of d_p_list:  tensor(-0.0120, device='cuda:0')
Epoch:  170  
Training Loss: 0.005214908625930548
Test Loss:  0.005005337297916412
Test Acc:  0.0
Valid Loss:  0.004882126115262508
Valid Acc:  0.0
std:  0.0011793231504441625 
thres:  6.660996936261654e-06
Preserved_eigens number check:  512
 17%|█▋        | 170/1000 [51:18<3:59:34, 17.32s/it]Epoch:   171
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  484
Criterion check: 
Mean:  tensor(2.5235, device='cuda:0') 
Std:  tensor(149.1972, device='cuda:0') 
ABS Max:  tensor(2981.6101, device='cuda:0') 
ABS Min:  tensor(0.0063, device='cuda:0')
Criterion check:  tensor([1.0018, 1.0004, 0.9992, 1.0000, 0.9981, 0.9988, 0.9994, 0.9988, 0.8917,
        1.0120], device='cuda:0') tensor(196, device='cuda:0')
max of Lambda2 tensor(69996.4297, device='cuda:0')
min of Lambda2 tensor(5.4933e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0290, device='cuda:0')
min of grad d_p:  tensor(-0.0284, device='cuda:0')
max|min: (J_L, Jta/N)  (0.029033128172159195, 0.029033182188868523, ratio: 1.0000019073486328)|(-0.028432102873921394, -0.028432099148631096)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.7695e-08, device='cuda:0') mean:  tensor(-6.1548e-12, device='cuda:0') min:  tensor(-5.5879e-08, device='cuda:0') norm:  tensor(5.9329e-07, device='cuda:0') MSE:  tensor(7.4759e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(8.7021e-06, device='cuda:0') min:  tensor(8.1705e-16, device='cuda:0') norm:  tensor(0.0153, device='cuda:0') MSE:  tensor(1.9320e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0239, device='cuda:0')
min of d_p_list:  tensor(-0.0261, device='cuda:0')
Epoch:  171  
Training Loss: 0.005626784637570381
Test Loss:  0.005816428456455469
Test Acc:  0.0
Valid Loss:  0.005411633290350437
Valid Acc:  0.0
std:  0.0008324308655360843 
thres:  6.106500886380673e-06
Preserved_eigens number check:  512
 17%|█▋        | 171/1000 [51:35<3:59:59, 17.37s/it]Epoch:   172
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  483
Criterion check: 
Mean:  tensor(0.2648, device='cuda:0') 
Std:  tensor(10.9107, device='cuda:0') 
ABS Max:  tensor(140.2608, device='cuda:0') 
ABS Min:  tensor(5.8832e-05, device='cuda:0')
Criterion check:  tensor([1.0000, 0.9998, 0.9996, 1.0000, 0.9994, 0.9972, 0.9999, 1.0002, 1.0027,
        1.0137], device='cuda:0') tensor(141, device='cuda:0')
max of Lambda2 tensor(70261.6016, device='cuda:0')
min of Lambda2 tensor(1.5897e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0282, device='cuda:0')
min of grad d_p:  tensor(-0.0275, device='cuda:0')
max|min: (J_L, Jta/N)  (0.028175372630357742, 0.02817535400390625, ratio: 0.9999993443489075)|(-0.0275409072637558, -0.0275408998131752)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.9802e-08, device='cuda:0') mean:  tensor(-4.8892e-12, device='cuda:0') min:  tensor(-2.7940e-08, device='cuda:0') norm:  tensor(3.8707e-07, device='cuda:0') MSE:  tensor(4.8773e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(5.9315e-05, device='cuda:0') mean:  tensor(9.4367e-07, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0018, device='cuda:0') MSE:  tensor(2.2397e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0103, device='cuda:0')
min of d_p_list:  tensor(-0.0089, device='cuda:0')
Epoch:  172  
Training Loss: 0.004840637557208538
Test Loss:  0.004848134703934193
Test Acc:  0.0
Valid Loss:  0.004713337402790785
Valid Acc:  0.0
std:  0.0005749696970632175 
thres:  5.571635998785496e-06
Preserved_eigens number check:  512
 17%|█▋        | 172/1000 [51:53<4:00:58, 17.46s/it]Epoch:   173
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  482
Criterion check: 
Mean:  tensor(-2.1847, device='cuda:0') 
Std:  tensor(60.3734, device='cuda:0') 
ABS Max:  tensor(1098.5515, device='cuda:0') 
ABS Min:  tensor(0.0061, device='cuda:0')
Criterion check:  tensor([1.0027, 0.9991, 0.9997, 1.0001, 1.0004, 1.0004, 1.0000, 0.9984, 1.0006,
        1.0428], device='cuda:0') tensor(182, device='cuda:0')
max of Lambda2 tensor(70410.4453, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0261, device='cuda:0')
min of grad d_p:  tensor(-0.0253, device='cuda:0')
max|min: (J_L, Jta/N)  (0.02606496401131153, 0.026064958423376083, ratio: 0.9999997615814209)|(-0.025295134633779526, -0.025295140221714973)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.8626e-08, device='cuda:0') mean:  tensor(-3.5870e-12, device='cuda:0') min:  tensor(-1.8626e-08, device='cuda:0') norm:  tensor(2.1449e-07, device='cuda:0') MSE:  tensor(2.7027e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(3.9953e-06, device='cuda:0') min:  tensor(5.2978e-15, device='cuda:0') norm:  tensor(0.0074, device='cuda:0') MSE:  tensor(9.3292e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0162, device='cuda:0')
min of d_p_list:  tensor(-0.0267, device='cuda:0')
Epoch:  173  
Training Loss: 0.004497614689171314
Test Loss:  0.004173954017460346
Test Acc:  0.0
Valid Loss:  0.00417028833180666
Valid Acc:  0.0
std:  0.0004392957867493381 
thres:  5.158160347491503e-06
Preserved_eigens number check:  512
 17%|█▋        | 173/1000 [52:10<3:59:27, 17.37s/it]Epoch:   174
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  479
Criterion check: 
Mean:  tensor(6.4699, device='cuda:0') 
Std:  tensor(101.2670, device='cuda:0') 
ABS Max:  tensor(1772.3542, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([1.0000, 0.9998, 0.9992, 1.0002, 0.9980, 0.9998, 1.0000, 1.0001, 1.0049,
        0.9966], device='cuda:0') tensor(161, device='cuda:0')
max of Lambda2 tensor(70545.6719, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0266, device='cuda:0')
min of grad d_p:  tensor(-0.0242, device='cuda:0')
max|min: (J_L, Jta/N)  (0.026646383106708527, 0.02664637565612793, ratio: 0.9999997019767761)|(-0.02421288937330246, -0.02421288937330246)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.6077e-08, device='cuda:0') mean:  tensor(-7.0520e-12, device='cuda:0') min:  tensor(-5.2154e-08, device='cuda:0') norm:  tensor(6.2821e-07, device='cuda:0') MSE:  tensor(7.9160e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(8.5294e-05, device='cuda:0') mean:  tensor(1.5338e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0029, device='cuda:0') MSE:  tensor(3.5964e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(6.0517, device='cuda:0')
min of d_p_list:  tensor(-2.9388, device='cuda:0')
Epoch:  174  
Training Loss: 13363.0302734375
Test Loss:  14638.130859375
Test Acc:  0.0
Valid Loss:  15151.4267578125
Valid Acc:  0.0
std:  5345.210091380462 
thres:  2.672610090676602
Preserved_eigens number check:  512
 17%|█▋        | 174/1000 [52:28<3:59:01, 17.36s/it]Epoch:   175
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  502
Criterion check: 
Mean:  tensor(5.3359, device='cuda:0') 
Std:  tensor(82.8006, device='cuda:0') 
ABS Max:  tensor(1389.6467, device='cuda:0') 
ABS Min:  tensor(0.0034, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0001, 1.0000, 1.0000, 1.0001, 0.9999, 0.9998, 0.9995, 1.0001,
        1.0004], device='cuda:0') tensor(229, device='cuda:0')
max of Lambda2 tensor(161447.6719, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.3543, device='cuda:0')
min of grad d_p:  tensor(-0.7130, device='cuda:0')
max|min: (J_L, Jta/N)  (1.35427725315094, 1.3542771339416504, ratio: 0.9999999403953552)|(-0.7130447626113892, -0.7130449414253235)

 check Jacobi res:  torch.Size([793601]) max:  tensor(6.5565e-07, device='cuda:0') mean:  tensor(-1.4276e-10, device='cuda:0') min:  tensor(-4.7684e-07, device='cuda:0') norm:  tensor(7.6039e-06, device='cuda:0') MSE:  tensor(9.5816e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0018, device='cuda:0') mean:  tensor(1.7877e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0354, device='cuda:0') MSE:  tensor(4.4668e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0454, device='cuda:0')
min of d_p_list:  tensor(-0.0494, device='cuda:0')
Epoch:  175  
Training Loss: 42.28937530517578
Test Loss:  47.68757629394531
Test Acc:  0.0
Valid Loss:  51.666587829589844
Valid Acc:  0.0
std:  5341.006782595709 
thres:  2.681066922755912
Preserved_eigens number check:  512
 18%|█▊        | 175/1000 [52:45<4:00:46, 17.51s/it]Epoch:   176
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  504
Criterion check: 
Mean:  tensor(1.1279, device='cuda:0') 
Std:  tensor(111.4877, device='cuda:0') 
ABS Max:  tensor(1434.6167, device='cuda:0') 
ABS Min:  tensor(0.0032, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0001, 1.0000, 1.0000, 1.0000, 1.0004,
        1.0012], device='cuda:0') tensor(200, device='cuda:0')
max of Lambda2 tensor(163585.1094, device='cuda:0')
min of Lambda2 tensor(7.8369e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.2290, device='cuda:0')
min of grad d_p:  tensor(-0.6871, device='cuda:0')
max|min: (J_L, Jta/N)  (1.228982925415039, 1.2289828062057495, ratio: 0.9999998807907104)|(-0.687134861946106, -0.6871349215507507)

 check Jacobi res:  torch.Size([793601]) max:  tensor(7.1526e-07, device='cuda:0') mean:  tensor(-4.0420e-11, device='cuda:0') min:  tensor(-5.9605e-07, device='cuda:0') norm:  tensor(7.1019e-06, device='cuda:0') MSE:  tensor(8.9490e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(5.6311e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0110, device='cuda:0') MSE:  tensor(1.3900e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0195, device='cuda:0')
min of d_p_list:  tensor(-0.0135, device='cuda:0')
Epoch:  176  
Training Loss: 10.652050018310547
Test Loss:  12.172203063964844
Test Acc:  0.0
Valid Loss:  13.084317207336426
Valid Acc:  0.0
std:  5339.939522301434 
thres:  2.6831962074026463
Preserved_eigens number check:  512
 18%|█▊        | 176/1000 [53:04<4:02:39, 17.67s/it]Epoch:   177
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  503
Criterion check: 
Mean:  tensor(-3.8354, device='cuda:0') 
Std:  tensor(75.7613, device='cuda:0') 
ABS Max:  tensor(1268.1046, device='cuda:0') 
ABS Min:  tensor(0.0013, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 0.9999, 1.0002, 1.0004, 1.0015,
        1.0021], device='cuda:0') tensor(198, device='cuda:0')
max of Lambda2 tensor(159809.4219, device='cuda:0')
min of Lambda2 tensor(1.9128e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.1141, device='cuda:0')
min of grad d_p:  tensor(-0.5965, device='cuda:0')
max|min: (J_L, Jta/N)  (1.1140652894973755, 1.114065408706665, ratio: 1.0000001192092896)|(-0.5964745283126831, -0.596474289894104)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.5763e-07, device='cuda:0') mean:  tensor(-1.0951e-10, device='cuda:0') min:  tensor(-5.9605e-07, device='cuda:0') norm:  tensor(6.9515e-06, device='cuda:0') MSE:  tensor(8.7594e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0006, device='cuda:0') mean:  tensor(5.3016e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0107, device='cuda:0') MSE:  tensor(1.3491e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.4029, device='cuda:0')
min of d_p_list:  tensor(-0.2187, device='cuda:0')
Epoch:  177  
Training Loss: 4.51535701751709
Test Loss:  5.142681121826172
Test Acc:  0.0
Valid Loss:  5.306130409240723
Valid Acc:  0.0
std:  5339.486522649346 
thres:  2.6840983106786385
Preserved_eigens number check:  512
 18%|█▊        | 177/1000 [53:21<4:03:00, 17.72s/it]Epoch:   178
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  503
Criterion check: 
Mean:  tensor(-50.9432, device='cuda:0') 
Std:  tensor(2269.6760, device='cuda:0') 
ABS Max:  tensor(39192.6172, device='cuda:0') 
ABS Min:  tensor(0.0233, device='cuda:0')
Criterion check:  tensor([1.0026, 0.9910, 0.9471, 1.0153, 1.0101, 1.0507, 0.9925, 0.9309, 0.8222,
        3.0319], device='cuda:0') tensor(258, device='cuda:0')
max of Lambda2 tensor(287279.2500, device='cuda:0')
min of Lambda2 tensor(1.0738e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.0386, device='cuda:0')
min of grad d_p:  tensor(-1.1821, device='cuda:0')
max|min: (J_L, Jta/N)  (1.038572072982788, 1.0385719537734985, ratio: 0.9999998807907104)|(-1.1820687055587769, -1.1820690631866455)

 check Jacobi res:  torch.Size([793601]) max:  tensor(7.1526e-07, device='cuda:0') mean:  tensor(1.3219e-11, device='cuda:0') min:  tensor(-4.7684e-07, device='cuda:0') norm:  tensor(6.5396e-06, device='cuda:0') MSE:  tensor(8.2404e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0166, device='cuda:0') mean:  tensor(0.0003, device='cuda:0') min:  tensor(8.0436e-13, device='cuda:0') norm:  tensor(0.5695, device='cuda:0') MSE:  tensor(7.1764e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0257, device='cuda:0')
min of d_p_list:  tensor(-0.0263, device='cuda:0')
Epoch:  178  
Training Loss: 2.2087206840515137
Test Loss:  2.5246353149414062
Test Acc:  0.0
Valid Loss:  2.505455732345581
Valid Acc:  0.0
std:  5339.26498371533 
thres:  2.6845391552925113
Preserved_eigens number check:  512
 18%|█▊        | 178/1000 [53:38<4:00:19, 17.54s/it]Epoch:   179
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  504
Criterion check: 
Mean:  tensor(206.0662, device='cuda:0') 
Std:  tensor(4679.8237, device='cuda:0') 
ABS Max:  tensor(105889.3984, device='cuda:0') 
ABS Min:  tensor(0.0014, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0008, 0.9998, 0.9999, 0.9985, 1.0002, 0.9997, 1.0023,
        0.9796], device='cuda:0') tensor(179, device='cuda:0')
max of Lambda2 tensor(274743.7188, device='cuda:0')
min of Lambda2 tensor(5.5825e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.9391, device='cuda:0')
min of grad d_p:  tensor(-1.0657, device='cuda:0')
max|min: (J_L, Jta/N)  (0.9391406774520874, 0.9391404390335083, ratio: 0.9999997615814209)|(-1.0656986236572266, -1.065698504447937)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.3644e-07, device='cuda:0') mean:  tensor(-2.6733e-11, device='cuda:0') min:  tensor(-6.5565e-07, device='cuda:0') norm:  tensor(5.9395e-06, device='cuda:0') MSE:  tensor(7.4842e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(6.9597e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0138, device='cuda:0') MSE:  tensor(1.7332e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0390, device='cuda:0')
min of d_p_list:  tensor(-0.0406, device='cuda:0')
Epoch:  179  
Training Loss: 1.2973434925079346
Test Loss:  1.4765568971633911
Test Acc:  0.0
Valid Loss:  1.421907901763916
Valid Acc:  0.0
std:  15.398140786362267 
thres:  0.012192569303512575
Preserved_eigens number check:  512
 18%|█▊        | 179/1000 [53:56<4:00:07, 17.55s/it]Epoch:   180
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  504
Criterion check: 
Mean:  tensor(56.2325, device='cuda:0') 
Std:  tensor(1152.4961, device='cuda:0') 
ABS Max:  tensor(25878.2090, device='cuda:0') 
ABS Min:  tensor(0.0016, device='cuda:0')
Criterion check:  tensor([1.0003, 0.9999, 1.0008, 0.9997, 0.9997, 1.0036, 1.0007, 1.0020, 1.0017,
        0.9970], device='cuda:0') tensor(236, device='cuda:0')
max of Lambda2 tensor(281214.5000, device='cuda:0')
min of Lambda2 tensor(2.6969e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.8609, device='cuda:0')
min of grad d_p:  tensor(-0.9351, device='cuda:0')
max|min: (J_L, Jta/N)  (0.860897421836853, 0.8608973026275635, ratio: 0.9999998807907104)|(-0.9350938200950623, -0.9350938200950623)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.9605e-07, device='cuda:0') mean:  tensor(1.0190e-11, device='cuda:0') min:  tensor(-5.3644e-07, device='cuda:0') norm:  tensor(5.1621e-06, device='cuda:0') MSE:  tensor(6.5046e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0017, device='cuda:0') mean:  tensor(2.1979e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0436, device='cuda:0') MSE:  tensor(5.4884e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0227, device='cuda:0')
min of d_p_list:  tensor(-0.0240, device='cuda:0')
Epoch:  180  
Training Loss: 0.8403010368347168
Test Loss:  0.9418628811836243
Test Acc:  0.0
Valid Loss:  0.8802857398986816
Valid Acc:  0.0
std:  3.6045751522071483 
thres:  0.00390275444984436
Preserved_eigens number check:  512
 18%|█▊        | 180/1000 [54:13<3:58:43, 17.47s/it]Epoch:   181
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  503
Criterion check: 
Mean:  tensor(1.3557, device='cuda:0') 
Std:  tensor(31.6935, device='cuda:0') 
ABS Max:  tensor(609.8436, device='cuda:0') 
ABS Min:  tensor(0.0007, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0001, 1.0000, 1.0002, 1.0003, 1.0000, 1.0001, 1.0002,
        0.9965], device='cuda:0') tensor(179, device='cuda:0')
max of Lambda2 tensor(271950.1562, device='cuda:0')
min of Lambda2 tensor(1.1953e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.7856, device='cuda:0')
min of grad d_p:  tensor(-0.7887, device='cuda:0')
max|min: (J_L, Jta/N)  (0.7856054306030273, 0.7856054306030273, ratio: 1.0)|(-0.7886871099472046, -0.7886868119239807)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.7684e-07, device='cuda:0') mean:  tensor(4.3423e-11, device='cuda:0') min:  tensor(-7.1526e-07, device='cuda:0') norm:  tensor(6.0683e-06, device='cuda:0') MSE:  tensor(7.6465e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(3.1155e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0063, device='cuda:0') MSE:  tensor(7.9301e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0297, device='cuda:0')
min of d_p_list:  tensor(-0.0342, device='cuda:0')
Epoch:  181  
Training Loss: 0.566820502281189
Test Loss:  0.6289486885070801
Test Acc:  0.0
Valid Loss:  0.5768231153488159
Valid Acc:  0.0
std:  1.4281389213472961 
thres:  0.0018857085466384889
Preserved_eigens number check:  512
 18%|█▊        | 181/1000 [54:31<3:58:45, 17.49s/it]Epoch:   182
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  504
Criterion check: 
Mean:  tensor(-25.5017, device='cuda:0') 
Std:  tensor(698.6924, device='cuda:0') 
ABS Max:  tensor(12694.3633, device='cuda:0') 
ABS Min:  tensor(0.0445, device='cuda:0')
Criterion check:  tensor([1.0049, 1.0002, 0.9949, 1.0046, 1.0055, 0.9976, 0.9987, 1.0041, 1.0775,
        1.1329], device='cuda:0') tensor(239, device='cuda:0')
max of Lambda2 tensor(254887.0781, device='cuda:0')
min of Lambda2 tensor(1.3476e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.6838, device='cuda:0')
min of grad d_p:  tensor(-0.6317, device='cuda:0')
max|min: (J_L, Jta/N)  (0.6838167905807495, 0.6838167905807495, ratio: 1.0)|(-0.6316708326339722, -0.6316707730293274)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.5763e-07, device='cuda:0') mean:  tensor(-1.0873e-11, device='cuda:0') min:  tensor(-4.7684e-07, device='cuda:0') norm:  tensor(4.8831e-06, device='cuda:0') MSE:  tensor(6.1531e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0095, device='cuda:0') mean:  tensor(9.3030e-05, device='cuda:0') min:  tensor(4.0495e-14, device='cuda:0') norm:  tensor(0.1880, device='cuda:0') MSE:  tensor(2.3688e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0188, device='cuda:0')
min of d_p_list:  tensor(-0.0176, device='cuda:0')
Epoch:  182  
Training Loss: 0.40728437900543213
Test Loss:  0.447323203086853
Test Acc:  0.0
Valid Loss:  0.4004950225353241
Valid Acc:  0.0
std:  0.6470453881645085 
thres:  0.0010640940189361571
Preserved_eigens number check:  512
 18%|█▊        | 182/1000 [54:48<3:57:43, 17.44s/it]Epoch:   183
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  504
Criterion check: 
Mean:  tensor(0.0260, device='cuda:0') 
Std:  tensor(22.2089, device='cuda:0') 
ABS Max:  tensor(298.0075, device='cuda:0') 
ABS Min:  tensor(0.0010, device='cuda:0')
Criterion check:  tensor([1.0000, 0.9998, 0.9999, 1.0000, 1.0001, 1.0000, 0.9999, 0.9998, 0.9987,
        1.0009], device='cuda:0') tensor(190, device='cuda:0')
max of Lambda2 tensor(253931.2656, device='cuda:0')
min of Lambda2 tensor(4.1487e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.6197, device='cuda:0')
min of grad d_p:  tensor(-0.5787, device='cuda:0')
max|min: (J_L, Jta/N)  (0.6197249293327332, 0.6197249889373779, ratio: 1.0000001192092896)|(-0.5787258148193359, -0.5787262320518494)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.1723e-07, device='cuda:0') mean:  tensor(-2.1264e-11, device='cuda:0') min:  tensor(-4.7684e-07, device='cuda:0') norm:  tensor(3.9847e-06, device='cuda:0') MSE:  tensor(5.0210e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(4.4749e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0086, device='cuda:0') MSE:  tensor(1.0785e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0772, device='cuda:0')
min of d_p_list:  tensor(-0.0889, device='cuda:0')
Epoch:  183  
Training Loss: 0.2826343774795532
Test Loss:  0.30752110481262207
Test Acc:  0.0
Valid Loss:  0.2674507796764374
Valid Acc:  0.0
std:  0.36107781665019956 
thres:  0.0006788767576217652
Preserved_eigens number check:  512
 18%|█▊        | 183/1000 [55:06<3:58:11, 17.49s/it]Epoch:   184
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  503
Criterion check: 
Mean:  tensor(22.0386, device='cuda:0') 
Std:  tensor(366.9637, device='cuda:0') 
ABS Max:  tensor(6965.4082, device='cuda:0') 
ABS Min:  tensor(0.0150, device='cuda:0')
Criterion check:  tensor([0.9999, 0.9999, 0.9988, 1.0001, 0.9982, 1.0010, 0.9899, 0.9998, 0.9999,
        1.0033], device='cuda:0') tensor(256, device='cuda:0')
max of Lambda2 tensor(294855.3438, device='cuda:0')
min of Lambda2 tensor(1.3561e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.5592, device='cuda:0')
min of grad d_p:  tensor(-0.4685, device='cuda:0')
max|min: (J_L, Jta/N)  (0.5591558218002319, 0.5591558814048767, ratio: 1.0000001192092896)|(-0.4685133099555969, -0.46851325035095215)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.2783e-07, device='cuda:0') mean:  tensor(1.0655e-11, device='cuda:0') min:  tensor(-2.6822e-07, device='cuda:0') norm:  tensor(3.6539e-06, device='cuda:0') MSE:  tensor(4.6042e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0024, device='cuda:0') mean:  tensor(2.8057e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0551, device='cuda:0') MSE:  tensor(6.9481e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0679, device='cuda:0')
min of d_p_list:  tensor(-0.0751, device='cuda:0')
Epoch:  184  
Training Loss: 0.22782346606254578
Test Loss:  0.24664707481861115
Test Acc:  0.0
Valid Loss:  0.21449004113674164
Valid Acc:  0.0
std:  0.22093406285879652 
thres:  0.0004649727523326874
Preserved_eigens number check:  512
 18%|█▊        | 184/1000 [55:23<3:58:28, 17.53s/it]Epoch:   185
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  505
Criterion check: 
Mean:  tensor(6.8865, device='cuda:0') 
Std:  tensor(228.9704, device='cuda:0') 
ABS Max:  tensor(3020.2190, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([1.0001, 0.9998, 0.9989, 1.0004, 1.0005, 0.9992, 1.0010, 0.9996, 0.9994,
        0.9983], device='cuda:0') tensor(216, device='cuda:0')
max of Lambda2 tensor(269038.9062, device='cuda:0')
min of Lambda2 tensor(9.8468e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.4975, device='cuda:0')
min of grad d_p:  tensor(-0.4071, device='cuda:0')
max|min: (J_L, Jta/N)  (0.49750277400016785, 0.49750247597694397, ratio: 0.9999994039535522)|(-0.4070985019207001, -0.4070982336997986)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(7.5985e-09, device='cuda:0') min:  tensor(-3.1121e-05, device='cuda:0') norm:  tensor(0.0012, device='cuda:0') MSE:  tensor(1.5541e-09, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0016, device='cuda:0') mean:  tensor(1.3441e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0278, device='cuda:0') MSE:  tensor(3.5038e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0515, device='cuda:0')
min of d_p_list:  tensor(-0.0576, device='cuda:0')
Epoch:  185  
Training Loss: 0.16321402788162231
Test Loss:  0.17466604709625244
Test Acc:  0.0
Valid Loss:  0.1514713168144226
Valid Acc:  0.0
std:  0.14321797635280367 
thres:  0.0003295553505420685
Preserved_eigens number check:  512
 18%|█▊        | 185/1000 [55:41<3:58:42, 17.57s/it]Epoch:   186
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  504
Criterion check: 
Mean:  tensor(-2.3635, device='cuda:0') 
Std:  tensor(67.4287, device='cuda:0') 
ABS Max:  tensor(1446.2618, device='cuda:0') 
ABS Min:  tensor(0.0014, device='cuda:0')
Criterion check:  tensor([1.0001, 1.0000, 0.9993, 1.0011, 0.9989, 0.9995, 1.0003, 0.9996, 0.9998,
        0.9996], device='cuda:0') tensor(192, device='cuda:0')
max of Lambda2 tensor(310693.9062, device='cuda:0')
min of Lambda2 tensor(7.4844e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.5162, device='cuda:0')
min of grad d_p:  tensor(-0.3995, device='cuda:0')
max|min: (J_L, Jta/N)  (0.5162014365196228, 0.516201376914978, ratio: 0.9999998807907104)|(-0.39949044585227966, -0.3994905948638916)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.2783e-07, device='cuda:0') mean:  tensor(-6.3225e-13, device='cuda:0') min:  tensor(-4.4703e-07, device='cuda:0') norm:  tensor(4.8732e-06, device='cuda:0') MSE:  tensor(6.1406e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0008, device='cuda:0') mean:  tensor(9.1462e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0181, device='cuda:0') MSE:  tensor(2.2811e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0533, device='cuda:0')
min of d_p_list:  tensor(-0.0262, device='cuda:0')
Epoch:  186  
Training Loss: 0.1395687460899353
Test Loss:  0.14876709878444672
Test Acc:  0.0
Valid Loss:  0.1263633668422699
Valid Acc:  0.0
std:  0.09575832993606614 
thres:  0.00024410499930381773
Preserved_eigens number check:  512
 19%|█▊        | 186/1000 [55:58<3:57:06, 17.48s/it]Epoch:   187
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  504
Criterion check: 
Mean:  tensor(-1.0756, device='cuda:0') 
Std:  tensor(58.1749, device='cuda:0') 
ABS Max:  tensor(739.4868, device='cuda:0') 
ABS Min:  tensor(2.3895e-05, device='cuda:0')
Criterion check:  tensor([1.0001, 1.0002, 0.9997, 1.0003, 1.0005, 1.0002, 0.9998, 1.0002, 1.0001,
        1.0005], device='cuda:0') tensor(179, device='cuda:0')
max of Lambda2 tensor(311706.0938, device='cuda:0')
min of Lambda2 tensor(1.6817e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.4660, device='cuda:0')
min of grad d_p:  tensor(-0.3417, device='cuda:0')
max|min: (J_L, Jta/N)  (0.46604740619659424, 0.46604737639427185, ratio: 0.9999999403953552)|(-0.3416751027107239, -0.3416750431060791)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.2783e-07, device='cuda:0') mean:  tensor(3.7142e-11, device='cuda:0') min:  tensor(-2.6822e-07, device='cuda:0') norm:  tensor(3.5760e-06, device='cuda:0') MSE:  tensor(4.5060e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(4.0068e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0077, device='cuda:0') MSE:  tensor(9.7493e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0367, device='cuda:0')
min of d_p_list:  tensor(-0.0286, device='cuda:0')
Epoch:  187  
Training Loss: 0.11364147067070007
Test Loss:  0.12098753452301025
Test Acc:  0.0
Valid Loss:  0.10300195962190628
Valid Acc:  0.0
std:  0.06163810441807441 
thres:  0.00018537641763687136
Preserved_eigens number check:  512
 19%|█▊        | 187/1000 [56:16<3:58:52, 17.63s/it]Epoch:   188
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  505
Criterion check: 
Mean:  tensor(-12.4789, device='cuda:0') 
Std:  tensor(318.1655, device='cuda:0') 
ABS Max:  tensor(7092.3545, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([0.9998, 1.0001, 1.0003, 0.9984, 1.0000, 1.0000, 1.0030, 0.9999, 0.9998,
        0.9966], device='cuda:0') tensor(175, device='cuda:0')
max of Lambda2 tensor(247897.3906, device='cuda:0')
min of Lambda2 tensor(3.1083e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3357, device='cuda:0')
min of grad d_p:  tensor(-0.2963, device='cuda:0')
max|min: (J_L, Jta/N)  (0.3357207477092743, 0.33572086691856384, ratio: 1.0000003576278687)|(-0.2963458299636841, -0.2963458299636841)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.9802e-07, device='cuda:0') mean:  tensor(8.3325e-12, device='cuda:0') min:  tensor(-2.2352e-07, device='cuda:0') norm:  tensor(3.0357e-06, device='cuda:0') MSE:  tensor(3.8252e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(7.2499e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0148, device='cuda:0') MSE:  tensor(1.8649e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.2511, device='cuda:0')
min of d_p_list:  tensor(-0.4890, device='cuda:0')
Epoch:  188  
Training Loss: 0.7169756293296814
Test Loss:  0.8568090200424194
Test Acc:  0.0
Valid Loss:  0.8544385433197021
Valid Acc:  0.0
std:  0.22556791708448978 
thres:  0.00027224466800689697
Preserved_eigens number check:  512
 19%|█▉        | 188/1000 [56:34<3:56:53, 17.50s/it]Epoch:   189
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  501
Criterion check: 
Mean:  tensor(4.2800, device='cuda:0') 
Std:  tensor(43.8885, device='cuda:0') 
ABS Max:  tensor(417.9534, device='cuda:0') 
ABS Min:  tensor(0.0013, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0002, 1.0005, 1.0000, 0.9995, 1.0003, 1.0002, 1.0030, 1.0005,
        0.9997], device='cuda:0') tensor(216, device='cuda:0')
max of Lambda2 tensor(136965.0625, device='cuda:0')
min of Lambda2 tensor(5.1949e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.4675, device='cuda:0')
min of grad d_p:  tensor(-0.7451, device='cuda:0')
max|min: (J_L, Jta/N)  (0.46745505928993225, 0.46745505928993225, ratio: 1.0)|(-0.7451032996177673, -0.7451031804084778)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.7684e-07, device='cuda:0') mean:  tensor(-1.3490e-11, device='cuda:0') min:  tensor(-4.7684e-07, device='cuda:0') norm:  tensor(3.9575e-06, device='cuda:0') MSE:  tensor(4.9868e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0008, device='cuda:0') mean:  tensor(7.2551e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0148, device='cuda:0') MSE:  tensor(1.8590e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0632, device='cuda:0')
min of d_p_list:  tensor(-0.0639, device='cuda:0')
Epoch:  189  
Training Loss: 0.5331913232803345
Test Loss:  0.6216692924499512
Test Acc:  0.0
Valid Loss:  0.6137534976005554
Valid Acc:  0.0
std:  0.2457130172217308 
thres:  0.00033331823945045467
Preserved_eigens number check:  512
 19%|█▉        | 189/1000 [56:51<3:56:38, 17.51s/it]Epoch:   190
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  505
Criterion check: 
Mean:  tensor(-0.9138, device='cuda:0') 
Std:  tensor(36.7837, device='cuda:0') 
ABS Max:  tensor(439.3766, device='cuda:0') 
ABS Min:  tensor(0.0022, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 0.9995, 1.0000, 0.9997, 0.9998, 1.0000, 1.0079, 1.0015,
        1.0005], device='cuda:0') tensor(198, device='cuda:0')
max of Lambda2 tensor(146568.3750, device='cuda:0')
min of Lambda2 tensor(5.9787e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.4273, device='cuda:0')
min of grad d_p:  tensor(-0.6731, device='cuda:0')
max|min: (J_L, Jta/N)  (0.4272502064704895, 0.4272499680519104, ratio: 0.999999463558197)|(-0.673094630241394, -0.6730944514274597)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.6822e-07, device='cuda:0') mean:  tensor(-1.5292e-12, device='cuda:0') min:  tensor(-3.5763e-07, device='cuda:0') norm:  tensor(4.4999e-06, device='cuda:0') MSE:  tensor(5.6703e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0007, device='cuda:0') mean:  tensor(1.2662e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0248, device='cuda:0') MSE:  tensor(3.1289e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.2044, device='cuda:0')
min of d_p_list:  tensor(-0.1753, device='cuda:0')
Epoch:  190  
Training Loss: 0.581611156463623
Test Loss:  0.670386552810669
Test Acc:  0.0
Valid Loss:  0.6648744940757751
Valid Acc:  0.0
std:  0.24477627849338432 
thres:  0.00041699766516685487
Preserved_eigens number check:  512
 19%|█▉        | 190/1000 [57:09<3:57:11, 17.57s/it]Epoch:   191
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  502
Criterion check: 
Mean:  tensor(-0.0552, device='cuda:0') 
Std:  tensor(30.4926, device='cuda:0') 
ABS Max:  tensor(571.2911, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0005, 1.0001, 1.0000, 1.0001, 1.0000, 1.0001, 0.9989, 1.0003,
        0.9991], device='cuda:0') tensor(192, device='cuda:0')
max of Lambda2 tensor(145876.5312, device='cuda:0')
min of Lambda2 tensor(4.9904e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3866, device='cuda:0')
min of grad d_p:  tensor(-0.6047, device='cuda:0')
max|min: (J_L, Jta/N)  (0.3865891098976135, 0.3865891396999359, ratio: 1.0000001192092896)|(-0.604651689529419, -0.604651927947998)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.5763e-07, device='cuda:0') mean:  tensor(1.3422e-11, device='cuda:0') min:  tensor(-2.3842e-07, device='cuda:0') norm:  tensor(3.6058e-06, device='cuda:0') MSE:  tensor(4.5436e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(4.3387e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0090, device='cuda:0') MSE:  tensor(1.1391e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.3003, device='cuda:0')
min of d_p_list:  tensor(-0.2805, device='cuda:0')
Epoch:  191  
Training Loss: 0.57065749168396
Test Loss:  0.6220477223396301
Test Acc:  0.0
Valid Loss:  0.5764132738113403
Valid Acc:  0.0
std:  0.20447697591409514 
thres:  0.0005032154142856597
Preserved_eigens number check:  512
 19%|█▉        | 191/1000 [57:26<3:57:30, 17.61s/it]Epoch:   192
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  503
Criterion check: 
Mean:  tensor(20.4098, device='cuda:0') 
Std:  tensor(361.4546, device='cuda:0') 
ABS Max:  tensor(7952.2383, device='cuda:0') 
ABS Min:  tensor(0.0012, device='cuda:0')
Criterion check:  tensor([0.9996, 1.0005, 0.9936, 0.9999, 0.9999, 1.0001, 1.0020, 0.9999, 0.9998,
        1.0087], device='cuda:0') tensor(201, device='cuda:0')
max of Lambda2 tensor(210337.8125, device='cuda:0')
min of Lambda2 tensor(1.0628e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3435, device='cuda:0')
min of grad d_p:  tensor(-0.4655, device='cuda:0')
max|min: (J_L, Jta/N)  (0.3434666097164154, 0.3434666395187378, ratio: 1.0000001192092896)|(-0.46548330783843994, -0.4654832184314728)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.6822e-07, device='cuda:0') mean:  tensor(4.0500e-13, device='cuda:0') min:  tensor(-2.6822e-07, device='cuda:0') norm:  tensor(2.4665e-06, device='cuda:0') MSE:  tensor(3.1079e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(5.6357e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0104, device='cuda:0') MSE:  tensor(1.3128e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0170, device='cuda:0')
min of d_p_list:  tensor(-0.0164, device='cuda:0')
Epoch:  192  
Training Loss: 0.3634093999862671
Test Loss:  0.3812987208366394
Test Acc:  0.0
Valid Loss:  0.3618924915790558
Valid Acc:  0.0
std:  0.113450631362298 
thres:  0.0005531690001487733
Preserved_eigens number check:  512
 19%|█▉        | 192/1000 [57:44<3:55:04, 17.46s/it]Epoch:   193
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  505
Criterion check: 
Mean:  tensor(-0.7092, device='cuda:0') 
Std:  tensor(24.0659, device='cuda:0') 
ABS Max:  tensor(335.0965, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([1.0001, 0.9993, 1.0013, 0.9999, 1.0001, 1.0002, 0.9984, 0.9999, 0.9997,
        1.0054], device='cuda:0') tensor(185, device='cuda:0')
max of Lambda2 tensor(219348.5156, device='cuda:0')
min of Lambda2 tensor(5.0815e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3312, device='cuda:0')
min of grad d_p:  tensor(-0.4668, device='cuda:0')
max|min: (J_L, Jta/N)  (0.3311697840690613, 0.33116966485977173, ratio: 0.9999996423721313)|(-0.46681228280067444, -0.4668121635913849)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.3842e-07, device='cuda:0') mean:  tensor(-2.0313e-11, device='cuda:0') min:  tensor(-2.6822e-07, device='cuda:0') norm:  tensor(2.4023e-06, device='cuda:0') MSE:  tensor(3.0270e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(6.9600e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0132, device='cuda:0') MSE:  tensor(1.6651e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0474, device='cuda:0')
min of d_p_list:  tensor(-0.0218, device='cuda:0')
Epoch:  193  
Training Loss: 0.26557549834251404
Test Loss:  0.27513012290000916
Test Acc:  0.0
Valid Loss:  0.26319360733032227
Valid Acc:  0.0
std:  0.12607951748721835 
thres:  0.0004628889739513397
Preserved_eigens number check:  512
 19%|█▉        | 193/1000 [58:01<3:54:47, 17.46s/it]Epoch:   194
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  505
Criterion check: 
Mean:  tensor(1.8270, device='cuda:0') 
Std:  tensor(35.5829, device='cuda:0') 
ABS Max:  tensor(558.0717, device='cuda:0') 
ABS Min:  tensor(0.0012, device='cuda:0')
Criterion check:  tensor([0.9991, 0.9997, 0.9994, 1.0000, 1.0000, 1.0001, 0.9966, 1.0000, 0.9995,
        0.9947], device='cuda:0') tensor(194, device='cuda:0')
max of Lambda2 tensor(233231.9375, device='cuda:0')
min of Lambda2 tensor(3.8975e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3061, device='cuda:0')
min of grad d_p:  tensor(-0.4795, device='cuda:0')
max|min: (J_L, Jta/N)  (0.30607303977012634, 0.30607298016548157, ratio: 0.9999998211860657)|(-0.4795477092266083, -0.4795476496219635)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.0862e-07, device='cuda:0') mean:  tensor(-8.1451e-11, device='cuda:0') min:  tensor(-4.1723e-07, device='cuda:0') norm:  tensor(3.5317e-06, device='cuda:0') MSE:  tensor(4.4502e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0009, device='cuda:0') mean:  tensor(9.4912e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0201, device='cuda:0') MSE:  tensor(2.5380e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0231, device='cuda:0')
min of d_p_list:  tensor(-0.0266, device='cuda:0')
Epoch:  194  
Training Loss: 0.2119109034538269
Test Loss:  0.21828816831111908
Test Acc:  0.0
Valid Loss:  0.20545050501823425
Valid Acc:  0.0
std:  0.1528944561230054 
thres:  0.0003986328899860382
Preserved_eigens number check:  512
 19%|█▉        | 194/1000 [58:19<3:55:48, 17.55s/it]Epoch:   195
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  502
Criterion check: 
Mean:  tensor(-2.0802, device='cuda:0') 
Std:  tensor(79.1259, device='cuda:0') 
ABS Max:  tensor(1081.8311, device='cuda:0') 
ABS Min:  tensor(0.0050, device='cuda:0')
Criterion check:  tensor([0.9997, 1.0005, 0.9991, 1.0000, 0.9997, 1.0001, 1.0006, 1.0002, 1.0007,
        0.9992], device='cuda:0') tensor(189, device='cuda:0')
max of Lambda2 tensor(227510.4531, device='cuda:0')
min of Lambda2 tensor(1.2758e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2772, device='cuda:0')
min of grad d_p:  tensor(-0.4318, device='cuda:0')
max|min: (J_L, Jta/N)  (0.2772402763366699, 0.27724024653434753, ratio: 0.9999998807907104)|(-0.4317830502986908, -0.4317830801010132)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.6822e-07, device='cuda:0') mean:  tensor(2.4547e-11, device='cuda:0') min:  tensor(-1.4901e-07, device='cuda:0') norm:  tensor(2.1335e-06, device='cuda:0') MSE:  tensor(2.6884e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0008, device='cuda:0') mean:  tensor(1.2558e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0256, device='cuda:0') MSE:  tensor(3.2205e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0242, device='cuda:0')
min of d_p_list:  tensor(-0.0183, device='cuda:0')
Epoch:  195  
Training Loss: 0.160800039768219
Test Loss:  0.16365014016628265
Test Acc:  0.0
Valid Loss:  0.15434004366397858
Valid Acc:  0.0
std:  0.1446033146359039 
thres:  0.0003144706666469574
Preserved_eigens number check:  512
 20%|█▉        | 195/1000 [58:36<3:54:04, 17.45s/it]Epoch:   196
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  502
Criterion check: 
Mean:  tensor(0.0020, device='cuda:0') 
Std:  tensor(130.3231, device='cuda:0') 
ABS Max:  tensor(2433.8948, device='cuda:0') 
ABS Min:  tensor(0.0030, device='cuda:0')
Criterion check:  tensor([0.9990, 1.0007, 0.9997, 1.0005, 0.9998, 1.0006, 1.0022, 1.0002, 0.9993,
        1.0002], device='cuda:0') tensor(214, device='cuda:0')
max of Lambda2 tensor(236285.4062, device='cuda:0')
min of Lambda2 tensor(1.2005e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2639, device='cuda:0')
min of grad d_p:  tensor(-0.4169, device='cuda:0')
max|min: (J_L, Jta/N)  (0.2638549208641052, 0.2638549208641052, ratio: 1.0)|(-0.41694343090057373, -0.4169432818889618)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.6822e-07, device='cuda:0') mean:  tensor(7.9673e-11, device='cuda:0') min:  tensor(-2.9802e-07, device='cuda:0') norm:  tensor(3.1989e-06, device='cuda:0') MSE:  tensor(4.0309e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0010, device='cuda:0') mean:  tensor(1.3788e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0285, device='cuda:0') MSE:  tensor(3.5920e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0834, device='cuda:0')
min of d_p_list:  tensor(-0.0835, device='cuda:0')
Epoch:  196  
Training Loss: 0.13471919298171997
Test Loss:  0.13613000512123108
Test Acc:  0.0
Valid Loss:  0.12314262986183167
Valid Acc:  0.0
std:  0.0815120309226254 
thres:  0.0002272830069065094
Preserved_eigens number check:  512
 20%|█▉        | 196/1000 [58:54<3:54:50, 17.53s/it]Epoch:   197
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  503
Criterion check: 
Mean:  tensor(5.4979, device='cuda:0') 
Std:  tensor(77.0874, device='cuda:0') 
ABS Max:  tensor(1536.9657, device='cuda:0') 
ABS Min:  tensor(2.7086e-05, device='cuda:0')
Criterion check:  tensor([0.9997, 0.9992, 1.0001, 1.0004, 0.9998, 1.0015, 1.0008, 1.0000, 0.9996,
        1.0200], device='cuda:0') tensor(195, device='cuda:0')
max of Lambda2 tensor(226960.7969, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2299, device='cuda:0')
min of grad d_p:  tensor(-0.3931, device='cuda:0')
max|min: (J_L, Jta/N)  (0.22994819283485413, 0.22994816303253174, ratio: 0.9999998807907104)|(-0.393073171377182, -0.39307311177253723)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.7881e-07, device='cuda:0') mean:  tensor(1.3105e-11, device='cuda:0') min:  tensor(-2.3842e-07, device='cuda:0') norm:  tensor(1.8468e-06, device='cuda:0') MSE:  tensor(2.3271e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0013, device='cuda:0') mean:  tensor(1.1375e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0227, device='cuda:0') MSE:  tensor(2.8576e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0181, device='cuda:0')
min of d_p_list:  tensor(-0.0265, device='cuda:0')
Epoch:  197  
Training Loss: 0.10820196568965912
Test Loss:  0.10848287492990494
Test Acc:  0.0
Valid Loss:  0.09751936793327332
Valid Acc:  0.0
std:  0.05629349608256393 
thres:  0.0001762415200471878
Preserved_eigens number check:  512
 20%|█▉        | 197/1000 [59:11<3:53:39, 17.46s/it]Epoch:   198
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  501
Criterion check: 
Mean:  tensor(-0.0565, device='cuda:0') 
Std:  tensor(20.4102, device='cuda:0') 
ABS Max:  tensor(377.6165, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([0.9999, 1.0001, 0.9999, 1.0001, 1.0000, 1.0004, 0.9999, 1.0006, 1.0000,
        0.9978], device='cuda:0') tensor(145, device='cuda:0')
max of Lambda2 tensor(223103.3125, device='cuda:0')
min of Lambda2 tensor(7.9618e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2133, device='cuda:0')
min of grad d_p:  tensor(-0.3520, device='cuda:0')
max|min: (J_L, Jta/N)  (0.2132725715637207, 0.21327249705791473, ratio: 0.9999996423721313)|(-0.3520095944404602, -0.3520095646381378)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.4901e-07, device='cuda:0') mean:  tensor(-4.8177e-11, device='cuda:0') min:  tensor(-2.0862e-07, device='cuda:0') norm:  tensor(2.0915e-06, device='cuda:0') MSE:  tensor(2.6354e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(2.5272e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0050, device='cuda:0') MSE:  tensor(6.2670e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0179, device='cuda:0')
min of d_p_list:  tensor(-0.0240, device='cuda:0')
Epoch:  198  
Training Loss: 0.09010908007621765
Test Loss:  0.08998455852270126
Test Acc:  0.0
Valid Loss:  0.08054869621992111
Valid Acc:  0.0
std:  0.04272079881142343 
thres:  0.00014114823639392853
Preserved_eigens number check:  512
 20%|█▉        | 198/1000 [59:29<3:54:36, 17.55s/it]Epoch:   199
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  499
Criterion check: 
Mean:  tensor(1.5706, device='cuda:0') 
Std:  tensor(60.0050, device='cuda:0') 
ABS Max:  tensor(1256.6460, device='cuda:0') 
ABS Min:  tensor(0.0008, device='cuda:0')
Criterion check:  tensor([1.0001, 1.0001, 0.9999, 1.0001, 1.0000, 1.0004, 1.0000, 0.9978, 1.0003,
        0.9986], device='cuda:0') tensor(169, device='cuda:0')
max of Lambda2 tensor(231768.1406, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1950, device='cuda:0')
min of grad d_p:  tensor(-0.3288, device='cuda:0')
max|min: (J_L, Jta/N)  (0.19497081637382507, 0.1949707716703415, ratio: 0.9999997615814209)|(-0.32881417870521545, -0.32881391048431396)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.3842e-07, device='cuda:0') mean:  tensor(2.6044e-12, device='cuda:0') min:  tensor(-2.6822e-07, device='cuda:0') norm:  tensor(2.0166e-06, device='cuda:0') MSE:  tensor(2.5410e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(3.5361e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0067, device='cuda:0') MSE:  tensor(8.4968e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0291, device='cuda:0')
min of d_p_list:  tensor(-0.0255, device='cuda:0')
Epoch:  199  
Training Loss: 0.07376214861869812
Test Loss:  0.07388335466384888
Test Acc:  0.0
Valid Loss:  0.06416071951389313
Valid Acc:  0.0
std:  0.03111863537866761 
thres:  0.00011351848542690277
Preserved_eigens number check:  512
 20%|█▉        | 199/1000 [59:55<4:30:07, 20.23s/it]Epoch:   200
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  501
Criterion check: 
Mean:  tensor(-5916.7842, device='cuda:0') 
Std:  tensor(169958.1406, device='cuda:0') 
ABS Max:  tensor(3570637.2500, device='cuda:0') 
ABS Min:  tensor(0.1301, device='cuda:0')
Criterion check:  tensor([ 0.8516, -0.8512,  1.5471,  0.5015,  0.9610, -0.1301,  8.4790,  1.4886,
         0.3503,  9.4073], device='cuda:0') tensor(256, device='cuda:0')
max of Lambda2 tensor(241453.0469, device='cuda:0')
min of Lambda2 tensor(1.5359e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1789, device='cuda:0')
min of grad d_p:  tensor(-0.3167, device='cuda:0')
max|min: (J_L, Jta/N)  (0.178918719291687, 0.17891868948936462, ratio: 0.9999998211860657)|(-0.3166893720626831, -0.3166894316673279)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.3842e-07, device='cuda:0') mean:  tensor(-6.4825e-11, device='cuda:0') min:  tensor(-1.9744e-07, device='cuda:0') norm:  tensor(2.5549e-06, device='cuda:0') MSE:  tensor(3.2194e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.6648, device='cuda:0') mean:  tensor(0.0073, device='cuda:0') min:  tensor(4.3283e-13, device='cuda:0') norm:  tensor(14.0596, device='cuda:0') MSE:  tensor(1.7716e-05, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0350, device='cuda:0')
min of d_p_list:  tensor(-0.0496, device='cuda:0')
Epoch:  200  
Training Loss: 0.05814969167113304
Test Loss:  0.05734989047050476
Test Acc:  0.0
Valid Loss:  0.05154925957322121
Valid Acc:  0.0
std:  0.026700511183495566 
thres:  9.298841580748558e-05
Preserved_eigens number check:  512
 20%|██        | 200/1000 [1:00:13<4:18:52, 19.42s/it]Epoch:   201
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  503
Criterion check: 
Mean:  tensor(-27.3388, device='cuda:0') 
Std:  tensor(630.6685, device='cuda:0') 
ABS Max:  tensor(14265.4141, device='cuda:0') 
ABS Min:  tensor(0.0020, device='cuda:0')
Criterion check:  tensor([0.9999, 0.9999, 1.0000, 0.9995, 1.0002, 0.9993, 1.0001, 0.9972, 1.0003,
        0.9994], device='cuda:0') tensor(172, device='cuda:0')
max of Lambda2 tensor(263782.7188, device='cuda:0')
min of Lambda2 tensor(8.2714e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1990, device='cuda:0')
min of grad d_p:  tensor(-0.2917, device='cuda:0')
max|min: (J_L, Jta/N)  (0.19904360175132751, 0.19904367625713348, ratio: 1.0000003576278687)|(-0.2916835844516754, -0.291683554649353)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.4901e-07, device='cuda:0') mean:  tensor(-2.6572e-11, device='cuda:0') min:  tensor(-2.6822e-07, device='cuda:0') norm:  tensor(2.1394e-06, device='cuda:0') MSE:  tensor(2.6958e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(3.1905e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0063, device='cuda:0') MSE:  tensor(7.9979e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0235, device='cuda:0')
min of d_p_list:  tensor(-0.0277, device='cuda:0')
Epoch:  201  
Training Loss: 0.04685911536216736
Test Loss:  0.04618038609623909
Test Acc:  0.0
Valid Loss:  0.041748467832803726
Valid Acc:  0.0
std:  0.021941569841038865 
thres:  7.541640028357507e-05
Preserved_eigens number check:  512
 20%|██        | 201/1000 [1:00:30<4:09:02, 18.70s/it]Epoch:   202
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  502
Criterion check: 
Mean:  tensor(18.1358, device='cuda:0') 
Std:  tensor(357.3603, device='cuda:0') 
ABS Max:  tensor(6722.1006, device='cuda:0') 
ABS Min:  tensor(0.0007, device='cuda:0')
Criterion check:  tensor([0.9976, 1.0011, 0.9997, 0.9987, 1.0008, 0.9934, 1.0002, 0.8822, 1.0016,
        0.9871], device='cuda:0') tensor(239, device='cuda:0')
max of Lambda2 tensor(268101.1875, device='cuda:0')
min of Lambda2 tensor(2.4782e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1808, device='cuda:0')
min of grad d_p:  tensor(-0.2681, device='cuda:0')
max|min: (J_L, Jta/N)  (0.18076753616333008, 0.18076743185520172, ratio: 0.9999994039535522)|(-0.2681330442428589, -0.2681329548358917)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.6391e-07, device='cuda:0') mean:  tensor(2.2789e-11, device='cuda:0') min:  tensor(-2.5332e-07, device='cuda:0') norm:  tensor(1.9351e-06, device='cuda:0') MSE:  tensor(2.4384e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0040, device='cuda:0') mean:  tensor(3.7454e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0762, device='cuda:0') MSE:  tensor(9.6065e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0177, device='cuda:0')
min of d_p_list:  tensor(-0.0153, device='cuda:0')
Epoch:  202  
Training Loss: 0.039324864745140076
Test Loss:  0.039010174572467804
Test Acc:  0.0
Valid Loss:  0.03527034819126129
Valid Acc:  0.0
std:  0.018363317059110738 
thres:  6.164098009467125e-05
Preserved_eigens number check:  512
 20%|██        | 202/1000 [1:00:47<4:04:12, 18.36s/it]Epoch:   203
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  501
Criterion check: 
Mean:  tensor(-30.7739, device='cuda:0') 
Std:  tensor(704.5494, device='cuda:0') 
ABS Max:  tensor(15645.3398, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([0.9991, 1.0016, 0.9994, 1.0006, 1.0002, 0.9992, 1.0011, 0.9988, 0.9966,
        0.9976], device='cuda:0') tensor(191, device='cuda:0')
max of Lambda2 tensor(266809.5312, device='cuda:0')
min of Lambda2 tensor(2.0295e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1629, device='cuda:0')
min of grad d_p:  tensor(-0.2521, device='cuda:0')
max|min: (J_L, Jta/N)  (0.16293106973171234, 0.1629311740398407, ratio: 1.0000005960464478)|(-0.25205713510513306, -0.25205719470977783)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.6391e-07, device='cuda:0') mean:  tensor(4.4793e-11, device='cuda:0') min:  tensor(-1.6391e-07, device='cuda:0') norm:  tensor(2.5789e-06, device='cuda:0') MSE:  tensor(3.2496e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(7.3278e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0141, device='cuda:0') MSE:  tensor(1.7787e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0221, device='cuda:0')
min of d_p_list:  tensor(-0.0448, device='cuda:0')
Epoch:  203  
Training Loss: 0.033975180238485336
Test Loss:  0.03388645499944687
Test Acc:  0.0
Valid Loss:  0.030764881521463394
Valid Acc:  0.0
std:  0.014218423892906265 
thres:  5.041420012712479e-05
Preserved_eigens number check:  512
 20%|██        | 203/1000 [1:01:05<4:01:25, 18.18s/it]Epoch:   204
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  505
Criterion check: 
Mean:  tensor(-16.3938, device='cuda:0') 
Std:  tensor(379.8338, device='cuda:0') 
ABS Max:  tensor(8577.2744, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([0.9999, 0.9991, 0.9995, 0.9999, 1.0000, 0.9997, 1.0001, 0.9981, 0.9996,
        0.9992], device='cuda:0') tensor(156, device='cuda:0')
max of Lambda2 tensor(259532.2500, device='cuda:0')
min of Lambda2 tensor(3.7050e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1620, device='cuda:0')
min of grad d_p:  tensor(-0.2210, device='cuda:0')
max|min: (J_L, Jta/N)  (0.16202190518379211, 0.1620219498872757, ratio: 1.000000238418579)|(-0.2209581434726715, -0.22095823287963867)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.7881e-07, device='cuda:0') mean:  tensor(8.2253e-12, device='cuda:0') min:  tensor(-8.1956e-08, device='cuda:0') norm:  tensor(1.2733e-06, device='cuda:0') MSE:  tensor(1.6045e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(2.9078e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0058, device='cuda:0') MSE:  tensor(7.2848e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1502, device='cuda:0')
min of d_p_list:  tensor(-0.1144, device='cuda:0')
Epoch:  204  
Training Loss: 0.028996996581554413
Test Loss:  0.03092261217534542
Test Acc:  0.0
Valid Loss:  0.02713230811059475
Valid Acc:  0.0
std:  0.010233318440831899 
thres:  4.146116971969605e-05
Preserved_eigens number check:  512
 20%|██        | 204/1000 [1:01:23<4:00:10, 18.10s/it]Epoch:   205
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  504
Criterion check: 
Mean:  tensor(4.2420, device='cuda:0') 
Std:  tensor(73.2628, device='cuda:0') 
ABS Max:  tensor(946.4683, device='cuda:0') 
ABS Min:  tensor(0.0013, device='cuda:0')
Criterion check:  tensor([1.0004, 0.9973, 1.0009, 1.0013, 1.0006, 0.9992, 0.9998, 1.0002, 1.0024,
        0.9889], device='cuda:0') tensor(192, device='cuda:0')
max of Lambda2 tensor(264034.4062, device='cuda:0')
min of Lambda2 tensor(5.1013e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1668, device='cuda:0')
min of grad d_p:  tensor(-0.1917, device='cuda:0')
max|min: (J_L, Jta/N)  (0.16683347523212433, 0.16683349013328552, ratio: 1.0000001192092896)|(-0.1917431354522705, -0.19174310564994812)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.0431e-07, device='cuda:0') mean:  tensor(-2.4615e-11, device='cuda:0') min:  tensor(-1.6391e-07, device='cuda:0') norm:  tensor(1.1904e-06, device='cuda:0') MSE:  tensor(1.5000e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(7.4444e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0147, device='cuda:0') MSE:  tensor(1.8554e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0210, device='cuda:0')
min of d_p_list:  tensor(-0.0186, device='cuda:0')
Epoch:  205  
Training Loss: 0.023651422932744026
Test Loss:  0.024803731590509415
Test Acc:  0.0
Valid Loss:  0.02168447896838188
Valid Acc:  0.0
std:  0.008053052068127741 
thres:  3.456151597201825e-05
Preserved_eigens number check:  512
 20%|██        | 205/1000 [1:01:41<3:59:09, 18.05s/it]Epoch:   206
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  502
Criterion check: 
Mean:  tensor(-8.0430, device='cuda:0') 
Std:  tensor(112.6104, device='cuda:0') 
ABS Max:  tensor(1886.2400, device='cuda:0') 
ABS Min:  tensor(0.0007, device='cuda:0')
Criterion check:  tensor([1.0002, 1.0000, 1.0009, 1.0002, 1.0005, 1.0000, 1.0013, 1.0003, 1.0002,
        0.9983], device='cuda:0') tensor(182, device='cuda:0')
max of Lambda2 tensor(264038., device='cuda:0')
min of Lambda2 tensor(2.2706e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1582, device='cuda:0')
min of grad d_p:  tensor(-0.1800, device='cuda:0')
max|min: (J_L, Jta/N)  (0.15817362070083618, 0.15817350149154663, ratio: 0.9999992251396179)|(-0.1799965798854828, -0.17999649047851562)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.3411e-07, device='cuda:0') mean:  tensor(-3.2004e-11, device='cuda:0') min:  tensor(-1.1921e-07, device='cuda:0') norm:  tensor(1.6836e-06, device='cuda:0') MSE:  tensor(2.1214e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(4.4177e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0087, device='cuda:0') MSE:  tensor(1.1011e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0135, device='cuda:0')
min of d_p_list:  tensor(-0.0092, device='cuda:0')
Epoch:  206  
Training Loss: 0.020140264183282852
Test Loss:  0.02092740871012211
Test Acc:  0.0
Valid Loss:  0.0185127854347229
Valid Acc:  0.0
std:  0.00690246896102423 
thres:  2.9217745736241342e-05
Preserved_eigens number check:  512
 21%|██        | 206/1000 [1:01:51<3:25:43, 15.55s/it]Epoch:   207
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  501
Criterion check: 
Mean:  tensor(1.9379, device='cuda:0') 
Std:  tensor(27.2531, device='cuda:0') 
ABS Max:  tensor(523.9543, device='cuda:0') 
ABS Min:  tensor(0.0004, device='cuda:0')
Criterion check:  tensor([0.9999, 0.9993, 0.9994, 0.9983, 0.9999, 1.0002, 1.0010, 0.9985, 0.9998,
        0.9996], device='cuda:0') tensor(140, device='cuda:0')
max of Lambda2 tensor(270355.2500, device='cuda:0')
min of Lambda2 tensor(9.4225e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1458, device='cuda:0')
min of grad d_p:  tensor(-0.1667, device='cuda:0')
max|min: (J_L, Jta/N)  (0.14576593041419983, 0.1457657665014267, ratio: 0.9999988675117493)|(-0.16670426726341248, -0.1667041778564453)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.6391e-07, device='cuda:0') mean:  tensor(-6.5246e-11, device='cuda:0') min:  tensor(-1.6158e-07, device='cuda:0') norm:  tensor(2.3175e-06, device='cuda:0') MSE:  tensor(2.9202e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(2.0442e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0042, device='cuda:0') MSE:  tensor(5.3383e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.6860, device='cuda:0')
min of d_p_list:  tensor(-1.5303, device='cuda:0')
Epoch:  207  
Training Loss: 5.342806339263916
Test Loss:  5.655226230621338
Test Acc:  0.0
Valid Loss:  4.968655586242676
Valid Acc:  0.0
std:  2.126451347089266 
thres:  0.0010899140406399966
Preserved_eigens number check:  512
 21%|██        | 207/1000 [1:02:07<3:29:55, 15.88s/it]Epoch:   208
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  498
Criterion check: 
Mean:  tensor(5.7969, device='cuda:0') 
Std:  tensor(72.9342, device='cuda:0') 
ABS Max:  tensor(758.6409, device='cuda:0') 
ABS Min:  tensor(0.0054, device='cuda:0')
Criterion check:  tensor([1.0000, 0.9980, 1.0003, 1.0000, 1.0002, 0.9994, 1.0005, 1.0015, 1.0014,
        1.0020], device='cuda:0') tensor(206, device='cuda:0')
max of Lambda2 tensor(106782.3438, device='cuda:0')
min of Lambda2 tensor(3.6259e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.4799, device='cuda:0')
min of grad d_p:  tensor(-0.9387, device='cuda:0')
max|min: (J_L, Jta/N)  (0.47992175817489624, 0.4799221456050873, ratio: 1.0000008344650269)|(-0.9386917352676392, -0.938692033290863)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.9605e-07, device='cuda:0') mean:  tensor(1.0778e-10, device='cuda:0') min:  tensor(-3.8743e-07, device='cuda:0') norm:  tensor(4.7144e-06, device='cuda:0') MSE:  tensor(5.9405e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0014, device='cuda:0') mean:  tensor(1.3763e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0273, device='cuda:0') MSE:  tensor(3.4351e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0412, device='cuda:0')
min of d_p_list:  tensor(-0.0465, device='cuda:0')
Epoch:  208  
Training Loss: 0.9897646307945251
Test Loss:  1.0788466930389404
Test Acc:  0.0
Valid Loss:  0.9506030082702637
Valid Acc:  0.0
std:  2.065008135108251 
thres:  0.0012810719307512044
Preserved_eigens number check:  512
 21%|██        | 208/1000 [1:02:23<3:30:36, 15.96s/it]Epoch:   209
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  501
Criterion check: 
Mean:  tensor(4.9892, device='cuda:0') 
Std:  tensor(149.9454, device='cuda:0') 
ABS Max:  tensor(2607.4092, device='cuda:0') 
ABS Min:  tensor(0.0047, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0055, 1.0002, 1.0000, 0.9999, 1.0003, 0.9988, 0.9994, 0.9998,
        0.9959], device='cuda:0') tensor(204, device='cuda:0')
max of Lambda2 tensor(98852.2578, device='cuda:0')
min of Lambda2 tensor(1.1415e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.4360, device='cuda:0')
min of grad d_p:  tensor(-0.8556, device='cuda:0')
max|min: (J_L, Jta/N)  (0.4360464811325073, 0.4360465109348297, ratio: 1.0000001192092896)|(-0.8555600643157959, -0.855560302734375)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.5763e-07, device='cuda:0') mean:  tensor(2.7823e-11, device='cuda:0') min:  tensor(-3.5763e-07, device='cuda:0') norm:  tensor(3.3408e-06, device='cuda:0') MSE:  tensor(4.2096e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0012, device='cuda:0') mean:  tensor(1.2447e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0233, device='cuda:0') MSE:  tensor(2.9403e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0565, device='cuda:0')
min of d_p_list:  tensor(-0.0740, device='cuda:0')
Epoch:  209  
Training Loss: 0.6229861974716187
Test Loss:  0.7059189081192017
Test Acc:  0.0
Valid Loss:  0.6412840485572815
Valid Acc:  0.0
std:  2.005797275286397 
thres:  0.0013998697709292174
Preserved_eigens number check:  512
 21%|██        | 209/1000 [1:02:38<3:24:33, 15.52s/it]Epoch:   210
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  499
Criterion check: 
Mean:  tensor(2.1321, device='cuda:0') 
Std:  tensor(35.7504, device='cuda:0') 
ABS Max:  tensor(607.3603, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([1.0000, 0.9996, 1.0000, 1.0000, 1.0000, 0.9996, 1.0000, 0.9999, 1.0011,
        0.9998], device='cuda:0') tensor(163, device='cuda:0')
max of Lambda2 tensor(98851.7812, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3995, device='cuda:0')
min of grad d_p:  tensor(-0.7798, device='cuda:0')
max|min: (J_L, Jta/N)  (0.39946356415748596, 0.3994637131690979, ratio: 1.0000003576278687)|(-0.7797857522964478, -0.779785692691803)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.7684e-07, device='cuda:0') mean:  tensor(2.7655e-11, device='cuda:0') min:  tensor(-2.9802e-07, device='cuda:0') norm:  tensor(3.4239e-06, device='cuda:0') MSE:  tensor(4.3144e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(2.3905e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0045, device='cuda:0') MSE:  tensor(5.6843e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0368, device='cuda:0')
min of d_p_list:  tensor(-0.0290, device='cuda:0')
Epoch:  210  
Training Loss: 0.4749727249145508
Test Loss:  0.5432414412498474
Test Acc:  0.0
Valid Loss:  0.500908613204956
Valid Acc:  0.0
std:  1.9512474455369149 
thres:  0.0014901340313255786
Preserved_eigens number check:  512
 21%|██        | 210/1000 [1:02:52<3:19:17, 15.14s/it]Epoch:   211
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  498
Criterion check: 
Mean:  tensor(5.5073, device='cuda:0') 
Std:  tensor(141.6785, device='cuda:0') 
ABS Max:  tensor(3147.0427, device='cuda:0') 
ABS Min:  tensor(0.0005, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0000, 1.0000, 0.9999, 1.0005, 1.0004, 1.0010, 1.0001,
        0.9992], device='cuda:0') tensor(168, device='cuda:0')
max of Lambda2 tensor(98942.6719, device='cuda:0')
min of Lambda2 tensor(4.5455e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3614, device='cuda:0')
min of grad d_p:  tensor(-0.7108, device='cuda:0')
max|min: (J_L, Jta/N)  (0.36136746406555176, 0.3613673448562622, ratio: 0.9999996423721313)|(-0.7108315229415894, -0.7108312845230103)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.9802e-07, device='cuda:0') mean:  tensor(-1.5152e-11, device='cuda:0') min:  tensor(-4.1723e-07, device='cuda:0') norm:  tensor(3.0938e-06, device='cuda:0') MSE:  tensor(3.8984e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(4.0029e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0077, device='cuda:0') MSE:  tensor(9.7504e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1905, device='cuda:0')
min of d_p_list:  tensor(-0.1972, device='cuda:0')
Epoch:  211  
Training Loss: 0.4551401734352112
Test Loss:  0.5152478218078613
Test Acc:  0.0
Valid Loss:  0.4604113698005676
Valid Acc:  0.0
std:  1.8925812317993345 
thres:  0.0015771340131759644
Preserved_eigens number check:  512
 21%|██        | 211/1000 [1:03:07<3:16:47, 14.97s/it]Epoch:   212
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  500
Criterion check: 
Mean:  tensor(3.6176, device='cuda:0') 
Std:  tensor(70.1427, device='cuda:0') 
ABS Max:  tensor(1198.5677, device='cuda:0') 
ABS Min:  tensor(7.2091e-05, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0000, 0.9999, 1.0000, 1.0001, 1.0005, 1.0001, 1.0002,
        1.0004], device='cuda:0') tensor(156, device='cuda:0')
max of Lambda2 tensor(113605.6016, device='cuda:0')
min of Lambda2 tensor(1.1571e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3230, device='cuda:0')
min of grad d_p:  tensor(-0.6409, device='cuda:0')
max|min: (J_L, Jta/N)  (0.32301732897758484, 0.32301729917526245, ratio: 0.9999998807907104)|(-0.6408570408821106, -0.640856921672821)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.9802e-07, device='cuda:0') mean:  tensor(-6.6367e-13, device='cuda:0') min:  tensor(-2.9802e-07, device='cuda:0') norm:  tensor(2.5852e-06, device='cuda:0') MSE:  tensor(3.2575e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(2.8227e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0053, device='cuda:0') MSE:  tensor(6.7079e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0537, device='cuda:0')
min of d_p_list:  tensor(-0.1239, device='cuda:0')
Epoch:  212  
Training Loss: 0.3546596169471741
Test Loss:  0.39978617429733276
Test Acc:  0.0
Valid Loss:  0.35170799493789673
Valid Acc:  0.0
std:  0.22232976952890465 
thres:  0.000579504668712616
Preserved_eigens number check:  512
 21%|██        | 212/1000 [1:03:21<3:15:29, 14.89s/it]Epoch:   213
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  499
Criterion check: 
Mean:  tensor(-5.8578, device='cuda:0') 
Std:  tensor(133.9856, device='cuda:0') 
ABS Max:  tensor(3019., device='cuda:0') 
ABS Min:  tensor(0.0016, device='cuda:0')
Criterion check:  tensor([0.9999, 1.0000, 1.0000, 1.0000, 1.0001, 1.0007, 0.9995, 1.0000, 0.9994,
        1.0008], device='cuda:0') tensor(174, device='cuda:0')
max of Lambda2 tensor(110569.9453, device='cuda:0')
min of Lambda2 tensor(7.5664e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3047, device='cuda:0')
min of grad d_p:  tensor(-0.6072, device='cuda:0')
max|min: (J_L, Jta/N)  (0.3047284185886383, 0.304728627204895, ratio: 1.0000007152557373)|(-0.6071510910987854, -0.6071511507034302)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.7684e-07, device='cuda:0') mean:  tensor(8.1318e-11, device='cuda:0') min:  tensor(-2.0862e-07, device='cuda:0') norm:  tensor(3.3688e-06, device='cuda:0') MSE:  tensor(4.2450e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(3.0595e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0058, device='cuda:0') MSE:  tensor(7.3519e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.3380, device='cuda:0')
min of d_p_list:  tensor(-0.5332, device='cuda:0')
Epoch:  213  
Training Loss: 0.4100109040737152
Test Loss:  0.5007523894309998
Test Acc:  0.0
Valid Loss:  0.4736442565917969
Valid Acc:  0.0
std:  0.08982722875449659 
thres:  0.000463553923368454
Preserved_eigens number check:  512
 21%|██▏       | 213/1000 [1:03:36<3:14:28, 14.83s/it]Epoch:   214
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  499
Criterion check: 
Mean:  tensor(9.4705, device='cuda:0') 
Std:  tensor(142.4259, device='cuda:0') 
ABS Max:  tensor(3106.1958, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([0.9999, 1.0000, 1.0000, 1.0000, 1.0000, 0.9998, 1.0001, 1.0000, 0.9986,
        1.0005], device='cuda:0') tensor(168, device='cuda:0')
max of Lambda2 tensor(110372.2031, device='cuda:0')
min of Lambda2 tensor(5.3594e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2929, device='cuda:0')
min of grad d_p:  tensor(-0.5538, device='cuda:0')
max|min: (J_L, Jta/N)  (0.29293981194496155, 0.2929399311542511, ratio: 1.0000003576278687)|(-0.5537618398666382, -0.5537619590759277)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.6822e-07, device='cuda:0') mean:  tensor(3.3956e-11, device='cuda:0') min:  tensor(-2.3842e-07, device='cuda:0') norm:  tensor(2.5803e-06, device='cuda:0') MSE:  tensor(3.2514e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(3.8327e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0068, device='cuda:0') MSE:  tensor(8.6288e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.3982, device='cuda:0')
min of d_p_list:  tensor(-0.2699, device='cuda:0')
Epoch:  214  
Training Loss: 0.40115106105804443
Test Loss:  0.4809754490852356
Test Acc:  0.0
Valid Loss:  0.46901533007621765
Valid Acc:  0.0
std:  0.04237441864583577 
thres:  0.00041918689608573913
Preserved_eigens number check:  512
 21%|██▏       | 214/1000 [1:03:51<3:13:59, 14.81s/it]Epoch:   215
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  499
Criterion check: 
Mean:  tensor(-0.9942, device='cuda:0') 
Std:  tensor(579.4913, device='cuda:0') 
ABS Max:  tensor(10656.8447, device='cuda:0') 
ABS Min:  tensor(0.0007, device='cuda:0')
Criterion check:  tensor([1.0022, 1.0002, 1.0007, 1.0001, 1.0001, 0.9987, 0.9996, 1.0008, 1.0009,
        1.0036], device='cuda:0') tensor(201, device='cuda:0')
max of Lambda2 tensor(119348.2656, device='cuda:0')
min of Lambda2 tensor(2.0873e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2934, device='cuda:0')
min of grad d_p:  tensor(-0.5521, device='cuda:0')
max|min: (J_L, Jta/N)  (0.29341191053390503, 0.29341188073158264, ratio: 0.9999998807907104)|(-0.5521096587181091, -0.5521095991134644)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.9802e-07, device='cuda:0') mean:  tensor(9.8141e-12, device='cuda:0') min:  tensor(-2.0862e-07, device='cuda:0') norm:  tensor(2.1113e-06, device='cuda:0') MSE:  tensor(2.6604e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0007, device='cuda:0') mean:  tensor(9.4302e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0184, device='cuda:0') MSE:  tensor(2.3179e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0202, device='cuda:0')
min of d_p_list:  tensor(-0.0277, device='cuda:0')
Epoch:  215  
Training Loss: 0.3048170506954193
Test Loss:  0.3651526868343353
Test Acc:  0.0
Valid Loss:  0.3568728566169739
Valid Acc:  0.0
std:  0.05129477345803863 
thres:  0.00038515576124191286
Preserved_eigens number check:  512
 22%|██▏       | 215/1000 [1:04:06<3:13:36, 14.80s/it]Epoch:   216
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  500
Criterion check: 
Mean:  tensor(1.6488, device='cuda:0') 
Std:  tensor(107.7944, device='cuda:0') 
ABS Max:  tensor(1659.2612, device='cuda:0') 
ABS Min:  tensor(0.0008, device='cuda:0')
Criterion check:  tensor([1.0011, 1.0000, 1.0000, 1.0000, 0.9999, 0.9988, 0.9999, 0.9999, 1.0000,
        1.0027], device='cuda:0') tensor(186, device='cuda:0')
max of Lambda2 tensor(119564.0625, device='cuda:0')
min of Lambda2 tensor(5.7125e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2675, device='cuda:0')
min of grad d_p:  tensor(-0.5023, device='cuda:0')
max|min: (J_L, Jta/N)  (0.2675406336784363, 0.26754069328308105, ratio: 1.000000238418579)|(-0.5022648572921753, -0.5022647976875305)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.6822e-07, device='cuda:0') mean:  tensor(5.9723e-12, device='cuda:0') min:  tensor(-2.3842e-07, device='cuda:0') norm:  tensor(2.6141e-06, device='cuda:0') MSE:  tensor(3.2940e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(5.3349e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0100, device='cuda:0') MSE:  tensor(1.2570e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.2498, device='cuda:0')
min of d_p_list:  tensor(-0.1294, device='cuda:0')
Epoch:  216  
Training Loss: 0.2957983613014221
Test Loss:  0.35270628333091736
Test Acc:  0.0
Valid Loss:  0.33576011657714844
Valid Acc:  0.0
std:  0.04725406495916494 
thres:  0.00035328739881515503
Preserved_eigens number check:  512
 22%|██▏       | 216/1000 [1:04:20<3:12:50, 14.76s/it]Epoch:   217
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  504
Criterion check: 
Mean:  tensor(1.0241, device='cuda:0') 
Std:  tensor(9.6735, device='cuda:0') 
ABS Max:  tensor(140.4054, device='cuda:0') 
ABS Min:  tensor(0.0011, device='cuda:0')
Criterion check:  tensor([0.9990, 1.0000, 1.0005, 0.9999, 1.0000, 0.9999, 1.0001, 1.0005, 0.9973,
        0.9987], device='cuda:0') tensor(166, device='cuda:0')
max of Lambda2 tensor(127245.7031, device='cuda:0')
min of Lambda2 tensor(1.2188e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2908, device='cuda:0')
min of grad d_p:  tensor(-0.5443, device='cuda:0')
max|min: (J_L, Jta/N)  (0.29078909754753113, 0.29078909754753113, ratio: 1.0)|(-0.5443263053894043, -0.54432612657547)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.0862e-07, device='cuda:0') mean:  tensor(-1.2256e-11, device='cuda:0') min:  tensor(-2.6822e-07, device='cuda:0') norm:  tensor(2.2392e-06, device='cuda:0') MSE:  tensor(2.8215e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(3.0563e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0060, device='cuda:0') MSE:  tensor(7.5981e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0329, device='cuda:0')
min of d_p_list:  tensor(-0.0297, device='cuda:0')
Epoch:  217  
Training Loss: 0.2321602702140808
Test Loss:  0.2765445113182068
Test Acc:  0.0
Valid Loss:  0.26475316286087036
Valid Acc:  0.0
std:  0.06757723519996554 
thres:  0.00032878752946853643
Preserved_eigens number check:  512
 22%|██▏       | 217/1000 [1:04:35<3:12:25, 14.75s/it]Epoch:   218
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  503
Criterion check: 
Mean:  tensor(1.8826, device='cuda:0') 
Std:  tensor(32.2006, device='cuda:0') 
ABS Max:  tensor(433.5179, device='cuda:0') 
ABS Min:  tensor(0.0008, device='cuda:0')
Criterion check:  tensor([0.9938, 0.9999, 1.0003, 1.0003, 1.0000, 1.0033, 1.0002, 1.0007, 0.9988,
        1.0009], device='cuda:0') tensor(167, device='cuda:0')
max of Lambda2 tensor(120396.6250, device='cuda:0')
min of Lambda2 tensor(2.2401e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2640, device='cuda:0')
min of grad d_p:  tensor(-0.4946, device='cuda:0')
max|min: (J_L, Jta/N)  (0.26400917768478394, 0.264009028673172, ratio: 0.999999463558197)|(-0.49459418654441833, -0.4945942759513855)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.6822e-07, device='cuda:0') mean:  tensor(-5.1280e-12, device='cuda:0') min:  tensor(-2.3842e-07, device='cuda:0') norm:  tensor(2.1742e-06, device='cuda:0') MSE:  tensor(2.7396e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(4.3635e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0075, device='cuda:0') MSE:  tensor(9.4657e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(1.0565, device='cuda:0')
min of d_p_list:  tensor(-1.1835, device='cuda:0')
Epoch:  218  
Training Loss: 0.2990332841873169
Test Loss:  0.3041786849498749
Test Acc:  0.0
Valid Loss:  0.3260604441165924
Valid Acc:  0.0
std:  0.05414477942189642 
thres:  0.0003065920054912567
Preserved_eigens number check:  512
 22%|██▏       | 218/1000 [1:04:50<3:12:11, 14.75s/it]Epoch:   219
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  490
Criterion check: 
Mean:  tensor(-11.4267, device='cuda:0') 
Std:  tensor(250.4477, device='cuda:0') 
ABS Max:  tensor(4535.3428, device='cuda:0') 
ABS Min:  tensor(0.0019, device='cuda:0')
Criterion check:  tensor([1.0003, 1.0007, 1.0001, 1.0000, 0.9997, 0.9995, 1.0011, 0.9988, 1.0015,
        0.9997], device='cuda:0') tensor(212, device='cuda:0')
max of Lambda2 tensor(78532.7812, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.6752, device='cuda:0')
min of grad d_p:  tensor(-0.7345, device='cuda:0')
max|min: (J_L, Jta/N)  (0.6752018928527832, 0.6752020120620728, ratio: 1.0000001192092896)|(-0.7345075011253357, -0.7345076203346252)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.5763e-07, device='cuda:0') mean:  tensor(-3.1606e-11, device='cuda:0') min:  tensor(-3.5763e-07, device='cuda:0') norm:  tensor(3.3872e-06, device='cuda:0') MSE:  tensor(4.2681e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0008, device='cuda:0') mean:  tensor(1.3314e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0256, device='cuda:0') MSE:  tensor(3.2242e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0467, device='cuda:0')
min of d_p_list:  tensor(-0.0270, device='cuda:0')
Epoch:  219  
Training Loss: 0.4287149906158447
Test Loss:  0.4878953695297241
Test Acc:  0.0
Valid Loss:  0.40177202224731445
Valid Acc:  0.0
std:  0.06399834397350156 
thres:  0.00031210479140281677
Preserved_eigens number check:  512
 22%|██▏       | 219/1000 [1:05:05<3:11:47, 14.73s/it]Epoch:   220
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  493
Criterion check: 
Mean:  tensor(-0.2635, device='cuda:0') 
Std:  tensor(24.5593, device='cuda:0') 
ABS Max:  tensor(244.6225, device='cuda:0') 
ABS Min:  tensor(0.0009, device='cuda:0')
Criterion check:  tensor([1.0000, 0.9999, 1.0000, 1.0000, 1.0000, 1.0001, 0.9993, 0.9988, 0.9997,
        0.9947], device='cuda:0') tensor(181, device='cuda:0')
max of Lambda2 tensor(78941.0781, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.6089, device='cuda:0')
min of grad d_p:  tensor(-0.6669, device='cuda:0')
max|min: (J_L, Jta/N)  (0.6089110970497131, 0.6089110970497131, ratio: 1.0)|(-0.6668658256530762, -0.6668657660484314)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.5763e-07, device='cuda:0') mean:  tensor(2.2775e-11, device='cuda:0') min:  tensor(-2.9802e-07, device='cuda:0') norm:  tensor(2.9499e-06, device='cuda:0') MSE:  tensor(3.7172e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(6.1534e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0122, device='cuda:0') MSE:  tensor(1.5403e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0374, device='cuda:0')
min of d_p_list:  tensor(-0.0299, device='cuda:0')
Epoch:  220  
Training Loss: 0.42785194516181946
Test Loss:  0.49477097392082214
Test Acc:  0.0
Valid Loss:  0.4031790494918823
Valid Acc:  0.0
std:  0.07848020838934287 
thres:  0.0003367117702960968
Preserved_eigens number check:  512
 22%|██▏       | 220/1000 [1:05:19<3:11:27, 14.73s/it]Epoch:   221
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  491
Criterion check: 
Mean:  tensor(-12.1375, device='cuda:0') 
Std:  tensor(333.2350, device='cuda:0') 
ABS Max:  tensor(7493.9521, device='cuda:0') 
ABS Min:  tensor(0.0028, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 0.9999, 1.0000, 0.9999, 0.9999, 1.0003, 1.0013, 0.9996,
        1.0019], device='cuda:0') tensor(210, device='cuda:0')
max of Lambda2 tensor(78983.8672, device='cuda:0')
min of Lambda2 tensor(6.3608e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.5564, device='cuda:0')
min of grad d_p:  tensor(-0.6062, device='cuda:0')
max|min: (J_L, Jta/N)  (0.5564154386520386, 0.556415319442749, ratio: 0.9999997615814209)|(-0.6062259674072266, -0.6062259674072266)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.5763e-07, device='cuda:0') mean:  tensor(9.7427e-12, device='cuda:0') min:  tensor(-2.9802e-07, device='cuda:0') norm:  tensor(2.6751e-06, device='cuda:0') MSE:  tensor(3.3709e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(5.2211e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0096, device='cuda:0') MSE:  tensor(1.2087e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1562, device='cuda:0')
min of d_p_list:  tensor(-0.1285, device='cuda:0')
Epoch:  221  
Training Loss: 0.38865363597869873
Test Loss:  0.4450637102127075
Test Acc:  0.0
Valid Loss:  0.3645661473274231
Valid Acc:  0.0
std:  0.07758265980503486 
thres:  0.00035528282523155215
Preserved_eigens number check:  512
 22%|██▏       | 221/1000 [1:05:34<3:11:33, 14.75s/it]Epoch:   222
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  493
Criterion check: 
Mean:  tensor(-15.6383, device='cuda:0') 
Std:  tensor(300.8281, device='cuda:0') 
ABS Max:  tensor(6649.0664, device='cuda:0') 
ABS Min:  tensor(0.0008, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0001, 1.0001, 1.0000, 1.0000, 1.0000, 1.0000, 1.0006, 0.9995,
        1.0064], device='cuda:0') tensor(175, device='cuda:0')
max of Lambda2 tensor(78892.4062, device='cuda:0')
min of Lambda2 tensor(2.8212e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.4976, device='cuda:0')
min of grad d_p:  tensor(-0.5610, device='cuda:0')
max|min: (J_L, Jta/N)  (0.4976061284542084, 0.4976060688495636, ratio: 0.9999998807907104)|(-0.5609680414199829, -0.560967743396759)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.0862e-07, device='cuda:0') mean:  tensor(-2.2890e-11, device='cuda:0') min:  tensor(-2.9802e-07, device='cuda:0') norm:  tensor(2.6477e-06, device='cuda:0') MSE:  tensor(3.3363e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(4.3975e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0083, device='cuda:0') MSE:  tensor(1.0492e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0370, device='cuda:0')
min of d_p_list:  tensor(-0.0341, device='cuda:0')
Epoch:  222  
Training Loss: 0.3458356559276581
Test Loss:  0.3995635211467743
Test Acc:  0.0
Valid Loss:  0.3277204632759094
Valid Acc:  0.0
std:  0.04988188509372701 
thres:  0.00037801790237426756
Preserved_eigens number check:  512
 22%|██▏       | 222/1000 [1:05:49<3:11:31, 14.77s/it]Epoch:   223
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  489
Criterion check: 
Mean:  tensor(0.7449, device='cuda:0') 
Std:  tensor(100.8367, device='cuda:0') 
ABS Max:  tensor(1680.4604, device='cuda:0') 
ABS Min:  tensor(0.0013, device='cuda:0')
Criterion check:  tensor([1.0001, 1.0001, 1.0000, 1.0000, 0.9999, 0.9999, 1.0004, 0.9996, 1.0000,
        0.9935], device='cuda:0') tensor(179, device='cuda:0')
max of Lambda2 tensor(78932.6172, device='cuda:0')
min of Lambda2 tensor(4.8568e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.4538, device='cuda:0')
min of grad d_p:  tensor(-0.5109, device='cuda:0')
max|min: (J_L, Jta/N)  (0.45382702350616455, 0.4538269639015198, ratio: 0.9999998807907104)|(-0.5108840465545654, -0.510884165763855)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.0862e-07, device='cuda:0') mean:  tensor(-4.0661e-11, device='cuda:0') min:  tensor(-2.6822e-07, device='cuda:0') norm:  tensor(2.4789e-06, device='cuda:0') MSE:  tensor(3.1236e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(3.0767e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0054, device='cuda:0') MSE:  tensor(6.8539e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0898, device='cuda:0')
min of d_p_list:  tensor(-0.0402, device='cuda:0')
Epoch:  223  
Training Loss: 0.2761364281177521
Test Loss:  0.3189612030982971
Test Acc:  0.0
Valid Loss:  0.26317423582077026
Valid Acc:  0.0
std:  0.05740631321638328 
thres:  0.00037343853116035466
Preserved_eigens number check:  512
 22%|██▏       | 223/1000 [1:06:04<3:10:54, 14.74s/it]Epoch:   224
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  495
Criterion check: 
Mean:  tensor(0.7640, device='cuda:0') 
Std:  tensor(19.4401, device='cuda:0') 
ABS Max:  tensor(342.3841, device='cuda:0') 
ABS Min:  tensor(0.0001, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0001, 1.0000, 1.0000, 0.9999, 0.9999, 1.0000, 0.9997, 1.0001,
        0.9997], device='cuda:0') tensor(169, device='cuda:0')
max of Lambda2 tensor(78894.9453, device='cuda:0')
min of Lambda2 tensor(1.5034e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.4163, device='cuda:0')
min of grad d_p:  tensor(-0.4620, device='cuda:0')
max|min: (J_L, Jta/N)  (0.41633331775665283, 0.4163333475589752, ratio: 1.0000001192092896)|(-0.46196913719177246, -0.461969256401062)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.3842e-07, device='cuda:0') mean:  tensor(1.9012e-12, device='cuda:0') min:  tensor(-2.6822e-07, device='cuda:0') norm:  tensor(2.2412e-06, device='cuda:0') MSE:  tensor(2.8241e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(8.3052e-05, device='cuda:0') mean:  tensor(1.2361e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0022, device='cuda:0') MSE:  tensor(2.8331e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0310, device='cuda:0')
min of d_p_list:  tensor(-0.0376, device='cuda:0')
Epoch:  224  
Training Loss: 0.2376951426267624
Test Loss:  0.2747913599014282
Test Acc:  0.0
Valid Loss:  0.22813621163368225
Valid Acc:  0.0
std:  0.0700720887100997 
thres:  0.0003352345615625382
Preserved_eigens number check:  512
 22%|██▏       | 224/1000 [1:06:18<3:10:38, 14.74s/it]Epoch:   225
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  488
Criterion check: 
Mean:  tensor(0.0731, device='cuda:0') 
Std:  tensor(332.5611, device='cuda:0') 
ABS Max:  tensor(6142.7837, device='cuda:0') 
ABS Min:  tensor(0.0060, device='cuda:0')
Criterion check:  tensor([1.0006, 0.9996, 1.0000, 1.0006, 1.0009, 1.0028, 1.0023, 1.0020, 0.9982,
        1.0181], device='cuda:0') tensor(239, device='cuda:0')
max of Lambda2 tensor(78953.4453, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3780, device='cuda:0')
min of grad d_p:  tensor(-0.4204, device='cuda:0')
max|min: (J_L, Jta/N)  (0.3780158758163452, 0.3780158758163452, ratio: 1.0)|(-0.42042598128318787, -0.42042598128318787)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.6822e-07, device='cuda:0') mean:  tensor(-5.9077e-12, device='cuda:0') min:  tensor(-2.1909e-07, device='cuda:0') norm:  tensor(2.3191e-06, device='cuda:0') MSE:  tensor(2.9223e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0012, device='cuda:0') mean:  tensor(1.5434e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0324, device='cuda:0') MSE:  tensor(4.0839e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0350, device='cuda:0')
min of d_p_list:  tensor(-0.0253, device='cuda:0')
Epoch:  225  
Training Loss: 0.20205287635326385
Test Loss:  0.23368684947490692
Test Acc:  0.0
Valid Loss:  0.19355562329292297
Valid Acc:  0.0
std:  0.06857525168225642 
thres:  0.00029007474780082704
Preserved_eigens number check:  512
 22%|██▎       | 225/1000 [1:06:33<3:10:19, 14.73s/it]Epoch:   226
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  490
Criterion check: 
Mean:  tensor(0.1608, device='cuda:0') 
Std:  tensor(6.3977, device='cuda:0') 
ABS Max:  tensor(77.3059, device='cuda:0') 
ABS Min:  tensor(0.0006, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0001, 1.0000, 1.0002, 1.0015, 1.0002,
        0.9959], device='cuda:0') tensor(157, device='cuda:0')
max of Lambda2 tensor(78809.8359, device='cuda:0')
min of Lambda2 tensor(3.4151e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3414, device='cuda:0')
min of grad d_p:  tensor(-0.3810, device='cuda:0')
max|min: (J_L, Jta/N)  (0.3413863182067871, 0.3413863778114319, ratio: 1.0000001192092896)|(-0.38100743293762207, -0.3810075521469116)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.7881e-07, device='cuda:0') mean:  tensor(-1.8973e-11, device='cuda:0') min:  tensor(-2.3842e-07, device='cuda:0') norm:  tensor(1.7678e-06, device='cuda:0') MSE:  tensor(2.2276e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(2.0321e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0042, device='cuda:0') MSE:  tensor(5.2329e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0575, device='cuda:0')
min of d_p_list:  tensor(-0.0557, device='cuda:0')
Epoch:  226  
Training Loss: 0.18080264329910278
Test Loss:  0.21014651656150818
Test Acc:  0.0
Valid Loss:  0.17301364243030548
Valid Acc:  0.0
std:  0.05847224010194201 
thres:  0.00024850454926490784
Preserved_eigens number check:  512
 23%|██▎       | 226/1000 [1:06:48<3:10:07, 14.74s/it]Epoch:   227
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  492
Criterion check: 
Mean:  tensor(1.4912, device='cuda:0') 
Std:  tensor(33.7110, device='cuda:0') 
ABS Max:  tensor(637.1677, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0001, 1.0002, 1.0008, 1.0001,
        0.9982], device='cuda:0') tensor(141, device='cuda:0')
max of Lambda2 tensor(78239.2031, device='cuda:0')
min of Lambda2 tensor(3.7666e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3079, device='cuda:0')
min of grad d_p:  tensor(-0.3453, device='cuda:0')
max|min: (J_L, Jta/N)  (0.30787885189056396, 0.30787888169288635, ratio: 1.0000001192092896)|(-0.3452846109867096, -0.3452846109867096)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.0862e-07, device='cuda:0') mean:  tensor(-1.6433e-11, device='cuda:0') min:  tensor(-2.3842e-07, device='cuda:0') norm:  tensor(1.6894e-06, device='cuda:0') MSE:  tensor(2.1288e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(1.6626e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0032, device='cuda:0') MSE:  tensor(4.0207e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0224, device='cuda:0')
min of d_p_list:  tensor(-0.0205, device='cuda:0')
Epoch:  227  
Training Loss: 0.14956443011760712
Test Loss:  0.17402923107147217
Test Acc:  0.0
Valid Loss:  0.14307649433612823
Valid Acc:  0.0
std:  0.044059819221567785 
thres:  0.00020925030410289764
Preserved_eigens number check:  512
 23%|██▎       | 227/1000 [1:07:03<3:09:52, 14.74s/it]Epoch:   228
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  492
Criterion check: 
Mean:  tensor(0.4604, device='cuda:0') 
Std:  tensor(20.2510, device='cuda:0') 
ABS Max:  tensor(310.2960, device='cuda:0') 
ABS Min:  tensor(9.5256e-05, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 0.9998, 0.9986, 0.9998,
        0.9993], device='cuda:0') tensor(135, device='cuda:0')
max of Lambda2 tensor(78208.5469, device='cuda:0')
min of Lambda2 tensor(2.4247e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2794, device='cuda:0')
min of grad d_p:  tensor(-0.3134, device='cuda:0')
max|min: (J_L, Jta/N)  (0.2793993651866913, 0.27939921617507935, ratio: 0.999999463558197)|(-0.3133849799633026, -0.3133849799633026)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.6391e-07, device='cuda:0') mean:  tensor(-3.0128e-11, device='cuda:0') min:  tensor(-2.0862e-07, device='cuda:0') norm:  tensor(1.6801e-06, device='cuda:0') MSE:  tensor(2.1171e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(9.9417e-05, device='cuda:0') mean:  tensor(9.7818e-07, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0018, device='cuda:0') MSE:  tensor(2.2741e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1045, device='cuda:0')
min of d_p_list:  tensor(-0.0758, device='cuda:0')
Epoch:  228  
Training Loss: 0.13283520936965942
Test Loss:  0.15534330904483795
Test Acc:  0.0
Valid Loss:  0.128035306930542
Valid Acc:  0.0
std:  0.03732238901144383 
thres:  0.00018059006035327913
Preserved_eigens number check:  512
 23%|██▎       | 228/1000 [1:07:17<3:09:35, 14.73s/it]Epoch:   229
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  489
Criterion check: 
Mean:  tensor(-1.4111, device='cuda:0') 
Std:  tensor(51.2288, device='cuda:0') 
ABS Max:  tensor(1064.5823, device='cuda:0') 
ABS Min:  tensor(5.4208e-05, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0000, 1.0000, 0.9999, 0.9995, 1.0000, 0.9994, 1.0001,
        0.9988], device='cuda:0') tensor(139, device='cuda:0')
max of Lambda2 tensor(77663.8125, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2557, device='cuda:0')
min of grad d_p:  tensor(-0.2862, device='cuda:0')
max|min: (J_L, Jta/N)  (0.255685031414032, 0.25568512082099915, ratio: 1.0000003576278687)|(-0.2862296402454376, -0.28622955083847046)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.8300e-07, device='cuda:0') mean:  tensor(1.0146e-11, device='cuda:0') min:  tensor(-1.3411e-07, device='cuda:0') norm:  tensor(1.3449e-06, device='cuda:0') MSE:  tensor(1.6946e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(9.8990e-05, device='cuda:0') mean:  tensor(1.3774e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0027, device='cuda:0') MSE:  tensor(3.4275e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1289, device='cuda:0')
min of d_p_list:  tensor(-0.1092, device='cuda:0')
Epoch:  229  
Training Loss: 0.10827410221099854
Test Loss:  0.1264803558588028
Test Acc:  0.0
Valid Loss:  0.10536318272352219
Valid Acc:  0.0
std:  0.03341691143036036 
thres:  0.00015470585227012634
Preserved_eigens number check:  512
 23%|██▎       | 229/1000 [1:07:32<3:09:23, 14.74s/it]Epoch:   230
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  492
Criterion check: 
Mean:  tensor(2.0164, device='cuda:0') 
Std:  tensor(235.0141, device='cuda:0') 
ABS Max:  tensor(3513.5242, device='cuda:0') 
ABS Min:  tensor(0.0034, device='cuda:0')
Criterion check:  tensor([0.9999, 1.0009, 1.0004, 0.9999, 0.9999, 0.9977, 1.0004, 1.0011, 1.0002,
        1.0155], device='cuda:0') tensor(208, device='cuda:0')
max of Lambda2 tensor(77396.5391, device='cuda:0')
min of Lambda2 tensor(1.2305e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2303, device='cuda:0')
min of grad d_p:  tensor(-0.2577, device='cuda:0')
max|min: (J_L, Jta/N)  (0.23032766580581665, 0.23032748699188232, ratio: 0.9999992251396179)|(-0.2577332854270935, -0.25773316621780396)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.7881e-07, device='cuda:0') mean:  tensor(-3.1576e-11, device='cuda:0') min:  tensor(-2.0862e-07, device='cuda:0') norm:  tensor(1.8503e-06, device='cuda:0') MSE:  tensor(2.3315e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0006, device='cuda:0') mean:  tensor(8.2746e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0161, device='cuda:0') MSE:  tensor(2.0226e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0127, device='cuda:0')
min of d_p_list:  tensor(-0.0121, device='cuda:0')
Epoch:  230  
Training Loss: 0.09200286865234375
Test Loss:  0.10774660110473633
Test Acc:  0.0
Valid Loss:  0.0889931321144104
Valid Acc:  0.0
std:  0.031148587363702185 
thres:  0.00013269585072994233
Preserved_eigens number check:  512
 23%|██▎       | 230/1000 [1:07:47<3:09:22, 14.76s/it]Epoch:   231
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  492
Criterion check: 
Mean:  tensor(-0.4425, device='cuda:0') 
Std:  tensor(12.1132, device='cuda:0') 
ABS Max:  tensor(196.7137, device='cuda:0') 
ABS Min:  tensor(0.0006, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 0.9999, 1.0000, 1.0003, 1.0000,
        1.0032], device='cuda:0') tensor(124, device='cuda:0')
max of Lambda2 tensor(77442.8672, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2093, device='cuda:0')
min of grad d_p:  tensor(-0.2345, device='cuda:0')
max|min: (J_L, Jta/N)  (0.2092912495136261, 0.2092912495136261, ratio: 1.0)|(-0.23445096611976624, -0.23445096611976624)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.6391e-07, device='cuda:0') mean:  tensor(1.4498e-11, device='cuda:0') min:  tensor(-1.9372e-07, device='cuda:0') norm:  tensor(1.4445e-06, device='cuda:0') MSE:  tensor(1.8202e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(5.9312e-05, device='cuda:0') mean:  tensor(7.8728e-07, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0016, device='cuda:0') MSE:  tensor(1.9742e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0340, device='cuda:0')
min of d_p_list:  tensor(-0.0312, device='cuda:0')
Epoch:  231  
Training Loss: 0.07543787360191345
Test Loss:  0.08837805688381195
Test Acc:  0.0
Valid Loss:  0.07257837057113647
Valid Acc:  0.0
std:  0.026814317028797257 
thres:  0.00011162289679050446
Preserved_eigens number check:  512
 23%|██▎       | 231/1000 [1:08:01<3:08:54, 14.74s/it]Epoch:   232
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  491
Criterion check: 
Mean:  tensor(-0.2285, device='cuda:0') 
Std:  tensor(18.5419, device='cuda:0') 
ABS Max:  tensor(339.1545, device='cuda:0') 
ABS Min:  tensor(4.9362e-05, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0000, 1.0000, 0.9998, 1.0001, 1.0000, 1.0031, 0.9994,
        1.0037], device='cuda:0') tensor(154, device='cuda:0')
max of Lambda2 tensor(77320.2266, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1902, device='cuda:0')
min of grad d_p:  tensor(-0.2131, device='cuda:0')
max|min: (J_L, Jta/N)  (0.19015681743621826, 0.19015684723854065, ratio: 1.0000001192092896)|(-0.21311956644058228, -0.21311955153942108)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.1921e-07, device='cuda:0') mean:  tensor(3.8198e-14, device='cuda:0') min:  tensor(-1.1921e-07, device='cuda:0') norm:  tensor(1.0409e-06, device='cuda:0') MSE:  tensor(1.3116e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(2.3193e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0053, device='cuda:0') MSE:  tensor(6.6944e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0089, device='cuda:0')
min of d_p_list:  tensor(-0.0078, device='cuda:0')
Epoch:  232  
Training Loss: 0.06361345946788788
Test Loss:  0.07465364038944244
Test Acc:  0.0
Valid Loss:  0.06093655899167061
Valid Acc:  0.0
std:  0.024424865356030362 
thres:  9.443270266056062e-05
Preserved_eigens number check:  512
 23%|██▎       | 232/1000 [1:08:16<3:08:32, 14.73s/it]Epoch:   233
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  491
Criterion check: 
Mean:  tensor(-0.6049, device='cuda:0') 
Std:  tensor(30.0710, device='cuda:0') 
ABS Max:  tensor(598.1816, device='cuda:0') 
ABS Min:  tensor(8.3812e-05, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0003, 1.0007, 1.0000, 1.0013, 0.9995,
        0.9895], device='cuda:0') tensor(159, device='cuda:0')
max of Lambda2 tensor(77368.5859, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1729, device='cuda:0')
min of grad d_p:  tensor(-0.1937, device='cuda:0')
max|min: (J_L, Jta/N)  (0.17288252711296082, 0.17288264632225037, ratio: 1.0000007152557373)|(-0.1937381625175476, -0.19373808801174164)

 check Jacobi res:  torch.Size([793601]) max:  tensor(7.4506e-08, device='cuda:0') mean:  tensor(-3.2442e-11, device='cuda:0') min:  tensor(-1.7881e-07, device='cuda:0') norm:  tensor(1.4997e-06, device='cuda:0') MSE:  tensor(1.8897e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(8.6373e-05, device='cuda:0') mean:  tensor(1.1374e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0022, device='cuda:0') MSE:  tensor(2.7446e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0205, device='cuda:0')
min of d_p_list:  tensor(-0.0140, device='cuda:0')
Epoch:  233  
Training Loss: 0.05311105400323868
Test Loss:  0.062451694160699844
Test Acc:  0.0
Valid Loss:  0.050411663949489594
Valid Acc:  0.0
std:  0.019720082021837525 
thres:  7.848787158727647e-05
Preserved_eigens number check:  512
 23%|██▎       | 233/1000 [1:08:31<3:08:26, 14.74s/it]Epoch:   234
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  490
Criterion check: 
Mean:  tensor(3.0164, device='cuda:0') 
Std:  tensor(51.4890, device='cuda:0') 
ABS Max:  tensor(850.6298, device='cuda:0') 
ABS Min:  tensor(1.8533e-05, device='cuda:0')
Criterion check:  tensor([1.0001, 1.0000, 1.0000, 1.0000, 1.0001, 0.9998, 0.9998, 0.9976, 1.0001,
        0.9957], device='cuda:0') tensor(146, device='cuda:0')
max of Lambda2 tensor(77229.3125, device='cuda:0')
min of Lambda2 tensor(3.0398e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1569, device='cuda:0')
min of grad d_p:  tensor(-0.1764, device='cuda:0')
max|min: (J_L, Jta/N)  (0.15686964988708496, 0.1568697690963745, ratio: 1.0000007152557373)|(-0.1764202117919922, -0.17642007768154144)

 check Jacobi res:  torch.Size([793601]) max:  tensor(9.6858e-08, device='cuda:0') mean:  tensor(-6.1564e-11, device='cuda:0') min:  tensor(-1.7881e-07, device='cuda:0') norm:  tensor(2.1241e-06, device='cuda:0') MSE:  tensor(2.6766e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(1.3352e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0028, device='cuda:0') MSE:  tensor(3.5362e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0499, device='cuda:0')
min of d_p_list:  tensor(-0.0209, device='cuda:0')
Epoch:  234  
Training Loss: 0.047132544219493866
Test Loss:  0.055529698729515076
Test Acc:  0.0
Valid Loss:  0.044561028480529785
Valid Acc:  0.0
std:  0.01607909930055505 
thres:  6.625955998897552e-05
Preserved_eigens number check:  512
 23%|██▎       | 234/1000 [1:08:46<3:08:05, 14.73s/it]Epoch:   235
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  490
Criterion check: 
Mean:  tensor(0.3096, device='cuda:0') 
Std:  tensor(5.1273, device='cuda:0') 
ABS Max:  tensor(60.1590, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0000, 1.0000, 0.9998, 1.0000, 1.0000, 1.0021, 1.0003,
        0.9982], device='cuda:0') tensor(128, device='cuda:0')
max of Lambda2 tensor(77275.3125, device='cuda:0')
min of Lambda2 tensor(1.8898e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1429, device='cuda:0')
min of grad d_p:  tensor(-0.1610, device='cuda:0')
max|min: (J_L, Jta/N)  (0.1428872048854828, 0.14288724958896637, ratio: 1.0000003576278687)|(-0.16095145046710968, -0.16095145046710968)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.9605e-08, device='cuda:0') mean:  tensor(-1.5010e-11, device='cuda:0') min:  tensor(-1.1921e-07, device='cuda:0') norm:  tensor(1.1909e-06, device='cuda:0') MSE:  tensor(1.5007e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(7.7572e-05, device='cuda:0') mean:  tensor(7.4431e-07, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0014, device='cuda:0') MSE:  tensor(1.8137e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0335, device='cuda:0')
min of d_p_list:  tensor(-0.0267, device='cuda:0')
Epoch:  235  
Training Loss: 0.03902880847454071
Test Loss:  0.04587119072675705
Test Acc:  0.0
Valid Loss:  0.03678487241268158
Valid Acc:  0.0
std:  0.012729751359274021 
thres:  5.5664747953414916e-05
Preserved_eigens number check:  512
 24%|██▎       | 235/1000 [1:09:00<3:07:52, 14.74s/it]Epoch:   236
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  488
Criterion check: 
Mean:  tensor(-1.2454, device='cuda:0') 
Std:  tensor(262.4008, device='cuda:0') 
ABS Max:  tensor(4159.9263, device='cuda:0') 
ABS Min:  tensor(0.0008, device='cuda:0')
Criterion check:  tensor([1.0000, 0.9967, 1.0001, 1.0005, 0.9995, 0.9955, 1.0005, 1.0088, 1.0122,
        1.1579], device='cuda:0') tensor(228, device='cuda:0')
max of Lambda2 tensor(77354.2578, device='cuda:0')
min of Lambda2 tensor(2.3071e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1288, device='cuda:0')
min of grad d_p:  tensor(-0.1460, device='cuda:0')
max|min: (J_L, Jta/N)  (0.12884673476219177, 0.12884677946567535, ratio: 1.0000003576278687)|(-0.14600655436515808, -0.14600668847560883)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.6391e-07, device='cuda:0') mean:  tensor(4.9009e-11, device='cuda:0') min:  tensor(-6.7055e-08, device='cuda:0') norm:  tensor(1.8443e-06, device='cuda:0') MSE:  tensor(2.3240e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0016, device='cuda:0') mean:  tensor(2.1054e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0425, device='cuda:0') MSE:  tensor(5.3578e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0161, device='cuda:0')
min of d_p_list:  tensor(-0.0275, device='cuda:0')
Epoch:  236  
Training Loss: 0.030717961490154266
Test Loss:  0.036204077303409576
Test Acc:  0.0
Valid Loss:  0.028759431093931198
Valid Acc:  0.0
std:  0.01132805718047199 
thres:  4.672076553106308e-05
Preserved_eigens number check:  512
 24%|██▎       | 236/1000 [1:09:15<3:07:30, 14.73s/it]Epoch:   237
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  489
Criterion check: 
Mean:  tensor(0.8724, device='cuda:0') 
Std:  tensor(97.2110, device='cuda:0') 
ABS Max:  tensor(1211.1641, device='cuda:0') 
ABS Min:  tensor(0.0006, device='cuda:0')
Criterion check:  tensor([1.0002, 0.9997, 0.9997, 1.0006, 1.0013, 1.0021, 1.0004, 0.9925, 0.9935,
        0.9757], device='cuda:0') tensor(199, device='cuda:0')
max of Lambda2 tensor(77191.0391, device='cuda:0')
min of Lambda2 tensor(4.2950e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1173, device='cuda:0')
min of grad d_p:  tensor(-0.1333, device='cuda:0')
max|min: (J_L, Jta/N)  (0.11727206408977509, 0.11727207899093628, ratio: 1.0000001192092896)|(-0.1333368420600891, -0.1333369016647339)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.1176e-07, device='cuda:0') mean:  tensor(8.5456e-12, device='cuda:0') min:  tensor(-7.8231e-08, device='cuda:0') norm:  tensor(1.1896e-06, device='cuda:0') MSE:  tensor(1.4990e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0007, device='cuda:0') mean:  tensor(9.1529e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0176, device='cuda:0') MSE:  tensor(2.2142e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0647, device='cuda:0')
min of d_p_list:  tensor(-0.0687, device='cuda:0')
Epoch:  237  
Training Loss: 0.0320432186126709
Test Loss:  0.037668757140636444
Test Acc:  0.0
Valid Loss:  0.030040699988603592
Valid Acc:  0.0
std:  0.00862966570600854 
thres:  4.0406717360019686e-05
Preserved_eigens number check:  512
 24%|██▎       | 237/1000 [1:09:30<3:07:08, 14.72s/it]Epoch:   238
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  488
Criterion check: 
Mean:  tensor(0.3127, device='cuda:0') 
Std:  tensor(18.2723, device='cuda:0') 
ABS Max:  tensor(368.4689, device='cuda:0') 
ABS Min:  tensor(0.0005, device='cuda:0')
Criterion check:  tensor([0.9998, 1.0000, 1.0000, 1.0000, 1.0002, 1.0003, 1.0002, 1.0020, 0.9995,
        1.0051], device='cuda:0') tensor(131, device='cuda:0')
max of Lambda2 tensor(77331.7969, device='cuda:0')
min of Lambda2 tensor(1.1321e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1050, device='cuda:0')
min of grad d_p:  tensor(-0.1206, device='cuda:0')
max|min: (J_L, Jta/N)  (0.10499931126832962, 0.10499921441078186, ratio: 0.9999991059303284)|(-0.12063217163085938, -0.12063220888376236)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.1176e-07, device='cuda:0') mean:  tensor(3.4851e-11, device='cuda:0') min:  tensor(-4.2841e-08, device='cuda:0') norm:  tensor(1.2523e-06, device='cuda:0') MSE:  tensor(1.5780e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(1.6690e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0034, device='cuda:0') MSE:  tensor(4.2689e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0505, device='cuda:0')
min of d_p_list:  tensor(-0.0907, device='cuda:0')
Epoch:  238  
Training Loss: 0.02069563791155815
Test Loss:  0.02426898665726185
Test Acc:  0.0
Valid Loss:  0.019255440682172775
Valid Acc:  0.0
std:  0.008824174685343314 
thres:  3.3923634141683575e-05
Preserved_eigens number check:  512
 24%|██▍       | 238/1000 [1:09:45<3:06:52, 14.71s/it]Epoch:   239
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  491
Criterion check: 
Mean:  tensor(5.1789, device='cuda:0') 
Std:  tensor(137.5277, device='cuda:0') 
ABS Max:  tensor(3020.4739, device='cuda:0') 
ABS Min:  tensor(0.0014, device='cuda:0')
Criterion check:  tensor([1.0000, 0.9998, 1.0001, 1.0001, 1.0018, 1.0035, 1.0004, 1.0251, 0.9983,
        1.0322], device='cuda:0') tensor(161, device='cuda:0')
max of Lambda2 tensor(77653.2266, device='cuda:0')
min of Lambda2 tensor(5.1069e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0987, device='cuda:0')
min of grad d_p:  tensor(-0.1139, device='cuda:0')
max|min: (J_L, Jta/N)  (0.09869687259197235, 0.09869688749313354, ratio: 1.0000001192092896)|(-0.11389975994825363, -0.11389972269535065)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.9605e-08, device='cuda:0') mean:  tensor(-7.0420e-12, device='cuda:0') min:  tensor(-6.7055e-08, device='cuda:0') norm:  tensor(6.0150e-07, device='cuda:0') MSE:  tensor(7.5794e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(5.3092e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0107, device='cuda:0') MSE:  tensor(1.3455e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0402, device='cuda:0')
min of d_p_list:  tensor(-0.0182, device='cuda:0')
Epoch:  239  
Training Loss: 0.017048662528395653
Test Loss:  0.020072264596819878
Test Acc:  0.0
Valid Loss:  0.01565565913915634
Valid Acc:  0.0
std:  0.007982626990810296 
thres:  2.7906857803463935e-05
Preserved_eigens number check:  512
 24%|██▍       | 239/1000 [1:09:59<3:06:36, 14.71s/it]Epoch:   240
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  492
Criterion check: 
Mean:  tensor(-0.5061, device='cuda:0') 
Std:  tensor(29.0932, device='cuda:0') 
ABS Max:  tensor(629.5970, device='cuda:0') 
ABS Min:  tensor(0.0006, device='cuda:0')
Criterion check:  tensor([1.0000, 0.9999, 1.0001, 1.0001, 1.0011, 1.0011, 1.0000, 1.0084, 0.9994,
        1.0063], device='cuda:0') tensor(140, device='cuda:0')
max of Lambda2 tensor(77850.3672, device='cuda:0')
min of Lambda2 tensor(2.0100e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0894, device='cuda:0')
min of grad d_p:  tensor(-0.1037, device='cuda:0')
max|min: (J_L, Jta/N)  (0.08944790065288544, 0.08944785594940186, ratio: 0.9999995231628418)|(-0.10371700674295425, -0.10371704399585724)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.8243e-08, device='cuda:0') mean:  tensor(2.6078e-11, device='cuda:0') min:  tensor(-2.9802e-08, device='cuda:0') norm:  tensor(9.9433e-07, device='cuda:0') MSE:  tensor(1.2529e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(8.4249e-05, device='cuda:0') mean:  tensor(1.1761e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0023, device='cuda:0') MSE:  tensor(2.8566e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0243, device='cuda:0')
min of d_p_list:  tensor(-0.0170, device='cuda:0')
Epoch:  240  
Training Loss: 0.015315238386392593
Test Loss:  0.01813732087612152
Test Acc:  0.0
Valid Loss:  0.01402355171740055
Valid Acc:  0.0
std:  0.006942565518905321 
thres:  2.3164143785834314e-05
Preserved_eigens number check:  512
 24%|██▍       | 240/1000 [1:10:14<3:06:14, 14.70s/it]Epoch:   241
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  493
Criterion check: 
Mean:  tensor(1.9363, device='cuda:0') 
Std:  tensor(78.2340, device='cuda:0') 
ABS Max:  tensor(1704.2554, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([1.0002, 0.9996, 1.0003, 1.0005, 1.0005, 1.0004, 0.9997, 1.0031, 1.0009,
        1.0020], device='cuda:0') tensor(167, device='cuda:0')
max of Lambda2 tensor(77805.1094, device='cuda:0')
min of Lambda2 tensor(2.8176e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0812, device='cuda:0')
min of grad d_p:  tensor(-0.0943, device='cuda:0')
max|min: (J_L, Jta/N)  (0.08115918189287186, 0.08115915954113007, ratio: 0.9999997019767761)|(-0.09428447484970093, -0.09428447484970093)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.7253e-08, device='cuda:0') mean:  tensor(-6.3560e-12, device='cuda:0') min:  tensor(-8.1956e-08, device='cuda:0') norm:  tensor(6.3234e-07, device='cuda:0') MSE:  tensor(7.9680e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(2.4378e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0046, device='cuda:0') MSE:  tensor(5.7645e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0223, device='cuda:0')
min of d_p_list:  tensor(-0.0215, device='cuda:0')
Epoch:  241  
Training Loss: 0.013096343725919724
Test Loss:  0.015554120764136314
Test Acc:  0.0
Valid Loss:  0.011897440068423748
Valid Acc:  0.0
std:  0.006681200992815991 
thres:  1.9639820232987403e-05
Preserved_eigens number check:  512
 24%|██▍       | 241/1000 [1:10:29<3:05:59, 14.70s/it]Epoch:   242
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  492
Criterion check: 
Mean:  tensor(1.1220, device='cuda:0') 
Std:  tensor(107.1925, device='cuda:0') 
ABS Max:  tensor(1212.5396, device='cuda:0') 
ABS Min:  tensor(0.0055, device='cuda:0')
Criterion check:  tensor([0.9994, 0.9993, 1.0004, 1.0013, 0.9940, 0.9970, 1.0014, 0.9777, 0.9906,
        0.9820], device='cuda:0') tensor(211, device='cuda:0')
max of Lambda2 tensor(77850.9453, device='cuda:0')
min of Lambda2 tensor(1.0057e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0738, device='cuda:0')
min of grad d_p:  tensor(-0.0864, device='cuda:0')
max|min: (J_L, Jta/N)  (0.0738070011138916, 0.07380697876214981, ratio: 0.9999997019767761)|(-0.08635938167572021, -0.08635932207107544)

 check Jacobi res:  torch.Size([793601]) max:  tensor(7.1712e-08, device='cuda:0') mean:  tensor(-1.7595e-11, device='cuda:0') min:  tensor(-1.0431e-07, device='cuda:0') norm:  tensor(1.1367e-06, device='cuda:0') MSE:  tensor(1.4324e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0008, device='cuda:0') mean:  tensor(8.1421e-06, device='cuda:0') min:  tensor(6.9779e-16, device='cuda:0') norm:  tensor(0.0153, device='cuda:0') MSE:  tensor(1.9288e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0186, device='cuda:0')
min of d_p_list:  tensor(-0.0144, device='cuda:0')
Epoch:  242  
Training Loss: 0.011355249211192131
Test Loss:  0.01347380131483078
Test Acc:  0.0
Valid Loss:  0.010327007621526718
Valid Acc:  0.0
std:  0.003236777520644796 
thres:  1.550222635269165e-05
Preserved_eigens number check:  512
 24%|██▍       | 242/1000 [1:10:43<3:05:47, 14.71s/it]Epoch:   243
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  492
Criterion check: 
Mean:  tensor(6.1995, device='cuda:0') 
Std:  tensor(66.6480, device='cuda:0') 
ABS Max:  tensor(715.8043, device='cuda:0') 
ABS Min:  tensor(0.0010, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0004, 1.0002, 0.9997, 0.9991, 1.0023, 1.0005, 0.9984, 0.9990,
        1.0042], device='cuda:0') tensor(150, device='cuda:0')
max of Lambda2 tensor(77956.7109, device='cuda:0')
min of Lambda2 tensor(5.5070e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0672, device='cuda:0')
min of grad d_p:  tensor(-0.0787, device='cuda:0')
max|min: (J_L, Jta/N)  (0.06721530854701996, 0.06721530854701996, ratio: 1.0)|(-0.07866689562797546, -0.07866692543029785)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.0058e-07, device='cuda:0') mean:  tensor(5.0523e-12, device='cuda:0') min:  tensor(-6.7055e-08, device='cuda:0') norm:  tensor(1.3108e-06, device='cuda:0') MSE:  tensor(1.6517e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(3.8991e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0078, device='cuda:0') MSE:  tensor(9.7719e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1310, device='cuda:0')
min of d_p_list:  tensor(-0.1369, device='cuda:0')
Epoch:  243  
Training Loss: 0.010940568521618843
Test Loss:  0.012202337384223938
Test Acc:  0.0
Valid Loss:  0.010000774636864662
Valid Acc:  0.0
std:  0.002331890493924227 
thres:  1.3551212474703789e-05
Preserved_eigens number check:  512
 24%|██▍       | 243/1000 [1:10:58<3:06:01, 14.74s/it]Epoch:   244
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  495
Criterion check: 
Mean:  tensor(-4.8481, device='cuda:0') 
Std:  tensor(154.9166, device='cuda:0') 
ABS Max:  tensor(1923.8525, device='cuda:0') 
ABS Min:  tensor(0.0074, device='cuda:0')
Criterion check:  tensor([0.9975, 0.9995, 0.9994, 0.9995, 1.1682, 0.9922, 1.0036, 1.0080, 0.9987,
        1.0041], device='cuda:0') tensor(202, device='cuda:0')
max of Lambda2 tensor(77847.3516, device='cuda:0')
min of Lambda2 tensor(1.1459e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0561, device='cuda:0')
min of grad d_p:  tensor(-0.0881, device='cuda:0')
max|min: (J_L, Jta/N)  (0.05609710142016411, 0.056097108870744705, ratio: 1.0000001192092896)|(-0.08813279867172241, -0.0881328284740448)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.9407e-08, device='cuda:0') mean:  tensor(1.3936e-11, device='cuda:0') min:  tensor(-3.3528e-08, device='cuda:0') norm:  tensor(7.9696e-07, device='cuda:0') MSE:  tensor(1.0042e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0012, device='cuda:0') mean:  tensor(1.6263e-05, device='cuda:0') min:  tensor(5.6725e-15, device='cuda:0') norm:  tensor(0.0312, device='cuda:0') MSE:  tensor(3.9279e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(7.3766, device='cuda:0')
min of d_p_list:  tensor(-4.7866, device='cuda:0')
Epoch:  244  
Training Loss: 220.97259521484375
Test Loss:  241.70318603515625
Test Acc:  0.0
Valid Loss:  256.47222900390625
Valid Acc:  0.0
std:  88.38396735941512 
thres:  0.044204660522937776
Preserved_eigens number check:  512
 24%|██▍       | 244/1000 [1:11:13<3:05:45, 14.74s/it]Epoch:   245
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  494
Criterion check: 
Mean:  tensor(12.8625, device='cuda:0') 
Std:  tensor(262.3897, device='cuda:0') 
ABS Max:  tensor(5262.5361, device='cuda:0') 
ABS Min:  tensor(0.0110, device='cuda:0')
Criterion check:  tensor([1.0002, 0.9999, 1.0001, 0.9999, 1.0000, 0.9990, 0.9895, 1.0183, 0.9869,
        0.9941], device='cuda:0') tensor(240, device='cuda:0')
max of Lambda2 tensor(74612.7422, device='cuda:0')
min of Lambda2 tensor(2.7429e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(3.1938, device='cuda:0')
min of grad d_p:  tensor(-1.0710, device='cuda:0')
max|min: (J_L, Jta/N)  (3.1937551498413086, 3.193755626678467, ratio: 1.0000001192092896)|(-1.0710058212280273, -1.0710057020187378)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(3.9028e-08, device='cuda:0') min:  tensor(-0.0002, device='cuda:0') norm:  tensor(0.0023, device='cuda:0') MSE:  tensor(2.8406e-09, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(3.3827e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0068, device='cuda:0') MSE:  tensor(8.6255e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0738, device='cuda:0')
min of d_p_list:  tensor(-0.0600, device='cuda:0')
Epoch:  245  
Training Loss: 23.941669464111328
Test Loss:  26.278858184814453
Test Acc:  0.0
Valid Loss:  24.845972061157227
Valid Acc:  0.0
std:  86.489334505032 
thres:  0.048989931368082766
Preserved_eigens number check:  512
 24%|██▍       | 245/1000 [1:11:28<3:05:19, 14.73s/it]Epoch:   246
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  495
Criterion check: 
Mean:  tensor(2.2511, device='cuda:0') 
Std:  tensor(66.4815, device='cuda:0') 
ABS Max:  tensor(1164.8938, device='cuda:0') 
ABS Min:  tensor(0.0004, device='cuda:0')
Criterion check:  tensor([1.0001, 1.0000, 0.9999, 1.0000, 1.0000, 0.9997, 1.0001, 0.9999, 1.0006,
        0.9958], device='cuda:0') tensor(203, device='cuda:0')
max of Lambda2 tensor(74237.6172, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(2.8946, device='cuda:0')
min of grad d_p:  tensor(-0.9711, device='cuda:0')
max|min: (J_L, Jta/N)  (2.8946032524108887, 2.894603967666626, ratio: 1.000000238418579)|(-0.9710673093795776, -0.9710674285888672)

 check Jacobi res:  torch.Size([793601]) max:  tensor(9.5367e-07, device='cuda:0') mean:  tensor(-3.4901e-11, device='cuda:0') min:  tensor(-1.1921e-06, device='cuda:0') norm:  tensor(8.6405e-06, device='cuda:0') MSE:  tensor(1.0888e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0012, device='cuda:0') mean:  tensor(1.1820e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0224, device='cuda:0') MSE:  tensor(2.8236e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0459, device='cuda:0')
min of d_p_list:  tensor(-0.0624, device='cuda:0')
Epoch:  246  
Training Loss: 11.832196235656738
Test Loss:  13.046156883239746
Test Acc:  0.0
Valid Loss:  11.877779960632324
Valid Acc:  0.0
std:  85.27139450288587 
thres:  0.051353751346468926
Preserved_eigens number check:  512
 25%|██▍       | 246/1000 [1:11:42<3:05:05, 14.73s/it]Epoch:   247
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  493
Criterion check: 
Mean:  tensor(4.1574, device='cuda:0') 
Std:  tensor(89.5125, device='cuda:0') 
ABS Max:  tensor(1944.3407, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 0.9999, 1.0000, 0.9991, 1.0000,
        0.9994], device='cuda:0') tensor(163, device='cuda:0')
max of Lambda2 tensor(75023.9609, device='cuda:0')
min of Lambda2 tensor(1.6389e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(2.6275, device='cuda:0')
min of grad d_p:  tensor(-0.8803, device='cuda:0')
max|min: (J_L, Jta/N)  (2.6275382041931152, 2.6275393962860107, ratio: 1.0000004768371582)|(-0.8802686929702759, -0.8802687525749207)

 check Jacobi res:  torch.Size([793601]) max:  tensor(9.5367e-07, device='cuda:0') mean:  tensor(-2.3521e-11, device='cuda:0') min:  tensor(-1.1921e-06, device='cuda:0') norm:  tensor(8.2267e-06, device='cuda:0') MSE:  tensor(1.0366e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0007, device='cuda:0') mean:  tensor(3.3996e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0065, device='cuda:0') MSE:  tensor(8.2043e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(5.0380, device='cuda:0')
min of d_p_list:  tensor(-4.1593, device='cuda:0')
Epoch:  247  
Training Loss: 3.079768180847168
Test Loss:  3.269289016723633
Test Acc:  0.0
Valid Loss:  2.8434290885925293
Valid Acc:  0.0
std:  84.90995982146875 
thres:  0.05196743393279612
Preserved_eigens number check:  512
 25%|██▍       | 247/1000 [1:11:57<3:04:30, 14.70s/it]Epoch:   248
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  487
Criterion check: 
Mean:  tensor(11.8984, device='cuda:0') 
Std:  tensor(270.7259, device='cuda:0') 
ABS Max:  tensor(6098.8540, device='cuda:0') 
ABS Min:  tensor(0.0008, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0000, 1.0000, 0.9999, 0.9962, 1.0001, 1.0006, 0.9988,
        0.9903], device='cuda:0') tensor(161, device='cuda:0')
max of Lambda2 tensor(72581.4844, device='cuda:0')
min of Lambda2 tensor(3.4833e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.6532, device='cuda:0')
min of grad d_p:  tensor(-0.8454, device='cuda:0')
max|min: (J_L, Jta/N)  (1.6532076597213745, 1.6532073020935059, ratio: 0.9999997615814209)|(-0.8453747630119324, -0.8453746438026428)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.9605e-07, device='cuda:0') mean:  tensor(-1.4567e-11, device='cuda:0') min:  tensor(-5.9605e-07, device='cuda:0') norm:  tensor(5.0251e-06, device='cuda:0') MSE:  tensor(6.3320e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(3.1253e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0056, device='cuda:0') MSE:  tensor(6.9939e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0415, device='cuda:0')
min of d_p_list:  tensor(-0.0592, device='cuda:0')
Epoch:  248  
Training Loss: 2.7231550216674805
Test Loss:  2.8980345726013184
Test Acc:  0.0
Valid Loss:  2.721130847930908
Valid Acc:  0.0
std:  84.5843448467083 
thres:  0.0525098768234253
Preserved_eigens number check:  512
 25%|██▍       | 248/1000 [1:12:12<3:04:26, 14.72s/it]Epoch:   249
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  489
Criterion check: 
Mean:  tensor(-0.5111, device='cuda:0') 
Std:  tensor(20.4361, device='cuda:0') 
ABS Max:  tensor(291.2251, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 0.9996, 1.0000, 0.9993, 0.9993,
        1.0101], device='cuda:0') tensor(134, device='cuda:0')
max of Lambda2 tensor(72879.1953, device='cuda:0')
min of Lambda2 tensor(1.0796e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.4995, device='cuda:0')
min of grad d_p:  tensor(-0.7677, device='cuda:0')
max|min: (J_L, Jta/N)  (1.499544382095337, 1.4995452165603638, ratio: 1.0000005960464478)|(-0.7677404880523682, -0.7677404880523682)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.7684e-07, device='cuda:0') mean:  tensor(1.1851e-11, device='cuda:0') min:  tensor(-8.3447e-07, device='cuda:0') norm:  tensor(4.7681e-06, device='cuda:0') MSE:  tensor(6.0081e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(1.6550e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0030, device='cuda:0') MSE:  tensor(3.7940e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.3458, device='cuda:0')
min of d_p_list:  tensor(-0.6717, device='cuda:0')
Epoch:  249  
Training Loss: 2.2213022708892822
Test Loss:  2.3979949951171875
Test Acc:  0.0
Valid Loss:  2.2175416946411133
Valid Acc:  0.0
std:  8.383132773654516 
thres:  0.008759618234634399
Preserved_eigens number check:  512
 25%|██▍       | 249/1000 [1:12:26<3:04:22, 14.73s/it]Epoch:   250
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  491
Criterion check: 
Mean:  tensor(0.3970, device='cuda:0') 
Std:  tensor(50.7146, device='cuda:0') 
ABS Max:  tensor(683.7567, device='cuda:0') 
ABS Min:  tensor(0.0005, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0002, 1.0000, 0.9999, 1.0006, 1.0000, 0.9999, 1.0021,
        1.0048], device='cuda:0') tensor(198, device='cuda:0')
max of Lambda2 tensor(74546.7578, device='cuda:0')
min of Lambda2 tensor(2.5791e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.4717, device='cuda:0')
min of grad d_p:  tensor(-0.7420, device='cuda:0')
max|min: (J_L, Jta/N)  (1.4716591835021973, 1.4716591835021973, ratio: 1.0)|(-0.741980791091919, -0.741980791091919)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.9605e-07, device='cuda:0') mean:  tensor(4.8209e-11, device='cuda:0') min:  tensor(-4.7684e-07, device='cuda:0') norm:  tensor(4.3440e-06, device='cuda:0') MSE:  tensor(5.4738e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0007, device='cuda:0') mean:  tensor(7.3958e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0139, device='cuda:0') MSE:  tensor(1.7544e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0339, device='cuda:0')
min of d_p_list:  tensor(-0.0346, device='cuda:0')
Epoch:  250  
Training Loss: 1.7398366928100586
Test Loss:  1.8866887092590332
Test Acc:  0.0
Valid Loss:  1.744449257850647
Valid Acc:  0.0
std:  3.7837270827350302 
thres:  0.0043192516803741456
Preserved_eigens number check:  512
 25%|██▌       | 250/1000 [1:12:41<3:04:43, 14.78s/it]Epoch:   251
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  490
Criterion check: 
Mean:  tensor(-1.7323, device='cuda:0') 
Std:  tensor(33.7062, device='cuda:0') 
ABS Max:  tensor(419.1445, device='cuda:0') 
ABS Min:  tensor(6.9494e-05, device='cuda:0')
Criterion check:  tensor([0.9999, 1.0000, 1.0001, 1.0000, 1.0000, 1.0006, 1.0001, 1.0000, 1.0003,
        0.9956], device='cuda:0') tensor(170, device='cuda:0')
max of Lambda2 tensor(74522.6953, device='cuda:0')
min of Lambda2 tensor(1.5930e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.3396, device='cuda:0')
min of grad d_p:  tensor(-0.6746, device='cuda:0')
max|min: (J_L, Jta/N)  (1.3396191596984863, 1.3396191596984863, ratio: 1.0)|(-0.6745704412460327, -0.6745708584785461)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.9605e-07, device='cuda:0') mean:  tensor(1.9161e-11, device='cuda:0') min:  tensor(-5.9605e-07, device='cuda:0') norm:  tensor(4.1267e-06, device='cuda:0') MSE:  tensor(5.1999e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(2.7808e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0053, device='cuda:0') MSE:  tensor(6.6653e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0363, device='cuda:0')
min of d_p_list:  tensor(-0.0561, device='cuda:0')
Epoch:  251  
Training Loss: 1.392880916595459
Test Loss:  1.5158592462539673
Test Acc:  0.0
Valid Loss:  1.381386399269104
Valid Acc:  0.0
std:  0.6174791127323258 
thres:  0.0022313886165618896
Preserved_eigens number check:  512
 25%|██▌       | 251/1000 [1:12:56<3:05:37, 14.87s/it]Epoch:   252
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  492
Criterion check: 
Mean:  tensor(-53.0608, device='cuda:0') 
Std:  tensor(1490.5004, device='cuda:0') 
ABS Max:  tensor(33090.7500, device='cuda:0') 
ABS Min:  tensor(0.0040, device='cuda:0')
Criterion check:  tensor([0.9997, 0.9999, 0.9996, 0.9999, 1.0005, 0.9972, 1.0021, 0.9693, 1.0017,
        1.0668], device='cuda:0') tensor(201, device='cuda:0')
max of Lambda2 tensor(74182.7344, device='cuda:0')
min of Lambda2 tensor(4.6159e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.2353, device='cuda:0')
min of grad d_p:  tensor(-0.6140, device='cuda:0')
max|min: (J_L, Jta/N)  (1.235331416130066, 1.235331416130066, ratio: 1.0)|(-0.6140025854110718, -0.6140023469924927)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.1723e-07, device='cuda:0') mean:  tensor(-1.9146e-12, device='cuda:0') min:  tensor(-5.3644e-07, device='cuda:0') norm:  tensor(3.4005e-06, device='cuda:0') MSE:  tensor(4.2848e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0029, device='cuda:0') mean:  tensor(2.2179e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0426, device='cuda:0') MSE:  tensor(5.3638e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1749, device='cuda:0')
min of d_p_list:  tensor(-0.1792, device='cuda:0')
Epoch:  252  
Training Loss: 1.151621699333191
Test Loss:  1.2660961151123047
Test Acc:  0.0
Valid Loss:  1.1461613178253174
Valid Acc:  0.0
std:  0.5672743979615588 
thres:  0.0018457593202590944
Preserved_eigens number check:  512
 25%|██▌       | 252/1000 [1:13:11<3:05:16, 14.86s/it]Epoch:   253
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  488
Criterion check: 
Mean:  tensor(-2.5240, device='cuda:0') 
Std:  tensor(106.6379, device='cuda:0') 
ABS Max:  tensor(1842.8722, device='cuda:0') 
ABS Min:  tensor(0.0007, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0002, 0.9996, 0.9999, 0.9989, 1.0017,
        1.0099], device='cuda:0') tensor(168, device='cuda:0')
max of Lambda2 tensor(74411.9453, device='cuda:0')
min of Lambda2 tensor(3.7261e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.1375, device='cuda:0')
min of grad d_p:  tensor(-0.5525, device='cuda:0')
max|min: (J_L, Jta/N)  (1.1375296115875244, 1.1375294923782349, ratio: 0.9999998807907104)|(-0.552480161190033, -0.5524799823760986)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.9605e-07, device='cuda:0') mean:  tensor(1.0303e-11, device='cuda:0') min:  tensor(-4.1723e-07, device='cuda:0') norm:  tensor(3.6009e-06, device='cuda:0') MSE:  tensor(4.5374e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0010, device='cuda:0') mean:  tensor(5.2886e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0104, device='cuda:0') MSE:  tensor(1.3068e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0656, device='cuda:0')
min of d_p_list:  tensor(-0.1089, device='cuda:0')
Epoch:  253  
Training Loss: 0.9416117668151855
Test Loss:  1.0382397174835205
Test Acc:  0.0
Valid Loss:  0.9458549618721008
Valid Acc:  0.0
std:  0.4520799753760378 
thres:  0.0014894506692886354
Preserved_eigens number check:  512
 25%|██▌       | 253/1000 [1:13:26<3:04:49, 14.85s/it]Epoch:   254
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  491
Criterion check: 
Mean:  tensor(-5.5282, device='cuda:0') 
Std:  tensor(110.4936, device='cuda:0') 
ABS Max:  tensor(1461.5212, device='cuda:0') 
ABS Min:  tensor(0.0005, device='cuda:0')
Criterion check:  tensor([0.9999, 1.0001, 1.0002, 1.0000, 0.9992, 1.0042, 1.0013, 0.9156, 1.0060,
        1.0092], device='cuda:0') tensor(217, device='cuda:0')
max of Lambda2 tensor(74549.7969, device='cuda:0')
min of Lambda2 tensor(3.5747e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.0013, device='cuda:0')
min of grad d_p:  tensor(-0.5038, device='cuda:0')
max|min: (J_L, Jta/N)  (1.0013294219970703, 1.0013290643692017, ratio: 0.9999996423721313)|(-0.5038381814956665, -0.5038381814956665)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.5763e-07, device='cuda:0') mean:  tensor(-3.0201e-12, device='cuda:0') min:  tensor(-4.7684e-07, device='cuda:0') norm:  tensor(3.3128e-06, device='cuda:0') MSE:  tensor(4.1744e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0018, device='cuda:0') mean:  tensor(2.4383e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0473, device='cuda:0') MSE:  tensor(5.9578e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0394, device='cuda:0')
min of d_p_list:  tensor(-0.0296, device='cuda:0')
Epoch:  254  
Training Loss: 0.7820031642913818
Test Loss:  0.863877534866333
Test Acc:  0.0
Valid Loss:  0.7806199789047241
Valid Acc:  0.0
std:  0.3383608554755406 
thres:  0.0012015908479690552
Preserved_eigens number check:  512
 25%|██▌       | 254/1000 [1:13:41<3:04:09, 14.81s/it]Epoch:   255
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  488
Criterion check: 
Mean:  tensor(-0.9416, device='cuda:0') 
Std:  tensor(30.4319, device='cuda:0') 
ABS Max:  tensor(415.1009, device='cuda:0') 
ABS Min:  tensor(0.0008, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 0.9999, 1.0000, 0.9999, 0.9999, 1.0000, 1.0067, 1.0030,
        1.0031], device='cuda:0') tensor(163, device='cuda:0')
max of Lambda2 tensor(74246.8906, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.8919, device='cuda:0')
min of grad d_p:  tensor(-0.4586, device='cuda:0')
max|min: (J_L, Jta/N)  (0.8919488191604614, 0.891948938369751, ratio: 1.0000001192092896)|(-0.45861709117889404, -0.45861706137657166)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.1723e-07, device='cuda:0') mean:  tensor(-5.1626e-12, device='cuda:0') min:  tensor(-4.1723e-07, device='cuda:0') norm:  tensor(2.9172e-06, device='cuda:0') MSE:  tensor(3.6759e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(3.8662e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0075, device='cuda:0') MSE:  tensor(9.4897e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.4981, device='cuda:0')
min of d_p_list:  tensor(-0.3887, device='cuda:0')
Epoch:  255  
Training Loss: 0.7555521726608276
Test Loss:  0.8294174075126648
Test Acc:  0.0
Valid Loss:  0.7301411032676697
Valid Acc:  0.0
std:  0.23996626831774964 
thres:  0.001004733943939209
Preserved_eigens number check:  512
 26%|██▌       | 255/1000 [1:13:56<3:03:34, 14.78s/it]Epoch:   256
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  492
Criterion check: 
Mean:  tensor(-0.7697, device='cuda:0') 
Std:  tensor(22.7750, device='cuda:0') 
ABS Max:  tensor(493.8235, device='cuda:0') 
ABS Min:  tensor(0.0006, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0001, 1.0000, 1.0000, 1.0001, 0.9998, 0.9999, 0.9992,
        1.0000], device='cuda:0') tensor(161, device='cuda:0')
max of Lambda2 tensor(77864.2188, device='cuda:0')
min of Lambda2 tensor(6.0825e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.9931, device='cuda:0')
min of grad d_p:  tensor(-0.4010, device='cuda:0')
max|min: (J_L, Jta/N)  (0.9931167364120483, 0.9931164979934692, ratio: 0.9999997615814209)|(-0.40097975730895996, -0.4009797275066376)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.3644e-07, device='cuda:0') mean:  tensor(5.9770e-11, device='cuda:0') min:  tensor(-2.3842e-07, device='cuda:0') norm:  tensor(3.4901e-06, device='cuda:0') MSE:  tensor(4.3978e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(1.6192e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0031, device='cuda:0') MSE:  tensor(3.9154e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0412, device='cuda:0')
min of d_p_list:  tensor(-0.0500, device='cuda:0')
Epoch:  256  
Training Loss: 0.6110435128211975
Test Loss:  0.6724724769592285
Test Acc:  0.0
Valid Loss:  0.5896618962287903
Valid Acc:  0.0
std:  0.1843904485787209 
thres:  0.0008483664631843567
Preserved_eigens number check:  512
 26%|██▌       | 256/1000 [1:14:10<3:03:04, 14.76s/it]Epoch:   257
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  490
Criterion check: 
Mean:  tensor(-1.0631, device='cuda:0') 
Std:  tensor(64.1299, device='cuda:0') 
ABS Max:  tensor(1048.5804, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([1.0001, 1.0000, 1.0001, 1.0000, 1.0000, 1.0002, 0.9998, 0.9998, 1.0124,
        1.0004], device='cuda:0') tensor(165, device='cuda:0')
max of Lambda2 tensor(77671.7578, device='cuda:0')
min of Lambda2 tensor(1.8955e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.9002, device='cuda:0')
min of grad d_p:  tensor(-0.3600, device='cuda:0')
max|min: (J_L, Jta/N)  (0.9001719951629639, 0.9001719951629639, ratio: 1.0)|(-0.3600328266620636, -0.36003267765045166)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.3842e-07, device='cuda:0') mean:  tensor(-6.3250e-11, device='cuda:0') min:  tensor(-4.1723e-07, device='cuda:0') norm:  tensor(3.6978e-06, device='cuda:0') MSE:  tensor(4.6595e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(3.7325e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0071, device='cuda:0') MSE:  tensor(8.9253e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.8482, device='cuda:0')
min of d_p_list:  tensor(-0.5291, device='cuda:0')
Epoch:  257  
Training Loss: 0.8733919858932495
Test Loss:  0.96149742603302
Test Acc:  0.0
Valid Loss:  0.8535423278808594
Valid Acc:  0.0
std:  0.11240940483990054 
thres:  0.0007927205204963685
Preserved_eigens number check:  512
 26%|██▌       | 257/1000 [1:14:25<3:02:40, 14.75s/it]Epoch:   258
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  490
Criterion check: 
Mean:  tensor(0.2783, device='cuda:0') 
Std:  tensor(10.1680, device='cuda:0') 
ABS Max:  tensor(111.6405, device='cuda:0') 
ABS Min:  tensor(1.1141e-05, device='cuda:0')
Criterion check:  tensor([1.0001, 1.0000, 1.0000, 1.0000, 0.9998, 1.0000, 0.9999, 1.0003, 0.9910,
        0.9970], device='cuda:0') tensor(164, device='cuda:0')
max of Lambda2 tensor(75342.8906, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.8595, device='cuda:0')
min of grad d_p:  tensor(-0.5074, device='cuda:0')
max|min: (J_L, Jta/N)  (0.859548807144165, 0.8595487475395203, ratio: 0.9999999403953552)|(-0.5073642730712891, -0.5073641538619995)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.3842e-07, device='cuda:0') mean:  tensor(-4.3382e-11, device='cuda:0') min:  tensor(-4.7684e-07, device='cuda:0') norm:  tensor(3.0934e-06, device='cuda:0') MSE:  tensor(3.8979e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(2.6046e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0051, device='cuda:0') MSE:  tensor(6.4421e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0552, device='cuda:0')
min of d_p_list:  tensor(-0.0324, device='cuda:0')
Epoch:  258  
Training Loss: 0.6874904632568359
Test Loss:  0.7534242868423462
Test Acc:  0.0
Valid Loss:  0.6848500967025757
Valid Acc:  0.0
std:  0.08850831126411679 
thres:  0.0007418962597846986
Preserved_eigens number check:  512
 26%|██▌       | 258/1000 [1:14:40<3:02:22, 14.75s/it]Epoch:   259
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  491
Criterion check: 
Mean:  tensor(0.7611, device='cuda:0') 
Std:  tensor(18.2136, device='cuda:0') 
ABS Max:  tensor(183.9970, device='cuda:0') 
ABS Min:  tensor(0.0026, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 0.9999, 1.0000, 1.0001, 1.0000, 0.9994, 1.0006, 0.8614,
        0.9865], device='cuda:0') tensor(178, device='cuda:0')
max of Lambda2 tensor(75006.1562, device='cuda:0')
min of Lambda2 tensor(3.7125e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.7822, device='cuda:0')
min of grad d_p:  tensor(-0.4608, device='cuda:0')
max|min: (J_L, Jta/N)  (0.7821515798568726, 0.7821516990661621, ratio: 1.0000001192092896)|(-0.4607711136341095, -0.4607710540294647)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.1723e-07, device='cuda:0') mean:  tensor(-1.7272e-11, device='cuda:0') min:  tensor(-4.1723e-07, device='cuda:0') norm:  tensor(2.7624e-06, device='cuda:0') MSE:  tensor(3.4808e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0008, device='cuda:0') mean:  tensor(7.1707e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0140, device='cuda:0') MSE:  tensor(1.7593e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0225, device='cuda:0')
min of d_p_list:  tensor(-0.0228, device='cuda:0')
Epoch:  259  
Training Loss: 0.5564035177230835
Test Loss:  0.6095969676971436
Test Acc:  0.0
Valid Loss:  0.5602521896362305
Valid Acc:  0.0
std:  0.1111652457166441 
thres:  0.0006967763304710389
Preserved_eigens number check:  512
 26%|██▌       | 259/1000 [1:14:54<3:01:59, 14.74s/it]Epoch:   260
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  489
Criterion check: 
Mean:  tensor(-60.2435, device='cuda:0') 
Std:  tensor(1376.3606, device='cuda:0') 
ABS Max:  tensor(28927.4805, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0001, 0.9999, 1.0000, 1.0011, 0.9977, 1.0009, 0.9936, 1.8613,
        0.9595], device='cuda:0') tensor(221, device='cuda:0')
max of Lambda2 tensor(74843.3125, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.7106, device='cuda:0')
min of grad d_p:  tensor(-0.4195, device='cuda:0')
max|min: (J_L, Jta/N)  (0.7106009125709534, 0.7106006741523743, ratio: 0.9999996423721313)|(-0.41945868730545044, -0.4194587171077728)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.9802e-07, device='cuda:0') mean:  tensor(1.5645e-11, device='cuda:0') min:  tensor(-2.9802e-07, device='cuda:0') norm:  tensor(2.3735e-06, device='cuda:0') MSE:  tensor(2.9908e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0025, device='cuda:0') mean:  tensor(2.2182e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0427, device='cuda:0') MSE:  tensor(5.3779e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1456, device='cuda:0')
min of d_p_list:  tensor(-0.1329, device='cuda:0')
Epoch:  260  
Training Loss: 0.4769463837146759
Test Loss:  0.5260083675384521
Test Acc:  0.0
Valid Loss:  0.48428207635879517
Valid Acc:  0.0
std:  0.13500735388498966 
thres:  0.0006410551726818085
Preserved_eigens number check:  512
 26%|██▌       | 260/1000 [1:15:09<3:01:47, 14.74s/it]Epoch:   261
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  491
Criterion check: 
Mean:  tensor(-166.6839, device='cuda:0') 
Std:  tensor(3386.1509, device='cuda:0') 
ABS Max:  tensor(74604.8516, device='cuda:0') 
ABS Min:  tensor(0.0073, device='cuda:0')
Criterion check:  tensor([0.9995, 1.0003, 1.0007, 0.9999, 0.9974, 0.9982, 0.9957, 0.9954, 1.0345,
        4.7612], device='cuda:0') tensor(235, device='cuda:0')
max of Lambda2 tensor(75387.7500, device='cuda:0')
min of Lambda2 tensor(1.7724e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.6504, device='cuda:0')
min of grad d_p:  tensor(-0.3742, device='cuda:0')
max|min: (J_L, Jta/N)  (0.6503864526748657, 0.650386393070221, ratio: 0.9999998807907104)|(-0.37415555119514465, -0.3741554021835327)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.3842e-07, device='cuda:0') mean:  tensor(-3.8661e-11, device='cuda:0') min:  tensor(-3.2783e-07, device='cuda:0') norm:  tensor(2.7422e-06, device='cuda:0') MSE:  tensor(3.4554e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0042, device='cuda:0') mean:  tensor(2.9355e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0571, device='cuda:0') MSE:  tensor(7.1997e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.4226, device='cuda:0')
min of d_p_list:  tensor(-0.2887, device='cuda:0')
Epoch:  261  
Training Loss: 0.45165181159973145
Test Loss:  0.49092549085617065
Test Acc:  0.0
Valid Loss:  0.46480974555015564
Valid Acc:  0.0
std:  0.15558066627513728 
thres:  0.0006091768324375153
Preserved_eigens number check:  512
 26%|██▌       | 261/1000 [1:15:24<3:01:20, 14.72s/it]Epoch:   262
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  490
Criterion check: 
Mean:  tensor(3.9001, device='cuda:0') 
Std:  tensor(79.0367, device='cuda:0') 
ABS Max:  tensor(1618.0760, device='cuda:0') 
ABS Min:  tensor(0.0007, device='cuda:0')
Criterion check:  tensor([0.9998, 1.0001, 1.0004, 1.0000, 1.0016, 0.9995, 1.0004, 0.9953, 0.9479,
        1.0018], device='cuda:0') tensor(190, device='cuda:0')
max of Lambda2 tensor(76263.7500, device='cuda:0')
min of Lambda2 tensor(1.9249e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.6073, device='cuda:0')
min of grad d_p:  tensor(-0.3439, device='cuda:0')
max|min: (J_L, Jta/N)  (0.6072760820388794, 0.607276201248169, ratio: 1.000000238418579)|(-0.34386616945266724, -0.34386616945266724)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.4901e-07, device='cuda:0') mean:  tensor(-2.2904e-11, device='cuda:0') min:  tensor(-3.5763e-07, device='cuda:0') norm:  tensor(2.1934e-06, device='cuda:0') MSE:  tensor(2.7639e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(4.7415e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0094, device='cuda:0') MSE:  tensor(1.1878e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0772, device='cuda:0')
min of d_p_list:  tensor(-0.0751, device='cuda:0')
Epoch:  262  
Training Loss: 0.35865676403045654
Test Loss:  0.38611334562301636
Test Acc:  0.0
Valid Loss:  0.3700674772262573
Valid Acc:  0.0
std:  0.11044175499048411 
thres:  0.0005062297880649567
Preserved_eigens number check:  512
 26%|██▌       | 262/1000 [1:15:39<3:01:08, 14.73s/it]Epoch:   263
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  486
Criterion check: 
Mean:  tensor(-3.1514, device='cuda:0') 
Std:  tensor(57.0863, device='cuda:0') 
ABS Max:  tensor(944.5724, device='cuda:0') 
ABS Min:  tensor(0.0016, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0006, 1.0003, 1.0001, 1.0007, 1.0000, 0.9981, 0.9977, 0.9610,
        1.0014], device='cuda:0') tensor(177, device='cuda:0')
max of Lambda2 tensor(76432.5469, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.5529, device='cuda:0')
min of grad d_p:  tensor(-0.3116, device='cuda:0')
max|min: (J_L, Jta/N)  (0.5528817176818848, 0.5528817176818848, ratio: 1.0)|(-0.31161367893218994, -0.3116135895252228)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.7881e-07, device='cuda:0') mean:  tensor(-3.2454e-11, device='cuda:0') min:  tensor(-8.3910e-06, device='cuda:0') norm:  tensor(8.5906e-06, device='cuda:0') MSE:  tensor(1.0825e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0012, device='cuda:0') mean:  tensor(7.6835e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0147, device='cuda:0') MSE:  tensor(1.8539e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0717, device='cuda:0')
min of d_p_list:  tensor(-0.0971, device='cuda:0')
Epoch:  263  
Training Loss: 0.28964805603027344
Test Loss:  0.3139353394508362
Test Acc:  0.0
Valid Loss:  0.3010350465774536
Valid Acc:  0.0
std:  0.0931487029533453 
thres:  0.00042666130661964417
Preserved_eigens number check:  512
 26%|██▋       | 263/1000 [1:15:53<3:01:17, 14.76s/it]Epoch:   264
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  488
Criterion check: 
Mean:  tensor(1.0459, device='cuda:0') 
Std:  tensor(110.4888, device='cuda:0') 
ABS Max:  tensor(1845.2909, device='cuda:0') 
ABS Min:  tensor(0.0028, device='cuda:0')
Criterion check:  tensor([0.9999, 1.0001, 0.9999, 1.0000, 0.9999, 1.0011, 0.9992, 1.0048, 0.9618,
        0.9961], device='cuda:0') tensor(180, device='cuda:0')
max of Lambda2 tensor(77146.8984, device='cuda:0')
min of Lambda2 tensor(1.0255e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.5009, device='cuda:0')
min of grad d_p:  tensor(-0.2806, device='cuda:0')
max|min: (J_L, Jta/N)  (0.5009375214576721, 0.5009374022483826, ratio: 0.9999997615814209)|(-0.28061097860336304, -0.2806108295917511)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.2352e-07, device='cuda:0') mean:  tensor(1.6466e-12, device='cuda:0') min:  tensor(-2.6822e-07, device='cuda:0') norm:  tensor(2.4853e-06, device='cuda:0') MSE:  tensor(3.1316e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0007, device='cuda:0') mean:  tensor(6.8433e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0140, device='cuda:0') MSE:  tensor(1.7618e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0525, device='cuda:0')
min of d_p_list:  tensor(-0.0644, device='cuda:0')
Epoch:  264  
Training Loss: 0.23873789608478546
Test Loss:  0.25905418395996094
Test Acc:  0.0
Valid Loss:  0.2455376386642456
Valid Acc:  0.0
std:  0.09130529202661494 
thres:  0.00036312818229198456
Preserved_eigens number check:  512
 26%|██▋       | 264/1000 [1:16:08<3:00:50, 14.74s/it]Epoch:   265
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  489
Criterion check: 
Mean:  tensor(-3.4239, device='cuda:0') 
Std:  tensor(81.6098, device='cuda:0') 
ABS Max:  tensor(1679.7848, device='cuda:0') 
ABS Min:  tensor(0.0008, device='cuda:0')
Criterion check:  tensor([1.0003, 0.9998, 0.9994, 0.9999, 0.9994, 0.9993, 1.0020, 0.9976, 0.8737,
        1.0115], device='cuda:0') tensor(181, device='cuda:0')
max of Lambda2 tensor(77298.9688, device='cuda:0')
min of Lambda2 tensor(3.1429e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.4555, device='cuda:0')
min of grad d_p:  tensor(-0.2557, device='cuda:0')
max|min: (J_L, Jta/N)  (0.4555447995662689, 0.45554491877555847, ratio: 1.000000238418579)|(-0.25573596358299255, -0.25573602318763733)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.3842e-07, device='cuda:0') mean:  tensor(1.6454e-11, device='cuda:0') min:  tensor(-2.6822e-07, device='cuda:0') norm:  tensor(2.0369e-06, device='cuda:0') MSE:  tensor(2.5666e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0008, device='cuda:0') mean:  tensor(6.7147e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0132, device='cuda:0') MSE:  tensor(1.6645e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0665, device='cuda:0')
min of d_p_list:  tensor(-0.0592, device='cuda:0')
Epoch:  265  
Training Loss: 0.1958625316619873
Test Loss:  0.21381208300590515
Test Acc:  0.0
Valid Loss:  0.2046794295310974
Valid Acc:  0.0
std:  0.09044873718184415 
thres:  0.00030691141188144685
Preserved_eigens number check:  512
 26%|██▋       | 265/1000 [1:16:23<3:00:40, 14.75s/it]Epoch:   266
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  490
Criterion check: 
Mean:  tensor(7.4649, device='cuda:0') 
Std:  tensor(117.2756, device='cuda:0') 
ABS Max:  tensor(2095.8462, device='cuda:0') 
ABS Min:  tensor(0.0052, device='cuda:0')
Criterion check:  tensor([1.0001, 0.9997, 1.0005, 1.0000, 0.9968, 1.0016, 1.0021, 1.0010, 1.0873,
        1.0152], device='cuda:0') tensor(202, device='cuda:0')
max of Lambda2 tensor(77779.7734, device='cuda:0')
min of Lambda2 tensor(5.4942e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.4135, device='cuda:0')
min of grad d_p:  tensor(-0.2301, device='cuda:0')
max|min: (J_L, Jta/N)  (0.4134920537471771, 0.4134920835494995, ratio: 1.0000001192092896)|(-0.23007610440254211, -0.23007622361183167)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.6822e-07, device='cuda:0') mean:  tensor(6.3531e-11, device='cuda:0') min:  tensor(-1.1921e-07, device='cuda:0') norm:  tensor(2.5522e-06, device='cuda:0') MSE:  tensor(3.2160e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0017, device='cuda:0') mean:  tensor(1.3756e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0256, device='cuda:0') MSE:  tensor(3.2244e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0352, device='cuda:0')
min of d_p_list:  tensor(-0.0564, device='cuda:0')
Epoch:  266  
Training Loss: 0.16023457050323486
Test Loss:  0.17446276545524597
Test Acc:  0.0
Valid Loss:  0.16738685965538025
Valid Acc:  0.0
std:  0.06997768371898745 
thres:  0.0002486279636621475
Preserved_eigens number check:  512
 27%|██▋       | 266/1000 [1:16:38<3:00:27, 14.75s/it]Epoch:   267
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  488
Criterion check: 
Mean:  tensor(-5.9793, device='cuda:0') 
Std:  tensor(88.7862, device='cuda:0') 
ABS Max:  tensor(1703.5797, device='cuda:0') 
ABS Min:  tensor(0.0004, device='cuda:0')
Criterion check:  tensor([1.0000, 0.9999, 1.0001, 1.0000, 1.0001, 0.9986, 0.9993, 1.0017, 1.0563,
        0.9973], device='cuda:0') tensor(160, device='cuda:0')
max of Lambda2 tensor(78215.9062, device='cuda:0')
min of Lambda2 tensor(5.0965e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3755, device='cuda:0')
min of grad d_p:  tensor(-0.2089, device='cuda:0')
max|min: (J_L, Jta/N)  (0.3755137324333191, 0.37551364302635193, ratio: 0.9999997615814209)|(-0.20891094207763672, -0.2089109867811203)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.0862e-07, device='cuda:0') mean:  tensor(2.6790e-11, device='cuda:0') min:  tensor(-1.4901e-07, device='cuda:0') norm:  tensor(1.4328e-06, device='cuda:0') MSE:  tensor(1.8054e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0007, device='cuda:0') mean:  tensor(5.8350e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0110, device='cuda:0') MSE:  tensor(1.3905e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0177, device='cuda:0')
min of d_p_list:  tensor(-0.0248, device='cuda:0')
Epoch:  267  
Training Loss: 0.1308373361825943
Test Loss:  0.1425449550151825
Test Acc:  0.0
Valid Loss:  0.13716968894004822
Valid Acc:  0.0
std:  0.0563424134448027 
thres:  0.00020306407809257508
Preserved_eigens number check:  512
 27%|██▋       | 267/1000 [1:16:52<3:00:24, 14.77s/it]Epoch:   268
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  489
Criterion check: 
Mean:  tensor(3.2318, device='cuda:0') 
Std:  tensor(42.4408, device='cuda:0') 
ABS Max:  tensor(919.5702, device='cuda:0') 
ABS Min:  tensor(5.6138e-05, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0001, 1.0000, 1.0003, 1.0001, 0.9995, 1.0019, 0.9916,
        1.0009], device='cuda:0') tensor(174, device='cuda:0')
max of Lambda2 tensor(78178.9141, device='cuda:0')
min of Lambda2 tensor(1.5823e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3414, device='cuda:0')
min of grad d_p:  tensor(-0.1898, device='cuda:0')
max|min: (J_L, Jta/N)  (0.34138110280036926, 0.3413810729980469, ratio: 0.9999999403953552)|(-0.18983525037765503, -0.18983536958694458)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.7881e-07, device='cuda:0') mean:  tensor(5.9243e-11, device='cuda:0') min:  tensor(-8.1956e-08, device='cuda:0') norm:  tensor(2.2751e-06, device='cuda:0') MSE:  tensor(2.8669e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(2.9918e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0064, device='cuda:0') MSE:  tensor(8.0243e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0287, device='cuda:0')
min of d_p_list:  tensor(-0.0587, device='cuda:0')
Epoch:  268  
Training Loss: 0.10557721555233002
Test Loss:  0.11442102491855621
Test Acc:  0.0
Valid Loss:  0.10942432284355164
Valid Acc:  0.0
std:  0.04712287349790742 
thres:  0.0001662499099969864
Preserved_eigens number check:  512
 27%|██▋       | 268/1000 [1:17:07<3:00:00, 14.75s/it]Epoch:   269
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  487
Criterion check: 
Mean:  tensor(1.0132, device='cuda:0') 
Std:  tensor(34.2564, device='cuda:0') 
ABS Max:  tensor(738.7491, device='cuda:0') 
ABS Min:  tensor(9.4867e-05, device='cuda:0')
Criterion check:  tensor([0.9996, 1.0001, 1.0002, 0.9999, 1.0014, 0.9999, 0.9998, 0.9988, 0.9899,
        0.9965], device='cuda:0') tensor(141, device='cuda:0')
max of Lambda2 tensor(78203.2578, device='cuda:0')
min of Lambda2 tensor(5.3966e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3104, device='cuda:0')
min of grad d_p:  tensor(-0.1723, device='cuda:0')
max|min: (J_L, Jta/N)  (0.31038782000541687, 0.3103877305984497, ratio: 0.9999997019767761)|(-0.17229491472244263, -0.17229506373405457)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.9372e-07, device='cuda:0') mean:  tensor(5.4575e-11, device='cuda:0') min:  tensor(-7.4506e-08, device='cuda:0') norm:  tensor(2.2066e-06, device='cuda:0') MSE:  tensor(2.7804e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(2.2712e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0048, device='cuda:0') MSE:  tensor(6.0938e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0144, device='cuda:0')
min of d_p_list:  tensor(-0.0172, device='cuda:0')
Epoch:  269  
Training Loss: 0.08639310300350189
Test Loss:  0.09349644929170609
Test Acc:  0.0
Valid Loss:  0.08922763168811798
Valid Acc:  0.0
std:  0.03894519311502457 
thres:  0.00013578095138072968
Preserved_eigens number check:  512
 27%|██▋       | 269/1000 [1:17:22<2:59:51, 14.76s/it]Epoch:   270
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  488
Criterion check: 
Mean:  tensor(-1.4539, device='cuda:0') 
Std:  tensor(29.0641, device='cuda:0') 
ABS Max:  tensor(434.5219, device='cuda:0') 
ABS Min:  tensor(0.0007, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0001, 1.0000, 1.0000, 0.9999, 0.9998, 0.9999, 0.9956, 0.9898,
        0.9987], device='cuda:0') tensor(156, device='cuda:0')
max of Lambda2 tensor(78373.4062, device='cuda:0')
min of Lambda2 tensor(1.4110e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2814, device='cuda:0')
min of grad d_p:  tensor(-0.1564, device='cuda:0')
max|min: (J_L, Jta/N)  (0.28140783309936523, 0.2814076542854309, ratio: 0.9999993443489075)|(-0.15641123056411743, -0.1564112901687622)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.9802e-07, device='cuda:0') mean:  tensor(5.5326e-11, device='cuda:0') min:  tensor(-9.6858e-08, device='cuda:0') norm:  tensor(2.1609e-06, device='cuda:0') MSE:  tensor(2.7229e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(2.9627e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0054, device='cuda:0') MSE:  tensor(6.8097e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0228, device='cuda:0')
min of d_p_list:  tensor(-0.0232, device='cuda:0')
Epoch:  270  
Training Loss: 0.07016654312610626
Test Loss:  0.07580161094665527
Test Acc:  0.0
Valid Loss:  0.072606161236763
Valid Acc:  0.0
std:  0.03199749461611489 
thres:  0.00011064175367355347
Preserved_eigens number check:  512
 27%|██▋       | 270/1000 [1:17:37<2:59:33, 14.76s/it]Epoch:   271
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  489
Criterion check: 
Mean:  tensor(-1.1711, device='cuda:0') 
Std:  tensor(16.7494, device='cuda:0') 
ABS Max:  tensor(296.5210, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0002, 0.9997, 1.0000, 0.9983, 1.0005,
        0.9988], device='cuda:0') tensor(137, device='cuda:0')
max of Lambda2 tensor(78594.7188, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2560, device='cuda:0')
min of grad d_p:  tensor(-0.1425, device='cuda:0')
max|min: (J_L, Jta/N)  (0.25600430369377136, 0.2560041844844818, ratio: 0.9999995231628418)|(-0.14253778755664825, -0.14253777265548706)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.1921e-07, device='cuda:0') mean:  tensor(8.1549e-12, device='cuda:0') min:  tensor(-6.7055e-08, device='cuda:0') norm:  tensor(9.3346e-07, device='cuda:0') MSE:  tensor(1.1762e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(1.3942e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0029, device='cuda:0') MSE:  tensor(3.6521e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0614, device='cuda:0')
min of d_p_list:  tensor(-0.0319, device='cuda:0')
Epoch:  271  
Training Loss: 0.05652344971895218
Test Loss:  0.060783617198467255
Test Acc:  0.0
Valid Loss:  0.058536723256111145
Valid Acc:  0.0
std:  0.02621961988853147 
thres:  8.989952951669693e-05
Preserved_eigens number check:  512
 27%|██▋       | 271/1000 [1:17:52<2:59:27, 14.77s/it]Epoch:   272
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  487
Criterion check: 
Mean:  tensor(-12.6632, device='cuda:0') 
Std:  tensor(402.8005, device='cuda:0') 
ABS Max:  tensor(4506.1758, device='cuda:0') 
ABS Min:  tensor(0.0108, device='cuda:0')
Criterion check:  tensor([0.9975, 1.0012, 0.9990, 0.9989, 0.9905, 0.9944, 0.9600, 0.9633, 0.5025,
        0.9399], device='cuda:0') tensor(243, device='cuda:0')
max of Lambda2 tensor(78762.7422, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2315, device='cuda:0')
min of grad d_p:  tensor(-0.1301, device='cuda:0')
max|min: (J_L, Jta/N)  (0.23152947425842285, 0.23152950406074524, ratio: 1.0000001192092896)|(-0.13009124994277954, -0.1300913542509079)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.5646e-07, device='cuda:0') mean:  tensor(2.9207e-11, device='cuda:0') min:  tensor(-1.0431e-07, device='cuda:0') norm:  tensor(1.7558e-06, device='cuda:0') MSE:  tensor(2.2124e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0136, device='cuda:0') mean:  tensor(5.0496e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1012, device='cuda:0') MSE:  tensor(1.2755e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1364, device='cuda:0')
min of d_p_list:  tensor(-0.1688, device='cuda:0')
Epoch:  272  
Training Loss: 0.04872500151395798
Test Loss:  0.05240446701645851
Test Acc:  0.0
Valid Loss:  0.050936393439769745
Valid Acc:  0.0
std:  0.020534327240903174 
thres:  7.347706258296966e-05
Preserved_eigens number check:  512
 27%|██▋       | 272/1000 [1:18:06<2:59:04, 14.76s/it]Epoch:   273
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  490
Criterion check: 
Mean:  tensor(-1.0996, device='cuda:0') 
Std:  tensor(44.7723, device='cuda:0') 
ABS Max:  tensor(552.9390, device='cuda:0') 
ABS Min:  tensor(0.0004, device='cuda:0')
Criterion check:  tensor([0.9999, 1.0000, 0.9998, 1.0000, 0.9791, 1.0013, 1.0007, 0.9985, 0.9224,
        1.0191], device='cuda:0') tensor(174, device='cuda:0')
max of Lambda2 tensor(77938.6953, device='cuda:0')
min of Lambda2 tensor(2.1480e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2042, device='cuda:0')
min of grad d_p:  tensor(-0.1174, device='cuda:0')
max|min: (J_L, Jta/N)  (0.20419076085090637, 0.2041906863451004, ratio: 0.9999996423721313)|(-0.11737381666898727, -0.11737392097711563)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.7136e-07, device='cuda:0') mean:  tensor(4.4942e-11, device='cuda:0') min:  tensor(-7.4506e-08, device='cuda:0') norm:  tensor(2.1623e-06, device='cuda:0') MSE:  tensor(2.7247e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(4.2325e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0082, device='cuda:0') MSE:  tensor(1.0388e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0332, device='cuda:0')
min of d_p_list:  tensor(-0.0325, device='cuda:0')
Epoch:  273  
Training Loss: 0.038250118494033813
Test Loss:  0.0405597984790802
Test Acc:  0.0
Valid Loss:  0.04005247727036476
Valid Acc:  0.0
std:  0.016806089049577966 
thres:  6.0011643171310426e-05
Preserved_eigens number check:  512
 27%|██▋       | 273/1000 [1:18:21<2:58:39, 14.75s/it]Epoch:   274
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  488
Criterion check: 
Mean:  tensor(2.5556, device='cuda:0') 
Std:  tensor(1584.5297, device='cuda:0') 
ABS Max:  tensor(27365.9531, device='cuda:0') 
ABS Min:  tensor(0.0183, device='cuda:0')
Criterion check:  tensor([1.0022, 1.0004, 0.9869, 0.9994, 0.7566, 1.0117, 1.0139, 1.3086, 1.0213,
        0.8175], device='cuda:0') tensor(240, device='cuda:0')
max of Lambda2 tensor(77897.2188, device='cuda:0')
min of Lambda2 tensor(1.4505e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1837, device='cuda:0')
min of grad d_p:  tensor(-0.1059, device='cuda:0')
max|min: (J_L, Jta/N)  (0.18365207314491272, 0.18365202844142914, ratio: 0.9999997615814209)|(-0.10592609643936157, -0.105926014482975)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.9605e-08, device='cuda:0') mean:  tensor(-2.2080e-11, device='cuda:0') min:  tensor(-1.1176e-07, device='cuda:0') norm:  tensor(1.2786e-06, device='cuda:0') MSE:  tensor(1.6112e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0080, device='cuda:0') mean:  tensor(7.9177e-05, device='cuda:0') min:  tensor(1.6627e-14, device='cuda:0') norm:  tensor(0.1552, device='cuda:0') MSE:  tensor(1.9551e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0220, device='cuda:0')
min of d_p_list:  tensor(-0.0217, device='cuda:0')
Epoch:  274  
Training Loss: 0.031061839312314987
Test Loss:  0.03276166692376137
Test Acc:  0.0
Valid Loss:  0.03182683885097504
Valid Acc:  0.0
std:  0.013726056374470896 
thres:  4.8945390433073045e-05
Preserved_eigens number check:  512
 27%|██▋       | 274/1000 [1:18:36<2:58:16, 14.73s/it]Epoch:   275
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  489
Criterion check: 
Mean:  tensor(0.2547, device='cuda:0') 
Std:  tensor(7.9532, device='cuda:0') 
ABS Max:  tensor(137.0552, device='cuda:0') 
ABS Min:  tensor(6.1711e-05, device='cuda:0')
Criterion check:  tensor([1.0001, 1.0000, 1.0000, 1.0000, 0.9978, 1.0002, 1.0002, 1.0010, 1.0098,
        0.9977], device='cuda:0') tensor(116, device='cuda:0')
max of Lambda2 tensor(77415.1406, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1650, device='cuda:0')
min of grad d_p:  tensor(-0.0963, device='cuda:0')
max|min: (J_L, Jta/N)  (0.16502392292022705, 0.1650238186120987, ratio: 0.9999993443489075)|(-0.09634830802679062, -0.0963483676314354)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.1921e-07, device='cuda:0') mean:  tensor(2.2403e-11, device='cuda:0') min:  tensor(-4.0978e-08, device='cuda:0') norm:  tensor(1.2944e-06, device='cuda:0') MSE:  tensor(1.6310e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(6.9741e-05, device='cuda:0') mean:  tensor(7.4665e-07, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0015, device='cuda:0') MSE:  tensor(1.8298e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0196, device='cuda:0')
min of d_p_list:  tensor(-0.0229, device='cuda:0')
Epoch:  275  
Training Loss: 0.025705136358737946
Test Loss:  0.027150869369506836
Test Acc:  0.0
Valid Loss:  0.025885015726089478
Valid Acc:  0.0
std:  0.011282126284062829 
thres:  4.005310907959938e-05
Preserved_eigens number check:  512
 28%|██▊       | 275/1000 [1:18:50<2:58:02, 14.73s/it]Epoch:   276
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  487
Criterion check: 
Mean:  tensor(-71.4277, device='cuda:0') 
Std:  tensor(952.6666, device='cuda:0') 
ABS Max:  tensor(18312.5625, device='cuda:0') 
ABS Min:  tensor(0.0041, device='cuda:0')
Criterion check:  tensor([0.9992, 1.0001, 1.0020, 0.9996, 0.9722, 0.9932, 1.0057, 0.9741, 0.9790,
        1.0662], device='cuda:0') tensor(219, device='cuda:0')
max of Lambda2 tensor(77274.3750, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1500, device='cuda:0')
min of grad d_p:  tensor(-0.0877, device='cuda:0')
max|min: (J_L, Jta/N)  (0.14998087286949158, 0.149980828166008, ratio: 0.9999997019767761)|(-0.08771280199289322, -0.08771271258592606)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.9605e-08, device='cuda:0') mean:  tensor(-3.8213e-11, device='cuda:0') min:  tensor(-1.4156e-07, device='cuda:0') norm:  tensor(1.7550e-06, device='cuda:0') MSE:  tensor(2.2114e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0027, device='cuda:0') mean:  tensor(1.9887e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0415, device='cuda:0') MSE:  tensor(5.2282e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0302, device='cuda:0')
min of d_p_list:  tensor(-0.0302, device='cuda:0')
Epoch:  276  
Training Loss: 0.020882152020931244
Test Loss:  0.0219523124396801
Test Acc:  0.0
Valid Loss:  0.021077774465084076
Valid Acc:  0.0
std:  0.009783914563168438 
thres:  3.2924849539995194e-05
Preserved_eigens number check:  512
 28%|██▊       | 276/1000 [1:19:05<2:57:56, 14.75s/it]Epoch:   277
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  490
Criterion check: 
Mean:  tensor(0.5156, device='cuda:0') 
Std:  tensor(15.5355, device='cuda:0') 
ABS Max:  tensor(255.9581, device='cuda:0') 
ABS Min:  tensor(0.0001, device='cuda:0')
Criterion check:  tensor([0.9999, 1.0000, 1.0001, 1.0000, 1.0013, 0.9999, 1.0002, 1.0026, 1.0051,
        0.9968], device='cuda:0') tensor(115, device='cuda:0')
max of Lambda2 tensor(77700.6875, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1354, device='cuda:0')
min of grad d_p:  tensor(-0.0798, device='cuda:0')
max|min: (J_L, Jta/N)  (0.13538873195648193, 0.13538865745067596, ratio: 0.999999463558197)|(-0.07981225848197937, -0.07981228828430176)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.4529e-07, device='cuda:0') mean:  tensor(4.7814e-11, device='cuda:0') min:  tensor(-6.7055e-08, device='cuda:0') norm:  tensor(1.6987e-06, device='cuda:0') MSE:  tensor(2.1405e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(9.5666e-05, device='cuda:0') mean:  tensor(1.2427e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0023, device='cuda:0') MSE:  tensor(2.9397e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0404, device='cuda:0')
min of d_p_list:  tensor(-0.0316, device='cuda:0')
Epoch:  277  
Training Loss: 0.01885848306119442
Test Loss:  0.01935972273349762
Test Acc:  0.0
Valid Loss:  0.019428640604019165
Valid Acc:  0.0
std:  0.007048985735758785 
thres:  2.6951545849442482e-05
Preserved_eigens number check:  512
 28%|██▊       | 277/1000 [1:19:20<2:58:05, 14.78s/it]Epoch:   278
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  488
Criterion check: 
Mean:  tensor(10.2583, device='cuda:0') 
Std:  tensor(167.5239, device='cuda:0') 
ABS Max:  tensor(2423.5974, device='cuda:0') 
ABS Min:  tensor(0.0021, device='cuda:0')
Criterion check:  tensor([1.0010, 0.9980, 0.9973, 0.9997, 1.0169, 0.9931, 0.9784, 0.9323, 0.0653,
        0.9163], device='cuda:0') tensor(207, device='cuda:0')
max of Lambda2 tensor(77640.4141, device='cuda:0')
min of Lambda2 tensor(1.3039e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1228, device='cuda:0')
min of grad d_p:  tensor(-0.0727, device='cuda:0')
max|min: (J_L, Jta/N)  (0.12279081344604492, 0.1227908656001091, ratio: 1.0000004768371582)|(-0.07269248366355896, -0.07269260287284851)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.1921e-07, device='cuda:0') mean:  tensor(1.7679e-11, device='cuda:0') min:  tensor(-9.6858e-08, device='cuda:0') norm:  tensor(1.5768e-06, device='cuda:0') MSE:  tensor(1.9869e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0024, device='cuda:0') mean:  tensor(2.4396e-05, device='cuda:0') min:  tensor(5.9258e-15, device='cuda:0') norm:  tensor(0.0497, device='cuda:0') MSE:  tensor(6.2599e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0174, device='cuda:0')
min of d_p_list:  tensor(-0.0279, device='cuda:0')
Epoch:  278  
Training Loss: 0.01575075462460518
Test Loss:  0.016086511313915253
Test Acc:  0.0
Valid Loss:  0.01623653620481491
Valid Acc:  0.0
std:  0.005385103617687384 
thres:  2.2451673075556755e-05
Preserved_eigens number check:  512
 28%|██▊       | 278/1000 [1:19:35<2:57:50, 14.78s/it]Epoch:   279
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  487
Criterion check: 
Mean:  tensor(0.9008, device='cuda:0') 
Std:  tensor(50.7873, device='cuda:0') 
ABS Max:  tensor(911.2731, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([1.0003, 0.9999, 0.9999, 1.0000, 0.9980, 1.0009, 0.9997, 1.0059, 1.0076,
        1.0077], device='cuda:0') tensor(153, device='cuda:0')
max of Lambda2 tensor(77526.3438, device='cuda:0')
min of Lambda2 tensor(5.0633e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1125, device='cuda:0')
min of grad d_p:  tensor(-0.0660, device='cuda:0')
max|min: (J_L, Jta/N)  (0.11248553544282913, 0.11248558759689331, ratio: 1.0000004768371582)|(-0.0660085678100586, -0.06600857526063919)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.8429e-08, device='cuda:0') mean:  tensor(-6.2556e-12, device='cuda:0') min:  tensor(-8.1956e-08, device='cuda:0') norm:  tensor(6.9442e-07, device='cuda:0') MSE:  tensor(8.7502e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(2.4475e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0051, device='cuda:0') MSE:  tensor(6.4439e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0158, device='cuda:0')
min of d_p_list:  tensor(-0.0177, device='cuda:0')
Epoch:  279  
Training Loss: 0.013011399656534195
Test Loss:  0.013349698856472969
Test Acc:  0.0
Valid Loss:  0.01326277107000351
Valid Acc:  0.0
std:  0.004354694710632297 
thres:  1.8841585144400596e-05
Preserved_eigens number check:  512
 28%|██▊       | 279/1000 [1:19:50<2:57:22, 14.76s/it]Epoch:   280
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  487
Criterion check: 
Mean:  tensor(1.1467, device='cuda:0') 
Std:  tensor(22.9090, device='cuda:0') 
ABS Max:  tensor(495.0791, device='cuda:0') 
ABS Min:  tensor(3.9084e-05, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 0.9999, 1.0000, 0.9997, 0.9998, 0.9989, 1.0005, 0.9885,
        1.0147], device='cuda:0') tensor(146, device='cuda:0')
max of Lambda2 tensor(77522.4531, device='cuda:0')
min of Lambda2 tensor(2.2048e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1023, device='cuda:0')
min of grad d_p:  tensor(-0.0602, device='cuda:0')
max|min: (J_L, Jta/N)  (0.10228902101516724, 0.10228899866342545, ratio: 0.9999997615814209)|(-0.060191329568624496, -0.060191284865140915)

 check Jacobi res:  torch.Size([793601]) max:  tensor(6.7055e-08, device='cuda:0') mean:  tensor(2.6193e-12, device='cuda:0') min:  tensor(-4.4703e-08, device='cuda:0') norm:  tensor(7.2457e-07, device='cuda:0') MSE:  tensor(9.1301e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(1.2848e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0025, device='cuda:0') MSE:  tensor(3.0906e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0202, device='cuda:0')
min of d_p_list:  tensor(-0.0205, device='cuda:0')
Epoch:  280  
Training Loss: 0.011039769276976585
Test Loss:  0.011364254169166088
Test Acc:  0.0
Valid Loss:  0.011160699650645256
Valid Acc:  0.0
std:  0.0036211110820531297 
thres:  1.5908511728048324e-05
Preserved_eigens number check:  512
 28%|██▊       | 280/1000 [1:20:04<2:56:47, 14.73s/it]Epoch:   281
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  488
Criterion check: 
Mean:  tensor(274.9092, device='cuda:0') 
Std:  tensor(6198.2642, device='cuda:0') 
ABS Max:  tensor(140250.0312, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([1.0001, 0.9999, 0.9999, 0.9999, 0.9990, 1.0003, 0.9995, 1.0010, 1.0066,
        0.9996], device='cuda:0') tensor(136, device='cuda:0')
max of Lambda2 tensor(77722.5312, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0932, device='cuda:0')
min of grad d_p:  tensor(-0.0548, device='cuda:0')
max|min: (J_L, Jta/N)  (0.09317561984062195, 0.09317556023597717, ratio: 0.9999993443489075)|(-0.05481630563735962, -0.05481626093387604)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.3411e-07, device='cuda:0') mean:  tensor(1.2728e-11, device='cuda:0') min:  tensor(-6.1467e-08, device='cuda:0') norm:  tensor(1.0803e-06, device='cuda:0') MSE:  tensor(1.3613e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(1.8841e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0037, device='cuda:0') MSE:  tensor(4.6854e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0519, device='cuda:0')
min of d_p_list:  tensor(-0.0434, device='cuda:0')
Epoch:  281  
Training Loss: 0.008701187558472157
Test Loss:  0.008849140256643295
Test Acc:  0.0
Valid Loss:  0.008955651894211769
Valid Acc:  0.0
std:  0.003552336476688829 
thres:  1.3472318835556507e-05
Preserved_eigens number check:  512
 28%|██▊       | 281/1000 [1:20:19<2:56:24, 14.72s/it]Epoch:   282
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  490
Criterion check: 
Mean:  tensor(5.3161, device='cuda:0') 
Std:  tensor(116.2157, device='cuda:0') 
ABS Max:  tensor(2234.5706, device='cuda:0') 
ABS Min:  tensor(0.0001, device='cuda:0')
Criterion check:  tensor([1.0009, 0.9998, 0.9986, 0.9995, 0.9981, 1.0022, 1.0070, 1.0107, 1.0152,
        1.0088], device='cuda:0') tensor(172, device='cuda:0')
max of Lambda2 tensor(78499.2500, device='cuda:0')
min of Lambda2 tensor(1.0769e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0859, device='cuda:0')
min of grad d_p:  tensor(-0.0497, device='cuda:0')
max|min: (J_L, Jta/N)  (0.0859016627073288, 0.08590161800384521, ratio: 0.999999463558197)|(-0.04969935491681099, -0.04969942942261696)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.4529e-07, device='cuda:0') mean:  tensor(4.4983e-11, device='cuda:0') min:  tensor(-7.4506e-08, device='cuda:0') norm:  tensor(1.7638e-06, device='cuda:0') MSE:  tensor(2.2226e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0007, device='cuda:0') mean:  tensor(6.5724e-06, device='cuda:0') min:  tensor(1.0546e-15, device='cuda:0') norm:  tensor(0.0131, device='cuda:0') MSE:  tensor(1.6568e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0128, device='cuda:0')
min of d_p_list:  tensor(-0.0229, device='cuda:0')
Epoch:  282  
Training Loss: 0.007000140845775604
Test Loss:  0.0070935143157839775
Test Acc:  0.0
Valid Loss:  0.007181778084486723
Valid Acc:  0.0
std:  0.0030935332247879906 
thres:  1.1100650392472743e-05
Preserved_eigens number check:  512
 28%|██▊       | 282/1000 [1:20:34<2:56:41, 14.77s/it]Epoch:   283
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  489
Criterion check: 
Mean:  tensor(-0.9779, device='cuda:0') 
Std:  tensor(18.1959, device='cuda:0') 
ABS Max:  tensor(304.4120, device='cuda:0') 
ABS Min:  tensor(0.0011, device='cuda:0')
Criterion check:  tensor([0.9998, 0.9999, 1.0000, 1.0000, 0.9979, 0.9999, 1.0017, 1.0001, 0.9924,
        1.0067], device='cuda:0') tensor(165, device='cuda:0')
max of Lambda2 tensor(78651.3750, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0783, device='cuda:0')
min of grad d_p:  tensor(-0.0453, device='cuda:0')
max|min: (J_L, Jta/N)  (0.07832139730453491, 0.07832134515047073, ratio: 0.9999993443489075)|(-0.04530288279056549, -0.045302871614694595)

 check Jacobi res:  torch.Size([793601]) max:  tensor(9.4995e-08, device='cuda:0') mean:  tensor(1.1679e-11, device='cuda:0') min:  tensor(-4.8429e-08, device='cuda:0') norm:  tensor(1.0274e-06, device='cuda:0') MSE:  tensor(1.2946e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(1.1821e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0023, device='cuda:0') MSE:  tensor(2.8611e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1925, device='cuda:0')
min of d_p_list:  tensor(-0.2408, device='cuda:0')
Epoch:  283  
Training Loss: 0.010307833552360535
Test Loss:  0.009715868160128593
Test Acc:  0.0
Valid Loss:  0.011915493756532669
Valid Acc:  0.0
std:  0.0020459594461703537 
thres:  1.0012066178023815e-05
Preserved_eigens number check:  512
 28%|██▊       | 283/1000 [1:20:49<2:57:32, 14.86s/it]Epoch:   284
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  490
Criterion check: 
Mean:  tensor(-5.7316, device='cuda:0') 
Std:  tensor(78.0157, device='cuda:0') 
ABS Max:  tensor(1377.7921, device='cuda:0') 
ABS Min:  tensor(0.0009, device='cuda:0')
Criterion check:  tensor([1.0003, 1.0000, 1.0012, 0.9996, 0.9997, 0.9997, 1.0001, 0.9995, 0.9942,
        0.9799], device='cuda:0') tensor(166, device='cuda:0')
max of Lambda2 tensor(76123.5000, device='cuda:0')
min of Lambda2 tensor(3.6741e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0867, device='cuda:0')
min of grad d_p:  tensor(-0.0520, device='cuda:0')
max|min: (J_L, Jta/N)  (0.0866699293255806, 0.08666995167732239, ratio: 1.000000238418579)|(-0.051992133259773254, -0.051992084830999374)

 check Jacobi res:  torch.Size([793601]) max:  tensor(7.4506e-08, device='cuda:0') mean:  tensor(-5.9370e-11, device='cuda:0') min:  tensor(-1.9930e-07, device='cuda:0') norm:  tensor(2.0885e-06, device='cuda:0') MSE:  tensor(2.6316e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0012, device='cuda:0') mean:  tensor(5.6978e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0111, device='cuda:0') MSE:  tensor(1.4040e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0264, device='cuda:0')
min of d_p_list:  tensor(-0.0218, device='cuda:0')
Epoch:  284  
Training Loss: 0.007969792932271957
Test Loss:  0.007499484345316887
Test Acc:  0.0
Valid Loss:  0.009210396558046341
Valid Acc:  0.0
std:  0.0014846595097492156 
thres:  9.003744833171369e-06
Preserved_eigens number check:  512
 28%|██▊       | 284/1000 [1:21:04<2:56:51, 14.82s/it]Epoch:   285
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  486
Criterion check: 
Mean:  tensor(2.0502, device='cuda:0') 
Std:  tensor(40.3804, device='cuda:0') 
ABS Max:  tensor(460.6613, device='cuda:0') 
ABS Min:  tensor(7.4627e-05, device='cuda:0')
Criterion check:  tensor([0.9996, 1.0001, 1.0011, 1.0003, 0.9975, 0.9997, 0.9992, 1.0012, 0.9880,
        0.9882], device='cuda:0') tensor(176, device='cuda:0')
max of Lambda2 tensor(76344.0078, device='cuda:0')
min of Lambda2 tensor(1.1024e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0789, device='cuda:0')
min of grad d_p:  tensor(-0.0475, device='cuda:0')
max|min: (J_L, Jta/N)  (0.07892362028360367, 0.07892351597547531, ratio: 0.9999986886978149)|(-0.047514963895082474, -0.047514915466308594)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.0431e-07, device='cuda:0') mean:  tensor(-9.0318e-12, device='cuda:0') min:  tensor(-8.9407e-08, device='cuda:0') norm:  tensor(1.0987e-06, device='cuda:0') MSE:  tensor(1.3845e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0012, device='cuda:0') mean:  tensor(5.4979e-06, device='cuda:0') min:  tensor(3.2891e-15, device='cuda:0') norm:  tensor(0.0110, device='cuda:0') MSE:  tensor(1.3885e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.9841, device='cuda:0')
min of d_p_list:  tensor(-0.5506, device='cuda:0')
Epoch:  285  
Training Loss: 0.1339035928249359
Test Loss:  0.13858439028263092
Test Acc:  0.0
Valid Loss:  0.12306425720453262
Valid Acc:  0.0
std:  0.05017518086617077 
thres:  3.357650954276323e-05
Preserved_eigens number check:  512
 28%|██▊       | 285/1000 [1:21:18<2:56:22, 14.80s/it]Epoch:   286
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  485
Criterion check: 
Mean:  tensor(-179.9588, device='cuda:0') 
Std:  tensor(2510.0005, device='cuda:0') 
ABS Max:  tensor(49570.5586, device='cuda:0') 
ABS Min:  tensor(0.0359, device='cuda:0')
Criterion check:  tensor([0.9748, 1.0158, 0.9995, 1.0004, 0.9983, 1.0093, 0.7081, 0.9922, 1.2969,
        1.0455], device='cuda:0') tensor(245, device='cuda:0')
max of Lambda2 tensor(72401.3203, device='cuda:0')
min of Lambda2 tensor(1.7346e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2248, device='cuda:0')
min of grad d_p:  tensor(-0.1130, device='cuda:0')
max|min: (J_L, Jta/N)  (0.2248152494430542, 0.22481539845466614, ratio: 1.0000007152557373)|(-0.11304144561290741, -0.11304131895303726)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.8186e-05, device='cuda:0') mean:  tensor(-6.0336e-09, device='cuda:0') min:  tensor(-6.4793e-05, device='cuda:0') norm:  tensor(0.0004, device='cuda:0') MSE:  tensor(4.4458e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0134, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(3.1641e-15, device='cuda:0') norm:  tensor(0.2029, device='cuda:0') MSE:  tensor(2.5569e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.4530, device='cuda:0')
min of d_p_list:  tensor(-0.4078, device='cuda:0')
Epoch:  286  
Training Loss: 0.1051211953163147
Test Loss:  0.11414200067520142
Test Acc:  0.0
Valid Loss:  0.09432358294725418
Valid Acc:  0.0
std:  0.05518739115807944 
thres:  5.2860511094331745e-05
Preserved_eigens number check:  512
 29%|██▊       | 286/1000 [1:21:33<2:55:36, 14.76s/it]Epoch:   287
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  489
Criterion check: 
Mean:  tensor(0.4211, device='cuda:0') 
Std:  tensor(16.5697, device='cuda:0') 
ABS Max:  tensor(170.2635, device='cuda:0') 
ABS Min:  tensor(0.0012, device='cuda:0')
Criterion check:  tensor([0.9980, 0.9989, 1.0000, 1.0000, 1.0001, 0.9997, 0.9995, 0.9954, 0.9950,
        0.9775], device='cuda:0') tensor(189, device='cuda:0')
max of Lambda2 tensor(72526.3828, device='cuda:0')
min of Lambda2 tensor(1.8739e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2151, device='cuda:0')
min of grad d_p:  tensor(-0.1324, device='cuda:0')
max|min: (J_L, Jta/N)  (0.21509291231632233, 0.21509288251399994, ratio: 0.9999998807907104)|(-0.13243743777275085, -0.13243742287158966)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.1956e-08, device='cuda:0') mean:  tensor(-4.5246e-12, device='cuda:0') min:  tensor(-7.4506e-08, device='cuda:0') norm:  tensor(9.6046e-07, device='cuda:0') MSE:  tensor(1.2103e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0009, device='cuda:0') mean:  tensor(5.4128e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0100, device='cuda:0') MSE:  tensor(1.2574e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1583, device='cuda:0')
min of d_p_list:  tensor(-0.1767, device='cuda:0')
Epoch:  287  
Training Loss: 0.0775219202041626
Test Loss:  0.07850101590156555
Test Acc:  0.0
Valid Loss:  0.07610034197568893
Valid Acc:  0.0
std:  0.05047492046818403 
thres:  6.696486696600915e-05
Preserved_eigens number check:  512
 29%|██▊       | 287/1000 [1:21:48<2:55:09, 14.74s/it]Epoch:   288
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  486
Criterion check: 
Mean:  tensor(-0.0847, device='cuda:0') 
Std:  tensor(22.5296, device='cuda:0') 
ABS Max:  tensor(443.1516, device='cuda:0') 
ABS Min:  tensor(9.3233e-05, device='cuda:0')
Criterion check:  tensor([1.0004, 1.0000, 0.9999, 1.0000, 1.0000, 1.0000, 1.0000, 0.9329, 0.9993,
        0.9946], device='cuda:0') tensor(152, device='cuda:0')
max of Lambda2 tensor(71674.3672, device='cuda:0')
min of Lambda2 tensor(3.8712e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1984, device='cuda:0')
min of grad d_p:  tensor(-0.1409, device='cuda:0')
max|min: (J_L, Jta/N)  (0.19841177761554718, 0.19841167330741882, ratio: 0.999999463558197)|(-0.14092853665351868, -0.14092865586280823)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.1607e-07, device='cuda:0') mean:  tensor(4.7188e-11, device='cuda:0') min:  tensor(-9.3132e-08, device='cuda:0') norm:  tensor(2.1388e-06, device='cuda:0') MSE:  tensor(2.6950e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(1.5032e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0029, device='cuda:0') MSE:  tensor(3.6969e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1094, device='cuda:0')
min of d_p_list:  tensor(-0.0392, device='cuda:0')
Epoch:  288  
Training Loss: 0.06413143128156662
Test Loss:  0.06304468214511871
Test Acc:  0.0
Valid Loss:  0.06560982763767242
Valid Acc:  0.0
std:  0.04232540837224613 
thres:  7.772958651185036e-05
Preserved_eigens number check:  512
 29%|██▉       | 288/1000 [1:22:02<2:54:39, 14.72s/it]Epoch:   289
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  487
Criterion check: 
Mean:  tensor(50.7187, device='cuda:0') 
Std:  tensor(704.3021, device='cuda:0') 
ABS Max:  tensor(10839.6777, device='cuda:0') 
ABS Min:  tensor(0.0058, device='cuda:0')
Criterion check:  tensor([1.0010, 1.0010, 1.0005, 0.9998, 1.0008, 0.9985, 1.0021, 1.0564, 0.9902,
        0.7781], device='cuda:0') tensor(200, device='cuda:0')
max of Lambda2 tensor(71709.2422, device='cuda:0')
min of Lambda2 tensor(1.5054e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1813, device='cuda:0')
min of grad d_p:  tensor(-0.1339, device='cuda:0')
max|min: (J_L, Jta/N)  (0.1813206821680069, 0.18132057785987854, ratio: 0.9999994039535522)|(-0.1339237093925476, -0.13392381370067596)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.5832e-07, device='cuda:0') mean:  tensor(4.4402e-11, device='cuda:0') min:  tensor(-7.4506e-08, device='cuda:0') norm:  tensor(1.8122e-06, device='cuda:0') MSE:  tensor(2.2835e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0038, device='cuda:0') mean:  tensor(1.5748e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0311, device='cuda:0') MSE:  tensor(3.9174e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0188, device='cuda:0')
min of d_p_list:  tensor(-0.0238, device='cuda:0')
Epoch:  289  
Training Loss: 0.05414845049381256
Test Loss:  0.051862940192222595
Test Acc:  0.0
Valid Loss:  0.057123973965644836
Valid Acc:  0.0
std:  0.02905287752421649 
thres:  8.696531802415849e-05
Preserved_eigens number check:  512
 29%|██▉       | 289/1000 [1:22:17<2:54:12, 14.70s/it]Epoch:   290
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  487
Criterion check: 
Mean:  tensor(0.4676, device='cuda:0') 
Std:  tensor(12.5157, device='cuda:0') 
ABS Max:  tensor(127.9459, device='cuda:0') 
ABS Min:  tensor(0.0004, device='cuda:0')
Criterion check:  tensor([1.0014, 0.9998, 1.0001, 1.0000, 0.9999, 0.9997, 0.9997, 1.0076, 0.9880,
        1.0110], device='cuda:0') tensor(150, device='cuda:0')
max of Lambda2 tensor(71721.1562, device='cuda:0')
min of Lambda2 tensor(2.3658e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1647, device='cuda:0')
min of grad d_p:  tensor(-0.1204, device='cuda:0')
max|min: (J_L, Jta/N)  (0.16471296548843384, 0.16471292078495026, ratio: 0.9999997019767761)|(-0.12036973983049393, -0.12036971002817154)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.3784e-07, device='cuda:0') mean:  tensor(3.8932e-12, device='cuda:0') min:  tensor(-1.4901e-07, device='cuda:0') norm:  tensor(1.9578e-06, device='cuda:0') MSE:  tensor(2.4670e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(2.6190e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0053, device='cuda:0') MSE:  tensor(6.6376e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0373, device='cuda:0')
min of d_p_list:  tensor(-0.0724, device='cuda:0')
Epoch:  290  
Training Loss: 0.04307195171713829
Test Loss:  0.04027301073074341
Test Acc:  0.0
Valid Loss:  0.046720728278160095
Valid Acc:  0.0
std:  0.021418202638911726 
thres:  6.879898980259895e-05
Preserved_eigens number check:  512
 29%|██▉       | 290/1000 [1:22:32<2:53:54, 14.70s/it]Epoch:   291
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  486
Criterion check: 
Mean:  tensor(-0.8765, device='cuda:0') 
Std:  tensor(56.2930, device='cuda:0') 
ABS Max:  tensor(1132.9093, device='cuda:0') 
ABS Min:  tensor(0.0020, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0012, 0.9998, 1.0000, 0.9995, 1.0000, 1.0001, 1.0268, 1.0038,
        0.9997], device='cuda:0') tensor(178, device='cuda:0')
max of Lambda2 tensor(71645.2422, device='cuda:0')
min of Lambda2 tensor(2.5054e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1514, device='cuda:0')
min of grad d_p:  tensor(-0.1097, device='cuda:0')
max|min: (J_L, Jta/N)  (0.1514475792646408, 0.1514475792646408, ratio: 1.0)|(-0.10974039137363434, -0.1097404733300209)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.9407e-08, device='cuda:0') mean:  tensor(3.5485e-11, device='cuda:0') min:  tensor(-4.4703e-08, device='cuda:0') norm:  tensor(1.1686e-06, device='cuda:0') MSE:  tensor(1.4725e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(4.2845e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0078, device='cuda:0') MSE:  tensor(9.8609e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1189, device='cuda:0')
min of d_p_list:  tensor(-0.1025, device='cuda:0')
Epoch:  291  
Training Loss: 0.03855433687567711
Test Loss:  0.03465614467859268
Test Acc:  0.0
Valid Loss:  0.04235069826245308
Valid Acc:  0.0
std:  0.014162655896163041 
thres:  5.548561811447143e-05
Preserved_eigens number check:  512
 29%|██▉       | 291/1000 [1:22:46<2:53:35, 14.69s/it]Epoch:   292
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  489
Criterion check: 
Mean:  tensor(-11.1358, device='cuda:0') 
Std:  tensor(469.2963, device='cuda:0') 
ABS Max:  tensor(8841.2773, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([1.0011, 1.0040, 0.9999, 1.0000, 0.9999, 0.9998, 1.0002, 1.0216, 1.0000,
        1.0112], device='cuda:0') tensor(181, device='cuda:0')
max of Lambda2 tensor(72002.2344, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1368, device='cuda:0')
min of grad d_p:  tensor(-0.1010, device='cuda:0')
max|min: (J_L, Jta/N)  (0.1368066966533661, 0.1368066668510437, ratio: 0.9999997615814209)|(-0.10099182277917862, -0.10099180042743683)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.4808e-07, device='cuda:0') mean:  tensor(2.0987e-11, device='cuda:0') min:  tensor(-8.9407e-08, device='cuda:0') norm:  tensor(1.6737e-06, device='cuda:0') MSE:  tensor(2.1090e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0012, device='cuda:0') mean:  tensor(9.1254e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0162, device='cuda:0') MSE:  tensor(2.0474e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0194, device='cuda:0')
min of d_p_list:  tensor(-0.0306, device='cuda:0')
Epoch:  292  
Training Loss: 0.032364100217819214
Test Loss:  0.029107164591550827
Test Acc:  0.0
Valid Loss:  0.03573571890592575
Valid Acc:  0.0
std:  0.011349575754528378 
thres:  4.645405411720276e-05
Preserved_eigens number check:  512
 29%|██▉       | 292/1000 [1:23:01<2:53:07, 14.67s/it]Epoch:   293
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  489
Criterion check: 
Mean:  tensor(-0.9305, device='cuda:0') 
Std:  tensor(29.9426, device='cuda:0') 
ABS Max:  tensor(611.2338, device='cuda:0') 
ABS Min:  tensor(0.0012, device='cuda:0')
Criterion check:  tensor([0.9998, 1.0003, 0.9998, 1.0001, 0.9997, 1.0005, 1.0007, 0.9638, 1.0194,
        0.9816], device='cuda:0') tensor(136, device='cuda:0')
max of Lambda2 tensor(71892.6094, device='cuda:0')
min of Lambda2 tensor(8.6524e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1249, device='cuda:0')
min of grad d_p:  tensor(-0.0913, device='cuda:0')
max|min: (J_L, Jta/N)  (0.12493041902780533, 0.1249305009841919, ratio: 1.0000007152557373)|(-0.09132296591997147, -0.09132293611764908)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.1956e-08, device='cuda:0') mean:  tensor(-2.4595e-11, device='cuda:0') min:  tensor(-1.8626e-07, device='cuda:0') norm:  tensor(2.0751e-06, device='cuda:0') MSE:  tensor(2.6148e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(1.8508e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0038, device='cuda:0') MSE:  tensor(4.8295e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0461, device='cuda:0')
min of d_p_list:  tensor(-0.0431, device='cuda:0')
Epoch:  293  
Training Loss: 0.02854652889072895
Test Loss:  0.025143979117274284
Test Acc:  0.0
Valid Loss:  0.031771980226039886
Valid Acc:  0.0
std:  0.00893305199505103 
thres:  3.933707363903523e-05
Preserved_eigens number check:  512
 29%|██▉       | 293/1000 [1:23:16<2:55:16, 14.88s/it]Epoch:   294
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  485
Criterion check: 
Mean:  tensor(-2.3528, device='cuda:0') 
Std:  tensor(48.2427, device='cuda:0') 
ABS Max:  tensor(797.2712, device='cuda:0') 
ABS Min:  tensor(0.0013, device='cuda:0')
Criterion check:  tensor([0.9983, 1.0040, 0.9970, 1.0001, 1.0018, 0.9998, 0.9964, 0.3624, 0.9667,
        1.0037], device='cuda:0') tensor(181, device='cuda:0')
max of Lambda2 tensor(71835.3984, device='cuda:0')
min of Lambda2 tensor(1.6234e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1151, device='cuda:0')
min of grad d_p:  tensor(-0.0817, device='cuda:0')
max|min: (J_L, Jta/N)  (0.11511354148387909, 0.11511357873678207, ratio: 1.0000003576278687)|(-0.08170637488365173, -0.08170630037784576)

 check Jacobi res:  torch.Size([793601]) max:  tensor(7.8231e-08, device='cuda:0') mean:  tensor(-1.3066e-12, device='cuda:0') min:  tensor(-1.0058e-07, device='cuda:0') norm:  tensor(1.2666e-06, device='cuda:0') MSE:  tensor(1.5960e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0015, device='cuda:0') mean:  tensor(6.6030e-06, device='cuda:0') min:  tensor(9.4222e-15, device='cuda:0') norm:  tensor(0.0126, device='cuda:0') MSE:  tensor(1.5924e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0988, device='cuda:0')
min of d_p_list:  tensor(-0.1106, device='cuda:0')
Epoch:  294  
Training Loss: 0.025389734655618668
Test Loss:  0.021106496453285217
Test Acc:  0.0
Valid Loss:  0.02916703000664711
Valid Acc:  0.0
std:  0.006461203027039571 
thres:  3.358533047139645e-05
Preserved_eigens number check:  512
 29%|██▉       | 294/1000 [1:23:31<2:54:23, 14.82s/it]Epoch:   295
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  489
Criterion check: 
Mean:  tensor(2.2419, device='cuda:0') 
Std:  tensor(26.0483, device='cuda:0') 
ABS Max:  tensor(508.2170, device='cuda:0') 
ABS Min:  tensor(0.0005, device='cuda:0')
Criterion check:  tensor([1.0006, 0.9996, 1.0001, 1.0000, 0.9996, 1.0001, 1.0006, 1.0009, 1.0348,
        1.0051], device='cuda:0') tensor(143, device='cuda:0')
max of Lambda2 tensor(71606.9844, device='cuda:0')
min of Lambda2 tensor(1.7351e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1087, device='cuda:0')
min of grad d_p:  tensor(-0.0738, device='cuda:0')
max|min: (J_L, Jta/N)  (0.10870116204023361, 0.10870122164487839, ratio: 1.0000005960464478)|(-0.07380520552396774, -0.07380514591932297)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.9407e-08, device='cuda:0') mean:  tensor(-4.9082e-11, device='cuda:0') min:  tensor(-1.4901e-07, device='cuda:0') norm:  tensor(1.8428e-06, device='cuda:0') MSE:  tensor(2.3221e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(1.3677e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0028, device='cuda:0') MSE:  tensor(3.5286e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0977, device='cuda:0')
min of d_p_list:  tensor(-0.1264, device='cuda:0')
Epoch:  295  
Training Loss: 0.023202724754810333
Test Loss:  0.019664771854877472
Test Acc:  0.0
Valid Loss:  0.026341665536165237
Valid Acc:  0.0
std:  0.005432881474373477 
thres:  2.9611485078930855e-05
Preserved_eigens number check:  512
 30%|██▉       | 295/1000 [1:23:46<2:53:49, 14.79s/it]Epoch:   296
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  486
Criterion check: 
Mean:  tensor(1.4110, device='cuda:0') 
Std:  tensor(17.7392, device='cuda:0') 
ABS Max:  tensor(309.8448, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([1.0015, 1.0004, 1.0002, 1.0000, 1.0000, 1.0002, 0.9999, 0.9970, 0.9922,
        0.7359], device='cuda:0') tensor(131, device='cuda:0')
max of Lambda2 tensor(71654.7812, device='cuda:0')
min of Lambda2 tensor(2.0464e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0993, device='cuda:0')
min of grad d_p:  tensor(-0.0636, device='cuda:0')
max|min: (J_L, Jta/N)  (0.09931410849094391, 0.09931392967700958, ratio: 0.9999982118606567)|(-0.06358221173286438, -0.06358224898576736)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.7881e-07, device='cuda:0') mean:  tensor(3.9690e-11, device='cuda:0') min:  tensor(-6.8918e-08, device='cuda:0') norm:  tensor(1.9729e-06, device='cuda:0') MSE:  tensor(2.4861e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(2.0207e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0037, device='cuda:0') MSE:  tensor(4.6969e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0450, device='cuda:0')
min of d_p_list:  tensor(-0.0456, device='cuda:0')
Epoch:  296  
Training Loss: 0.01916251704096794
Test Loss:  0.01639091596007347
Test Acc:  0.0
Valid Loss:  0.022060483694076538
Valid Acc:  0.0
std:  0.0045073008568852265 
thres:  2.573312111198902e-05
Preserved_eigens number check:  512
 30%|██▉       | 296/1000 [1:24:00<2:53:17, 14.77s/it]Epoch:   297
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  485
Criterion check: 
Mean:  tensor(-2.0332, device='cuda:0') 
Std:  tensor(70.0783, device='cuda:0') 
ABS Max:  tensor(1469.9620, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([1.0005, 1.0006, 0.9991, 1.0000, 1.0000, 1.0002, 0.9993, 0.9996, 1.0121,
        0.9414], device='cuda:0') tensor(148, device='cuda:0')
max of Lambda2 tensor(71560.9609, device='cuda:0')
min of Lambda2 tensor(4.8897e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0906, device='cuda:0')
min of grad d_p:  tensor(-0.0576, device='cuda:0')
max|min: (J_L, Jta/N)  (0.09064885973930359, 0.09064894169569016, ratio: 1.0000009536743164)|(-0.05763768032193184, -0.05763767659664154)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.5879e-08, device='cuda:0') mean:  tensor(8.1678e-13, device='cuda:0') min:  tensor(-9.3132e-08, device='cuda:0') norm:  tensor(8.1179e-07, device='cuda:0') MSE:  tensor(1.0229e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(2.3319e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0046, device='cuda:0') MSE:  tensor(5.8016e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0610, device='cuda:0')
min of d_p_list:  tensor(-0.0692, device='cuda:0')
Epoch:  297  
Training Loss: 0.01648332178592682
Test Loss:  0.01447896659374237
Test Acc:  0.0
Valid Loss:  0.01879953406751156
Valid Acc:  0.0
std:  0.004306457570260827 
thres:  2.255696542561054e-05
Preserved_eigens number check:  512
 30%|██▉       | 297/1000 [1:24:15<2:52:32, 14.73s/it]Epoch:   298
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  484
Criterion check: 
Mean:  tensor(-1.2221, device='cuda:0') 
Std:  tensor(30.9676, device='cuda:0') 
ABS Max:  tensor(552.0851, device='cuda:0') 
ABS Min:  tensor(0.0006, device='cuda:0')
Criterion check:  tensor([0.9960, 0.9982, 0.9996, 0.9999, 1.0004, 0.9992, 1.0008, 0.9842, 0.9580,
        1.0414], device='cuda:0') tensor(148, device='cuda:0')
max of Lambda2 tensor(71553.1016, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0823, device='cuda:0')
min of grad d_p:  tensor(-0.0509, device='cuda:0')
max|min: (J_L, Jta/N)  (0.08231477439403534, 0.08231478929519653, ratio: 1.000000238418579)|(-0.05091581121087074, -0.05091578885912895)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.1548e-07, device='cuda:0') mean:  tensor(-6.3493e-11, device='cuda:0') min:  tensor(-1.8813e-07, device='cuda:0') norm:  tensor(2.2587e-06, device='cuda:0') MSE:  tensor(2.8461e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(3.1416e-06, device='cuda:0') min:  tensor(1.9106e-15, device='cuda:0') norm:  tensor(0.0063, device='cuda:0') MSE:  tensor(7.9056e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0285, device='cuda:0')
min of d_p_list:  tensor(-0.0213, device='cuda:0')
Epoch:  298  
Training Loss: 0.013375337235629559
Test Loss:  0.011888125911355019
Test Acc:  0.0
Valid Loss:  0.015185663476586342
Valid Acc:  0.0
std:  0.004361703760951784 
thres:  1.9522727094590665e-05
Preserved_eigens number check:  512
 30%|██▉       | 298/1000 [1:24:30<2:52:13, 14.72s/it]Epoch:   299
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  484
Criterion check: 
Mean:  tensor(-0.5223, device='cuda:0') 
Std:  tensor(34.9264, device='cuda:0') 
ABS Max:  tensor(658.1842, device='cuda:0') 
ABS Min:  tensor(0.0001, device='cuda:0')
Criterion check:  tensor([0.9989, 1.0002, 0.9995, 1.0001, 1.0004, 1.0002, 0.9994, 0.9940, 1.0270,
        1.0135], device='cuda:0') tensor(144, device='cuda:0')
max of Lambda2 tensor(71519.6484, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0749, device='cuda:0')
min of grad d_p:  tensor(-0.0471, device='cuda:0')
max|min: (J_L, Jta/N)  (0.07493992894887924, 0.0749397799372673, ratio: 0.9999980330467224)|(-0.047079868614673615, -0.047079898416996)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.6019e-07, device='cuda:0') mean:  tensor(1.9075e-11, device='cuda:0') min:  tensor(-7.8231e-08, device='cuda:0') norm:  tensor(1.4974e-06, device='cuda:0') MSE:  tensor(1.8869e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(2.2476e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0046, device='cuda:0') MSE:  tensor(5.7701e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0132, device='cuda:0')
min of d_p_list:  tensor(-0.0268, device='cuda:0')
Epoch:  299  
Training Loss: 0.010579233057796955
Test Loss:  0.00952223315834999
Test Acc:  0.0
Valid Loss:  0.01200465951114893
Valid Acc:  0.0
std:  0.004400373048746973 
thres:  1.6560626775026324e-05
Preserved_eigens number check:  512
 30%|██▉       | 299/1000 [1:24:45<2:51:53, 14.71s/it]Epoch:   300
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  482
Criterion check: 
Mean:  tensor(-7.2196, device='cuda:0') 
Std:  tensor(160.5775, device='cuda:0') 
ABS Max:  tensor(3378.7693, device='cuda:0') 
ABS Min:  tensor(0.0009, device='cuda:0')
Criterion check:  tensor([1.0005, 1.0007, 1.0004, 0.9997, 0.9983, 1.0025, 1.0019, 1.0293, 0.8007,
        0.9414], device='cuda:0') tensor(174, device='cuda:0')
max of Lambda2 tensor(71529.5156, device='cuda:0')
min of Lambda2 tensor(4.5381e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0683, device='cuda:0')
min of grad d_p:  tensor(-0.0432, device='cuda:0')
max|min: (J_L, Jta/N)  (0.0683361366391182, 0.06833616644144058, ratio: 1.0000004768371582)|(-0.04324990138411522, -0.04324989765882492)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.9802e-08, device='cuda:0') mean:  tensor(-1.6832e-11, device='cuda:0') min:  tensor(-4.0978e-08, device='cuda:0') norm:  tensor(5.2518e-07, device='cuda:0') MSE:  tensor(6.6177e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0010, device='cuda:0') mean:  tensor(6.5546e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0127, device='cuda:0') MSE:  tensor(1.6059e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0905, device='cuda:0')
min of d_p_list:  tensor(-0.0877, device='cuda:0')
Epoch:  300  
Training Loss: 0.00948471762239933
Test Loss:  0.00889267772436142
Test Acc:  0.0
Valid Loss:  0.010470635257661343
Valid Acc:  0.0
std:  0.0036091743007756606 
thres:  1.381702534854412e-05
Preserved_eigens number check:  512
 30%|███       | 300/1000 [1:24:59<2:52:02, 14.75s/it]Epoch:   301
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  485
Criterion check: 
Mean:  tensor(-1.4985, device='cuda:0') 
Std:  tensor(22.8826, device='cuda:0') 
ABS Max:  tensor(293.8549, device='cuda:0') 
ABS Min:  tensor(0.0001, device='cuda:0')
Criterion check:  tensor([0.9930, 1.0001, 1.0015, 1.0000, 1.0009, 1.0022, 0.9993, 1.0029, 1.0848,
        1.0993], device='cuda:0') tensor(145, device='cuda:0')
max of Lambda2 tensor(71140.3047, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0625, device='cuda:0')
min of grad d_p:  tensor(-0.0436, device='cuda:0')
max|min: (J_L, Jta/N)  (0.06252112984657288, 0.06252099573612213, ratio: 0.9999978542327881)|(-0.04358801618218422, -0.0435880683362484)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.7509e-07, device='cuda:0') mean:  tensor(3.3247e-11, device='cuda:0') min:  tensor(-8.1956e-08, device='cuda:0') norm:  tensor(1.7740e-06, device='cuda:0') MSE:  tensor(2.2354e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0009, device='cuda:0') mean:  tensor(3.3547e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0070, device='cuda:0') MSE:  tensor(8.8620e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0403, device='cuda:0')
min of d_p_list:  tensor(-0.0549, device='cuda:0')
Epoch:  301  
Training Loss: 0.008029884658753872
Test Loss:  0.0075804926455020905
Test Acc:  0.0
Valid Loss:  0.008876144886016846
Valid Acc:  0.0
std:  0.003008664515862379 
thres:  1.1590498872101307e-05
Preserved_eigens number check:  512
 30%|███       | 301/1000 [1:25:14<2:51:40, 14.74s/it]Epoch:   302
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  481
Criterion check: 
Mean:  tensor(0.8195, device='cuda:0') 
Std:  tensor(15.9567, device='cuda:0') 
ABS Max:  tensor(311.6827, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([1.0012, 0.9995, 1.0005, 1.0000, 0.9997, 1.0003, 1.0000, 1.0029, 0.9867,
        0.9860], device='cuda:0') tensor(115, device='cuda:0')
max of Lambda2 tensor(71086.5156, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0560, device='cuda:0')
min of grad d_p:  tensor(-0.0396, device='cuda:0')
max|min: (J_L, Jta/N)  (0.05601298436522484, 0.05601290240883827, ratio: 0.9999985098838806)|(-0.03955253213644028, -0.03955262154340744)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.6135e-07, device='cuda:0') mean:  tensor(4.0861e-11, device='cuda:0') min:  tensor(-7.9162e-08, device='cuda:0') norm:  tensor(1.6502e-06, device='cuda:0') MSE:  tensor(2.0793e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(1.0427e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0022, device='cuda:0') MSE:  tensor(2.7394e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0437, device='cuda:0')
min of d_p_list:  tensor(-0.0156, device='cuda:0')
Epoch:  302  
Training Loss: 0.006651927717030048
Test Loss:  0.006187926046550274
Test Acc:  0.0
Valid Loss:  0.007461802568286657
Valid Acc:  0.0
std:  0.0022969030438877995 
thres:  9.624220058321952e-06
Preserved_eigens number check:  512
 30%|███       | 302/1000 [1:25:29<2:51:50, 14.77s/it]Epoch:   303
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  483
Criterion check: 
Mean:  tensor(-1.8396, device='cuda:0') 
Std:  tensor(23.1101, device='cuda:0') 
ABS Max:  tensor(359.6216, device='cuda:0') 
ABS Min:  tensor(8.3001e-05, device='cuda:0')
Criterion check:  tensor([0.9987, 0.9985, 0.9993, 0.9998, 0.9991, 0.9996, 0.9991, 0.9829, 0.9138,
        0.8807], device='cuda:0') tensor(143, device='cuda:0')
max of Lambda2 tensor(71165.4844, device='cuda:0')
min of Lambda2 tensor(1.8955e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0509, device='cuda:0')
min of grad d_p:  tensor(-0.0361, device='cuda:0')
max|min: (J_L, Jta/N)  (0.050927747040987015, 0.05092776566743851, ratio: 1.0000003576278687)|(-0.03605901449918747, -0.03605899214744568)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.7008e-08, device='cuda:0') mean:  tensor(-9.7002e-12, device='cuda:0') min:  tensor(-4.7963e-08, device='cuda:0') norm:  tensor(5.2942e-07, device='cuda:0') MSE:  tensor(6.6711e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(2.6682e-06, device='cuda:0') min:  tensor(1.0412e-14, device='cuda:0') norm:  tensor(0.0048, device='cuda:0') MSE:  tensor(5.9860e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.3187, device='cuda:0')
min of d_p_list:  tensor(-0.1832, device='cuda:0')
Epoch:  303  
Training Loss: 0.008945816196501255
Test Loss:  0.007779099512845278
Test Acc:  0.0
Valid Loss:  0.010089540854096413
Valid Acc:  0.0
std:  0.0013299652897523443 
thres:  8.738315850496292e-06
Preserved_eigens number check:  512
 30%|███       | 303/1000 [1:25:44<2:51:21, 14.75s/it]Epoch:   304
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  486
Criterion check: 
Mean:  tensor(-7.7616, device='cuda:0') 
Std:  tensor(138.4102, device='cuda:0') 
ABS Max:  tensor(2394.1301, device='cuda:0') 
ABS Min:  tensor(0.0004, device='cuda:0')
Criterion check:  tensor([0.9957, 0.9969, 1.2110, 1.0003, 0.9998, 0.9997, 1.0006, 0.9911, 1.0766,
        1.0687], device='cuda:0') tensor(158, device='cuda:0')
max of Lambda2 tensor(72216.3359, device='cuda:0')
min of Lambda2 tensor(3.0483e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0451, device='cuda:0')
min of grad d_p:  tensor(-0.0387, device='cuda:0')
max|min: (J_L, Jta/N)  (0.045148227363824844, 0.04514840617775917, ratio: 1.0000039339065552)|(-0.03874564543366432, -0.03874558210372925)

 check Jacobi res:  torch.Size([793601]) max:  tensor(9.1270e-08, device='cuda:0') mean:  tensor(-3.2312e-11, device='cuda:0') min:  tensor(-2.0675e-07, device='cuda:0') norm:  tensor(2.2338e-06, device='cuda:0') MSE:  tensor(2.8148e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0007, device='cuda:0') mean:  tensor(5.8189e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0115, device='cuda:0') MSE:  tensor(1.4536e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0239, device='cuda:0')
min of d_p_list:  tensor(-0.0291, device='cuda:0')
Epoch:  304  
Training Loss: 0.007080962881445885
Test Loss:  0.006146029569208622
Test Acc:  0.0
Valid Loss:  0.008211608044803143
Valid Acc:  0.0
std:  0.0010727816380107602 
thres:  8.038661815226079e-06
Preserved_eigens number check:  512
 30%|███       | 304/1000 [1:25:58<2:50:47, 14.72s/it]Epoch:   305
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  484
Criterion check: 
Mean:  tensor(-58.2096, device='cuda:0') 
Std:  tensor(1355.1519, device='cuda:0') 
ABS Max:  tensor(30628.5410, device='cuda:0') 
ABS Min:  tensor(0.0001, device='cuda:0')
Criterion check:  tensor([1.0054, 1.0084, 0.9855, 1.0000, 1.0002, 1.0001, 0.9990, 0.9980, 1.0128,
        1.0120], device='cuda:0') tensor(156, device='cuda:0')
max of Lambda2 tensor(72263.0234, device='cuda:0')
min of Lambda2 tensor(2.4896e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0411, device='cuda:0')
min of grad d_p:  tensor(-0.0355, device='cuda:0')
max|min: (J_L, Jta/N)  (0.041118085384368896, 0.04111798480153084, ratio: 0.9999975562095642)|(-0.03554060682654381, -0.0355406254529953)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.4948e-07, device='cuda:0') mean:  tensor(4.9030e-11, device='cuda:0') min:  tensor(-7.6136e-08, device='cuda:0') norm:  tensor(1.7067e-06, device='cuda:0') MSE:  tensor(2.1506e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0006, device='cuda:0') mean:  tensor(3.0545e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0062, device='cuda:0') MSE:  tensor(7.7950e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0810, device='cuda:0')
min of d_p_list:  tensor(-0.0951, device='cuda:0')
Epoch:  305  
Training Loss: 0.0064656357280910015
Test Loss:  0.005368855781853199
Test Acc:  0.0
Valid Loss:  0.007550620939582586
Valid Acc:  0.0
std:  0.0009289418486326448 
thres:  7.434845436364413e-06
Preserved_eigens number check:  512
 30%|███       | 305/1000 [1:26:13<2:50:20, 14.71s/it]Epoch:   306
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  488
Criterion check: 
Mean:  tensor(46.4094, device='cuda:0') 
Std:  tensor(1068.6735, device='cuda:0') 
ABS Max:  tensor(24176.2539, device='cuda:0') 
ABS Min:  tensor(0.0007, device='cuda:0')
Criterion check:  tensor([1.0021, 0.9919, 1.0136, 1.0000, 1.0007, 0.9984, 1.0004, 0.9849, 1.0062,
        1.0366], device='cuda:0') tensor(172, device='cuda:0')
max of Lambda2 tensor(72471.2344, device='cuda:0')
min of Lambda2 tensor(1.2108e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0389, device='cuda:0')
min of grad d_p:  tensor(-0.0311, device='cuda:0')
max|min: (J_L, Jta/N)  (0.03893926367163658, 0.038939155638217926, ratio: 0.9999971985816956)|(-0.031076708808541298, -0.03107672557234764)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.2852e-07, device='cuda:0') mean:  tensor(2.5219e-12, device='cuda:0') min:  tensor(-6.5193e-08, device='cuda:0') norm:  tensor(1.3501e-06, device='cuda:0') MSE:  tensor(1.7012e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(2.9092e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0056, device='cuda:0') MSE:  tensor(7.0707e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0943, device='cuda:0')
min of d_p_list:  tensor(-0.0424, device='cuda:0')
Epoch:  306  
Training Loss: 0.004901429638266563
Test Loss:  0.004111488349735737
Test Acc:  0.0
Valid Loss:  0.0058078765869140625
Valid Acc:  0.0
std:  0.0012977937091489262 
thres:  6.809154432266951e-06
Preserved_eigens number check:  512
 31%|███       | 306/1000 [1:26:28<2:50:06, 14.71s/it]Epoch:   307
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  488
Criterion check: 
Mean:  tensor(0.4370, device='cuda:0') 
Std:  tensor(16.0377, device='cuda:0') 
ABS Max:  tensor(264.0094, device='cuda:0') 
ABS Min:  tensor(0.0004, device='cuda:0')
Criterion check:  tensor([1.0018, 0.9992, 0.9994, 1.0000, 0.9979, 1.0007, 1.0009, 0.9993, 1.0080,
        1.0129], device='cuda:0') tensor(156, device='cuda:0')
max of Lambda2 tensor(72158.6250, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0356, device='cuda:0')
min of grad d_p:  tensor(-0.0288, device='cuda:0')
max|min: (J_L, Jta/N)  (0.035634592175483704, 0.035634711384773254, ratio: 1.0000033378601074)|(-0.02880524843931198, -0.028805265203118324)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.1956e-08, device='cuda:0') mean:  tensor(-3.4678e-11, device='cuda:0') min:  tensor(-1.1921e-07, device='cuda:0') norm:  tensor(1.3762e-06, device='cuda:0') MSE:  tensor(1.7341e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(2.7810e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0053, device='cuda:0') MSE:  tensor(6.6563e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0389, device='cuda:0')
min of d_p_list:  tensor(-0.0405, device='cuda:0')
Epoch:  307  
Training Loss: 0.004356295336037874
Test Loss:  0.00367897842079401
Test Acc:  0.0
Valid Loss:  0.005188350565731525
Valid Acc:  0.0
std:  0.0016345736115434026 
thres:  6.350027956068515e-06
Preserved_eigens number check:  512
 31%|███       | 307/1000 [1:26:42<2:49:33, 14.68s/it]Epoch:   308
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  487
Criterion check: 
Mean:  tensor(-5.4144, device='cuda:0') 
Std:  tensor(97.3835, device='cuda:0') 
ABS Max:  tensor(2192.4817, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([0.9980, 1.0042, 1.0122, 1.0000, 1.0037, 0.9993, 1.0008, 0.9965, 0.9759,
        0.9977], device='cuda:0') tensor(162, device='cuda:0')
max of Lambda2 tensor(72360.5703, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0328, device='cuda:0')
min of grad d_p:  tensor(-0.0265, device='cuda:0')
max|min: (J_L, Jta/N)  (0.03278343379497528, 0.03278350085020065, ratio: 1.0000020265579224)|(-0.026487354189157486, -0.02648727223277092)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.0431e-07, device='cuda:0') mean:  tensor(-5.6054e-11, device='cuda:0') min:  tensor(-1.6252e-07, device='cuda:0') norm:  tensor(2.0757e-06, device='cuda:0') MSE:  tensor(2.6155e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0007, device='cuda:0') mean:  tensor(3.4488e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0066, device='cuda:0') MSE:  tensor(8.2916e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0265, device='cuda:0')
min of d_p_list:  tensor(-0.0547, device='cuda:0')
Epoch:  308  
Training Loss: 0.003957980778068304
Test Loss:  0.003294436726719141
Test Acc:  0.0
Valid Loss:  0.004751357715576887
Valid Acc:  0.0
std:  0.001213855604106621 
thres:  5.352460872381925e-06
Preserved_eigens number check:  512
 31%|███       | 308/1000 [1:26:57<2:49:12, 14.67s/it]Epoch:   309
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  484
Criterion check: 
Mean:  tensor(0.7755, device='cuda:0') 
Std:  tensor(13.3272, device='cuda:0') 
ABS Max:  tensor(280.3654, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([1.0038, 0.9956, 0.9868, 1.0001, 1.0002, 1.0001, 0.9994, 0.9988, 1.0054,
        1.0015], device='cuda:0') tensor(147, device='cuda:0')
max of Lambda2 tensor(72490.2734, device='cuda:0')
min of Lambda2 tensor(1.3638e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0298, device='cuda:0')
min of grad d_p:  tensor(-0.0237, device='cuda:0')
max|min: (J_L, Jta/N)  (0.029772164300084114, 0.029772086068987846, ratio: 0.9999973773956299)|(-0.023660698905587196, -0.023660782724618912)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.2136e-07, device='cuda:0') mean:  tensor(2.9610e-11, device='cuda:0') min:  tensor(-5.5879e-08, device='cuda:0') norm:  tensor(1.3327e-06, device='cuda:0') MSE:  tensor(1.6793e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(1.6925e-06, device='cuda:0') min:  tensor(2.6520e-15, device='cuda:0') norm:  tensor(0.0037, device='cuda:0') MSE:  tensor(4.6927e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1096, device='cuda:0')
min of d_p_list:  tensor(-0.0843, device='cuda:0')
Epoch:  309  
Training Loss: 0.0027673598378896713
Test Loss:  0.0024955756962299347
Test Acc:  0.0
Valid Loss:  0.003277902491390705
Valid Acc:  0.0
std:  0.001211678262396792 
thres:  4.489740263670684e-06
Preserved_eigens number check:  512
 31%|███       | 309/1000 [1:27:12<2:48:49, 14.66s/it]Epoch:   310
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  485
Criterion check: 
Mean:  tensor(0.9862, device='cuda:0') 
Std:  tensor(13.8528, device='cuda:0') 
ABS Max:  tensor(261.4176, device='cuda:0') 
ABS Min:  tensor(6.5480e-06, device='cuda:0')
Criterion check:  tensor([0.9989, 1.0019, 1.0045, 1.0001, 0.9999, 0.9995, 1.0003, 1.0026, 0.9936,
        0.9882], device='cuda:0') tensor(133, device='cuda:0')
max of Lambda2 tensor(72597.9766, device='cuda:0')
min of Lambda2 tensor(1.8888e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0272, device='cuda:0')
min of grad d_p:  tensor(-0.0210, device='cuda:0')
max|min: (J_L, Jta/N)  (0.02724163793027401, 0.027241598814725876, ratio: 0.9999985694885254)|(-0.02102724090218544, -0.02102724462747574)

 check Jacobi res:  torch.Size([793601]) max:  tensor(7.2177e-08, device='cuda:0') mean:  tensor(1.3507e-12, device='cuda:0') min:  tensor(-8.1578e-08, device='cuda:0') norm:  tensor(1.0982e-06, device='cuda:0') MSE:  tensor(1.3838e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(7.1128e-05, device='cuda:0') mean:  tensor(6.3527e-07, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0012, device='cuda:0') MSE:  tensor(1.4743e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0110, device='cuda:0')
min of d_p_list:  tensor(-0.0178, device='cuda:0')
Epoch:  310  
Training Loss: 0.0024752006866037846
Test Loss:  0.0022484129294753075
Test Acc:  0.0
Valid Loss:  0.0030158022418618202
Valid Acc:  0.0
std:  0.0009284733184115544 
thres:  3.6916532553732397e-06
Preserved_eigens number check:  512
 31%|███       | 310/1000 [1:27:26<2:48:36, 14.66s/it]Epoch:   311
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  487
Criterion check: 
Mean:  tensor(3.2907, device='cuda:0') 
Std:  tensor(84.7866, device='cuda:0') 
ABS Max:  tensor(1421.7769, device='cuda:0') 
ABS Min:  tensor(3.6687e-05, device='cuda:0')
Criterion check:  tensor([0.9892, 0.9819, 0.8645, 0.9996, 1.0038, 0.9988, 0.9992, 0.9848, 1.0045,
        1.0130], device='cuda:0') tensor(166, device='cuda:0')
max of Lambda2 tensor(72611.6016, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0249, device='cuda:0')
min of grad d_p:  tensor(-0.0194, device='cuda:0')
max|min: (J_L, Jta/N)  (0.0248702559620142, 0.0248703733086586, ratio: 1.000004768371582)|(-0.019419576972723007, -0.019419508054852486)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.2363e-07, device='cuda:0') mean:  tensor(-7.6546e-11, device='cuda:0') min:  tensor(-2.3894e-07, device='cuda:0') norm:  tensor(2.6699e-06, device='cuda:0') MSE:  tensor(3.3643e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(3.9787e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0075, device='cuda:0') MSE:  tensor(9.4597e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0495, device='cuda:0')
min of d_p_list:  tensor(-0.0605, device='cuda:0')
Epoch:  311  
Training Loss: 0.0021064751781523228
Test Loss:  0.0018008998595178127
Test Acc:  0.0
Valid Loss:  0.002546567004173994
Valid Acc:  0.0
std:  0.000871457407804153 
thres:  3.1326623633503917e-06
Preserved_eigens number check:  512
 31%|███       | 311/1000 [1:27:41<2:48:43, 14.69s/it]Epoch:   312
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  484
Criterion check: 
Mean:  tensor(-1.2580, device='cuda:0') 
Std:  tensor(24.4269, device='cuda:0') 
ABS Max:  tensor(340.6416, device='cuda:0') 
ABS Min:  tensor(4.0392e-05, device='cuda:0')
Criterion check:  tensor([1.0090, 1.0002, 1.0079, 1.0001, 0.9989, 1.0029, 0.9988, 1.0046, 1.0084,
        1.0025], device='cuda:0') tensor(143, device='cuda:0')
max of Lambda2 tensor(72523.0312, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0231, device='cuda:0')
min of grad d_p:  tensor(-0.0179, device='cuda:0')
max|min: (J_L, Jta/N)  (0.023097295314073563, 0.023097293451428413, ratio: 0.9999999403953552)|(-0.017894353717565536, -0.01789439469575882)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.3085e-08, device='cuda:0') mean:  tensor(-6.1647e-12, device='cuda:0') min:  tensor(-4.6566e-08, device='cuda:0') norm:  tensor(7.2359e-07, device='cuda:0') MSE:  tensor(9.1178e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(3.3795e-06, device='cuda:0') min:  tensor(6.4038e-15, device='cuda:0') norm:  tensor(0.0067, device='cuda:0') MSE:  tensor(8.4308e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0221, device='cuda:0')
min of d_p_list:  tensor(-0.0154, device='cuda:0')
Epoch:  312  
Training Loss: 0.0020630923099815845
Test Loss:  0.0017574634402990341
Test Acc:  0.0
Valid Loss:  0.0024934709072113037
Valid Acc:  0.0
std:  0.0006916843921263904 
thres:  2.6740217581391333e-06
Preserved_eigens number check:  512
 31%|███       | 312/1000 [1:27:56<2:48:32, 14.70s/it]Epoch:   313
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  485
Criterion check: 
Mean:  tensor(0.1706, device='cuda:0') 
Std:  tensor(5.2505, device='cuda:0') 
ABS Max:  tensor(66.1356, device='cuda:0') 
ABS Min:  tensor(3.6787e-06, device='cuda:0')
Criterion check:  tensor([1.0004, 1.0008, 0.9949, 0.9999, 1.0010, 0.9987, 1.0000, 0.9973, 1.0008,
        1.0058], device='cuda:0') tensor(106, device='cuda:0')
max of Lambda2 tensor(72647.7266, device='cuda:0')
min of Lambda2 tensor(2.6690e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0211, device='cuda:0')
min of grad d_p:  tensor(-0.0159, device='cuda:0')
max|min: (J_L, Jta/N)  (0.021092504262924194, 0.021092550829052925, ratio: 1.0000022649765015)|(-0.01588795892894268, -0.015887917950749397)

 check Jacobi res:  torch.Size([793601]) max:  tensor(6.2631e-08, device='cuda:0') mean:  tensor(-1.6971e-12, device='cuda:0') min:  tensor(-1.1176e-07, device='cuda:0') norm:  tensor(1.1606e-06, device='cuda:0') MSE:  tensor(1.4624e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(6.5007e-05, device='cuda:0') mean:  tensor(8.4577e-07, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0017, device='cuda:0') MSE:  tensor(2.1434e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0139, device='cuda:0')
min of d_p_list:  tensor(-0.0125, device='cuda:0')
Epoch:  313  
Training Loss: 0.001997066894546151
Test Loss:  0.001762939733453095
Test Acc:  0.0
Valid Loss:  0.002454690169543028
Valid Acc:  0.0
std:  0.00029421657408208724 
thres:  2.281838981434703e-06
Preserved_eigens number check:  512
 31%|███▏      | 313/1000 [1:28:10<2:48:18, 14.70s/it]Epoch:   314
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  482
Criterion check: 
Mean:  tensor(1.0879, device='cuda:0') 
Std:  tensor(69.1116, device='cuda:0') 
ABS Max:  tensor(1355.6841, device='cuda:0') 
ABS Min:  tensor(0.0015, device='cuda:0')
Criterion check:  tensor([1.0045, 0.9973, 0.9791, 0.9999, 1.0016, 0.9987, 0.9950, 0.9755, 1.0127,
        0.9910], device='cuda:0') tensor(147, device='cuda:0')
max of Lambda2 tensor(72310.5781, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0192, device='cuda:0')
min of grad d_p:  tensor(-0.0144, device='cuda:0')
max|min: (J_L, Jta/N)  (0.019159605726599693, 0.019159534946084023, ratio: 0.9999963045120239)|(-0.01441027969121933, -0.014410275034606457)

 check Jacobi res:  torch.Size([793601]) max:  tensor(9.8720e-08, device='cuda:0') mean:  tensor(7.1246e-14, device='cuda:0') min:  tensor(-1.2573e-07, device='cuda:0') norm:  tensor(1.8426e-06, device='cuda:0') MSE:  tensor(2.3219e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(2.6171e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0049, device='cuda:0') MSE:  tensor(6.1399e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0343, device='cuda:0')
min of d_p_list:  tensor(-0.0420, device='cuda:0')
Epoch:  314  
Training Loss: 0.002274071564897895
Test Loss:  0.0018646419048309326
Test Acc:  0.0
Valid Loss:  0.0027299225330352783
Valid Acc:  0.0
std:  0.00017232534867259077 
thres:  2.1831813268363476e-06
Preserved_eigens number check:  512
 31%|███▏      | 314/1000 [1:28:25<2:48:07, 14.70s/it]Epoch:   315
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  483
Criterion check: 
Mean:  tensor(-0.1496, device='cuda:0') 
Std:  tensor(7.1628, device='cuda:0') 
ABS Max:  tensor(119.3278, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([0.9984, 1.0007, 1.0093, 1.0001, 1.0003, 1.0012, 0.9980, 0.9864, 0.9992,
        1.0277], device='cuda:0') tensor(116, device='cuda:0')
max of Lambda2 tensor(72297.0156, device='cuda:0')
min of Lambda2 tensor(2.5102e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0177, device='cuda:0')
min of grad d_p:  tensor(-0.0134, device='cuda:0')
max|min: (J_L, Jta/N)  (0.01770791783928871, 0.017707830294966698, ratio: 0.9999950528144836)|(-0.013366343453526497, -0.013366357423365116)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.7544e-08, device='cuda:0') mean:  tensor(-1.0886e-11, device='cuda:0') min:  tensor(-8.8476e-08, device='cuda:0') norm:  tensor(1.1644e-06, device='cuda:0') MSE:  tensor(1.4673e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(1.1670e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0024, device='cuda:0') MSE:  tensor(3.0134e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0505, device='cuda:0')
min of d_p_list:  tensor(-0.0449, device='cuda:0')
Epoch:  315  
Training Loss: 0.003012030851095915
Test Loss:  0.0024044832680374384
Test Acc:  0.0
Valid Loss:  0.0033727195113897324
Valid Acc:  0.0
std:  0.00037217174295216113 
thres:  2.290547359734774e-06
Preserved_eigens number check:  512
 32%|███▏      | 315/1000 [1:28:40<2:47:53, 14.71s/it]Epoch:   316
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  482
Criterion check: 
Mean:  tensor(-4.5566, device='cuda:0') 
Std:  tensor(75.4249, device='cuda:0') 
ABS Max:  tensor(1292.5704, device='cuda:0') 
ABS Min:  tensor(3.9738e-06, device='cuda:0')
Criterion check:  tensor([1.0016, 0.9990, 1.0026, 1.0000, 1.0012, 1.0008, 1.0004, 0.9989, 1.0007,
        1.0003], device='cuda:0') tensor(108, device='cuda:0')
max of Lambda2 tensor(72158.4453, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0165, device='cuda:0')
min of grad d_p:  tensor(-0.0131, device='cuda:0')
max|min: (J_L, Jta/N)  (0.01653478294610977, 0.01653491146862507, ratio: 1.0000077486038208)|(-0.013138994574546814, -0.013138961046934128)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.9837e-08, device='cuda:0') mean:  tensor(-2.9768e-11, device='cuda:0') min:  tensor(-1.3039e-07, device='cuda:0') norm:  tensor(1.3216e-06, device='cuda:0') MSE:  tensor(1.6654e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(8.4313e-05, device='cuda:0') mean:  tensor(6.0432e-07, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0012, device='cuda:0') MSE:  tensor(1.5006e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0244, device='cuda:0')
min of d_p_list:  tensor(-0.0217, device='cuda:0')
Epoch:  316  
Training Loss: 0.0022289659827947617
Test Loss:  0.0018584313802421093
Test Acc:  0.0
Valid Loss:  0.002589623210951686
Valid Acc:  0.0
std:  0.0003631715654533439 
thres:  2.3150455206632618e-06
Preserved_eigens number check:  512
 32%|███▏      | 316/1000 [1:28:54<2:47:23, 14.68s/it]Epoch:   317
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  483
Criterion check: 
Mean:  tensor(-1.8130, device='cuda:0') 
Std:  tensor(33.5774, device='cuda:0') 
ABS Max:  tensor(699.3500, device='cuda:0') 
ABS Min:  tensor(2.2336e-05, device='cuda:0')
Criterion check:  tensor([0.9943, 0.9967, 0.9969, 1.0000, 1.0006, 1.0011, 1.0000, 1.0256, 1.0055,
        0.9971], device='cuda:0') tensor(129, device='cuda:0')
max of Lambda2 tensor(72236.3906, device='cuda:0')
min of Lambda2 tensor(2.2718e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0151, device='cuda:0')
min of grad d_p:  tensor(-0.0123, device='cuda:0')
max|min: (J_L, Jta/N)  (0.015079870820045471, 0.01507990900427103, ratio: 1.0000025033950806)|(-0.012259131297469139, -0.012259083800017834)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.0792e-08, device='cuda:0') mean:  tensor(4.1754e-12, device='cuda:0') min:  tensor(-9.3365e-08, device='cuda:0') norm:  tensor(1.2404e-06, device='cuda:0') MSE:  tensor(1.5631e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(1.3494e-06, device='cuda:0') min:  tensor(1.5261e-15, device='cuda:0') norm:  tensor(0.0025, device='cuda:0') MSE:  tensor(3.1840e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0621, device='cuda:0')
min of d_p_list:  tensor(-0.0547, device='cuda:0')
Epoch:  317  
Training Loss: 0.002204990480095148
Test Loss:  0.0017750337719917297
Test Acc:  0.0
Valid Loss:  0.0025887899100780487
Valid Acc:  0.0
std:  0.0003475838325395732 
thres:  2.343425154685974e-06
Preserved_eigens number check:  512
 32%|███▏      | 317/1000 [1:29:09<2:47:21, 14.70s/it]Epoch:   318
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  483
Criterion check: 
Mean:  tensor(-6.2851, device='cuda:0') 
Std:  tensor(84.4123, device='cuda:0') 
ABS Max:  tensor(1414.9346, device='cuda:0') 
ABS Min:  tensor(0.0008, device='cuda:0')
Criterion check:  tensor([1.0081, 0.9903, 1.0060, 0.9996, 0.9978, 1.0058, 1.0001, 1.0170, 0.9893,
        0.9473], device='cuda:0') tensor(133, device='cuda:0')
max of Lambda2 tensor(72041.1641, device='cuda:0')
min of Lambda2 tensor(6.1498e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0138, device='cuda:0')
min of grad d_p:  tensor(-0.0113, device='cuda:0')
max|min: (J_L, Jta/N)  (0.013814875856041908, 0.013814919628202915, ratio: 1.0000032186508179)|(-0.011341417208313942, -0.011341309174895287)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.9162e-07, device='cuda:0') mean:  tensor(1.7953e-11, device='cuda:0') min:  tensor(-1.6741e-07, device='cuda:0') norm:  tensor(2.8080e-06, device='cuda:0') MSE:  tensor(3.5383e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(1.6161e-06, device='cuda:0') min:  tensor(4.2363e-15, device='cuda:0') norm:  tensor(0.0033, device='cuda:0') MSE:  tensor(4.1171e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0244, device='cuda:0')
min of d_p_list:  tensor(-0.0236, device='cuda:0')
Epoch:  318  
Training Loss: 0.001989444252103567
Test Loss:  0.0016465694643557072
Test Acc:  0.0
Valid Loss:  0.002407981315627694
Valid Acc:  0.0
std:  0.00034911299526225 
thres:  2.3419006261974573e-06
Preserved_eigens number check:  512
 32%|███▏      | 318/1000 [1:29:24<2:47:23, 14.73s/it]Epoch:   319
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  486
Criterion check: 
Mean:  tensor(6.9145, device='cuda:0') 
Std:  tensor(91.9414, device='cuda:0') 
ABS Max:  tensor(1536.9314, device='cuda:0') 
ABS Min:  tensor(0.0009, device='cuda:0')
Criterion check:  tensor([0.9902, 1.0101, 1.0071, 1.0002, 1.0081, 0.9941, 0.9961, 1.0210, 1.0241,
        1.0691], device='cuda:0') tensor(158, device='cuda:0')
max of Lambda2 tensor(72095.6641, device='cuda:0')
min of Lambda2 tensor(4.8545e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0126, device='cuda:0')
min of grad d_p:  tensor(-0.0104, device='cuda:0')
max|min: (J_L, Jta/N)  (0.012553781270980835, 0.012553881853818893, ratio: 1.0000079870224)|(-0.01035822182893753, -0.01035813894122839)

 check Jacobi res:  torch.Size([793601]) max:  tensor(7.7998e-08, device='cuda:0') mean:  tensor(-4.6372e-11, device='cuda:0') min:  tensor(-1.7369e-07, device='cuda:0') norm:  tensor(1.7874e-06, device='cuda:0') MSE:  tensor(2.2523e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(3.0604e-06, device='cuda:0') min:  tensor(1.1343e-15, device='cuda:0') norm:  tensor(0.0056, device='cuda:0') MSE:  tensor(7.0992e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0578, device='cuda:0')
min of d_p_list:  tensor(-0.0846, device='cuda:0')
Epoch:  319  
Training Loss: 0.0027495231479406357
Test Loss:  0.002180827781558037
Test Acc:  0.0
Valid Loss:  0.0032028923742473125
Valid Acc:  0.0
std:  0.00038098396670117695 
thres:  2.4369909428060057e-06
Preserved_eigens number check:  512
 32%|███▏      | 319/1000 [1:29:39<2:47:33, 14.76s/it]Epoch:   320
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  484
Criterion check: 
Mean:  tensor(-0.4309, device='cuda:0') 
Std:  tensor(8.5132, device='cuda:0') 
ABS Max:  tensor(112.7420, device='cuda:0') 
ABS Min:  tensor(1.8071e-05, device='cuda:0')
Criterion check:  tensor([0.9968, 0.9959, 1.0006, 0.9998, 1.0002, 0.9973, 0.9998, 1.0011, 0.9933,
        0.9887], device='cuda:0') tensor(111, device='cuda:0')
max of Lambda2 tensor(71896.1328, device='cuda:0')
min of Lambda2 tensor(4.2638e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0119, device='cuda:0')
min of grad d_p:  tensor(-0.0108, device='cuda:0')
max|min: (J_L, Jta/N)  (0.011872198432683945, 0.01187216117978096, ratio: 0.9999968409538269)|(-0.01080421544611454, -0.010804272256791592)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.2503e-07, device='cuda:0') mean:  tensor(4.3733e-11, device='cuda:0') min:  tensor(-8.6147e-08, device='cuda:0') norm:  tensor(1.6104e-06, device='cuda:0') MSE:  tensor(2.0292e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(7.5466e-05, device='cuda:0') mean:  tensor(9.0582e-07, device='cuda:0') min:  tensor(8.9761e-16, device='cuda:0') norm:  tensor(0.0016, device='cuda:0') MSE:  tensor(2.0580e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0755, device='cuda:0')
min of d_p_list:  tensor(-0.0511, device='cuda:0')
Epoch:  320  
Training Loss: 0.002258495893329382
Test Loss:  0.0018879929557442665
Test Acc:  0.0
Valid Loss:  0.0028250478208065033
Valid Acc:  0.0
std:  0.00025034796362789546 
thres:  2.286283951252699e-06
Preserved_eigens number check:  512
 32%|███▏      | 320/1000 [1:29:53<2:46:54, 14.73s/it]Epoch:   321
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  483
Criterion check: 
Mean:  tensor(-0.7975, device='cuda:0') 
Std:  tensor(31.6876, device='cuda:0') 
ABS Max:  tensor(604.1439, device='cuda:0') 
ABS Min:  tensor(0.0014, device='cuda:0')
Criterion check:  tensor([0.9995, 0.9871, 0.9189, 0.9995, 0.9992, 0.9969, 1.0015, 0.9910, 1.0266,
        0.9878], device='cuda:0') tensor(164, device='cuda:0')
max of Lambda2 tensor(71845.4453, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0111, device='cuda:0')
min of grad d_p:  tensor(-0.0102, device='cuda:0')
max|min: (J_L, Jta/N)  (0.011112261563539505, 0.011112216860055923, ratio: 0.9999960064888)|(-0.01017842348664999, -0.01017849426716566)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.4040e-07, device='cuda:0') mean:  tensor(4.7586e-11, device='cuda:0') min:  tensor(-8.6147e-08, device='cuda:0') norm:  tensor(1.7544e-06, device='cuda:0') MSE:  tensor(2.2106e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(2.4280e-06, device='cuda:0') min:  tensor(1.0028e-15, device='cuda:0') norm:  tensor(0.0051, device='cuda:0') MSE:  tensor(6.3659e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0152, device='cuda:0')
min of d_p_list:  tensor(-0.0140, device='cuda:0')
Epoch:  321  
Training Loss: 0.002087279222905636
Test Loss:  0.0017963064601644874
Test Acc:  0.0
Valid Loss:  0.0026969294995069504
Valid Acc:  0.0
std:  0.00026293459995745626 
thres:  2.257946599274874e-06
Preserved_eigens number check:  512
 32%|███▏      | 321/1000 [1:30:08<2:46:21, 14.70s/it]Epoch:   322
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  483
Criterion check: 
Mean:  tensor(0.2769, device='cuda:0') 
Std:  tensor(6.5764, device='cuda:0') 
ABS Max:  tensor(75.6775, device='cuda:0') 
ABS Min:  tensor(0.0001, device='cuda:0')
Criterion check:  tensor([0.9984, 1.0050, 1.0147, 1.0000, 0.9998, 1.0007, 0.9992, 0.9989, 0.9915,
        1.0132], device='cuda:0') tensor(118, device='cuda:0')
max of Lambda2 tensor(71833.3047, device='cuda:0')
min of Lambda2 tensor(1.3539e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0101, device='cuda:0')
min of grad d_p:  tensor(-0.0093, device='cuda:0')
max|min: (J_L, Jta/N)  (0.010061455890536308, 0.01006145030260086, ratio: 0.999999463558197)|(-0.009281821548938751, -0.009281800128519535)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.6077e-08, device='cuda:0') mean:  tensor(-3.6225e-12, device='cuda:0') min:  tensor(-2.8405e-08, device='cuda:0') norm:  tensor(4.2812e-07, device='cuda:0') MSE:  tensor(5.3946e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(1.3537e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0025, device='cuda:0') MSE:  tensor(3.2046e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0983, device='cuda:0')
min of d_p_list:  tensor(-0.0710, device='cuda:0')
Epoch:  322  
Training Loss: 0.0019532162696123123
Test Loss:  0.0017249597003683448
Test Acc:  0.0
Valid Loss:  0.002548103453591466
Valid Acc:  0.0
std:  0.00029087839105673105 
thres:  2.2075917571783067e-06
Preserved_eigens number check:  512
 32%|███▏      | 322/1000 [1:30:23<2:46:05, 14.70s/it]Epoch:   323
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  485
Criterion check: 
Mean:  tensor(-0.9932, device='cuda:0') 
Std:  tensor(59.6131, device='cuda:0') 
ABS Max:  tensor(1290.3408, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([1.0048, 1.0008, 1.0037, 1.0000, 0.9995, 1.0001, 1.0001, 0.9043, 1.0076,
        0.9945], device='cuda:0') tensor(127, device='cuda:0')
max of Lambda2 tensor(72088.4219, device='cuda:0')
min of Lambda2 tensor(2.1417e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0109, device='cuda:0')
min of grad d_p:  tensor(-0.0091, device='cuda:0')
max|min: (J_L, Jta/N)  (0.010933520272374153, 0.010933554731309414, ratio: 1.0000030994415283)|(-0.009105302393436432, -0.009105287492275238)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.8743e-08, device='cuda:0') mean:  tensor(-1.1728e-11, device='cuda:0') min:  tensor(-5.4948e-08, device='cuda:0') norm:  tensor(5.5759e-07, device='cuda:0') MSE:  tensor(7.0261e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(1.1525e-06, device='cuda:0') min:  tensor(5.3429e-16, device='cuda:0') norm:  tensor(0.0024, device='cuda:0') MSE:  tensor(3.0340e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0441, device='cuda:0')
min of d_p_list:  tensor(-0.0527, device='cuda:0')
Epoch:  323  
Training Loss: 0.001986395800486207
Test Loss:  0.0017140691634267569
Test Acc:  0.0
Valid Loss:  0.0025259419344365597
Valid Acc:  0.0
std:  0.00029133782816308284 
thres:  2.2069820668548347e-06
Preserved_eigens number check:  512
 32%|███▏      | 323/1000 [1:30:38<2:47:59, 14.89s/it]Epoch:   324
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  485
Criterion check: 
Mean:  tensor(-1.1339, device='cuda:0') 
Std:  tensor(29.4097, device='cuda:0') 
ABS Max:  tensor(474.6416, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([0.9997, 1.0004, 1.0009, 1.0001, 1.0005, 1.0009, 0.9998, 1.0893, 1.0305,
        1.0071], device='cuda:0') tensor(131, device='cuda:0')
max of Lambda2 tensor(72161.7109, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0104, device='cuda:0')
min of grad d_p:  tensor(-0.0090, device='cuda:0')
max|min: (J_L, Jta/N)  (0.0104044945910573, 0.010404525324702263, ratio: 1.0000029802322388)|(-0.009007670916616917, -0.009007630869746208)

 check Jacobi res:  torch.Size([793601]) max:  tensor(6.1467e-08, device='cuda:0') mean:  tensor(-3.4804e-11, device='cuda:0') min:  tensor(-1.0512e-07, device='cuda:0') norm:  tensor(1.2949e-06, device='cuda:0') MSE:  tensor(1.6317e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(9.5535e-05, device='cuda:0') mean:  tensor(8.7494e-07, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0017, device='cuda:0') MSE:  tensor(2.1431e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0685, device='cuda:0')
min of d_p_list:  tensor(-0.0358, device='cuda:0')
Epoch:  324  
Training Loss: 0.0018399906111881137
Test Loss:  0.0015452139778062701
Test Acc:  0.0
Valid Loss:  0.0022611143067479134
Valid Acc:  0.0
std:  0.00014090469642864513 
thres:  2.0250755595043305e-06
Preserved_eigens number check:  512
 32%|███▏      | 324/1000 [1:30:53<2:47:07, 14.83s/it]Epoch:   325
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  481
Criterion check: 
Mean:  tensor(-356.7902, device='cuda:0') 
Std:  tensor(8013.2681, device='cuda:0') 
ABS Max:  tensor(179227.8594, device='cuda:0') 
ABS Min:  tensor(0.0022, device='cuda:0')
Criterion check:  tensor([ 1.8354,  0.9837,  0.7948,  1.0091,  0.9956,  1.0496,  1.0087, 12.6025,
         2.3426,  1.0896], device='cuda:0') tensor(203, device='cuda:0')
max of Lambda2 tensor(72027.7266, device='cuda:0')
min of Lambda2 tensor(1.3229e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0103, device='cuda:0')
min of grad d_p:  tensor(-0.0082, device='cuda:0')
max|min: (J_L, Jta/N)  (0.01027296669781208, 0.010272933170199394, ratio: 0.9999967217445374)|(-0.008202946744859219, -0.00820293091237545)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.9477e-08, device='cuda:0') mean:  tensor(3.9787e-12, device='cuda:0') min:  tensor(-5.6112e-08, device='cuda:0') norm:  tensor(7.5250e-07, device='cuda:0') MSE:  tensor(9.4821e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0020, device='cuda:0') mean:  tensor(1.9298e-05, device='cuda:0') min:  tensor(1.1862e-14, device='cuda:0') norm:  tensor(0.0389, device='cuda:0') MSE:  tensor(4.8995e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0727, device='cuda:0')
min of d_p_list:  tensor(-0.0690, device='cuda:0')
Epoch:  325  
Training Loss: 0.0015872010262683034
Test Loss:  0.0014272814150899649
Test Acc:  0.0
Valid Loss:  0.002050168579444289
Valid Acc:  0.0
std:  0.00017110953350611571 
thres:  1.8908165860921146e-06
Preserved_eigens number check:  512
 32%|███▎      | 325/1000 [1:31:08<2:46:23, 14.79s/it]Epoch:   326
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  483
Criterion check: 
Mean:  tensor(1.4038, device='cuda:0') 
Std:  tensor(21.7689, device='cuda:0') 
ABS Max:  tensor(457.4121, device='cuda:0') 
ABS Min:  tensor(0.0004, device='cuda:0')
Criterion check:  tensor([1.0048, 0.9970, 0.9956, 0.9998, 0.9989, 0.9997, 1.0008, 0.9808, 0.9867,
        0.9804], device='cuda:0') tensor(140, device='cuda:0')
max of Lambda2 tensor(72080.9453, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0128, device='cuda:0')
min of grad d_p:  tensor(-0.0076, device='cuda:0')
max|min: (J_L, Jta/N)  (0.012843195348978043, 0.012843192555010319, ratio: 0.9999997615814209)|(-0.007584147155284882, -0.007584122009575367)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.7265e-08, device='cuda:0') mean:  tensor(5.8255e-12, device='cuda:0') min:  tensor(-5.8324e-08, device='cuda:0') norm:  tensor(7.0176e-07, device='cuda:0') MSE:  tensor(8.8427e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(9.3863e-07, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0018, device='cuda:0') MSE:  tensor(2.3166e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0212, device='cuda:0')
min of d_p_list:  tensor(-0.0185, device='cuda:0')
Epoch:  326  
Training Loss: 0.00150331761687994
Test Loss:  0.001403861795552075
Test Acc:  0.0
Valid Loss:  0.0019981605000793934
Valid Acc:  0.0
std:  0.00019480657807053475 
thres:  1.7740242648869754e-06
Preserved_eigens number check:  512
 33%|███▎      | 326/1000 [1:31:22<2:45:47, 14.76s/it]Epoch:   327
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  482
Criterion check: 
Mean:  tensor(0.4637, device='cuda:0') 
Std:  tensor(9.5046, device='cuda:0') 
ABS Max:  tensor(197.0655, device='cuda:0') 
ABS Min:  tensor(0.0001, device='cuda:0')
Criterion check:  tensor([1.0001, 1.0020, 1.0005, 1.0002, 0.9993, 0.9991, 0.9996, 0.9984, 1.0117,
        1.0108], device='cuda:0') tensor(105, device='cuda:0')
max of Lambda2 tensor(72125.4453, device='cuda:0')
min of Lambda2 tensor(4.4534e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0117, device='cuda:0')
min of grad d_p:  tensor(-0.0069, device='cuda:0')
max|min: (J_L, Jta/N)  (0.011723246425390244, 0.011723252013325691, ratio: 1.0000004768371582)|(-0.0069230180233716965, -0.006923002656549215)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.7940e-08, device='cuda:0') mean:  tensor(-7.6002e-12, device='cuda:0') min:  tensor(-4.3074e-08, device='cuda:0') norm:  tensor(5.0724e-07, device='cuda:0') MSE:  tensor(6.3916e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(4.1716e-05, device='cuda:0') mean:  tensor(4.3594e-07, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0008, device='cuda:0') MSE:  tensor(1.0386e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.2394, device='cuda:0')
min of d_p_list:  tensor(-0.2504, device='cuda:0')
Epoch:  327  
Training Loss: 0.0032482161186635494
Test Loss:  0.0031273351050913334
Test Acc:  0.0
Valid Loss:  0.003987298812717199
Valid Acc:  0.0
std:  0.0006317396520201876 
thres:  2.0330242346972228e-06
Preserved_eigens number check:  512
 33%|███▎      | 327/1000 [1:31:37<2:44:40, 14.68s/it]Epoch:   328
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  485
Criterion check: 
Mean:  tensor(1.0314, device='cuda:0') 
Std:  tensor(38.5222, device='cuda:0') 
ABS Max:  tensor(785.2657, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([0.9993, 0.9998, 1.0001, 1.0000, 1.0003, 1.0005, 1.0019, 0.9999, 0.9929,
        0.9941], device='cuda:0') tensor(136, device='cuda:0')
max of Lambda2 tensor(74812.0859, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0271, device='cuda:0')
min of grad d_p:  tensor(-0.0327, device='cuda:0')
max|min: (J_L, Jta/N)  (0.027071379125118256, 0.027071500197052956, ratio: 1.000004529953003)|(-0.0327104851603508, -0.032710447907447815)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.0896e-07, device='cuda:0') mean:  tensor(-5.6447e-11, device='cuda:0') min:  tensor(-2.1244e-07, device='cuda:0') norm:  tensor(2.2015e-06, device='cuda:0') MSE:  tensor(2.7741e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(1.9432e-06, device='cuda:0') min:  tensor(5.5793e-16, device='cuda:0') norm:  tensor(0.0039, device='cuda:0') MSE:  tensor(4.9307e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0603, device='cuda:0')
min of d_p_list:  tensor(-0.0603, device='cuda:0')
Epoch:  328  
Training Loss: 0.0022249529138207436
Test Loss:  0.002379428595304489
Test Acc:  0.0
Valid Loss:  0.0029399418272078037
Valid Acc:  0.0
std:  0.0006354141086569553 
thres:  2.08073565736413e-06
Preserved_eigens number check:  512
 33%|███▎      | 328/1000 [1:31:51<2:43:49, 14.63s/it]Epoch:   329
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  487
Criterion check: 
Mean:  tensor(3.7103, device='cuda:0') 
Std:  tensor(72.8683, device='cuda:0') 
ABS Max:  tensor(1426.1821, device='cuda:0') 
ABS Min:  tensor(0.0007, device='cuda:0')
Criterion check:  tensor([1.0037, 0.9980, 0.9999, 1.0001, 1.0024, 1.0025, 1.0199, 1.0059, 0.9534,
        0.9686], device='cuda:0') tensor(178, device='cuda:0')
max of Lambda2 tensor(74645.1016, device='cuda:0')
min of Lambda2 tensor(3.8411e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0247, device='cuda:0')
min of grad d_p:  tensor(-0.0301, device='cuda:0')
max|min: (J_L, Jta/N)  (0.024707814678549767, 0.02470782957971096, ratio: 1.0000005960464478)|(-0.030143119394779205, -0.030143169686198235)

 check Jacobi res:  torch.Size([793601]) max:  tensor(7.4506e-08, device='cuda:0') mean:  tensor(5.0671e-12, device='cuda:0') min:  tensor(-7.3574e-08, device='cuda:0') norm:  tensor(1.1020e-06, device='cuda:0') MSE:  tensor(1.3886e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0008, device='cuda:0') mean:  tensor(5.6701e-06, device='cuda:0') min:  tensor(2.9451e-15, device='cuda:0') norm:  tensor(0.0106, device='cuda:0') MSE:  tensor(1.3349e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0237, device='cuda:0')
min of d_p_list:  tensor(-0.0144, device='cuda:0')
Epoch:  329  
Training Loss: 0.0017573526129126549
Test Loss:  0.0018774683121591806
Test Acc:  0.0
Valid Loss:  0.0024010860361158848
Valid Acc:  0.0
std:  0.0006424963900023381 
thres:  2.064208057709038e-06
Preserved_eigens number check:  512
 33%|███▎      | 329/1000 [1:32:06<2:42:52, 14.56s/it]Epoch:   330
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  484
Criterion check: 
Mean:  tensor(17.1190, device='cuda:0') 
Std:  tensor(284.4648, device='cuda:0') 
ABS Max:  tensor(5908.8521, device='cuda:0') 
ABS Min:  tensor(0.0042, device='cuda:0')
Criterion check:  tensor([0.9996, 0.9904, 1.0147, 0.9986, 0.9857, 1.0469, 0.9968, 0.9495, 1.0507,
        1.0604], device='cuda:0') tensor(205, device='cuda:0')
max of Lambda2 tensor(74658.2500, device='cuda:0')
min of Lambda2 tensor(2.1126e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0225, device='cuda:0')
min of grad d_p:  tensor(-0.0271, device='cuda:0')
max|min: (J_L, Jta/N)  (0.02246934548020363, 0.02246946655213833, ratio: 1.0000053644180298)|(-0.027082834392786026, -0.027082758024334908)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.5216e-08, device='cuda:0') mean:  tensor(-6.6339e-11, device='cuda:0') min:  tensor(-2.0751e-07, device='cuda:0') norm:  tensor(2.2776e-06, device='cuda:0') MSE:  tensor(2.8699e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0026, device='cuda:0') mean:  tensor(1.2210e-05, device='cuda:0') min:  tensor(7.0412e-15, device='cuda:0') norm:  tensor(0.0241, device='cuda:0') MSE:  tensor(3.0305e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1796, device='cuda:0')
min of d_p_list:  tensor(-0.2280, device='cuda:0')
Epoch:  330  
Training Loss: 0.0033583291806280613
Test Loss:  0.003165293950587511
Test Acc:  0.0
Valid Loss:  0.004292498808354139
Valid Acc:  0.0
std:  0.0007594528083743338 
thres:  2.41843368858099e-06
Preserved_eigens number check:  512
 33%|███▎      | 330/1000 [1:32:20<2:42:08, 14.52s/it]Epoch:   331
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  482
Criterion check: 
Mean:  tensor(1.8778, device='cuda:0') 
Std:  tensor(34.5604, device='cuda:0') 
ABS Max:  tensor(724.3016, device='cuda:0') 
ABS Min:  tensor(9.6442e-06, device='cuda:0')
Criterion check:  tensor([0.9995, 1.0008, 1.0012, 1.0001, 0.9995, 0.6374, 1.0050, 1.0047, 0.9865,
        0.9961], device='cuda:0') tensor(141, device='cuda:0')
max of Lambda2 tensor(74905.2500, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0254, device='cuda:0')
min of grad d_p:  tensor(-0.0311, device='cuda:0')
max|min: (J_L, Jta/N)  (0.025395262986421585, 0.025395182892680168, ratio: 0.9999968409538269)|(-0.031141169369220734, -0.031141085550189018)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.0094e-08, device='cuda:0') mean:  tensor(-4.2667e-11, device='cuda:0') min:  tensor(-1.1548e-07, device='cuda:0') norm:  tensor(1.4781e-06, device='cuda:0') MSE:  tensor(1.8626e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(2.2123e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0045, device='cuda:0') MSE:  tensor(5.7231e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0196, device='cuda:0')
min of d_p_list:  tensor(-0.0280, device='cuda:0')
Epoch:  331  
Training Loss: 0.0024857488460838795
Test Loss:  0.0023800358176231384
Test Acc:  0.0
Valid Loss:  0.0032575533259660006
Valid Acc:  0.0
std:  0.0006095740352835508 
thres:  2.6149199344217778e-06
Preserved_eigens number check:  512
 33%|███▎      | 331/1000 [1:32:35<2:41:51, 14.52s/it]Epoch:   332
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  483
Criterion check: 
Mean:  tensor(-0.9390, device='cuda:0') 
Std:  tensor(108.5964, device='cuda:0') 
ABS Max:  tensor(1899.3108, device='cuda:0') 
ABS Min:  tensor(0.0010, device='cuda:0')
Criterion check:  tensor([0.9992, 1.0005, 1.0011, 1.0001, 1.0025, 0.9904, 1.0029, 0.9949, 0.9950,
        1.0029], device='cuda:0') tensor(140, device='cuda:0')
max of Lambda2 tensor(74850.6719, device='cuda:0')
min of Lambda2 tensor(3.4451e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0228, device='cuda:0')
min of grad d_p:  tensor(-0.0279, device='cuda:0')
max|min: (J_L, Jta/N)  (0.022780219092965126, 0.022780146449804306, ratio: 0.9999967813491821)|(-0.027913769707083702, -0.027913684025406837)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.3178e-07, device='cuda:0') mean:  tensor(2.0513e-12, device='cuda:0') min:  tensor(-1.0803e-07, device='cuda:0') norm:  tensor(1.7605e-06, device='cuda:0') MSE:  tensor(2.2184e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(1.8780e-06, device='cuda:0') min:  tensor(4.5038e-15, device='cuda:0') norm:  tensor(0.0044, device='cuda:0') MSE:  tensor(5.5109e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0192, device='cuda:0')
min of d_p_list:  tensor(-0.0186, device='cuda:0')
Epoch:  332  
Training Loss: 0.001959518762305379
Test Loss:  0.0018898248672485352
Test Acc:  0.0
Valid Loss:  0.0026475805789232254
Valid Acc:  0.0
std:  0.0005575376196524882 
thres:  2.357180463150144e-06
Preserved_eigens number check:  512
 33%|███▎      | 332/1000 [1:32:49<2:41:41, 14.52s/it]Epoch:   333
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  482
Criterion check: 
Mean:  tensor(-0.4657, device='cuda:0') 
Std:  tensor(9.4620, device='cuda:0') 
ABS Max:  tensor(114.4719, device='cuda:0') 
ABS Min:  tensor(0.0001, device='cuda:0')
Criterion check:  tensor([1.0000, 0.9972, 0.9995, 1.0000, 1.0018, 0.9405, 0.9959, 1.0017, 1.0144,
        0.9997], device='cuda:0') tensor(125, device='cuda:0')
max of Lambda2 tensor(74800.2656, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0206, device='cuda:0')
min of grad d_p:  tensor(-0.0253, device='cuda:0')
max|min: (J_L, Jta/N)  (0.02064487338066101, 0.020644813776016235, ratio: 0.9999971389770508)|(-0.02530018426477909, -0.025300126522779465)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.0058e-07, device='cuda:0') mean:  tensor(-6.5340e-11, device='cuda:0') min:  tensor(-2.2817e-07, device='cuda:0') norm:  tensor(2.3610e-06, device='cuda:0') MSE:  tensor(2.9751e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(1.9217e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0037, device='cuda:0') MSE:  tensor(4.7215e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(2.4725, device='cuda:0')
min of d_p_list:  tensor(-2.4722, device='cuda:0')
Epoch:  333  
Training Loss: 0.4971452057361603
Test Loss:  0.5399779081344604
Test Acc:  0.0
Valid Loss:  0.5425660014152527
Valid Acc:  0.0
std:  0.19790276166829054 
thres:  0.00010134123102761805
Preserved_eigens number check:  512
 33%|███▎      | 333/1000 [1:33:04<2:41:29, 14.53s/it]Epoch:   334
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  484
Criterion check: 
Mean:  tensor(0.9473, device='cuda:0') 
Std:  tensor(29.8716, device='cuda:0') 
ABS Max:  tensor(639.2573, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0002, 1.0000, 1.0000, 0.9999, 1.0000, 1.0033, 0.9999,
        0.9984], device='cuda:0') tensor(116, device='cuda:0')
max of Lambda2 tensor(72186.7812, device='cuda:0')
min of Lambda2 tensor(5.5625e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3475, device='cuda:0')
min of grad d_p:  tensor(-0.3856, device='cuda:0')
max|min: (J_L, Jta/N)  (0.347538560628891, 0.34753847122192383, ratio: 0.9999997615814209)|(-0.38564547896385193, -0.3856455087661743)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.0862e-07, device='cuda:0') mean:  tensor(9.9526e-12, device='cuda:0') min:  tensor(-2.0862e-07, device='cuda:0') norm:  tensor(1.7713e-06, device='cuda:0') MSE:  tensor(2.2320e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(1.1906e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0023, device='cuda:0') MSE:  tensor(2.9498e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1349, device='cuda:0')
min of d_p_list:  tensor(-0.3122, device='cuda:0')
Epoch:  334  
Training Loss: 0.22522717714309692
Test Loss:  0.23416027426719666
Test Acc:  0.0
Valid Loss:  0.22298777103424072
Valid Acc:  0.0
std:  0.19558657504511057 
thres:  0.00014603519593365491
Preserved_eigens number check:  512
 33%|███▎      | 334/1000 [1:33:18<2:41:05, 14.51s/it]Epoch:   335
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  487
Criterion check: 
Mean:  tensor(-0.7038, device='cuda:0') 
Std:  tensor(28.1127, device='cuda:0') 
ABS Max:  tensor(535.5071, device='cuda:0') 
ABS Min:  tensor(0.0009, device='cuda:0')
Criterion check:  tensor([1.0001, 1.0001, 0.9996, 0.9999, 0.9999, 0.9996, 1.0005, 0.9994, 1.0000,
        1.1871], device='cuda:0') tensor(164, device='cuda:0')
max of Lambda2 tensor(72253.0938, device='cuda:0')
min of Lambda2 tensor(2.1978e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3185, device='cuda:0')
min of grad d_p:  tensor(-0.3561, device='cuda:0')
max|min: (J_L, Jta/N)  (0.31852275133132935, 0.3185226619243622, ratio: 0.9999997019767761)|(-0.3560783863067627, -0.3560784161090851)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.3842e-07, device='cuda:0') mean:  tensor(3.2054e-11, device='cuda:0') min:  tensor(-1.7881e-07, device='cuda:0') norm:  tensor(1.6608e-06, device='cuda:0') MSE:  tensor(2.0928e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(3.4051e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0075, device='cuda:0') MSE:  tensor(9.4282e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(3.2152, device='cuda:0')
min of d_p_list:  tensor(-2.2123, device='cuda:0')
Epoch:  335  
Training Loss: 0.39518213272094727
Test Loss:  0.37247198820114136
Test Acc:  0.0
Valid Loss:  0.3841761648654938
Valid Acc:  0.0
std:  0.20113819671522007 
thres:  0.00022439995664171874
Preserved_eigens number check:  512
 34%|███▎      | 335/1000 [1:33:33<2:40:52, 14.51s/it]Epoch:   336
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  482
Criterion check: 
Mean:  tensor(1.4563, device='cuda:0') 
Std:  tensor(28.8198, device='cuda:0') 
ABS Max:  tensor(635.2512, device='cuda:0') 
ABS Min:  tensor(0.0001, device='cuda:0')
Criterion check:  tensor([0.9999, 1.0000, 1.0000, 1.0000, 1.0001, 0.9997, 0.9997, 0.9999, 1.0000,
        0.9989], device='cuda:0') tensor(119, device='cuda:0')
max of Lambda2 tensor(74563.1406, device='cuda:0')
min of Lambda2 tensor(1.1106e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.7064, device='cuda:0')
min of grad d_p:  tensor(-0.6612, device='cuda:0')
max|min: (J_L, Jta/N)  (0.70635986328125, 0.7063600420951843, ratio: 1.000000238418579)|(-0.6612356901168823, -0.6612357497215271)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.3842e-07, device='cuda:0') mean:  tensor(-1.9532e-11, device='cuda:0') min:  tensor(-3.5763e-07, device='cuda:0') norm:  tensor(2.5864e-06, device='cuda:0') MSE:  tensor(3.2591e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0010, device='cuda:0') mean:  tensor(7.6198e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0163, device='cuda:0') MSE:  tensor(2.0563e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0513, device='cuda:0')
min of d_p_list:  tensor(-0.0538, device='cuda:0')
Epoch:  336  
Training Loss: 0.2664816379547119
Test Loss:  0.2494306117296219
Test Acc:  0.0
Valid Loss:  0.2534509599208832
Valid Acc:  0.0
std:  0.16785056286862188 
thres:  0.00027719913446344434
Preserved_eigens number check:  512
 34%|███▎      | 336/1000 [1:33:47<2:40:39, 14.52s/it]Epoch:   337
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  487
Criterion check: 
Mean:  tensor(2.4010, device='cuda:0') 
Std:  tensor(96.9995, device='cuda:0') 
ABS Max:  tensor(1725.8865, device='cuda:0') 
ABS Min:  tensor(0.0023, device='cuda:0')
Criterion check:  tensor([1.0001, 0.9999, 1.0000, 1.0000, 0.9977, 1.0032, 1.0005, 1.0018, 0.9998,
        0.9849], device='cuda:0') tensor(165, device='cuda:0')
max of Lambda2 tensor(74604.1719, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.6421, device='cuda:0')
min of grad d_p:  tensor(-0.6019, device='cuda:0')
max|min: (J_L, Jta/N)  (0.6421064734458923, 0.6421059370040894, ratio: 0.9999991655349731)|(-0.6018652319908142, -0.6018652319908142)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.9605e-07, device='cuda:0') mean:  tensor(-4.8500e-11, device='cuda:0') min:  tensor(-3.2783e-07, device='cuda:0') norm:  tensor(2.7529e-06, device='cuda:0') MSE:  tensor(3.4689e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0018, device='cuda:0') mean:  tensor(6.9083e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0143, device='cuda:0') MSE:  tensor(1.7974e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0295, device='cuda:0')
min of d_p_list:  tensor(-0.0367, device='cuda:0')
Epoch:  337  
Training Loss: 0.2995365560054779
Test Loss:  0.28513702750205994
Test Acc:  0.0
Valid Loss:  0.28878724575042725
Valid Acc:  0.0
std:  0.0978782437598028 
thres:  0.00033671454191207885
Preserved_eigens number check:  512
 34%|███▎      | 337/1000 [1:34:02<2:40:56, 14.56s/it]Epoch:   338
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  485
Criterion check: 
Mean:  tensor(1.0236, device='cuda:0') 
Std:  tensor(24.2132, device='cuda:0') 
ABS Max:  tensor(520.4994, device='cuda:0') 
ABS Min:  tensor(0.0005, device='cuda:0')
Criterion check:  tensor([1.0002, 1.0000, 1.0000, 1.0000, 1.0011, 1.0011, 0.9998, 0.9990, 0.9996,
        0.9515], device='cuda:0') tensor(149, device='cuda:0')
max of Lambda2 tensor(74646.6875, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.5835, device='cuda:0')
min of grad d_p:  tensor(-0.5475, device='cuda:0')
max|min: (J_L, Jta/N)  (0.5834643244743347, 0.5834643244743347, ratio: 1.0)|(-0.5474787354469299, -0.5474786162376404)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.0862e-07, device='cuda:0') mean:  tensor(2.8159e-11, device='cuda:0') min:  tensor(-4.4703e-07, device='cuda:0') norm:  tensor(2.6863e-06, device='cuda:0') MSE:  tensor(3.3849e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(2.5750e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0052, device='cuda:0') MSE:  tensor(6.5651e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0971, device='cuda:0')
min of d_p_list:  tensor(-0.1625, device='cuda:0')
Epoch:  338  
Training Loss: 0.2764625549316406
Test Loss:  0.2623969614505768
Test Acc:  0.0
Valid Loss:  0.2677333652973175
Valid Acc:  0.0
std:  0.05666196356348841 
thres:  0.00029257801175117495
Preserved_eigens number check:  512
 34%|███▍      | 338/1000 [1:34:16<2:40:40, 14.56s/it]Epoch:   339
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  482
Criterion check: 
Mean:  tensor(1.0153, device='cuda:0') 
Std:  tensor(10.5356, device='cuda:0') 
ABS Max:  tensor(213.8191, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0008, 1.0002, 1.0001, 1.0010,
        0.9888], device='cuda:0') tensor(126, device='cuda:0')
max of Lambda2 tensor(74297.7031, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.5229, device='cuda:0')
min of grad d_p:  tensor(-0.4964, device='cuda:0')
max|min: (J_L, Jta/N)  (0.522915780544281, 0.5229158401489258, ratio: 1.0000001192092896)|(-0.49636000394821167, -0.49636006355285645)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.7881e-07, device='cuda:0') mean:  tensor(-1.3549e-11, device='cuda:0') min:  tensor(-2.9802e-07, device='cuda:0') norm:  tensor(2.0659e-06, device='cuda:0') MSE:  tensor(2.6032e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(1.1507e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0023, device='cuda:0') MSE:  tensor(2.9456e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1502, device='cuda:0')
min of d_p_list:  tensor(-0.1255, device='cuda:0')
Epoch:  339  
Training Loss: 0.25737982988357544
Test Loss:  0.24509850144386292
Test Acc:  0.0
Valid Loss:  0.24853375554084778
Valid Acc:  0.0
std:  0.05009772258911659 
thres:  0.00029900854229927067
Preserved_eigens number check:  512
 34%|███▍      | 339/1000 [1:34:31<2:40:41, 14.59s/it]Epoch:   340
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  484
Criterion check: 
Mean:  tensor(7.2296, device='cuda:0') 
Std:  tensor(150.7082, device='cuda:0') 
ABS Max:  tensor(3317.0837, device='cuda:0') 
ABS Min:  tensor(0.0005, device='cuda:0')
Criterion check:  tensor([1.0003, 1.0000, 1.0000, 1.0001, 0.9953, 1.0000, 1.0012, 1.0042, 0.9940,
        1.0617], device='cuda:0') tensor(165, device='cuda:0')
max of Lambda2 tensor(74314.7109, device='cuda:0')
min of Lambda2 tensor(1.8550e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.4761, device='cuda:0')
min of grad d_p:  tensor(-0.4499, device='cuda:0')
max|min: (J_L, Jta/N)  (0.4761195778846741, 0.47611963748931885, ratio: 1.0000001192092896)|(-0.449851930141449, -0.44985178112983704)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.9388e-06, device='cuda:0') mean:  tensor(2.0403e-09, device='cuda:0') min:  tensor(-5.0069e-05, device='cuda:0') norm:  tensor(0.0001, device='cuda:0') MSE:  tensor(1.8433e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0015, device='cuda:0') mean:  tensor(8.5515e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0165, device='cuda:0') MSE:  tensor(2.0835e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.4301, device='cuda:0')
min of d_p_list:  tensor(-0.5537, device='cuda:0')
Epoch:  340  
Training Loss: 0.27134495973587036
Test Loss:  0.2526874840259552
Test Acc:  0.0
Valid Loss:  0.2552318572998047
Valid Acc:  0.0
std:  0.01412582221422097 
thres:  0.00027424110770225526
Preserved_eigens number check:  512
 34%|███▍      | 340/1000 [1:34:46<2:40:24, 14.58s/it]Epoch:   341
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  482
Criterion check: 
Mean:  tensor(-1.0401, device='cuda:0') 
Std:  tensor(23.6072, device='cuda:0') 
ABS Max:  tensor(366.1470, device='cuda:0') 
ABS Min:  tensor(0.0005, device='cuda:0')
Criterion check:  tensor([1.0020, 1.0001, 1.0000, 1.0000, 1.0016, 1.0005, 0.9996, 1.0033, 1.0018,
        1.0008], device='cuda:0') tensor(168, device='cuda:0')
max of Lambda2 tensor(74365.2812, device='cuda:0')
min of Lambda2 tensor(4.9935e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.4456, device='cuda:0')
min of grad d_p:  tensor(-0.4138, device='cuda:0')
max|min: (J_L, Jta/N)  (0.4456292986869812, 0.4456292390823364, ratio: 0.9999998807907104)|(-0.4137785732746124, -0.41377851366996765)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.9802e-07, device='cuda:0') mean:  tensor(4.4050e-11, device='cuda:0') min:  tensor(-1.7881e-07, device='cuda:0') norm:  tensor(2.6556e-06, device='cuda:0') MSE:  tensor(3.3462e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(3.8730e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0074, device='cuda:0') MSE:  tensor(9.2795e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0409, device='cuda:0')
min of d_p_list:  tensor(-0.0695, device='cuda:0')
Epoch:  341  
Training Loss: 0.22893358767032623
Test Loss:  0.21524283289909363
Test Acc:  0.0
Valid Loss:  0.2180020958185196
Valid Acc:  0.0
std:  0.023273525950262677 
thres:  0.0002667314976453781
Preserved_eigens number check:  512
 34%|███▍      | 341/1000 [1:35:00<2:40:22, 14.60s/it]Epoch:   342
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  485
Criterion check: 
Mean:  tensor(-1.6487, device='cuda:0') 
Std:  tensor(54.5874, device='cuda:0') 
ABS Max:  tensor(1179.4722, device='cuda:0') 
ABS Min:  tensor(0.0007, device='cuda:0')
Criterion check:  tensor([0.9991, 1.0000, 1.0000, 1.0000, 1.0094, 1.0007, 1.0000, 1.0000, 0.9995,
        0.9981], device='cuda:0') tensor(134, device='cuda:0')
max of Lambda2 tensor(74227.0938, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.4043, device='cuda:0')
min of grad d_p:  tensor(-0.3751, device='cuda:0')
max|min: (J_L, Jta/N)  (0.40430396795272827, 0.40430396795272827, ratio: 1.0)|(-0.3751180171966553, -0.37511780858039856)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.1292e-07, device='cuda:0') mean:  tensor(4.5075e-11, device='cuda:0') min:  tensor(-2.3842e-07, device='cuda:0') norm:  tensor(3.6917e-06, device='cuda:0') MSE:  tensor(4.6518e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(1.9773e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0040, device='cuda:0') MSE:  tensor(5.0196e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1719, device='cuda:0')
min of d_p_list:  tensor(-0.2618, device='cuda:0')
Epoch:  342  
Training Loss: 0.17209942638874054
Test Loss:  0.15954546630382538
Test Acc:  0.0
Valid Loss:  0.16497060656547546
Valid Acc:  0.0
std:  0.03831265510535365 
thres:  0.00024124407172203063
Preserved_eigens number check:  512
 34%|███▍      | 342/1000 [1:35:15<2:40:08, 14.60s/it]Epoch:   343
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  479
Criterion check: 
Mean:  tensor(-0.5338, device='cuda:0') 
Std:  tensor(30.5235, device='cuda:0') 
ABS Max:  tensor(614.8766, device='cuda:0') 
ABS Min:  tensor(2.7162e-05, device='cuda:0')
Criterion check:  tensor([1.0022, 1.0000, 1.0000, 1.0000, 1.0002, 1.0017, 0.9998, 1.0015, 0.9995,
        0.9990], device='cuda:0') tensor(130, device='cuda:0')
max of Lambda2 tensor(74566., device='cuda:0')
min of Lambda2 tensor(3.7812e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3597, device='cuda:0')
min of grad d_p:  tensor(-0.3295, device='cuda:0')
max|min: (J_L, Jta/N)  (0.3596540689468384, 0.35965412855148315, ratio: 1.0000001192092896)|(-0.32952988147735596, -0.32952994108200073)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.0117e-07, device='cuda:0') mean:  tensor(-7.5387e-11, device='cuda:0') min:  tensor(-2.6822e-07, device='cuda:0') norm:  tensor(3.0608e-06, device='cuda:0') MSE:  tensor(3.8569e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(1.0295e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0021, device='cuda:0') MSE:  tensor(2.6381e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0286, device='cuda:0')
min of d_p_list:  tensor(-0.0448, device='cuda:0')
Epoch:  343  
Training Loss: 0.14231106638908386
Test Loss:  0.13298870623111725
Test Acc:  0.0
Valid Loss:  0.1378801167011261
Valid Acc:  0.0
std:  0.04957291864535606 
thres:  0.00021441377401351932
Preserved_eigens number check:  512
 34%|███▍      | 343/1000 [1:35:29<2:39:49, 14.60s/it]Epoch:   344
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  484
Criterion check: 
Mean:  tensor(-6.2485, device='cuda:0') 
Std:  tensor(130.6950, device='cuda:0') 
ABS Max:  tensor(2886.6536, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([1.0212, 1.0000, 1.0000, 1.0001, 0.9967, 1.0324, 1.0013, 0.9869, 1.0009,
        1.0001], device='cuda:0') tensor(140, device='cuda:0')
max of Lambda2 tensor(74613.5234, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3272, device='cuda:0')
min of grad d_p:  tensor(-0.2995, device='cuda:0')
max|min: (J_L, Jta/N)  (0.32717975974082947, 0.327179878950119, ratio: 1.0000003576278687)|(-0.29945430159568787, -0.2994542717933655)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.0431e-07, device='cuda:0') mean:  tensor(-4.1985e-11, device='cuda:0') min:  tensor(-2.6822e-07, device='cuda:0') norm:  tensor(2.4449e-06, device='cuda:0') MSE:  tensor(3.0808e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(3.3792e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0068, device='cuda:0') MSE:  tensor(8.6223e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1091, device='cuda:0')
min of d_p_list:  tensor(-0.0826, device='cuda:0')
Epoch:  344  
Training Loss: 0.11601360142230988
Test Loss:  0.1102222129702568
Test Acc:  0.0
Valid Loss:  0.11417383700609207
Valid Acc:  0.0
std:  0.05679260729034003 
thres:  0.0001861405283212662
Preserved_eigens number check:  512
 34%|███▍      | 344/1000 [1:35:47<2:50:44, 15.62s/it]Epoch:   345
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  484
Criterion check: 
Mean:  tensor(-0.8437, device='cuda:0') 
Std:  tensor(13.7672, device='cuda:0') 
ABS Max:  tensor(167.3240, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([0.9781, 1.0000, 0.9999, 1.0000, 0.9994, 0.9976, 0.9996, 1.0001, 1.0003,
        1.0005], device='cuda:0') tensor(148, device='cuda:0')
max of Lambda2 tensor(74338.3438, device='cuda:0')
min of Lambda2 tensor(3.9803e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2977, device='cuda:0')
min of grad d_p:  tensor(-0.2718, device='cuda:0')
max|min: (J_L, Jta/N)  (0.29766565561294556, 0.29766565561294556, ratio: 1.0)|(-0.27178117632865906, -0.27178120613098145)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.3411e-07, device='cuda:0') mean:  tensor(-2.0871e-11, device='cuda:0') min:  tensor(-2.0862e-07, device='cuda:0') norm:  tensor(1.8073e-06, device='cuda:0') MSE:  tensor(2.2773e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(2.5187e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0051, device='cuda:0') MSE:  tensor(6.4793e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0861, device='cuda:0')
min of d_p_list:  tensor(-0.0438, device='cuda:0')
Epoch:  345  
Training Loss: 0.09356901049613953
Test Loss:  0.08978737890720367
Test Acc:  0.0
Valid Loss:  0.09379757940769196
Valid Acc:  0.0
std:  0.04715047055612107 
thres:  0.00015058533847332002
Preserved_eigens number check:  512
 34%|███▍      | 345/1000 [1:36:07<3:04:50, 16.93s/it]Epoch:   346
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  481
Criterion check: 
Mean:  tensor(-0.7624, device='cuda:0') 
Std:  tensor(28.8293, device='cuda:0') 
ABS Max:  tensor(415.2932, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([2.1746, 1.0000, 1.0002, 1.0000, 1.0048, 0.9913, 0.9987, 0.9945, 0.9910,
        0.9915], device='cuda:0') tensor(158, device='cuda:0')
max of Lambda2 tensor(74366.5625, device='cuda:0')
min of Lambda2 tensor(2.4751e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2709, device='cuda:0')
min of grad d_p:  tensor(-0.2459, device='cuda:0')
max|min: (J_L, Jta/N)  (0.2709256410598755, 0.2709257900714874, ratio: 1.0000005960464478)|(-0.2459469735622406, -0.2459469735622406)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.3411e-07, device='cuda:0') mean:  tensor(-1.4742e-11, device='cuda:0') min:  tensor(-1.4901e-07, device='cuda:0') norm:  tensor(1.3656e-06, device='cuda:0') MSE:  tensor(1.7207e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0013, device='cuda:0') mean:  tensor(5.6168e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0108, device='cuda:0') MSE:  tensor(1.3622e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.2779, device='cuda:0')
min of d_p_list:  tensor(-0.1635, device='cuda:0')
Epoch:  346  
Training Loss: 0.11013155430555344
Test Loss:  0.10403258353471756
Test Acc:  0.0
Valid Loss:  0.11028894782066345
Valid Acc:  0.0
std:  0.027535832085678242 
thres:  0.00012682493180036545
Preserved_eigens number check:  512
 35%|███▍      | 346/1000 [1:36:22<2:56:44, 16.21s/it]Epoch:   347
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  481
Criterion check: 
Mean:  tensor(-2.1555, device='cuda:0') 
Std:  tensor(36.8559, device='cuda:0') 
ABS Max:  tensor(808.0211, device='cuda:0') 
ABS Min:  tensor(4.7575e-05, device='cuda:0')
Criterion check:  tensor([1.0001, 1.0001, 1.0000, 1.0001, 1.0003, 1.0019, 1.0001, 1.0079, 0.9982,
        0.9989], device='cuda:0') tensor(125, device='cuda:0')
max of Lambda2 tensor(74078.5312, device='cuda:0')
min of Lambda2 tensor(4.0273e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2446, device='cuda:0')
min of grad d_p:  tensor(-0.2113, device='cuda:0')
max|min: (J_L, Jta/N)  (0.2445841133594513, 0.24458420276641846, ratio: 1.0000003576278687)|(-0.21129649877548218, -0.21129652857780457)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.9407e-08, device='cuda:0') mean:  tensor(7.9735e-12, device='cuda:0') min:  tensor(-1.1921e-07, device='cuda:0') norm:  tensor(9.2270e-07, device='cuda:0') MSE:  tensor(1.1627e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(1.5377e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0036, device='cuda:0') MSE:  tensor(4.5911e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0678, device='cuda:0')
min of d_p_list:  tensor(-0.0761, device='cuda:0')
Epoch:  347  
Training Loss: 0.08431411534547806
Test Loss:  0.08082699775695801
Test Acc:  0.0
Valid Loss:  0.08550883084535599
Valid Acc:  0.0
std:  0.020036205886789983 
thres:  0.00010926786959171295
Preserved_eigens number check:  512
 35%|███▍      | 347/1000 [1:36:37<2:51:02, 15.72s/it]Epoch:   348
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  483
Criterion check: 
Mean:  tensor(0.4316, device='cuda:0') 
Std:  tensor(10.7046, device='cuda:0') 
ABS Max:  tensor(167.1184, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([1.0002, 0.9999, 1.0000, 1.0000, 1.0004, 0.9987, 0.9998, 0.9539, 0.9997,
        0.9983], device='cuda:0') tensor(127, device='cuda:0')
max of Lambda2 tensor(73880.5078, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2213, device='cuda:0')
min of grad d_p:  tensor(-0.1923, device='cuda:0')
max|min: (J_L, Jta/N)  (0.2212708741426468, 0.2212708294391632, ratio: 0.9999998211860657)|(-0.19229690730571747, -0.1922968477010727)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.1921e-07, device='cuda:0') mean:  tensor(-1.7735e-12, device='cuda:0') min:  tensor(-1.1921e-07, device='cuda:0') norm:  tensor(9.0933e-07, device='cuda:0') MSE:  tensor(1.1458e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(1.1356e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0023, device='cuda:0') MSE:  tensor(2.8681e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.7643, device='cuda:0')
min of d_p_list:  tensor(-0.4672, device='cuda:0')
Epoch:  348  
Training Loss: 0.10118220746517181
Test Loss:  0.08955228328704834
Test Acc:  0.0
Valid Loss:  0.1054736003279686
Valid Acc:  0.0
std:  0.011335397671430627 
thres:  0.00010104209780693055
Preserved_eigens number check:  512
 35%|███▍      | 348/1000 [1:36:51<2:47:09, 15.38s/it]Epoch:   349
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  481
Criterion check: 
Mean:  tensor(1110.8632, device='cuda:0') 
Std:  tensor(25242.1602, device='cuda:0') 
ABS Max:  tensor(571157., device='cuda:0') 
ABS Min:  tensor(0.0017, device='cuda:0')
Criterion check:  tensor([0.9994, 0.9996, 0.9999, 1.0003, 1.0016, 0.9992, 0.9992, 0.9968, 1.0006,
        1.0037], device='cuda:0') tensor(191, device='cuda:0')
max of Lambda2 tensor(73959.6641, device='cuda:0')
min of Lambda2 tensor(1.5014e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1663, device='cuda:0')
min of grad d_p:  tensor(-0.1421, device='cuda:0')
max|min: (J_L, Jta/N)  (0.16632424294948578, 0.16632410883903503, ratio: 0.9999991655349731)|(-0.14208683371543884, -0.14208689332008362)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.4156e-07, device='cuda:0') mean:  tensor(4.7776e-11, device='cuda:0') min:  tensor(-6.7055e-08, device='cuda:0') norm:  tensor(1.6747e-06, device='cuda:0') MSE:  tensor(2.1103e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0019, device='cuda:0') mean:  tensor(9.2288e-06, device='cuda:0') min:  tensor(6.4864e-14, device='cuda:0') norm:  tensor(0.0195, device='cuda:0') MSE:  tensor(2.4592e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1472, device='cuda:0')
min of d_p_list:  tensor(-0.1666, device='cuda:0')
Epoch:  349  
Training Loss: 0.08161621540784836
Test Loss:  0.07373935729265213
Test Acc:  0.0
Valid Loss:  0.08121475577354431
Valid Acc:  0.0
std:  0.01057392221835828 
thres:  9.416262060403824e-05
Preserved_eigens number check:  512
 35%|███▍      | 349/1000 [1:37:06<2:44:49, 15.19s/it]Epoch:   350
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  483
Criterion check: 
Mean:  tensor(-2.8331, device='cuda:0') 
Std:  tensor(411.5350, device='cuda:0') 
ABS Max:  tensor(4796.9844, device='cuda:0') 
ABS Min:  tensor(0.0176, device='cuda:0')
Criterion check:  tensor([1.0155, 1.0001, 1.0002, 1.0007, 1.0396, 0.9890, 0.9913, 1.0016, 1.0321,
        1.0013], device='cuda:0') tensor(208, device='cuda:0')
max of Lambda2 tensor(74347.2109, device='cuda:0')
min of Lambda2 tensor(1.8070e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1504, device='cuda:0')
min of grad d_p:  tensor(-0.1416, device='cuda:0')
max|min: (J_L, Jta/N)  (0.15036043524742126, 0.15036055445671082, ratio: 1.0000008344650269)|(-0.14163553714752197, -0.1416354924440384)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.0058e-07, device='cuda:0') mean:  tensor(-2.6793e-11, device='cuda:0') min:  tensor(-2.3842e-07, device='cuda:0') norm:  tensor(1.8714e-06, device='cuda:0') MSE:  tensor(2.3581e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0054, device='cuda:0') mean:  tensor(4.3468e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0866, device='cuda:0') MSE:  tensor(1.0912e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0525, device='cuda:0')
min of d_p_list:  tensor(-0.0611, device='cuda:0')
Epoch:  350  
Training Loss: 0.06298734247684479
Test Loss:  0.057867489755153656
Test Acc:  0.0
Valid Loss:  0.061938926577568054
Valid Acc:  0.0
std:  0.016392297367841098 
thres:  8.80462870001793e-05
Preserved_eigens number check:  512
 35%|███▌      | 350/1000 [1:37:21<2:43:10, 15.06s/it]Epoch:   351
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  482
Criterion check: 
Mean:  tensor(-6.9861, device='cuda:0') 
Std:  tensor(104.5159, device='cuda:0') 
ABS Max:  tensor(1690.9850, device='cuda:0') 
ABS Min:  tensor(0.0010, device='cuda:0')
Criterion check:  tensor([0.9981, 0.9996, 1.0000, 1.0002, 1.0013, 1.0003, 0.9987, 0.9965, 1.0029,
        0.9870], device='cuda:0') tensor(149, device='cuda:0')
max of Lambda2 tensor(74256.7969, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1363, device='cuda:0')
min of grad d_p:  tensor(-0.1283, device='cuda:0')
max|min: (J_L, Jta/N)  (0.13628704845905304, 0.13628700375556946, ratio: 0.9999996423721313)|(-0.12828214466571808, -0.12828198075294495)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.1176e-07, device='cuda:0') mean:  tensor(-5.1701e-12, device='cuda:0') min:  tensor(-1.6391e-07, device='cuda:0') norm:  tensor(1.6260e-06, device='cuda:0') MSE:  tensor(2.0489e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0009, device='cuda:0') mean:  tensor(5.4623e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0103, device='cuda:0') MSE:  tensor(1.3035e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0373, device='cuda:0')
min of d_p_list:  tensor(-0.0485, device='cuda:0')
Epoch:  351  
Training Loss: 0.04777510464191437
Test Loss:  0.04403425008058548
Test Acc:  0.0
Valid Loss:  0.04654083400964737
Valid Acc:  0.0
std:  0.01843844244306259 
thres:  7.557499706745148e-05
Preserved_eigens number check:  512
 35%|███▌      | 351/1000 [1:37:35<2:41:27, 14.93s/it]Epoch:   352
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  484
Criterion check: 
Mean:  tensor(0.3509, device='cuda:0') 
Std:  tensor(6.9856, device='cuda:0') 
ABS Max:  tensor(99.7507, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([1.0007, 1.0003, 1.0000, 1.0001, 0.9993, 0.9998, 1.0024, 1.0022, 0.9978,
        1.0160], device='cuda:0') tensor(143, device='cuda:0')
max of Lambda2 tensor(74254.5703, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1227, device='cuda:0')
min of grad d_p:  tensor(-0.1162, device='cuda:0')
max|min: (J_L, Jta/N)  (0.12272994220256805, 0.12272997945547104, ratio: 1.0000003576278687)|(-0.1162303239107132, -0.11623027175664902)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.4901e-07, device='cuda:0') mean:  tensor(-7.4187e-11, device='cuda:0') min:  tensor(-1.8626e-07, device='cuda:0') norm:  tensor(2.2568e-06, device='cuda:0') MSE:  tensor(2.8438e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(2.1833e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0043, device='cuda:0') MSE:  tensor(5.3572e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0261, device='cuda:0')
min of d_p_list:  tensor(-0.0439, device='cuda:0')
Epoch:  352  
Training Loss: 0.03543141111731529
Test Loss:  0.03305596858263016
Test Acc:  0.0
Valid Loss:  0.034169938415288925
Valid Acc:  0.0
std:  0.023482386372588645 
thres:  6.579845622181893e-05
Preserved_eigens number check:  512
 35%|███▌      | 352/1000 [1:37:50<2:40:36, 14.87s/it]Epoch:   353
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  482
Criterion check: 
Mean:  tensor(0.1373, device='cuda:0') 
Std:  tensor(9.5508, device='cuda:0') 
ABS Max:  tensor(150.7136, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([0.9993, 0.9999, 1.0000, 1.0000, 1.0002, 1.0003, 1.0003, 1.0003, 1.0014,
        0.9849], device='cuda:0') tensor(126, device='cuda:0')
max of Lambda2 tensor(74304.7969, device='cuda:0')
min of Lambda2 tensor(2.3556e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1110, device='cuda:0')
min of grad d_p:  tensor(-0.1055, device='cuda:0')
max|min: (J_L, Jta/N)  (0.1110481470823288, 0.11104820668697357, ratio: 1.0000005960464478)|(-0.1054815798997879, -0.1054815873503685)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.6077e-08, device='cuda:0') mean:  tensor(-1.9663e-11, device='cuda:0') min:  tensor(-7.4506e-08, device='cuda:0') norm:  tensor(7.0077e-07, device='cuda:0') MSE:  tensor(8.8302e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(1.0620e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0022, device='cuda:0') MSE:  tensor(2.7683e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0606, device='cuda:0')
min of d_p_list:  tensor(-0.0461, device='cuda:0')
Epoch:  353  
Training Loss: 0.030497640371322632
Test Loss:  0.028451822698116302
Test Acc:  0.0
Valid Loss:  0.029167935252189636
Valid Acc:  0.0
std:  0.018718912849670966 
thres:  5.166154280304909e-05
Preserved_eigens number check:  512
 35%|███▌      | 353/1000 [1:38:05<2:40:01, 14.84s/it]Epoch:   354
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  484
Criterion check: 
Mean:  tensor(0.3563, device='cuda:0') 
Std:  tensor(10.4604, device='cuda:0') 
ABS Max:  tensor(170.4866, device='cuda:0') 
ABS Min:  tensor(0.0001, device='cuda:0')
Criterion check:  tensor([0.9999, 1.0002, 1.0000, 1.0001, 1.0003, 1.0000, 1.0000, 1.0012, 1.0018,
        0.9974], device='cuda:0') tensor(110, device='cuda:0')
max of Lambda2 tensor(74300.5469, device='cuda:0')
min of Lambda2 tensor(1.3736e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1026, device='cuda:0')
min of grad d_p:  tensor(-0.0952, device='cuda:0')
max|min: (J_L, Jta/N)  (0.10258859395980835, 0.10258857160806656, ratio: 0.9999997615814209)|(-0.09518884122371674, -0.09518881887197495)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.0431e-07, device='cuda:0') mean:  tensor(-5.1959e-11, device='cuda:0') min:  tensor(-1.4529e-07, device='cuda:0') norm:  tensor(1.5656e-06, device='cuda:0') MSE:  tensor(1.9728e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(1.4653e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0027, device='cuda:0') MSE:  tensor(3.4538e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0238, device='cuda:0')
min of d_p_list:  tensor(-0.0287, device='cuda:0')
Epoch:  354  
Training Loss: 0.02234092727303505
Test Loss:  0.020947841927409172
Test Acc:  0.0
Valid Loss:  0.021246256306767464
Valid Acc:  0.0
std:  0.014224574643011611 
thres:  3.9806485176086425e-05
Preserved_eigens number check:  512
 35%|███▌      | 354/1000 [1:38:20<2:39:33, 14.82s/it]Epoch:   355
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  485
Criterion check: 
Mean:  tensor(0.6390, device='cuda:0') 
Std:  tensor(7.7002, device='cuda:0') 
ABS Max:  tensor(131.6223, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([0.9995, 1.0003, 1.0002, 0.9999, 1.0006, 0.9995, 0.9995, 1.0015, 1.0032,
        0.9771], device='cuda:0') tensor(123, device='cuda:0')
max of Lambda2 tensor(74261.3047, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0934, device='cuda:0')
min of grad d_p:  tensor(-0.0860, device='cuda:0')
max|min: (J_L, Jta/N)  (0.09342131018638611, 0.0934213176369667, ratio: 1.0000001192092896)|(-0.08603986352682114, -0.08603973686695099)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.1956e-08, device='cuda:0') mean:  tensor(5.2748e-12, device='cuda:0') min:  tensor(-1.2666e-07, device='cuda:0') norm:  tensor(1.2900e-06, device='cuda:0') MSE:  tensor(1.6255e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(1.7224e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0036, device='cuda:0') MSE:  tensor(4.5944e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0105, device='cuda:0')
min of d_p_list:  tensor(-0.0122, device='cuda:0')
Epoch:  355  
Training Loss: 0.017017628997564316
Test Loss:  0.01607396826148033
Test Acc:  0.0
Valid Loss:  0.016201041638851166
Valid Acc:  0.0
std:  0.010686716316314002 
thres:  3.061254248023033e-05
Preserved_eigens number check:  512
 36%|███▌      | 355/1000 [1:38:34<2:38:59, 14.79s/it]Epoch:   356
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  482
Criterion check: 
Mean:  tensor(0.1494, device='cuda:0') 
Std:  tensor(5.2248, device='cuda:0') 
ABS Max:  tensor(81.0418, device='cuda:0') 
ABS Min:  tensor(4.4488e-05, device='cuda:0')
Criterion check:  tensor([0.9993, 1.0000, 1.0000, 1.0000, 1.0002, 1.0003, 0.9995, 1.0004, 0.9994,
        0.9976], device='cuda:0') tensor(101, device='cuda:0')
max of Lambda2 tensor(74306.4219, device='cuda:0')
min of Lambda2 tensor(5.1332e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0850, device='cuda:0')
min of grad d_p:  tensor(-0.0782, device='cuda:0')
max|min: (J_L, Jta/N)  (0.08499372005462646, 0.08499377965927124, ratio: 1.0000007152557373)|(-0.07817728072404861, -0.07817725092172623)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.0978e-08, device='cuda:0') mean:  tensor(-2.7850e-11, device='cuda:0') min:  tensor(-7.8231e-08, device='cuda:0') norm:  tensor(9.0882e-07, device='cuda:0') MSE:  tensor(1.1452e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(8.0528e-07, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0016, device='cuda:0') MSE:  tensor(1.9944e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.4883, device='cuda:0')
min of d_p_list:  tensor(-0.4885, device='cuda:0')
Epoch:  356  
Training Loss: 0.02960435301065445
Test Loss:  0.03195537254214287
Test Acc:  0.0
Valid Loss:  0.028560789301991463
Valid Acc:  0.0
std:  0.006503186775893303 
thres:  2.697839215397835e-05
Preserved_eigens number check:  512
 36%|███▌      | 356/1000 [1:38:49<2:39:47, 14.89s/it]Epoch:   357
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  480
Criterion check: 
Mean:  tensor(0.9502, device='cuda:0') 
Std:  tensor(34.6026, device='cuda:0') 
ABS Max:  tensor(627.5880, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([1.0004, 1.0007, 1.0001, 1.0000, 1.0001, 0.9996, 1.0006, 0.9889, 1.0001,
        1.0005], device='cuda:0') tensor(126, device='cuda:0')
max of Lambda2 tensor(74662.5000, device='cuda:0')
min of Lambda2 tensor(2.8285e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0667, device='cuda:0')
min of grad d_p:  tensor(-0.0993, device='cuda:0')
max|min: (J_L, Jta/N)  (0.06668469309806824, 0.06668470054864883, ratio: 1.0000001192092896)|(-0.09933286905288696, -0.09933286905288696)

 check Jacobi res:  torch.Size([793601]) max:  tensor(7.4506e-08, device='cuda:0') mean:  tensor(2.6555e-11, device='cuda:0') min:  tensor(-3.3528e-08, device='cuda:0') norm:  tensor(7.3423e-07, device='cuda:0') MSE:  tensor(9.2519e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(1.8749e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0035, device='cuda:0') MSE:  tensor(4.3589e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0468, device='cuda:0')
min of d_p_list:  tensor(-0.0601, device='cuda:0')
Epoch:  357  
Training Loss: 0.01796847954392433
Test Loss:  0.01882144808769226
Test Acc:  0.0
Valid Loss:  0.017494289204478264
Valid Acc:  0.0
std:  0.005660236585685392 
thres:  2.3485805839300155e-05
Preserved_eigens number check:  512
 36%|███▌      | 357/1000 [1:39:04<2:38:59, 14.84s/it]Epoch:   358
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  479
Criterion check: 
Mean:  tensor(8.6244, device='cuda:0') 
Std:  tensor(146.6241, device='cuda:0') 
ABS Max:  tensor(2785.2578, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([1.0012, 1.0001, 1.0002, 0.9999, 0.9997, 1.0016, 1.0007, 0.9925, 0.9961,
        1.0057], device='cuda:0') tensor(135, device='cuda:0')
max of Lambda2 tensor(74669.8359, device='cuda:0')
min of Lambda2 tensor(5.3198e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0600, device='cuda:0')
min of grad d_p:  tensor(-0.0929, device='cuda:0')
max|min: (J_L, Jta/N)  (0.06002064794301987, 0.06002067029476166, ratio: 1.0000003576278687)|(-0.092903271317482, -0.09290323406457901)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.0803e-07, device='cuda:0') mean:  tensor(-4.2769e-11, device='cuda:0') min:  tensor(-1.6764e-07, device='cuda:0') norm:  tensor(1.8176e-06, device='cuda:0') MSE:  tensor(2.2904e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0007, device='cuda:0') mean:  tensor(4.8054e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0094, device='cuda:0') MSE:  tensor(1.1830e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0454, device='cuda:0')
min of d_p_list:  tensor(-0.0296, device='cuda:0')
Epoch:  358  
Training Loss: 0.014299187809228897
Test Loss:  0.014493039809167385
Test Acc:  0.0
Valid Loss:  0.014191792346537113
Valid Acc:  0.0
std:  0.005346803629727659 
thres:  2.024611532688141e-05
Preserved_eigens number check:  512
 36%|███▌      | 358/1000 [1:39:19<2:38:57, 14.86s/it]Epoch:   359
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  481
Criterion check: 
Mean:  tensor(0.9735, device='cuda:0') 
Std:  tensor(209.7861, device='cuda:0') 
ABS Max:  tensor(2883.4441, device='cuda:0') 
ABS Min:  tensor(0.0008, device='cuda:0')
Criterion check:  tensor([1.0115, 0.9924, 0.9999, 1.0013, 1.0026, 0.9908, 1.0103, 0.4351, 0.9057,
        0.8379], device='cuda:0') tensor(221, device='cuda:0')
max of Lambda2 tensor(74672.8516, device='cuda:0')
min of Lambda2 tensor(1.2059e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0546, device='cuda:0')
min of grad d_p:  tensor(-0.0854, device='cuda:0')
max|min: (J_L, Jta/N)  (0.05456214398145676, 0.054562073200941086, ratio: 0.9999986886978149)|(-0.08541947603225708, -0.08541957288980484)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.4156e-07, device='cuda:0') mean:  tensor(5.1326e-11, device='cuda:0') min:  tensor(-6.1467e-08, device='cuda:0') norm:  tensor(1.5968e-06, device='cuda:0') MSE:  tensor(2.0121e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0078, device='cuda:0') mean:  tensor(4.4277e-05, device='cuda:0') min:  tensor(9.8532e-16, device='cuda:0') norm:  tensor(0.0823, device='cuda:0') MSE:  tensor(1.0377e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0954, device='cuda:0')
min of d_p_list:  tensor(-0.1155, device='cuda:0')
Epoch:  359  
Training Loss: 0.011284382082521915
Test Loss:  0.011156760156154633
Test Acc:  0.0
Valid Loss:  0.01155098807066679
Valid Acc:  0.0
std:  0.0062356480435906995 
thres:  1.8034806288778782e-05
Preserved_eigens number check:  512
 36%|███▌      | 359/1000 [1:39:34<2:39:34, 14.94s/it]Epoch:   360
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  481
Criterion check: 
Mean:  tensor(0.9730, device='cuda:0') 
Std:  tensor(21.0443, device='cuda:0') 
ABS Max:  tensor(420.9575, device='cuda:0') 
ABS Min:  tensor(0.0018, device='cuda:0')
Criterion check:  tensor([1.0009, 0.9999, 1.0002, 1.0001, 0.9995, 1.0017, 0.9996, 1.0117, 1.0054,
        1.0196], device='cuda:0') tensor(141, device='cuda:0')
max of Lambda2 tensor(74570.8906, device='cuda:0')
min of Lambda2 tensor(5.8406e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0494, device='cuda:0')
min of grad d_p:  tensor(-0.0793, device='cuda:0')
max|min: (J_L, Jta/N)  (0.04938952997326851, 0.049389541149139404, ratio: 1.000000238418579)|(-0.07925917208194733, -0.07925910502672195)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.6391e-07, device='cuda:0') mean:  tensor(5.8702e-12, device='cuda:0') min:  tensor(-1.8999e-07, device='cuda:0') norm:  tensor(2.5956e-06, device='cuda:0') MSE:  tensor(3.2707e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0008, device='cuda:0') mean:  tensor(3.4077e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0064, device='cuda:0') MSE:  tensor(8.0854e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0679, device='cuda:0')
min of d_p_list:  tensor(-0.1601, device='cuda:0')
Epoch:  360  
Training Loss: 0.00921202078461647
Test Loss:  0.00832098163664341
Test Acc:  0.0
Valid Loss:  0.009707918390631676
Valid Acc:  0.0
std:  0.007197748580126554 
thres:  1.6473684646189212e-05
Preserved_eigens number check:  512
 36%|███▌      | 360/1000 [1:39:49<2:38:39, 14.87s/it]Epoch:   361
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  477
Criterion check: 
Mean:  tensor(142.0395, device='cuda:0') 
Std:  tensor(3098.6895, device='cuda:0') 
ABS Max:  tensor(70040.5703, device='cuda:0') 
ABS Min:  tensor(0.0023, device='cuda:0')
Criterion check:  tensor([0.9994, 1.0062, 1.0007, 0.9996, 0.9987, 1.0111, 1.0073, 1.8284, 0.9927,
        1.0092], device='cuda:0') tensor(165, device='cuda:0')
max of Lambda2 tensor(74374.2109, device='cuda:0')
min of Lambda2 tensor(1.3253e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0440, device='cuda:0')
min of grad d_p:  tensor(-0.0720, device='cuda:0')
max|min: (J_L, Jta/N)  (0.04403039813041687, 0.04403027147054672, ratio: 0.9999971389770508)|(-0.07200291752815247, -0.07200290262699127)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.4342e-07, device='cuda:0') mean:  tensor(-9.8744e-12, device='cuda:0') min:  tensor(-5.2154e-08, device='cuda:0') norm:  tensor(1.2362e-06, device='cuda:0') MSE:  tensor(1.5577e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0014, device='cuda:0') mean:  tensor(1.8785e-05, device='cuda:0') min:  tensor(2.6324e-15, device='cuda:0') norm:  tensor(0.0349, device='cuda:0') MSE:  tensor(4.3923e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0258, device='cuda:0')
min of d_p_list:  tensor(-0.0448, device='cuda:0')
Epoch:  361  
Training Loss: 0.007704347372055054
Test Loss:  0.006994961760938168
Test Acc:  0.0
Valid Loss:  0.008007466793060303
Valid Acc:  0.0
std:  0.0036770286441468623 
thres:  1.2093683518469334e-05
Preserved_eigens number check:  512
 36%|███▌      | 361/1000 [1:40:04<2:38:30, 14.88s/it]Epoch:   362
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  482
Criterion check: 
Mean:  tensor(0.6281, device='cuda:0') 
Std:  tensor(25.0127, device='cuda:0') 
ABS Max:  tensor(321.7158, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([0.9989, 1.0014, 0.9996, 0.9998, 0.9999, 0.9983, 1.0012, 1.1276, 1.0031,
        1.0102], device='cuda:0') tensor(133, device='cuda:0')
max of Lambda2 tensor(74478.7812, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0395, device='cuda:0')
min of grad d_p:  tensor(-0.0653, device='cuda:0')
max|min: (J_L, Jta/N)  (0.039490263909101486, 0.03949020430445671, ratio: 0.9999985098838806)|(-0.06525333970785141, -0.06525333225727081)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.2888e-08, device='cuda:0') mean:  tensor(4.9600e-12, device='cuda:0') min:  tensor(-3.1665e-08, device='cuda:0') norm:  tensor(7.4890e-07, device='cuda:0') MSE:  tensor(9.4367e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(2.5236e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0047, device='cuda:0') MSE:  tensor(5.9667e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0483, device='cuda:0')
min of d_p_list:  tensor(-0.0635, device='cuda:0')
Epoch:  362  
Training Loss: 0.00651678629219532
Test Loss:  0.005975343286991119
Test Acc:  0.0
Valid Loss:  0.006683789659291506
Valid Acc:  0.0
std:  0.0027554671805254493 
thres:  9.803344868123532e-06
Preserved_eigens number check:  512
 36%|███▌      | 362/1000 [1:40:21<2:46:44, 15.68s/it]Epoch:   363
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  479
Criterion check: 
Mean:  tensor(-33.7340, device='cuda:0') 
Std:  tensor(658.5767, device='cuda:0') 
ABS Max:  tensor(14308.8516, device='cuda:0') 
ABS Min:  tensor(0.0047, device='cuda:0')
Criterion check:  tensor([0.9947, 0.9983, 0.9924, 0.9991, 1.0076, 0.9610, 0.9469, 1.1653, 1.0699,
        0.9302], device='cuda:0') tensor(208, device='cuda:0')
max of Lambda2 tensor(74580.7656, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0361, device='cuda:0')
min of grad d_p:  tensor(-0.0585, device='cuda:0')
max|min: (J_L, Jta/N)  (0.036108434200286865, 0.036108408123254776, ratio: 0.9999992847442627)|(-0.058532342314720154, -0.05853233113884926)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.6077e-08, device='cuda:0') mean:  tensor(-1.0021e-11, device='cuda:0') min:  tensor(-5.3085e-08, device='cuda:0') norm:  tensor(4.8533e-07, device='cuda:0') MSE:  tensor(6.1156e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0055, device='cuda:0') mean:  tensor(3.6227e-05, device='cuda:0') min:  tensor(8.6362e-15, device='cuda:0') norm:  tensor(0.0771, device='cuda:0') MSE:  tensor(9.7102e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0124, device='cuda:0')
min of d_p_list:  tensor(-0.0250, device='cuda:0')
Epoch:  363  
Training Loss: 0.005827224813401699
Test Loss:  0.005273817572742701
Test Acc:  0.0
Valid Loss:  0.006062271073460579
Valid Acc:  0.0
std:  0.001959851650136075 
thres:  8.10895226895809e-06
Preserved_eigens number check:  512
 36%|███▋      | 363/1000 [1:40:37<2:47:51, 15.81s/it]Epoch:   364
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  478
Criterion check: 
Mean:  tensor(-0.4873, device='cuda:0') 
Std:  tensor(9.9766, device='cuda:0') 
ABS Max:  tensor(158.0319, device='cuda:0') 
ABS Min:  tensor(0.0001, device='cuda:0')
Criterion check:  tensor([1.0016, 1.0007, 1.0012, 1.0000, 0.9999, 1.0007, 1.0000, 1.0677, 1.0023,
        0.9938], device='cuda:0') tensor(126, device='cuda:0')
max of Lambda2 tensor(74535.7266, device='cuda:0')
min of Lambda2 tensor(1.2446e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0326, device='cuda:0')
min of grad d_p:  tensor(-0.0534, device='cuda:0')
max|min: (J_L, Jta/N)  (0.0325886495411396, 0.032588642090559006, ratio: 0.9999997615814209)|(-0.05338384211063385, -0.05338380113244057)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.1735e-07, device='cuda:0') mean:  tensor(-6.6114e-11, device='cuda:0') min:  tensor(-1.7509e-07, device='cuda:0') norm:  tensor(1.9711e-06, device='cuda:0') MSE:  tensor(2.4838e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(1.3908e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0029, device='cuda:0') MSE:  tensor(3.6357e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0242, device='cuda:0')
min of d_p_list:  tensor(-0.0230, device='cuda:0')
Epoch:  364  
Training Loss: 0.004938282538205385
Test Loss:  0.004491882864385843
Test Acc:  0.0
Valid Loss:  0.005265881307423115
Valid Acc:  0.0
std:  0.0014913275031375264 
thres:  6.839732360094786e-06
Preserved_eigens number check:  512
 36%|███▋      | 364/1000 [1:40:53<2:47:52, 15.84s/it]Epoch:   365
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  480
Criterion check: 
Mean:  tensor(1.8528, device='cuda:0') 
Std:  tensor(32.2940, device='cuda:0') 
ABS Max:  tensor(436.1578, device='cuda:0') 
ABS Min:  tensor(0.0007, device='cuda:0')
Criterion check:  tensor([0.9960, 0.9864, 1.0019, 1.0001, 0.9994, 1.0053, 0.9938, 1.4892, 1.0329,
        0.9925], device='cuda:0') tensor(175, device='cuda:0')
max of Lambda2 tensor(74536.5703, device='cuda:0')
min of Lambda2 tensor(2.6053e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0296, device='cuda:0')
min of grad d_p:  tensor(-0.0487, device='cuda:0')
max|min: (J_L, Jta/N)  (0.029641609638929367, 0.02964164689183235, ratio: 1.000001311302185)|(-0.04871472343802452, -0.04871464893221855)

 check Jacobi res:  torch.Size([793601]) max:  tensor(7.4506e-08, device='cuda:0') mean:  tensor(-6.1806e-11, device='cuda:0') min:  tensor(-1.4342e-07, device='cuda:0') norm:  tensor(1.7826e-06, device='cuda:0') MSE:  tensor(2.2462e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0015, device='cuda:0') mean:  tensor(9.0889e-06, device='cuda:0') min:  tensor(9.5594e-15, device='cuda:0') norm:  tensor(0.0197, device='cuda:0') MSE:  tensor(2.4798e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0196, device='cuda:0')
min of d_p_list:  tensor(-0.0252, device='cuda:0')
Epoch:  365  
Training Loss: 0.0044504390098154545
Test Loss:  0.003968041390180588
Test Acc:  0.0
Valid Loss:  0.004761272110044956
Valid Acc:  0.0
std:  0.0011547057419981992 
thres:  5.887416005134583e-06
Preserved_eigens number check:  512
 36%|███▋      | 365/1000 [1:41:08<2:44:30, 15.54s/it]Epoch:   366
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  479
Criterion check: 
Mean:  tensor(6.9773, device='cuda:0') 
Std:  tensor(93.0848, device='cuda:0') 
ABS Max:  tensor(1562.3091, device='cuda:0') 
ABS Min:  tensor(4.5488e-06, device='cuda:0')
Criterion check:  tensor([0.9995, 1.0045, 1.0003, 0.9998, 1.0015, 0.9930, 0.9990, 1.1875, 0.9694,
        1.0215], device='cuda:0') tensor(142, device='cuda:0')
max of Lambda2 tensor(74517.2031, device='cuda:0')
min of Lambda2 tensor(1.0535e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0270, device='cuda:0')
min of grad d_p:  tensor(-0.0442, device='cuda:0')
max|min: (J_L, Jta/N)  (0.02695462480187416, 0.026954585686326027, ratio: 0.9999985694885254)|(-0.04419170320034027, -0.04419172182679176)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.2154e-08, device='cuda:0') mean:  tensor(1.4723e-11, device='cuda:0') min:  tensor(-2.1799e-08, device='cuda:0') norm:  tensor(6.0453e-07, device='cuda:0') MSE:  tensor(7.6176e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0006, device='cuda:0') mean:  tensor(4.5828e-06, device='cuda:0') min:  tensor(1.2407e-15, device='cuda:0') norm:  tensor(0.0092, device='cuda:0') MSE:  tensor(1.1588e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0187, device='cuda:0')
min of d_p_list:  tensor(-0.0236, device='cuda:0')
Epoch:  366  
Training Loss: 0.003927368205040693
Test Loss:  0.003525026608258486
Test Acc:  0.0
Valid Loss:  0.004322347231209278
Valid Acc:  0.0
std:  0.0009331838204726189 
thres:  5.132020171731711e-06
Preserved_eigens number check:  512
 37%|███▋      | 366/1000 [1:41:23<2:42:10, 15.35s/it]Epoch:   367
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  481
Criterion check: 
Mean:  tensor(-18.9772, device='cuda:0') 
Std:  tensor(389.1085, device='cuda:0') 
ABS Max:  tensor(8547.1406, device='cuda:0') 
ABS Min:  tensor(0.0028, device='cuda:0')
Criterion check:  tensor([0.9985, 1.0064, 1.0057, 0.9988, 0.9977, 0.9985, 1.0084, 0.8123, 0.9861,
        0.9784], device='cuda:0') tensor(151, device='cuda:0')
max of Lambda2 tensor(74540.5938, device='cuda:0')
min of Lambda2 tensor(7.0301e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0245, device='cuda:0')
min of grad d_p:  tensor(-0.0405, device='cuda:0')
max|min: (J_L, Jta/N)  (0.024452747777104378, 0.024452749639749527, ratio: 1.0000001192092896)|(-0.040521278977394104, -0.040521290153265)

 check Jacobi res:  torch.Size([793601]) max:  tensor(7.0781e-08, device='cuda:0') mean:  tensor(-1.7392e-11, device='cuda:0') min:  tensor(-8.9407e-08, device='cuda:0') norm:  tensor(1.2531e-06, device='cuda:0') MSE:  tensor(1.5790e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0013, device='cuda:0') mean:  tensor(7.1309e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0142, device='cuda:0') MSE:  tensor(1.7871e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0366, device='cuda:0')
min of d_p_list:  tensor(-0.0235, device='cuda:0')
Epoch:  367  
Training Loss: 0.003984558861702681
Test Loss:  0.0032636187970638275
Test Acc:  0.0
Valid Loss:  0.004273396451026201
Valid Acc:  0.0
std:  0.0007029673266434498 
thres:  4.625574685633182e-06
Preserved_eigens number check:  512
 37%|███▋      | 367/1000 [1:41:38<2:39:42, 15.14s/it]Epoch:   368
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  475
Criterion check: 
Mean:  tensor(-2.0771, device='cuda:0') 
Std:  tensor(125.1529, device='cuda:0') 
ABS Max:  tensor(1848.1439, device='cuda:0') 
ABS Min:  tensor(0.0018, device='cuda:0')
Criterion check:  tensor([0.9986, 1.0023, 1.0008, 0.9995, 0.9994, 0.9994, 0.9975, 1.0445, 1.0095,
        1.0263], device='cuda:0') tensor(170, device='cuda:0')
max of Lambda2 tensor(74560.2266, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0237, device='cuda:0')
min of grad d_p:  tensor(-0.0360, device='cuda:0')
max|min: (J_L, Jta/N)  (0.0236523374915123, 0.023652279749512672, ratio: 0.9999975562095642)|(-0.03598795086145401, -0.03598802909255028)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.2107e-07, device='cuda:0') mean:  tensor(5.9901e-11, device='cuda:0') min:  tensor(-8.1956e-08, device='cuda:0') norm:  tensor(1.6411e-06, device='cuda:0') MSE:  tensor(2.0680e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0007, device='cuda:0') mean:  tensor(6.4616e-06, device='cuda:0') min:  tensor(2.8506e-15, device='cuda:0') norm:  tensor(0.0143, device='cuda:0') MSE:  tensor(1.8028e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1315, device='cuda:0')
min of d_p_list:  tensor(-0.1354, device='cuda:0')
Epoch:  368  
Training Loss: 0.004933175630867481
Test Loss:  0.004336333833634853
Test Acc:  0.0
Valid Loss:  0.004984657280147076
Valid Acc:  0.0
std:  0.00043854437299459546 
thres:  4.446764849126339e-06
Preserved_eigens number check:  512
 37%|███▋      | 368/1000 [1:41:52<2:38:12, 15.02s/it]