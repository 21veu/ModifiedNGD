/nishome/yui/ModifiedNGD/utils/readData.py:18: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  return torch.tensor(x, dtype=torch.float32), torch.tensor(y, dtype=torch.float32)
Train info: 
 train data shape: torch.Size([512, 1]), 
 train lable shape: torch.Size([512, 1]), 
 positive / negative: 0.014509063214063644 / 0.9854909181594849, 
 discrepancy norm error: 8.21854019165039
Test info: 
 test data shape: torch.Size([256, 1]), 
 test lable shape: torch.Size([256, 1]), , 
 positive / negative: -0.04019593074917793 / 1.0401959419250488, 
 discrepancy norm error: 5.910345554351807
Valid info: 
 valid data shape: torch.Size([256, 1]), valid lable shape: torch.Size([256, 1]), 
 positive / negative: 0.04114104062318802 / 0.9588589668273926, 
 discrepancy norm error: 5.461434364318848
torch.Size([512, 1]) torch.Size([512])
seed is  2191
---------------------------------------- NGD ----------------------------------------
<bound method Module.modules of Sequential(
  (0): Linear(in_features=1, out_features=512, bias=True)
  (1): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (2): ReLU()
  (3): Linear(in_features=512, out_features=512, bias=True)
  (4): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (5): ReLU()
  (6): Linear(in_features=512, out_features=512, bias=True)
  (7): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (8): ReLU()
  (9): Linear(in_features=512, out_features=512, bias=True)
  (10): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (11): ReLU()
  (12): Linear(in_features=512, out_features=1, bias=True)
)>
Learning rate is:  1.0
  0%|          | 0/1000 [00:00<?, ?it/s]/nishome/yui/anaconda3/envs/ng/lib/python3.12/site-packages/torch/autograd/graph.py:744: UserWarning: Using backward() with create_graph=True will create a reference cycle between the parameter and its gradient which can cause a memory leak. We recommend using autograd.grad when creating the graph to avoid this. If you have to use this function, make sure to reset the .grad fields of your parameters to None after use to break the cycle and avoid the leak. (Triggered internally at /opt/conda/conda-bld/pytorch_1716905971214/work/torch/csrc/autograd/engine.cpp:1203.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
Epoch:   1
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.5201, device='cuda:0') 
Std:  tensor(37.1448, device='cuda:0') 
ABS Max:  tensor(570.4353, device='cuda:0') 
ABS Min:  tensor(0.0011, device='cuda:0')
Criterion check:  tensor([1.0012, 1.0003, 1.0000, 0.9985, 1.0004, 0.9998, 1.0016, 1.0089, 0.9992,
        0.9977], device='cuda:0') tensor(223, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0024, device='cuda:0')
eigenvalues preserved:  512
Test train Loss:  0.25982871651649475
Test train Acc:  0.0
Test Loss:  0.26468369364738464
Test Acc:  0.0
Valid Loss:  0.232069194316864
Valid Acc:  0.0
max of grad d_p:  tensor(4.7787, device='cuda:0')
min of grad d_p:  tensor(-0.3868, device='cuda:0')
max|min: (J_L, Jta/N)  (4.778709411621094, 4.7787394523620605, ratio: 1.0000063180923462)|(-0.3867913782596588, -0.3867897093296051)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.8030e-05, device='cuda:0') mean:  tensor(-2.4766e-09, device='cuda:0') min:  tensor(-3.0041e-05, device='cuda:0') norm:  tensor(0.0003, device='cuda:0') MSE:  tensor(3.8010e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0043, device='cuda:0') mean:  tensor(2.4455e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0493, device='cuda:0') MSE:  tensor(6.2138e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0067, device='cuda:0')
min of d_p_list:  tensor(-0.0192, device='cuda:0')
Epoch:  1  
Training Loss: 0.2613261382211931
Test Loss:  0.26451238989830017
Test Acc:  0.0
Valid Loss:  0.23405425250530243
Valid Acc:  0.0
local minima detector shape:  (0,)
Preserved_eigens number check:  512
  0%|          | 1/1000 [00:54<15:02:55, 54.23s/it]Epoch:   2
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.4183, device='cuda:0') 
Std:  tensor(19.7735, device='cuda:0') 
ABS Max:  tensor(239.7896, device='cuda:0') 
ABS Min:  tensor(0.0004, device='cuda:0')
Criterion check:  tensor([1.0004, 1.0001, 0.9977, 1.0079, 1.0002, 1.0001, 0.9997, 1.0017, 1.0001,
        0.9997], device='cuda:0') tensor(249, device='cuda:0')
max of Lambda2 tensor(659051.4375, device='cuda:0')
min of Lambda2 tensor(0.0002, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2915, device='cuda:0')
min of grad d_p:  tensor(-0.1846, device='cuda:0')
max|min: (J_L, Jta/N)  (0.29152315855026245, 0.29152312874794006, ratio: 0.9999998807907104)|(-0.18463903665542603, -0.18463903665542603)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.5879e-07, device='cuda:0') mean:  tensor(-2.9782e-10, device='cuda:0') min:  tensor(-1.7695e-06, device='cuda:0') norm:  tensor(2.0698e-05, device='cuda:0') MSE:  tensor(2.6082e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(1.0243e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0158, device='cuda:0') MSE:  tensor(1.9854e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0045, device='cuda:0')
min of d_p_list:  tensor(-0.0040, device='cuda:0')
Epoch:  2  
Training Loss: 0.2623074948787689
Test Loss:  0.2639389634132385
Test Acc:  0.0
Valid Loss:  0.2372673749923706
Valid Acc:  0.0
local minima detector shape:  (1,)
Preserved_eigens number check:  512
  0%|          | 2/1000 [01:32<12:27:08, 44.92s/it]Epoch:   3
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-1.9243, device='cuda:0') 
Std:  tensor(28.8061, device='cuda:0') 
ABS Max:  tensor(435.6063, device='cuda:0') 
ABS Min:  tensor(0.0023, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0003, 0.9998, 1.0001, 0.9997, 0.9984, 1.0002, 0.9998, 0.9996,
        1.0005], device='cuda:0') tensor(245, device='cuda:0')
max of Lambda2 tensor(368423.4375, device='cuda:0')
min of Lambda2 tensor(0.0002, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.4780, device='cuda:0')
min of grad d_p:  tensor(-0.2763, device='cuda:0')
max|min: (J_L, Jta/N)  (0.47802188992500305, 0.4780098795890808, ratio: 0.9999748468399048)|(-0.2762850522994995, -0.2762851119041443)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.6551e-05, device='cuda:0') mean:  tensor(-1.2208e-08, device='cuda:0') min:  tensor(-1.5248e-05, device='cuda:0') norm:  tensor(0.0008, device='cuda:0') MSE:  tensor(1.0464e-09, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(3.2525e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0048, device='cuda:0') MSE:  tensor(5.9861e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0035, device='cuda:0')
min of d_p_list:  tensor(-0.0030, device='cuda:0')
Epoch:  3  
Training Loss: 0.2615639567375183
Test Loss:  0.2614700496196747
Test Acc:  0.0
Valid Loss:  0.23838560283184052
Valid Acc:  0.0
local minima detector shape:  (2,)
Preserved_eigens number check:  512
  0%|          | 3/1000 [01:52<9:13:37, 33.32s/it] Epoch:   4
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(-0.3116, device='cuda:0') 
Std:  tensor(14.3019, device='cuda:0') 
ABS Max:  tensor(158.8048, device='cuda:0') 
ABS Min:  tensor(0.0018, device='cuda:0')
Criterion check:  tensor([1.0237, 1.0007, 0.9997, 0.9998, 1.0000, 1.0000, 1.0005, 0.9995, 1.0002,
        0.9994], device='cuda:0') tensor(229, device='cuda:0')
max of Lambda2 tensor(810679.7500, device='cuda:0')
min of Lambda2 tensor(6.0579e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1365, device='cuda:0')
min of grad d_p:  tensor(-1.1447, device='cuda:0')
max|min: (J_L, Jta/N)  (0.13645979762077332, 0.13645978271961212, ratio: 0.9999998807907104)|(-1.1446915864944458, -1.1446926593780518)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.0729e-06, device='cuda:0') mean:  tensor(1.1322e-10, device='cuda:0') min:  tensor(-1.4156e-07, device='cuda:0') norm:  tensor(4.1013e-06, device='cuda:0') MSE:  tensor(5.1679e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0017, device='cuda:0') mean:  tensor(5.0073e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0078, device='cuda:0') MSE:  tensor(9.8036e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0020, device='cuda:0')
min of d_p_list:  tensor(-0.0020, device='cuda:0')
Epoch:  4  
Training Loss: 0.2536701261997223
Test Loss:  0.2543914318084717
Test Acc:  0.0
Valid Loss:  0.23281772434711456
Valid Acc:  0.0
local minima detector shape:  (3,)
Preserved_eigens number check:  512
  0%|          | 4/1000 [02:17<8:21:09, 30.19s/it]Epoch:   5
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(0.6502, device='cuda:0') 
Std:  tensor(78.0494, device='cuda:0') 
ABS Max:  tensor(1045.1959, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([1.0013, 1.0020, 1.0007, 1.0012, 0.9877, 1.0010, 1.0021, 0.9930, 0.9999,
        0.9927], device='cuda:0') tensor(267, device='cuda:0')
max of Lambda2 tensor(702509.6250, device='cuda:0')
min of Lambda2 tensor(0.0001, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1281, device='cuda:0')
min of grad d_p:  tensor(-0.1641, device='cuda:0')
max|min: (J_L, Jta/N)  (0.12811891734600067, 0.12811559438705444, ratio: 0.9999740719795227)|(-0.16411331295967102, -0.16410955786705017)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.8713e-05, device='cuda:0') mean:  tensor(-2.1433e-10, device='cuda:0') min:  tensor(-3.9488e-06, device='cuda:0') norm:  tensor(8.9813e-05, device='cuda:0') MSE:  tensor(1.1317e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0011, device='cuda:0') mean:  tensor(2.3653e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0352, device='cuda:0') MSE:  tensor(4.4396e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0018, device='cuda:0')
min of d_p_list:  tensor(-0.0016, device='cuda:0')
Epoch:  5  
Training Loss: 0.23865944147109985
Test Loss:  0.23940777778625488
Test Acc:  0.0
Valid Loss:  0.22002831101417542
Valid Acc:  0.0
local minima detector shape:  (4,)
Preserved_eigens number check:  512
  0%|          | 5/1000 [02:37<7:17:25, 26.38s/it]Epoch:   6
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(44.6931, device='cuda:0') 
Std:  tensor(974.5864, device='cuda:0') 
ABS Max:  tensor(22018.2871, device='cuda:0') 
ABS Min:  tensor(0.0124, device='cuda:0')
Criterion check:  tensor([1.0078, 1.0030, 1.0016, 1.0008, 0.9973, 1.0014, 1.0003, 1.0092, 0.6609,
        1.0012], device='cuda:0') tensor(277, device='cuda:0')
max of Lambda2 tensor(645677.2500, device='cuda:0')
min of Lambda2 tensor(5.0647e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0490, device='cuda:0')
min of grad d_p:  tensor(-0.9054, device='cuda:0')
max|min: (J_L, Jta/N)  (0.048986177891492844, 0.04898614063858986, ratio: 0.9999992251396179)|(-0.9054412245750427, -0.9054325222969055)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.5390e-07, device='cuda:0') mean:  tensor(-1.0236e-10, device='cuda:0') min:  tensor(-8.7023e-06, device='cuda:0') norm:  tensor(1.4589e-05, device='cuda:0') MSE:  tensor(1.8383e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0007, device='cuda:0') mean:  tensor(8.3335e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0124, device='cuda:0') MSE:  tensor(1.5682e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0042, device='cuda:0')
min of d_p_list:  tensor(-0.0043, device='cuda:0')
Epoch:  6  
Training Loss: 0.21243701875209808
Test Loss:  0.2146398425102234
Test Acc:  0.0
Valid Loss:  0.19466808438301086
Valid Acc:  0.0
std:  0.018692182837511395 
thres:  0.0002457276076078415
Preserved_eigens number check:  512
  1%|          | 6/1000 [02:59<6:56:51, 25.16s/it]Epoch:   7
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-1.1844, device='cuda:0') 
Std:  tensor(32.4636, device='cuda:0') 
ABS Max:  tensor(359.9484, device='cuda:0') 
ABS Min:  tensor(0.0025, device='cuda:0')
Criterion check:  tensor([1.0003, 1.0000, 0.9993, 1.0022, 1.0004, 0.9998, 1.0101, 0.9998, 0.9949,
        0.9996], device='cuda:0') tensor(255, device='cuda:0')
max of Lambda2 tensor(292351.8125, device='cuda:0')
min of Lambda2 tensor(0.0001, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1112, device='cuda:0')
min of grad d_p:  tensor(-0.1966, device='cuda:0')
max|min: (J_L, Jta/N)  (0.11117132008075714, 0.11117129772901535, ratio: 0.9999998211860657)|(-0.1965908259153366, -0.19659081101417542)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.6822e-06, device='cuda:0') mean:  tensor(1.3752e-11, device='cuda:0') min:  tensor(-5.1490e-07, device='cuda:0') norm:  tensor(5.6045e-06, device='cuda:0') MSE:  tensor(7.0621e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(5.3110e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0078, device='cuda:0') MSE:  tensor(9.7985e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0020, device='cuda:0')
min of d_p_list:  tensor(-0.0021, device='cuda:0')
Epoch:  7  
Training Loss: 0.17404210567474365
Test Loss:  0.17430071532726288
Test Acc:  0.0
Valid Loss:  0.16459745168685913
Valid Acc:  0.0
std:  0.031789152978243 
thres:  0.00022807452976703643
Preserved_eigens number check:  512
  1%|          | 7/1000 [03:19<6:26:02, 23.33s/it]Epoch:   8
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(0.7507, device='cuda:0') 
Std:  tensor(21.8754, device='cuda:0') 
ABS Max:  tensor(301.7717, device='cuda:0') 
ABS Min:  tensor(0.0011, device='cuda:0')
Criterion check:  tensor([1.0006, 0.9996, 0.9999, 1.0000, 1.0000, 1.0043, 1.0001, 1.0000, 0.9996,
        1.0000], device='cuda:0') tensor(233, device='cuda:0')
max of Lambda2 tensor(389603.5312, device='cuda:0')
min of Lambda2 tensor(0.0001, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0881, device='cuda:0')
min of grad d_p:  tensor(-0.0734, device='cuda:0')
max|min: (J_L, Jta/N)  (0.08812090754508972, 0.08812104910612106, ratio: 1.0000015497207642)|(-0.07340122759342194, -0.07340122014284134)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.7739e-07, device='cuda:0') mean:  tensor(-5.2126e-11, device='cuda:0') min:  tensor(-1.4156e-07, device='cuda:0') norm:  tensor(3.0166e-06, device='cuda:0') MSE:  tensor(3.8011e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(8.3314e-05, device='cuda:0') mean:  tensor(2.3980e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0037, device='cuda:0') MSE:  tensor(4.7003e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0021, device='cuda:0')
min of d_p_list:  tensor(-0.0028, device='cuda:0')
Epoch:  8  
Training Loss: 0.12769433856010437
Test Loss:  0.12914922833442688
Test Acc:  0.0
Valid Loss:  0.12390228360891342
Valid Acc:  0.0
std:  0.04565780846494138 
thres:  0.00020130060613155365
Preserved_eigens number check:  512
  1%|          | 8/1000 [03:41<6:17:04, 22.81s/it]Epoch:   9
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-8.0518, device='cuda:0') 
Std:  tensor(118.1436, device='cuda:0') 
ABS Max:  tensor(2433.7988, device='cuda:0') 
ABS Min:  tensor(0.0005, device='cuda:0')
Criterion check:  tensor([1.0001, 1.0007, 1.0018, 0.9999, 0.9999, 0.9999, 1.0003, 1.0000, 0.9994,
        1.0008], device='cuda:0') tensor(254, device='cuda:0')
max of Lambda2 tensor(239753.7031, device='cuda:0')
min of Lambda2 tensor(0.0001, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0429, device='cuda:0')
min of grad d_p:  tensor(-0.0257, device='cuda:0')
max|min: (J_L, Jta/N)  (0.04288296774029732, 0.04288293048739433, ratio: 0.9999991059303284)|(-0.0257188081741333, -0.02571878768503666)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.7544e-08, device='cuda:0') mean:  tensor(3.3656e-13, device='cuda:0') min:  tensor(-4.3213e-07, device='cuda:0') norm:  tensor(2.4189e-06, device='cuda:0') MSE:  tensor(3.0480e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(4.6629e-05, device='cuda:0') mean:  tensor(1.5914e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0023, device='cuda:0') MSE:  tensor(2.8543e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0097, device='cuda:0')
min of d_p_list:  tensor(-0.0042, device='cuda:0')
Epoch:  9  
Training Loss: 0.12434139847755432
Test Loss:  0.12881895899772644
Test Acc:  0.0
Valid Loss:  0.11669456958770752
Valid Acc:  0.0
std:  0.045294914541967074 
thres:  0.00017543486058712004
Preserved_eigens number check:  512
  1%|          | 9/1000 [04:01<6:01:21, 21.88s/it]Epoch:   10
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(-0.0452, device='cuda:0') 
Std:  tensor(56.1668, device='cuda:0') 
ABS Max:  tensor(722.0758, device='cuda:0') 
ABS Min:  tensor(0.0015, device='cuda:0')
Criterion check:  tensor([1.0002, 1.0001, 1.0000, 1.0026, 0.9999, 1.0000, 1.0002, 1.0000, 0.9999,
        1.0003], device='cuda:0') tensor(239, device='cuda:0')
max of Lambda2 tensor(237293.0938, device='cuda:0')
min of Lambda2 tensor(4.7205e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1274, device='cuda:0')
min of grad d_p:  tensor(-0.1656, device='cuda:0')
max|min: (J_L, Jta/N)  (0.12738248705863953, 0.12738248705863953, ratio: 1.0)|(-0.16556373238563538, -0.16556361317634583)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.7940e-07, device='cuda:0') mean:  tensor(-1.2982e-11, device='cuda:0') min:  tensor(-2.0117e-07, device='cuda:0') norm:  tensor(3.6459e-06, device='cuda:0') MSE:  tensor(4.5942e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(5.0182e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0074, device='cuda:0') MSE:  tensor(9.2936e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0026, device='cuda:0')
min of d_p_list:  tensor(-0.0034, device='cuda:0')
Epoch:  10  
Training Loss: 0.07316124439239502
Test Loss:  0.07870645076036453
Test Acc:  0.0
Valid Loss:  0.07056678831577301
Valid Acc:  0.0
std:  0.04741890068559404 
thres:  0.0001423352211713791
Preserved_eigens number check:  512
  1%|          | 10/1000 [04:21<5:52:33, 21.37s/it]Epoch:   11
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(-4.3175, device='cuda:0') 
Std:  tensor(56.9458, device='cuda:0') 
ABS Max:  tensor(1102.3639, device='cuda:0') 
ABS Min:  tensor(0.0001, device='cuda:0')
Criterion check:  tensor([0.9990, 1.0005, 1.0000, 0.9990, 1.0000, 0.9992, 1.0004, 1.0002, 1.0000,
        1.0002], device='cuda:0') tensor(245, device='cuda:0')
max of Lambda2 tensor(255956.2031, device='cuda:0')
min of Lambda2 tensor(7.8332e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0479, device='cuda:0')
min of grad d_p:  tensor(-0.0402, device='cuda:0')
max|min: (J_L, Jta/N)  (0.047904886305332184, 0.04790494218468666, ratio: 1.0000011920928955)|(-0.04016048088669777, -0.04016049951314926)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.4249e-07, device='cuda:0') mean:  tensor(1.1601e-11, device='cuda:0') min:  tensor(-1.1735e-07, device='cuda:0') norm:  tensor(3.8434e-06, device='cuda:0') MSE:  tensor(4.8429e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(5.2683e-05, device='cuda:0') mean:  tensor(2.5801e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0037, device='cuda:0') MSE:  tensor(4.6718e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0057, device='cuda:0')
min of d_p_list:  tensor(-0.0057, device='cuda:0')
Epoch:  11  
Training Loss: 0.10637567937374115
Test Loss:  0.11647093296051025
Test Acc:  0.0
Valid Loss:  0.10912829637527466
Valid Acc:  0.0
std:  0.032777387910731766 
thres:  0.0001211229532957077
Preserved_eigens number check:  512
  1%|          | 11/1000 [04:44<6:00:12, 21.85s/it]Epoch:   12
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  509
Criterion check: 
Mean:  tensor(-137.6803, device='cuda:0') 
Std:  tensor(2238.1277, device='cuda:0') 
ABS Max:  tensor(48342.3281, device='cuda:0') 
ABS Min:  tensor(0.0057, device='cuda:0')
Criterion check:  tensor([1.0006, 1.0001, 0.9999, 0.9999, 1.0000, 1.0002, 0.9951, 0.9984, 0.9993,
        0.9984], device='cuda:0') tensor(261, device='cuda:0')
max of Lambda2 tensor(196352.5781, device='cuda:0')
min of Lambda2 tensor(4.7347e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2045, device='cuda:0')
min of grad d_p:  tensor(-0.1953, device='cuda:0')
max|min: (J_L, Jta/N)  (0.20445117354393005, 0.20445111393928528, ratio: 0.9999997019767761)|(-0.19531366229057312, -0.19531364738941193)

 check Jacobi res:  torch.Size([793601]) max:  tensor(6.1095e-07, device='cuda:0') mean:  tensor(2.5241e-11, device='cuda:0') min:  tensor(-2.6572e-07, device='cuda:0') norm:  tensor(3.6555e-06, device='cuda:0') MSE:  tensor(4.6062e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0008, device='cuda:0') mean:  tensor(2.5425e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0375, device='cuda:0') MSE:  tensor(4.7241e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0093, device='cuda:0')
min of d_p_list:  tensor(-0.0071, device='cuda:0')
Epoch:  12  
Training Loss: 0.1306629180908203
Test Loss:  0.1354348212480545
Test Acc:  0.0
Valid Loss:  0.1256190836429596
Valid Acc:  0.0
std:  0.02138227886798339 
thres:  0.00011244711577892305
Preserved_eigens number check:  512
  1%|          | 12/1000 [05:06<6:02:50, 22.03s/it]Epoch:   13
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  510
Criterion check: 
Mean:  tensor(2.5953, device='cuda:0') 
Std:  tensor(34.1315, device='cuda:0') 
ABS Max:  tensor(710.6516, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0001, 0.9998, 1.0009, 1.0000, 0.9994, 1.0000, 1.0005,
        0.9999], device='cuda:0') tensor(246, device='cuda:0')
max of Lambda2 tensor(194433.2656, device='cuda:0')
min of Lambda2 tensor(2.7761e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1022, device='cuda:0')
min of grad d_p:  tensor(-0.1527, device='cuda:0')
max|min: (J_L, Jta/N)  (0.10218288749456406, 0.10218289494514465, ratio: 1.0000001192092896)|(-0.15270152688026428, -0.15270160138607025)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.0568e-07, device='cuda:0') mean:  tensor(-6.1098e-11, device='cuda:0') min:  tensor(-1.2560e-07, device='cuda:0') norm:  tensor(2.2290e-06, device='cuda:0') MSE:  tensor(2.8087e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(9.3508e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0137, device='cuda:0') MSE:  tensor(1.7264e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0053, device='cuda:0')
min of d_p_list:  tensor(-0.0060, device='cuda:0')
Epoch:  13  
Training Loss: 0.10036307573318481
Test Loss:  0.1040264293551445
Test Acc:  0.0
Valid Loss:  0.08782890439033508
Valid Acc:  0.0
std:  0.020249226571334742 
thres:  0.00010698086321353912
Preserved_eigens number check:  512
  1%|▏         | 13/1000 [05:26<5:52:16, 21.42s/it]Epoch:   14
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  509
Criterion check: 
Mean:  tensor(-1.5702, device='cuda:0') 
Std:  tensor(41.8800, device='cuda:0') 
ABS Max:  tensor(766.5101, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 0.9998, 0.9999, 1.0004, 1.0001, 0.9965, 0.9998, 1.0002,
        0.9996], device='cuda:0') tensor(247, device='cuda:0')
max of Lambda2 tensor(181721.7656, device='cuda:0')
min of Lambda2 tensor(5.6797e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.6079, device='cuda:0')
min of grad d_p:  tensor(-0.1199, device='cuda:0')
max|min: (J_L, Jta/N)  (0.607898473739624, 0.6078882813453674, ratio: 0.9999832510948181)|(-0.1199125200510025, -0.1199125275015831)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.0192e-05, device='cuda:0') mean:  tensor(-3.1391e-11, device='cuda:0') min:  tensor(-1.6391e-07, device='cuda:0') norm:  tensor(1.0586e-05, device='cuda:0') MSE:  tensor(1.3339e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(6.5517e-05, device='cuda:0') mean:  tensor(2.4552e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0035, device='cuda:0') MSE:  tensor(4.4715e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.6372, device='cuda:0')
min of d_p_list:  tensor(-1.2468, device='cuda:0')
Epoch:  14  
Training Loss: 213633152.0
Test Loss:  223559232.0
Test Acc:  0.0
Valid Loss:  211050368.0
Valid Acc:  0.0
std:  85453260.7589437 
thres:  42726.63048211259
Preserved_eigens number check:  512
  1%|▏         | 14/1000 [05:50<6:01:54, 22.02s/it]Epoch:   15
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  509
Criterion check: 
Mean:  tensor(1.2987, device='cuda:0') 
Std:  tensor(31.1770, device='cuda:0') 
ABS Max:  tensor(377.7834, device='cuda:0') 
ABS Min:  tensor(1.4630e-05, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0001, 1.0000, 1.0001, 1.0000, 1.0000, 1.0000, 1.0000,
        1.0000], device='cuda:0') tensor(244, device='cuda:0')
max of Lambda2 tensor(464948.8125, device='cuda:0')
min of Lambda2 tensor(6.7509e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(2.0541, device='cuda:0')
min of grad d_p:  tensor(-3.9763, device='cuda:0')
max|min: (J_L, Jta/N)  (2.0540754795074463, 2.0540757179260254, ratio: 1.0000001192092896)|(-3.9763059616088867, -3.9763054847717285)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.1458e-06, device='cuda:0') mean:  tensor(-2.7845e-11, device='cuda:0') min:  tensor(-7.3522e-05, device='cuda:0') norm:  tensor(8.4991e-05, device='cuda:0') MSE:  tensor(1.0710e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0019, device='cuda:0') mean:  tensor(3.8226e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0715, device='cuda:0') MSE:  tensor(9.0154e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0256, device='cuda:0')
min of d_p_list:  tensor(-0.0312, device='cuda:0')
Epoch:  15  
Training Loss: 1470.745361328125
Test Loss:  1585.23974609375
Test Acc:  0.0
Valid Loss:  1407.6070556640625
Valid Acc:  0.0
std:  85453113.6936219 
thres:  42726.924616552606
Preserved_eigens number check:  512
  2%|▏         | 15/1000 [06:07<5:40:00, 20.71s/it]Epoch:   16
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  510
Criterion check: 
Mean:  tensor(7.7527, device='cuda:0') 
Std:  tensor(139.6341, device='cuda:0') 
ABS Max:  tensor(2602.9404, device='cuda:0') 
ABS Min:  tensor(0.0008, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0001, 1.0000, 1.0000, 0.9999, 1.0000, 1.0000, 1.0000, 0.9996,
        0.9997], device='cuda:0') tensor(235, device='cuda:0')
max of Lambda2 tensor(306402.4062, device='cuda:0')
min of Lambda2 tensor(2.8830e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.0355, device='cuda:0')
min of grad d_p:  tensor(-1.4824, device='cuda:0')
max|min: (J_L, Jta/N)  (1.0354931354522705, 1.0354933738708496, ratio: 1.000000238418579)|(-1.4823708534240723, -1.4823707342147827)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.9605e-07, device='cuda:0') mean:  tensor(-5.4069e-11, device='cuda:0') min:  tensor(-1.0431e-06, device='cuda:0') norm:  tensor(1.1165e-05, device='cuda:0') MSE:  tensor(1.4069e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(1.1725e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0215, device='cuda:0') MSE:  tensor(2.7074e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0141, device='cuda:0')
min of d_p_list:  tensor(-0.0173, device='cuda:0')
Epoch:  16  
Training Loss: 41.493377685546875
Test Loss:  45.673927307128906
Test Acc:  0.0
Valid Loss:  38.97687911987305
Valid Acc:  0.0
std:  85453109.5548876 
thres:  42726.932893953
Preserved_eigens number check:  512
  2%|▏         | 16/1000 [06:24<5:22:23, 19.66s/it]Epoch:   17
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(-1.9091, device='cuda:0') 
Std:  tensor(96.0688, device='cuda:0') 
ABS Max:  tensor(1936.3649, device='cuda:0') 
ABS Min:  tensor(0.0018, device='cuda:0')
Criterion check:  tensor([1.0002, 1.0000, 1.0001, 1.0003, 1.0002, 0.9999, 1.0001, 1.0000, 1.0000,
        0.9999], device='cuda:0') tensor(235, device='cuda:0')
max of Lambda2 tensor(281207.0312, device='cuda:0')
min of Lambda2 tensor(3.9722e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2398, device='cuda:0')
min of grad d_p:  tensor(-0.3978, device='cuda:0')
max|min: (J_L, Jta/N)  (0.2397773563861847, 0.23977750539779663, ratio: 1.0000005960464478)|(-0.3977876305580139, -0.39778754115104675)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.1292e-07, device='cuda:0') mean:  tensor(3.8055e-11, device='cuda:0') min:  tensor(-2.0862e-07, device='cuda:0') norm:  tensor(4.2319e-06, device='cuda:0') MSE:  tensor(5.3325e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0014, device='cuda:0') mean:  tensor(1.0224e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0186, device='cuda:0') MSE:  tensor(2.3436e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0045, device='cuda:0')
min of d_p_list:  tensor(-0.0126, device='cuda:0')
Epoch:  17  
Training Loss: 2.4475412368774414
Test Loss:  2.656188488006592
Test Acc:  0.0
Valid Loss:  2.242353916168213
Valid Acc:  0.0
std:  85453109.32319772 
thres:  42726.93335732867
Preserved_eigens number check:  512
  2%|▏         | 17/1000 [06:42<5:13:21, 19.13s/it]Epoch:   18
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  509
Criterion check: 
Mean:  tensor(14.2689, device='cuda:0') 
Std:  tensor(551.8376, device='cuda:0') 
ABS Max:  tensor(11823.3750, device='cuda:0') 
ABS Min:  tensor(0.0011, device='cuda:0')
Criterion check:  tensor([0.9995, 0.9998, 1.0029, 1.0010, 1.0001, 0.9998, 0.9998, 1.0002, 1.0001,
        1.0003], device='cuda:0') tensor(225, device='cuda:0')
max of Lambda2 tensor(307425.7812, device='cuda:0')
min of Lambda2 tensor(2.5271e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0446, device='cuda:0')
min of grad d_p:  tensor(-0.0700, device='cuda:0')
max|min: (J_L, Jta/N)  (0.0446169450879097, 0.044616930186748505, ratio: 0.9999996423721313)|(-0.0699615329504013, -0.06996145844459534)

 check Jacobi res:  torch.Size([793601]) max:  tensor(6.7055e-08, device='cuda:0') mean:  tensor(-4.8460e-11, device='cuda:0') min:  tensor(-1.2852e-07, device='cuda:0') norm:  tensor(2.6771e-06, device='cuda:0') MSE:  tensor(3.3734e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(1.0684e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0198, device='cuda:0') MSE:  tensor(2.4901e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0362, device='cuda:0')
min of d_p_list:  tensor(-0.0255, device='cuda:0')
Epoch:  18  
Training Loss: 2.799114227294922
Test Loss:  3.1668198108673096
Test Acc:  0.0
Valid Loss:  2.6002988815307617
Valid Acc:  0.0
std:  85453109.05332021 
thres:  42726.933897078896
Preserved_eigens number check:  512
  2%|▏         | 18/1000 [06:59<5:03:16, 18.53s/it]Epoch:   19
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  510
Criterion check: 
Mean:  tensor(1.2867, device='cuda:0') 
Std:  tensor(25.3859, device='cuda:0') 
ABS Max:  tensor(355.5866, device='cuda:0') 
ABS Min:  tensor(0.0007, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0000, 0.9999, 1.0000, 1.0000, 1.0001, 1.0000, 1.0001,
        0.9967], device='cuda:0') tensor(230, device='cuda:0')
max of Lambda2 tensor(225761.9219, device='cuda:0')
min of Lambda2 tensor(7.2578e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3168, device='cuda:0')
min of grad d_p:  tensor(-0.3942, device='cuda:0')
max|min: (J_L, Jta/N)  (0.31684184074401855, 0.3168419897556305, ratio: 1.0000004768371582)|(-0.3941793143749237, -0.39417940378189087)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.8743e-07, device='cuda:0') mean:  tensor(1.9133e-10, device='cuda:0') min:  tensor(-2.9802e-07, device='cuda:0') norm:  tensor(6.6228e-06, device='cuda:0') MSE:  tensor(8.3453e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(3.4292e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0066, device='cuda:0') MSE:  tensor(8.2547e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0428, device='cuda:0')
min of d_p_list:  tensor(-0.0360, device='cuda:0')
Epoch:  19  
Training Loss: 3.6398844718933105
Test Loss:  4.109259605407715
Test Acc:  0.0
Valid Loss:  3.4438869953155518
Valid Acc:  0.0
std:  583.4511581384514 
thres:  0.3042250557899475
Preserved_eigens number check:  512
  2%|▏         | 19/1000 [07:17<4:58:30, 18.26s/it]Epoch:   20
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  508
Criterion check: 
Mean:  tensor(-5.5704, device='cuda:0') 
Std:  tensor(197.9592, device='cuda:0') 
ABS Max:  tensor(3181.2434, device='cuda:0') 
ABS Min:  tensor(0.0011, device='cuda:0')
Criterion check:  tensor([1.0000, 0.9999, 0.9998, 1.0002, 0.9998, 1.0000, 1.0009, 0.9993, 1.0197,
        1.0001], device='cuda:0') tensor(235, device='cuda:0')
max of Lambda2 tensor(161057.1875, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.5052, device='cuda:0')
min of grad d_p:  tensor(-0.5530, device='cuda:0')
max|min: (J_L, Jta/N)  (0.5052341818809509, 0.5052340626716614, ratio: 0.9999997615814209)|(-0.5529597997665405, -0.5529598593711853)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.0862e-07, device='cuda:0') mean:  tensor(-3.4718e-11, device='cuda:0') min:  tensor(-6.2538e-07, device='cuda:0') norm:  tensor(4.0448e-06, device='cuda:0') MSE:  tensor(5.0968e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(6.7052e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0123, device='cuda:0') MSE:  tensor(1.5555e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0057, device='cuda:0')
min of d_p_list:  tensor(-0.0087, device='cuda:0')
Epoch:  20  
Training Loss: 0.10932856053113937
Test Loss:  0.09999096393585205
Test Acc:  0.0
Valid Loss:  0.10604745149612427
Valid Acc:  0.0
std:  15.741371007722012 
thres:  0.010097849236428738
Preserved_eigens number check:  512
  2%|▏         | 20/1000 [07:35<4:54:37, 18.04s/it]Epoch:   21
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  508
Criterion check: 
Mean:  tensor(1.3162, device='cuda:0') 
Std:  tensor(33.2738, device='cuda:0') 
ABS Max:  tensor(694.8015, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0001, 0.9950, 0.9997, 0.9790, 1.0001, 1.0001, 1.0000, 0.9998,
        0.9999], device='cuda:0') tensor(220, device='cuda:0')
max of Lambda2 tensor(149544.0625, device='cuda:0')
min of Lambda2 tensor(4.0823e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0520, device='cuda:0')
min of grad d_p:  tensor(-0.0465, device='cuda:0')
max|min: (J_L, Jta/N)  (0.051967453211545944, 0.05196734890341759, ratio: 0.9999979734420776)|(-0.04646564647555351, -0.04646576568484306)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.6089e-07, device='cuda:0') mean:  tensor(7.0932e-11, device='cuda:0') min:  tensor(-1.4715e-07, device='cuda:0') norm:  tensor(3.8875e-06, device='cuda:0') MSE:  tensor(4.8985e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(5.9609e-05, device='cuda:0') mean:  tensor(1.5833e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0027, device='cuda:0') MSE:  tensor(3.4528e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0140, device='cuda:0')
min of d_p_list:  tensor(-0.0126, device='cuda:0')
Epoch:  21  
Training Loss: 0.07542546838521957
Test Loss:  0.07413390278816223
Test Acc:  0.0
Valid Loss:  0.07013803720474243
Valid Acc:  0.0
std:  1.4583706269666499 
thres:  0.0018142587929964064
Preserved_eigens number check:  512
  2%|▏         | 21/1000 [07:53<4:54:13, 18.03s/it]Epoch:   22
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  508
Criterion check: 
Mean:  tensor(2.7606, device='cuda:0') 
Std:  tensor(60.9576, device='cuda:0') 
ABS Max:  tensor(699.6444, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([1.0030, 0.9967, 1.0082, 1.0005, 0.9889, 0.9985, 0.9978, 1.0043, 0.9994,
        0.9922], device='cuda:0') tensor(233, device='cuda:0')
max of Lambda2 tensor(169238.4531, device='cuda:0')
min of Lambda2 tensor(2.5483e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0107, device='cuda:0')
min of grad d_p:  tensor(-0.0179, device='cuda:0')
max|min: (J_L, Jta/N)  (0.010695215314626694, 0.01069522276520729, ratio: 1.0000007152557373)|(-0.01785779371857643, -0.017857816070318222)

 check Jacobi res:  torch.Size([793601]) max:  tensor(7.1770e-08, device='cuda:0') mean:  tensor(8.3699e-12, device='cuda:0') min:  tensor(-1.1316e-07, device='cuda:0') norm:  tensor(2.1982e-06, device='cuda:0') MSE:  tensor(2.7699e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(5.1715e-06, device='cuda:0') min:  tensor(8.2347e-16, device='cuda:0') norm:  tensor(0.0097, device='cuda:0') MSE:  tensor(1.2190e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0714, device='cuda:0')
min of d_p_list:  tensor(-0.0795, device='cuda:0')
Epoch:  22  
Training Loss: 0.869701623916626
Test Loss:  0.9736859798431396
Test Acc:  0.0
Valid Loss:  0.9803013801574707
Valid Acc:  0.0
std:  1.4579060635776164 
thres:  0.0014986908704042435
Preserved_eigens number check:  512
  2%|▏         | 22/1000 [08:10<4:51:39, 17.89s/it]Epoch:   23
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  506
Criterion check: 
Mean:  tensor(-0.5055, device='cuda:0') 
Std:  tensor(151.7144, device='cuda:0') 
ABS Max:  tensor(2672.4446, device='cuda:0') 
ABS Min:  tensor(0.0033, device='cuda:0')
Criterion check:  tensor([1.0000, 0.9997, 1.0000, 1.0000, 0.9999, 1.0001, 1.0002, 0.9999, 0.9999,
        1.0004], device='cuda:0') tensor(241, device='cuda:0')
max of Lambda2 tensor(110026.2734, device='cuda:0')
min of Lambda2 tensor(2.6586e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.4673, device='cuda:0')
min of grad d_p:  tensor(-0.8047, device='cuda:0')
max|min: (J_L, Jta/N)  (0.46729400753974915, 0.46729394793510437, ratio: 0.9999998807907104)|(-0.8047459721565247, -0.8047457933425903)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.9802e-07, device='cuda:0') mean:  tensor(-1.5605e-11, device='cuda:0') min:  tensor(-2.6822e-07, device='cuda:0') norm:  tensor(4.3575e-06, device='cuda:0') MSE:  tensor(5.4908e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(8.9160e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0165, device='cuda:0') MSE:  tensor(2.0808e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0239, device='cuda:0')
min of d_p_list:  tensor(-0.0198, device='cuda:0')
Epoch:  23  
Training Loss: 0.23456384241580963
Test Loss:  0.25838470458984375
Test Acc:  0.0
Valid Loss:  0.21358543634414673
Valid Acc:  0.0
std:  1.357864717231377 
thres:  0.0009857807934284212
Preserved_eigens number check:  512
  2%|▏         | 23/1000 [08:28<4:49:16, 17.77s/it]Epoch:   24
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  507
Criterion check: 
Mean:  tensor(14.3987, device='cuda:0') 
Std:  tensor(355.9458, device='cuda:0') 
ABS Max:  tensor(6914.6489, device='cuda:0') 
ABS Min:  tensor(0.0007, device='cuda:0')
Criterion check:  tensor([1.0013, 0.9990, 0.9997, 1.0000, 1.0011, 0.9996, 0.9994, 0.9993, 0.9983,
        0.9967], device='cuda:0') tensor(268, device='cuda:0')
max of Lambda2 tensor(105705.6641, device='cuda:0')
min of Lambda2 tensor(2.7683e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0666, device='cuda:0')
min of grad d_p:  tensor(-0.0876, device='cuda:0')
max|min: (J_L, Jta/N)  (0.0665687620639801, 0.0665687695145607, ratio: 1.0000001192092896)|(-0.0875951424241066, -0.0875951424241066)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.6206e-08, device='cuda:0') mean:  tensor(2.3982e-11, device='cuda:0') min:  tensor(-3.3760e-08, device='cuda:0') norm:  tensor(1.1242e-06, device='cuda:0') MSE:  tensor(1.4165e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0015, device='cuda:0') mean:  tensor(2.1018e-05, device='cuda:0') min:  tensor(2.8338e-14, device='cuda:0') norm:  tensor(0.0382, device='cuda:0') MSE:  tensor(4.8110e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0207, device='cuda:0')
min of d_p_list:  tensor(-0.0243, device='cuda:0')
Epoch:  24  
Training Loss: 0.19816505908966064
Test Loss:  0.21652942895889282
Test Acc:  0.0
Valid Loss:  0.2047635018825531
Valid Acc:  0.0
std:  0.29187965230637797 
thres:  0.00029743691086769105
Preserved_eigens number check:  512
  2%|▏         | 24/1000 [08:45<4:47:39, 17.68s/it]Epoch:   25
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  508
Criterion check: 
Mean:  tensor(4.5283, device='cuda:0') 
Std:  tensor(147.6536, device='cuda:0') 
ABS Max:  tensor(3224.4666, device='cuda:0') 
ABS Min:  tensor(0.0018, device='cuda:0')
Criterion check:  tensor([1.0001, 1.0058, 0.9998, 1.0006, 1.0000, 0.9999, 0.9998, 1.0004, 0.9995,
        0.9988], device='cuda:0') tensor(240, device='cuda:0')
max of Lambda2 tensor(108241.1172, device='cuda:0')
min of Lambda2 tensor(1.1247e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1711, device='cuda:0')
min of grad d_p:  tensor(-0.1029, device='cuda:0')
max|min: (J_L, Jta/N)  (0.17110569775104523, 0.17110565304756165, ratio: 0.9999997615814209)|(-0.10294477641582489, -0.10294484347105026)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.1921e-07, device='cuda:0') mean:  tensor(1.2259e-11, device='cuda:0') min:  tensor(-4.4703e-08, device='cuda:0') norm:  tensor(1.8266e-06, device='cuda:0') MSE:  tensor(2.3017e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(4.8495e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0087, device='cuda:0') MSE:  tensor(1.0913e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0118, device='cuda:0')
min of d_p_list:  tensor(-0.0083, device='cuda:0')
Epoch:  25  
Training Loss: 0.08128979802131653
Test Loss:  0.0885481983423233
Test Acc:  0.0
Valid Loss:  0.07840999960899353
Valid Acc:  0.0
std:  0.29568437416858157 
thres:  0.00029182915836572647
Preserved_eigens number check:  512
  2%|▎         | 25/1000 [09:03<4:48:10, 17.73s/it]Epoch:   26
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  504
Criterion check: 
Mean:  tensor(-1.0174, device='cuda:0') 
Std:  tensor(34.9745, device='cuda:0') 
ABS Max:  tensor(398.7789, device='cuda:0') 
ABS Min:  tensor(0.0006, device='cuda:0')
Criterion check:  tensor([1.0057, 0.9949, 0.9995, 1.0250, 0.9996, 0.9989, 1.0003, 0.9997, 0.9990,
        0.9996], device='cuda:0') tensor(221, device='cuda:0')
max of Lambda2 tensor(100327.6953, device='cuda:0')
min of Lambda2 tensor(6.9230e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0163, device='cuda:0')
min of grad d_p:  tensor(-0.0121, device='cuda:0')
max|min: (J_L, Jta/N)  (0.016327055171132088, 0.016327084973454475, ratio: 1.0000017881393433)|(-0.012074018828570843, -0.012074068188667297)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.7276e-08, device='cuda:0') mean:  tensor(6.1128e-12, device='cuda:0') min:  tensor(-8.1025e-08, device='cuda:0') norm:  tensor(1.3127e-06, device='cuda:0') MSE:  tensor(1.6541e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(3.7187e-06, device='cuda:0') min:  tensor(7.6814e-15, device='cuda:0') norm:  tensor(0.0069, device='cuda:0') MSE:  tensor(8.7164e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0400, device='cuda:0')
min of d_p_list:  tensor(-0.0331, device='cuda:0')
Epoch:  26  
Training Loss: 0.3046014606952667
Test Loss:  0.33632993698120117
Test Acc:  0.0
Valid Loss:  0.28524914383888245
Valid Acc:  0.0
std:  0.27567172260378375 
thres:  0.00033766435682773587
Preserved_eigens number check:  512
  3%|▎         | 26/1000 [09:20<4:45:23, 17.58s/it]Epoch:   27
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  507
Criterion check: 
Mean:  tensor(-3.8734, device='cuda:0') 
Std:  tensor(74.8132, device='cuda:0') 
ABS Max:  tensor(1290.7457, device='cuda:0') 
ABS Min:  tensor(0.0011, device='cuda:0')
Criterion check:  tensor([0.9953, 1.0000, 0.9998, 1.0000, 1.0007, 1.0000, 1.0000, 1.0000, 1.0006,
        1.0001], device='cuda:0') tensor(231, device='cuda:0')
max of Lambda2 tensor(104235.6016, device='cuda:0')
min of Lambda2 tensor(1.5858e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1445, device='cuda:0')
min of grad d_p:  tensor(-0.1281, device='cuda:0')
max|min: (J_L, Jta/N)  (0.1444549858570099, 0.1444549709558487, ratio: 0.9999998807907104)|(-0.12806516885757446, -0.12806521356105804)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.2666e-07, device='cuda:0') mean:  tensor(1.6240e-13, device='cuda:0') min:  tensor(-5.9605e-08, device='cuda:0') norm:  tensor(1.5368e-06, device='cuda:0') MSE:  tensor(1.9365e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(4.7001e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0085, device='cuda:0') MSE:  tensor(1.0741e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(4.8148, device='cuda:0')
min of d_p_list:  tensor(-3.2550, device='cuda:0')
Epoch:  27  
Training Loss: 1037357.8125
Test Loss:  1096027.5
Test Acc:  0.0
Valid Loss:  964239.375
Valid Acc:  0.0
std:  414943.0431379903 
thres:  207.47172622403207
Preserved_eigens number check:  512
  3%|▎         | 27/1000 [09:37<4:42:30, 17.42s/it]Epoch:   28
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(-164.1868, device='cuda:0') 
Std:  tensor(3949.0996, device='cuda:0') 
ABS Max:  tensor(85669.8594, device='cuda:0') 
ABS Min:  tensor(0.1063, device='cuda:0')
Criterion check:  tensor([1.0018, 1.0006, 0.9999, 1.0011, 1.0105, 1.0118, 1.0063, 1.0442, 0.9759,
        0.9992], device='cuda:0') tensor(262, device='cuda:0')
max of Lambda2 tensor(993346.8750, device='cuda:0')
min of Lambda2 tensor(5.5885e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(20.1731, device='cuda:0')
min of grad d_p:  tensor(-11.5867, device='cuda:0')
max|min: (J_L, Jta/N)  (20.17312240600586, 20.173137664794922, ratio: 1.0000007152557373)|(-11.586740493774414, -11.58674430847168)

 check Jacobi res:  torch.Size([793601]) max:  tensor(7.6294e-06, device='cuda:0') mean:  tensor(-8.8976e-10, device='cuda:0') min:  tensor(-1.5259e-05, device='cuda:0') norm:  tensor(9.0305e-05, device='cuda:0') MSE:  tensor(1.1379e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.1950, device='cuda:0') mean:  tensor(0.0016, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(3.9439, device='cuda:0') MSE:  tensor(4.9696e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0679, device='cuda:0')
min of d_p_list:  tensor(-0.0709, device='cuda:0')
Epoch:  28  
Training Loss: 811.529541015625
Test Loss:  905.3991088867188
Test Acc:  0.0
Valid Loss:  828.348388671875
Valid Acc:  0.0
std:  414862.03264327074 
thres:  207.63398521946667
Preserved_eigens number check:  512
  3%|▎         | 28/1000 [09:55<4:42:59, 17.47s/it]Epoch:   29
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  507
Criterion check: 
Mean:  tensor(1.0974, device='cuda:0') 
Std:  tensor(25.6140, device='cuda:0') 
ABS Max:  tensor(314.6439, device='cuda:0') 
ABS Min:  tensor(0.0007, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0001, 1.0000, 1.0000, 0.9973,
        1.0027], device='cuda:0') tensor(210, device='cuda:0')
max of Lambda2 tensor(319454.0938, device='cuda:0')
min of Lambda2 tensor(2.5620e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(6.7264, device='cuda:0')
min of grad d_p:  tensor(-3.8322, device='cuda:0')
max|min: (J_L, Jta/N)  (6.726429462432861, 6.726428508758545, ratio: 0.9999998807907104)|(-3.832214593887329, -3.8322126865386963)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.3842e-06, device='cuda:0') mean:  tensor(-2.4488e-10, device='cuda:0') min:  tensor(-3.0994e-06, device='cuda:0') norm:  tensor(2.4708e-05, device='cuda:0') MSE:  tensor(3.1135e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0018, device='cuda:0') mean:  tensor(1.7321e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0392, device='cuda:0') MSE:  tensor(4.9340e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1044, device='cuda:0')
min of d_p_list:  tensor(-0.1236, device='cuda:0')
Epoch:  29  
Training Loss: 51.87828063964844
Test Loss:  56.963111877441406
Test Acc:  0.0
Valid Loss:  54.18141174316406
Valid Acc:  0.0
std:  414856.8600625936 
thres:  207.6443212425828
Preserved_eigens number check:  512
  3%|▎         | 29/1000 [10:12<4:41:29, 17.39s/it]Epoch:   30
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  507
Criterion check: 
Mean:  tensor(-1.7220, device='cuda:0') 
Std:  tensor(27.0699, device='cuda:0') 
ABS Max:  tensor(348.4396, device='cuda:0') 
ABS Min:  tensor(0.0015, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0001, 1.0000, 1.0000, 1.0000, 1.0002, 1.0012, 0.9993,
        0.9992], device='cuda:0') tensor(187, device='cuda:0')
max of Lambda2 tensor(394937.9375, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(3.2295, device='cuda:0')
min of grad d_p:  tensor(-4.3795, device='cuda:0')
max|min: (J_L, Jta/N)  (3.229546308517456, 3.2295444011688232, ratio: 0.9999994039535522)|(-4.379545211791992, -4.379546642303467)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.9073e-06, device='cuda:0') mean:  tensor(7.3541e-11, device='cuda:0') min:  tensor(-2.6226e-06, device='cuda:0') norm:  tensor(1.4483e-05, device='cuda:0') MSE:  tensor(1.8249e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0019, device='cuda:0') mean:  tensor(1.5239e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0343, device='cuda:0') MSE:  tensor(4.3161e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0398, device='cuda:0')
min of d_p_list:  tensor(-0.0378, device='cuda:0')
Epoch:  30  
Training Loss: 7.830234050750732
Test Loss:  8.113175392150879
Test Acc:  0.0
Valid Loss:  7.933774948120117
Valid Acc:  0.0
std:  414856.08437281696 
thres:  207.64587103143336
Preserved_eigens number check:  512
  3%|▎         | 30/1000 [10:30<4:45:42, 17.67s/it]Epoch:   31
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  508
Criterion check: 
Mean:  tensor(-0.6171, device='cuda:0') 
Std:  tensor(40.7830, device='cuda:0') 
ABS Max:  tensor(539.8046, device='cuda:0') 
ABS Min:  tensor(0.0086, device='cuda:0')
Criterion check:  tensor([0.9995, 1.0005, 1.0011, 1.0002, 1.0006, 0.9993, 0.9999, 1.0001, 1.0034,
        0.9989], device='cuda:0') tensor(203, device='cuda:0')
max of Lambda2 tensor(345805.7500, device='cuda:0')
min of Lambda2 tensor(2.5486e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.6313, device='cuda:0')
min of grad d_p:  tensor(-0.4070, device='cuda:0')
max|min: (J_L, Jta/N)  (0.631284236907959, 0.6312839984893799, ratio: 0.9999996423721313)|(-0.4070196747779846, -0.40701958537101746)

 check Jacobi res:  torch.Size([793601]) max:  tensor(7.7486e-07, device='cuda:0') mean:  tensor(8.5859e-12, device='cuda:0') min:  tensor(-5.0664e-07, device='cuda:0') norm:  tensor(8.1130e-06, device='cuda:0') MSE:  tensor(1.0223e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0037, device='cuda:0') mean:  tensor(1.9039e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0449, device='cuda:0') MSE:  tensor(5.6528e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1149, device='cuda:0')
min of d_p_list:  tensor(-0.1140, device='cuda:0')
Epoch:  31  
Training Loss: 2.610189437866211
Test Loss:  2.494537591934204
Test Acc:  0.0
Valid Loss:  2.4840011596679688
Valid Acc:  0.0
std:  414855.8535731993 
thres:  207.64633214902878
Preserved_eigens number check:  512
  3%|▎         | 31/1000 [10:48<4:45:36, 17.68s/it]Epoch:   32
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  508
Criterion check: 
Mean:  tensor(760.5054, device='cuda:0') 
Std:  tensor(17109.0078, device='cuda:0') 
ABS Max:  tensor(387130.0312, device='cuda:0') 
ABS Min:  tensor(0.0014, device='cuda:0')
Criterion check:  tensor([0.9997, 0.9999, 1.0004, 1.0006, 1.0001, 1.0052, 0.9960, 1.0008, 1.0009,
        1.0112], device='cuda:0') tensor(209, device='cuda:0')
max of Lambda2 tensor(318642., device='cuda:0')
min of Lambda2 tensor(1.5512e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.5040, device='cuda:0')
min of grad d_p:  tensor(-0.7257, device='cuda:0')
max|min: (J_L, Jta/N)  (0.5040467381477356, 0.5040463209152222, ratio: 0.9999991655349731)|(-0.7256580591201782, -0.7256577610969543)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.1723e-07, device='cuda:0') mean:  tensor(-3.6614e-11, device='cuda:0') min:  tensor(-6.4075e-07, device='cuda:0') norm:  tensor(5.2978e-06, device='cuda:0') MSE:  tensor(6.6756e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0145, device='cuda:0') mean:  tensor(5.9959e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1359, device='cuda:0') MSE:  tensor(1.7122e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0740, device='cuda:0')
min of d_p_list:  tensor(-0.0879, device='cuda:0')
Epoch:  32  
Training Loss: 1.8383920192718506
Test Loss:  1.775455117225647
Test Acc:  0.0
Valid Loss:  1.7829828262329102
Valid Acc:  0.0
std:  318.7405339712347 
thres:  0.17513732743263244
Preserved_eigens number check:  512
  3%|▎         | 32/1000 [11:06<4:48:22, 17.87s/it]Epoch:   33
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  508
Criterion check: 
Mean:  tensor(-12.7989, device='cuda:0') 
Std:  tensor(293.9227, device='cuda:0') 
ABS Max:  tensor(6631.7573, device='cuda:0') 
ABS Min:  tensor(0.0004, device='cuda:0')
Criterion check:  tensor([1.0001, 1.0001, 0.9998, 1.0012, 1.0001, 0.9998, 1.0002, 1.0001, 0.9998,
        0.9904], device='cuda:0') tensor(173, device='cuda:0')
max of Lambda2 tensor(353214.9688, device='cuda:0')
min of Lambda2 tensor(4.8163e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.5413, device='cuda:0')
min of grad d_p:  tensor(-0.5981, device='cuda:0')
max|min: (J_L, Jta/N)  (0.5413466095924377, 0.5413466691970825, ratio: 1.0000001192092896)|(-0.598055362701416, -0.5980552434921265)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.8743e-07, device='cuda:0') mean:  tensor(9.6321e-12, device='cuda:0') min:  tensor(-5.9605e-07, device='cuda:0') norm:  tensor(5.4448e-06, device='cuda:0') MSE:  tensor(6.8609e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0012, device='cuda:0') mean:  tensor(4.0090e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0096, device='cuda:0') MSE:  tensor(1.2043e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1585, device='cuda:0')
min of d_p_list:  tensor(-0.1915, device='cuda:0')
Epoch:  33  
Training Loss: 1.0683567523956299
Test Loss:  1.143110752105713
Test Acc:  0.0
Valid Loss:  1.110144019126892
Valid Acc:  0.0
std:  19.56083222403304 
thres:  0.013045090579986573
Preserved_eigens number check:  512
  3%|▎         | 33/1000 [11:24<4:48:07, 17.88s/it]Epoch:   34
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  504
Criterion check: 
Mean:  tensor(-6.0476, device='cuda:0') 
Std:  tensor(176.7773, device='cuda:0') 
ABS Max:  tensor(3915.8098, device='cuda:0') 
ABS Min:  tensor(0.0005, device='cuda:0')
Criterion check:  tensor([1.0000, 0.9986, 1.0000, 1.0000, 1.0000, 1.0005, 1.0000, 1.0008, 1.0002,
        0.9992], device='cuda:0') tensor(190, device='cuda:0')
max of Lambda2 tensor(126309.0703, device='cuda:0')
min of Lambda2 tensor(9.3304e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.2645, device='cuda:0')
min of grad d_p:  tensor(-0.6717, device='cuda:0')
max|min: (J_L, Jta/N)  (1.2645413875579834, 1.264540433883667, ratio: 0.9999992251396179)|(-0.6717467308044434, -0.6717471480369568)

 check Jacobi res:  torch.Size([793601]) max:  tensor(9.5367e-07, device='cuda:0') mean:  tensor(3.7912e-11, device='cuda:0') min:  tensor(-3.5763e-07, device='cuda:0') norm:  tensor(4.1081e-06, device='cuda:0') MSE:  tensor(5.1766e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0028, device='cuda:0') mean:  tensor(1.0746e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0241, device='cuda:0') MSE:  tensor(3.0349e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1408, device='cuda:0')
min of d_p_list:  tensor(-0.1546, device='cuda:0')
Epoch:  34  
Training Loss: 0.6588239669799805
Test Loss:  0.6962146759033203
Test Acc:  0.0
Valid Loss:  0.626921534538269
Valid Acc:  0.0
std:  2.6018143098166946 
thres:  0.0028011992454528806
Preserved_eigens number check:  512
  3%|▎         | 34/1000 [11:42<4:44:51, 17.69s/it]Epoch:   35
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  504
Criterion check: 
Mean:  tensor(-2.0491, device='cuda:0') 
Std:  tensor(56.7430, device='cuda:0') 
ABS Max:  tensor(1019.1819, device='cuda:0') 
ABS Min:  tensor(9.0093e-05, device='cuda:0')
Criterion check:  tensor([0.9999, 1.0000, 0.9999, 1.0000, 1.0000, 0.9998, 1.0005, 0.9986, 1.0034,
        0.9990], device='cuda:0') tensor(174, device='cuda:0')
max of Lambda2 tensor(106040.6016, device='cuda:0')
min of Lambda2 tensor(2.0720e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.7944, device='cuda:0')
min of grad d_p:  tensor(-0.8994, device='cuda:0')
max|min: (J_L, Jta/N)  (0.7943704724311829, 0.7943707704544067, ratio: 1.0000003576278687)|(-0.8994157910346985, -0.8994161486625671)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.6624e-07, device='cuda:0') mean:  tensor(-9.4046e-11, device='cuda:0') min:  tensor(-1.3113e-06, device='cuda:0') norm:  tensor(6.2733e-06, device='cuda:0') MSE:  tensor(7.9049e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0018, device='cuda:0') mean:  tensor(4.8947e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0111, device='cuda:0') MSE:  tensor(1.4049e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0717, device='cuda:0')
min of d_p_list:  tensor(-0.0602, device='cuda:0')
Epoch:  35  
Training Loss: 0.11374163627624512
Test Loss:  0.1028694361448288
Test Acc:  0.0
Valid Loss:  0.11171368509531021
Valid Acc:  0.0
std:  0.8797243665524277 
thres:  0.0012579007625579835
Preserved_eigens number check:  512
  4%|▎         | 35/1000 [12:00<4:45:55, 17.78s/it]Epoch:   36
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  504
Criterion check: 
Mean:  tensor(-1.1589, device='cuda:0') 
Std:  tensor(25.2670, device='cuda:0') 
ABS Max:  tensor(491.5096, device='cuda:0') 
ABS Min:  tensor(0.0001, device='cuda:0')
Criterion check:  tensor([0.9998, 1.0000, 1.0001, 1.0054, 1.0000, 0.9999, 1.0063, 0.9999, 0.8859,
        1.0045], device='cuda:0') tensor(172, device='cuda:0')
max of Lambda2 tensor(104445.1328, device='cuda:0')
min of Lambda2 tensor(2.9752e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1838, device='cuda:0')
min of grad d_p:  tensor(-0.1427, device='cuda:0')
max|min: (J_L, Jta/N)  (0.18383708596229553, 0.18383800983428955, ratio: 1.0000050067901611)|(-0.14273393154144287, -0.14273414015769958)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.8115e-07, device='cuda:0') mean:  tensor(-6.2663e-11, device='cuda:0') min:  tensor(-9.2387e-07, device='cuda:0') norm:  tensor(7.3813e-06, device='cuda:0') MSE:  tensor(9.3010e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0006, device='cuda:0') mean:  tensor(2.8810e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0065, device='cuda:0') MSE:  tensor(8.2191e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0396, device='cuda:0')
min of d_p_list:  tensor(-0.0673, device='cuda:0')
Epoch:  36  
Training Loss: 0.10587399452924728
Test Loss:  0.0957326591014862
Test Acc:  0.0
Valid Loss:  0.09517474472522736
Valid Acc:  0.0
std:  0.6501902260832598 
thres:  0.0007570376738905907
Preserved_eigens number check:  512
  4%|▎         | 36/1000 [12:17<4:42:35, 17.59s/it]Epoch:   37
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  505
Criterion check: 
Mean:  tensor(-1.5935, device='cuda:0') 
Std:  tensor(47.0936, device='cuda:0') 
ABS Max:  tensor(764.2053, device='cuda:0') 
ABS Min:  tensor(0.0009, device='cuda:0')
Criterion check:  tensor([0.9998, 0.9999, 0.9916, 1.0013, 0.9997, 1.0000, 1.0006, 0.9985, 0.9774,
        0.9972], device='cuda:0') tensor(180, device='cuda:0')
max of Lambda2 tensor(103691.4297, device='cuda:0')
min of Lambda2 tensor(1.0031e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1552, device='cuda:0')
min of grad d_p:  tensor(-0.0981, device='cuda:0')
max|min: (J_L, Jta/N)  (0.15524360537528992, 0.1552455574274063, ratio: 1.0000125169754028)|(-0.0981074720621109, -0.0981077328324318)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.7218e-07, device='cuda:0') mean:  tensor(-2.0367e-10, device='cuda:0') min:  tensor(-1.9521e-06, device='cuda:0') norm:  tensor(9.8850e-06, device='cuda:0') MSE:  tensor(1.2456e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0010, device='cuda:0') mean:  tensor(6.0960e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0142, device='cuda:0') MSE:  tensor(1.7936e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0597, device='cuda:0')
min of d_p_list:  tensor(-0.0719, device='cuda:0')
Epoch:  37  
Training Loss: 0.25924229621887207
Test Loss:  0.2367226481437683
Test Acc:  0.0
Valid Loss:  0.23807156085968018
Valid Acc:  0.0
std:  0.3724156008181556 
thres:  0.00044120772927999495
Preserved_eigens number check:  512
  4%|▎         | 37/1000 [12:34<4:40:57, 17.51s/it]Epoch:   38
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  504
Criterion check: 
Mean:  tensor(-10.1807, device='cuda:0') 
Std:  tensor(149.7734, device='cuda:0') 
ABS Max:  tensor(2572.8623, device='cuda:0') 
ABS Min:  tensor(0.0022, device='cuda:0')
Criterion check:  tensor([1.0008, 0.9998, 0.9998, 1.0003, 1.0000, 0.9999, 1.0000, 1.0015, 1.0005,
        1.0060], device='cuda:0') tensor(180, device='cuda:0')
max of Lambda2 tensor(104376.0938, device='cuda:0')
min of Lambda2 tensor(9.3571e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1154, device='cuda:0')
min of grad d_p:  tensor(-0.1347, device='cuda:0')
max|min: (J_L, Jta/N)  (0.11543141305446625, 0.11543156951665878, ratio: 1.000001311302185)|(-0.1346684992313385, -0.1346687376499176)

 check Jacobi res:  torch.Size([793601]) max:  tensor(9.9943e-07, device='cuda:0') mean:  tensor(1.0089e-10, device='cuda:0') min:  tensor(-2.7195e-07, device='cuda:0') norm:  tensor(4.6159e-06, device='cuda:0') MSE:  tensor(5.8163e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0010, device='cuda:0') mean:  tensor(6.8511e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0152, device='cuda:0') MSE:  tensor(1.9180e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0413, device='cuda:0')
min of d_p_list:  tensor(-0.0370, device='cuda:0')
Epoch:  38  
Training Loss: 0.28243985772132874
Test Loss:  0.2801559567451477
Test Acc:  0.0
Valid Loss:  0.2666456401348114
Valid Acc:  0.0
std:  0.2009105101487793 
thres:  0.00028402435034513476
Preserved_eigens number check:  512
  4%|▍         | 38/1000 [12:51<4:38:57, 17.40s/it]Epoch:   39
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  503
Criterion check: 
Mean:  tensor(-0.5370, device='cuda:0') 
Std:  tensor(24.9528, device='cuda:0') 
ABS Max:  tensor(474.6330, device='cuda:0') 
ABS Min:  tensor(3.3735e-05, device='cuda:0')
Criterion check:  tensor([0.9991, 1.0000, 1.0012, 1.0029, 0.9961, 1.0005, 0.9981, 1.0004, 0.9995,
        1.0086], device='cuda:0') tensor(191, device='cuda:0')
max of Lambda2 tensor(104779.1953, device='cuda:0')
min of Lambda2 tensor(1.0441e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0795, device='cuda:0')
min of grad d_p:  tensor(-0.0864, device='cuda:0')
max|min: (J_L, Jta/N)  (0.0795324444770813, 0.079532690346241, ratio: 1.0000030994415283)|(-0.08639543503522873, -0.08639557659626007)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.6822e-07, device='cuda:0') mean:  tensor(-3.8020e-11, device='cuda:0') min:  tensor(-4.6194e-07, device='cuda:0') norm:  tensor(3.7148e-06, device='cuda:0') MSE:  tensor(4.6809e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0007, device='cuda:0') mean:  tensor(5.8685e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0137, device='cuda:0') MSE:  tensor(1.7239e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0353, device='cuda:0')
min of d_p_list:  tensor(-0.0229, device='cuda:0')
Epoch:  39  
Training Loss: 0.1401105672121048
Test Loss:  0.1411648690700531
Test Acc:  0.0
Valid Loss:  0.13553489744663239
Valid Acc:  0.0
std:  0.07516498063260257 
thres:  0.0001802816703915596
Preserved_eigens number check:  512
  4%|▍         | 39/1000 [13:08<4:37:56, 17.35s/it]Epoch:   40
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  503
Criterion check: 
Mean:  tensor(2.4748, device='cuda:0') 
Std:  tensor(49.8742, device='cuda:0') 
ABS Max:  tensor(1105.7443, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([0.9988, 0.9996, 1.0020, 0.9979, 0.9957, 0.9987, 1.0001, 1.0055, 0.9993,
        0.9986], device='cuda:0') tensor(151, device='cuda:0')
max of Lambda2 tensor(104555.4219, device='cuda:0')
min of Lambda2 tensor(1.0002e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0314, device='cuda:0')
min of grad d_p:  tensor(-0.0211, device='cuda:0')
max|min: (J_L, Jta/N)  (0.03135993331670761, 0.03136054426431656, ratio: 1.0000194311141968)|(-0.02108195796608925, -0.02108202688395977)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.3376e-07, device='cuda:0') mean:  tensor(-4.4979e-11, device='cuda:0') min:  tensor(-6.1095e-07, device='cuda:0') norm:  tensor(2.9656e-06, device='cuda:0') MSE:  tensor(3.7369e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(2.2351e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0056, device='cuda:0') MSE:  tensor(7.1158e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0245, device='cuda:0')
min of d_p_list:  tensor(-0.0207, device='cuda:0')
Epoch:  40  
Training Loss: 0.08896256983280182
Test Loss:  0.09797749668359756
Test Acc:  0.0
Valid Loss:  0.0850444808602333
Valid Acc:  0.0
std:  0.08004707755755881 
thres:  0.00017532585710287093
Preserved_eigens number check:  512
  4%|▍         | 40/1000 [13:26<4:37:32, 17.35s/it]Epoch:   41
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  505
Criterion check: 
Mean:  tensor(-0.7281, device='cuda:0') 
Std:  tensor(14.5332, device='cuda:0') 
ABS Max:  tensor(311.0863, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([0.9992, 0.9991, 1.0001, 1.0005, 1.0000, 0.9996, 1.0002, 1.0017, 1.0000,
        0.9999], device='cuda:0') tensor(150, device='cuda:0')
max of Lambda2 tensor(104285.3984, device='cuda:0')
min of Lambda2 tensor(5.8620e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0273, device='cuda:0')
min of grad d_p:  tensor(-0.0256, device='cuda:0')
max|min: (J_L, Jta/N)  (0.027344906702637672, 0.027345335111021996, ratio: 1.0000156164169312)|(-0.025581639260053635, -0.025581900030374527)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.0175e-07, device='cuda:0') mean:  tensor(-1.4579e-10, device='cuda:0') min:  tensor(-1.2498e-06, device='cuda:0') norm:  tensor(5.4124e-06, device='cuda:0') MSE:  tensor(6.8201e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(1.4577e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0033, device='cuda:0') MSE:  tensor(4.1540e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0303, device='cuda:0')
min of d_p_list:  tensor(-0.0212, device='cuda:0')
Epoch:  41  
Training Loss: 0.02101959101855755
Test Loss:  0.02439306490123272
Test Acc:  0.0
Valid Loss:  0.0209367536008358
Valid Acc:  0.0
std:  0.09958361482335898 
thres:  0.00015835497640073298
Preserved_eigens number check:  512
  4%|▍         | 41/1000 [13:43<4:37:25, 17.36s/it]Epoch:   42
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  503
Criterion check: 
Mean:  tensor(1.2976, device='cuda:0') 
Std:  tensor(32.3654, device='cuda:0') 
ABS Max:  tensor(553.9351, device='cuda:0') 
ABS Min:  tensor(0.0014, device='cuda:0')
Criterion check:  tensor([1.0001, 1.0032, 1.0002, 0.9985, 1.0001, 0.9927, 0.9989, 0.9889, 1.0152,
        1.0343], device='cuda:0') tensor(165, device='cuda:0')
max of Lambda2 tensor(104274.5781, device='cuda:0')
min of Lambda2 tensor(1.0998e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0719, device='cuda:0')
min of grad d_p:  tensor(-0.0529, device='cuda:0')
max|min: (J_L, Jta/N)  (0.07194598019123077, 0.0719466507434845, ratio: 1.000009298324585)|(-0.052927449345588684, -0.05292760953307152)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.3889e-07, device='cuda:0') mean:  tensor(-7.2531e-11, device='cuda:0') min:  tensor(-8.6799e-07, device='cuda:0') norm:  tensor(5.1457e-06, device='cuda:0') MSE:  tensor(6.4840e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0057, device='cuda:0') mean:  tensor(8.5683e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0205, device='cuda:0') MSE:  tensor(2.5780e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0722, device='cuda:0')
min of d_p_list:  tensor(-0.1351, device='cuda:0')
Epoch:  42  
Training Loss: 0.20533841848373413
Test Loss:  0.21095719933509827
Test Acc:  0.0
Valid Loss:  0.1945236623287201
Valid Acc:  0.0
std:  0.09058978819860208 
thres:  0.0001475742008537054
Preserved_eigens number check:  512
  4%|▍         | 42/1000 [14:00<4:35:56, 17.28s/it]Epoch:   43
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  503
Criterion check: 
Mean:  tensor(0.2995, device='cuda:0') 
Std:  tensor(9.6172, device='cuda:0') 
ABS Max:  tensor(142.4141, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([1.0018, 1.0001, 0.9998, 0.9978, 1.0000, 1.0001, 0.9993, 1.0009, 1.0001,
        0.9958], device='cuda:0') tensor(155, device='cuda:0')
max of Lambda2 tensor(118446.2969, device='cuda:0')
min of Lambda2 tensor(1.7189e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1717, device='cuda:0')
min of grad d_p:  tensor(-0.4001, device='cuda:0')
max|min: (J_L, Jta/N)  (0.17172744870185852, 0.1717272698879242, ratio: 0.9999989867210388)|(-0.4000973105430603, -0.40009719133377075)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.1514e-07, device='cuda:0') mean:  tensor(-4.0616e-11, device='cuda:0') min:  tensor(-4.7684e-07, device='cuda:0') norm:  tensor(3.7843e-06, device='cuda:0') MSE:  tensor(4.7686e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(2.2265e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0051, device='cuda:0') MSE:  tensor(6.3688e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0593, device='cuda:0')
min of d_p_list:  tensor(-0.0363, device='cuda:0')
Epoch:  43  
Training Loss: 0.05968489497900009
Test Loss:  0.0545099601149559
Test Acc:  0.0
Valid Loss:  0.05976443365216255
Valid Acc:  0.0
std:  0.06425632829359715 
thres:  0.00010302320830523967
Preserved_eigens number check:  512
  4%|▍         | 43/1000 [14:18<4:35:39, 17.28s/it]Epoch:   44
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  502
Criterion check: 
Mean:  tensor(4.0797, device='cuda:0') 
Std:  tensor(151.9983, device='cuda:0') 
ABS Max:  tensor(2772.5283, device='cuda:0') 
ABS Min:  tensor(0.0013, device='cuda:0')
Criterion check:  tensor([0.9976, 1.0022, 0.9973, 0.9983, 0.9985, 1.0003, 0.9938, 0.9893, 0.9288,
        1.0868], device='cuda:0') tensor(226, device='cuda:0')
max of Lambda2 tensor(114227.8516, device='cuda:0')
min of Lambda2 tensor(1.3513e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1728, device='cuda:0')
min of grad d_p:  tensor(-0.0569, device='cuda:0')
max|min: (J_L, Jta/N)  (0.17281246185302734, 0.17281295359134674, ratio: 1.0000028610229492)|(-0.056873880326747894, -0.05687398836016655)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.8685e-07, device='cuda:0') mean:  tensor(-6.1126e-11, device='cuda:0') min:  tensor(-4.9174e-07, device='cuda:0') norm:  tensor(3.2922e-06, device='cuda:0') MSE:  tensor(4.1484e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0070, device='cuda:0') mean:  tensor(2.6397e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0602, device='cuda:0') MSE:  tensor(7.5912e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.7000, device='cuda:0')
min of d_p_list:  tensor(-0.6245, device='cuda:0')
Epoch:  44  
Training Loss: 9.444535255432129
Test Loss:  11.013349533081055
Test Acc:  0.0
Valid Loss:  10.326702117919922
Valid Acc:  0.0
std:  3.7408194951722367 
thres:  0.0019639081459492443
Preserved_eigens number check:  512
  4%|▍         | 44/1000 [14:35<4:36:06, 17.33s/it]Epoch:   45
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  503
Criterion check: 
Mean:  tensor(-1.3625, device='cuda:0') 
Std:  tensor(24.8367, device='cuda:0') 
ABS Max:  tensor(476.3192, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0000, 0.9999, 1.0000, 1.0000, 1.0000, 1.0002, 0.9997,
        1.0001], device='cuda:0') tensor(165, device='cuda:0')
max of Lambda2 tensor(107277.4766, device='cuda:0')
min of Lambda2 tensor(8.5716e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(2.6087, device='cuda:0')
min of grad d_p:  tensor(-2.2634, device='cuda:0')
max|min: (J_L, Jta/N)  (2.608731985092163, 2.6087310314178467, ratio: 0.9999996423721313)|(-2.26340389251709, -2.263404369354248)

 check Jacobi res:  torch.Size([793601]) max:  tensor(6.6161e-06, device='cuda:0') mean:  tensor(1.2027e-10, device='cuda:0') min:  tensor(-8.3447e-07, device='cuda:0') norm:  tensor(1.2112e-05, device='cuda:0') MSE:  tensor(1.5263e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0020, device='cuda:0') mean:  tensor(4.7485e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0115, device='cuda:0') MSE:  tensor(1.4516e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.3976, device='cuda:0')
min of d_p_list:  tensor(-0.4674, device='cuda:0')
Epoch:  45  
Training Loss: 1.471207618713379
Test Loss:  1.5691354274749756
Test Acc:  0.0
Valid Loss:  1.8512661457061768
Valid Acc:  0.0
std:  3.641809031193487 
thres:  0.0022403571557253602
Preserved_eigens number check:  512
  4%|▍         | 45/1000 [14:53<4:36:51, 17.39s/it]Epoch:   46
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  500
Criterion check: 
Mean:  tensor(0.2777, device='cuda:0') 
Std:  tensor(25.7492, device='cuda:0') 
ABS Max:  tensor(304.6022, device='cuda:0') 
ABS Min:  tensor(9.5047e-06, device='cuda:0')
Criterion check:  tensor([1.0001, 1.0000, 1.0001, 0.9999, 1.0000, 1.0001, 0.9991, 1.0003, 1.0036,
        1.0005], device='cuda:0') tensor(167, device='cuda:0')
max of Lambda2 tensor(106533.1250, device='cuda:0')
min of Lambda2 tensor(7.3709e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.1918, device='cuda:0')
min of grad d_p:  tensor(-1.5812, device='cuda:0')
max|min: (J_L, Jta/N)  (1.1918479204177856, 1.1918482780456543, ratio: 1.0000003576278687)|(-1.5812253952026367, -1.5812268257141113)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.4305e-06, device='cuda:0') mean:  tensor(8.8231e-11, device='cuda:0') min:  tensor(-7.3639e-07, device='cuda:0') norm:  tensor(5.8755e-06, device='cuda:0') MSE:  tensor(7.4036e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0027, device='cuda:0') mean:  tensor(1.0339e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0242, device='cuda:0') MSE:  tensor(3.0528e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.3609, device='cuda:0')
min of d_p_list:  tensor(-0.4413, device='cuda:0')
Epoch:  46  
Training Loss: 2.643787384033203
Test Loss:  2.901688575744629
Test Acc:  0.0
Valid Loss:  2.6897950172424316
Valid Acc:  0.0
std:  3.4691606951016567 
thres:  0.002764910714328289
Preserved_eigens number check:  512
  5%|▍         | 46/1000 [15:10<4:37:39, 17.46s/it]Epoch:   47
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  499
Criterion check: 
Mean:  tensor(4.0908, device='cuda:0') 
Std:  tensor(92.1859, device='cuda:0') 
ABS Max:  tensor(2084.0710, device='cuda:0') 
ABS Min:  tensor(0.0007, device='cuda:0')
Criterion check:  tensor([0.9999, 1.0000, 1.0000, 1.0000, 1.0001, 1.0000, 1.0000, 1.0001, 1.0021,
        0.9995], device='cuda:0') tensor(146, device='cuda:0')
max of Lambda2 tensor(108066.6641, device='cuda:0')
min of Lambda2 tensor(1.1142e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.8831, device='cuda:0')
min of grad d_p:  tensor(-1.8747, device='cuda:0')
max|min: (J_L, Jta/N)  (1.883087396621704, 1.883089542388916, ratio: 1.0000011920928955)|(-1.8746864795684814, -1.8746697902679443)

 check Jacobi res:  torch.Size([793601]) max:  tensor(7.1526e-07, device='cuda:0') mean:  tensor(-1.7914e-10, device='cuda:0') min:  tensor(-1.6689e-05, device='cuda:0') norm:  tensor(1.9811e-05, device='cuda:0') MSE:  tensor(2.4963e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0014, device='cuda:0') mean:  tensor(5.2911e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0121, device='cuda:0') MSE:  tensor(1.5199e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1265, device='cuda:0')
min of d_p_list:  tensor(-0.1232, device='cuda:0')
Epoch:  47  
Training Loss: 0.3609713613986969
Test Loss:  0.3201472759246826
Test Acc:  0.0
Valid Loss:  0.3599826693534851
Valid Acc:  0.0
std:  3.4466809946531334 
thres:  0.0027960373029112815
Preserved_eigens number check:  512
  5%|▍         | 47/1000 [15:28<4:37:39, 17.48s/it]Epoch:   48
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  498
Criterion check: 
Mean:  tensor(0.1347, device='cuda:0') 
Std:  tensor(21.2638, device='cuda:0') 
ABS Max:  tensor(277.8088, device='cuda:0') 
ABS Min:  tensor(0.0001, device='cuda:0')
Criterion check:  tensor([1.0004, 0.9999, 0.9997, 1.0000, 1.0000, 1.0001, 0.9997, 1.0006, 0.9973,
        1.0026], device='cuda:0') tensor(149, device='cuda:0')
max of Lambda2 tensor(107401.0781, device='cuda:0')
min of Lambda2 tensor(4.9974e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1968, device='cuda:0')
min of grad d_p:  tensor(-0.1076, device='cuda:0')
max|min: (J_L, Jta/N)  (0.19683998823165894, 0.19683919847011566, ratio: 0.9999960064888)|(-0.10755057632923126, -0.10755059868097305)

 check Jacobi res:  torch.Size([793601]) max:  tensor(7.8976e-07, device='cuda:0') mean:  tensor(9.1770e-11, device='cuda:0') min:  tensor(-2.7567e-07, device='cuda:0') norm:  tensor(3.5072e-06, device='cuda:0') MSE:  tensor(4.4193e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0018, device='cuda:0') mean:  tensor(4.0377e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0096, device='cuda:0') MSE:  tensor(1.2129e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.2002, device='cuda:0')
min of d_p_list:  tensor(-0.1389, device='cuda:0')
Epoch:  48  
Training Loss: 0.2328435629606247
Test Loss:  0.23626494407653809
Test Acc:  0.0
Valid Loss:  0.22009196877479553
Valid Acc:  0.0
std:  3.419777485678902 
thres:  0.0028306690365076065
Preserved_eigens number check:  512
  5%|▍         | 48/1000 [15:45<4:38:27, 17.55s/it]Epoch:   49
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  498
Criterion check: 
Mean:  tensor(1.3473, device='cuda:0') 
Std:  tensor(224.2290, device='cuda:0') 
ABS Max:  tensor(3857.0920, device='cuda:0') 
ABS Min:  tensor(0.0029, device='cuda:0')
Criterion check:  tensor([1.0002, 1.0013, 1.0009, 1.0001, 1.0187, 0.9946, 0.9987, 0.9994, 1.0117,
        1.1216], device='cuda:0') tensor(174, device='cuda:0')
max of Lambda2 tensor(107436.0391, device='cuda:0')
min of Lambda2 tensor(9.1453e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1252, device='cuda:0')
min of grad d_p:  tensor(-0.3006, device='cuda:0')
max|min: (J_L, Jta/N)  (0.1251901239156723, 0.12519021332263947, ratio: 1.0000007152557373)|(-0.30055806040763855, -0.3005588948726654)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.3447e-07, device='cuda:0') mean:  tensor(6.3610e-11, device='cuda:0') min:  tensor(-3.5763e-07, device='cuda:0') norm:  tensor(3.6652e-06, device='cuda:0') MSE:  tensor(4.6185e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0036, device='cuda:0') mean:  tensor(1.2217e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0294, device='cuda:0') MSE:  tensor(3.7106e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1591, device='cuda:0')
min of d_p_list:  tensor(-0.1530, device='cuda:0')
Epoch:  49  
Training Loss: 0.5808055400848389
Test Loss:  0.6550302505493164
Test Acc:  0.0
Valid Loss:  0.6758062839508057
Valid Acc:  0.0
std:  0.9033170822186614 
thres:  0.0010579230934381486
Preserved_eigens number check:  512
  5%|▍         | 49/1000 [16:03<4:37:31, 17.51s/it]Epoch:   50
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  496
Criterion check: 
Mean:  tensor(1.1076, device='cuda:0') 
Std:  tensor(19.5554, device='cuda:0') 
ABS Max:  tensor(375.2391, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([1.0016, 1.0013, 1.0005, 1.0001, 1.0000, 0.9997, 0.9999, 1.0009, 1.0001,
        0.9904], device='cuda:0') tensor(137, device='cuda:0')
max of Lambda2 tensor(107049.8516, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0840, device='cuda:0')
min of grad d_p:  tensor(-0.0820, device='cuda:0')
max|min: (J_L, Jta/N)  (0.08402998745441437, 0.08403002470731735, ratio: 1.0000004768371582)|(-0.08201439678668976, -0.08201413601636887)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.2294e-07, device='cuda:0') mean:  tensor(2.2798e-11, device='cuda:0') min:  tensor(-3.8370e-07, device='cuda:0') norm:  tensor(3.5508e-06, device='cuda:0') MSE:  tensor(4.4742e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0008, device='cuda:0') mean:  tensor(2.4680e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0059, device='cuda:0') MSE:  tensor(7.4570e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1452, device='cuda:0')
min of d_p_list:  tensor(-0.1002, device='cuda:0')
Epoch:  50  
Training Loss: 0.482975035905838
Test Loss:  0.5177709460258484
Test Acc:  0.0
Valid Loss:  0.526741087436676
Valid Acc:  0.0
std:  0.8993719139070211 
thres:  0.0008602765768766403
Preserved_eigens number check:  512
  5%|▌         | 50/1000 [16:20<4:35:17, 17.39s/it]Epoch:   51
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  498
Criterion check: 
Mean:  tensor(-0.7130, device='cuda:0') 
Std:  tensor(23.3093, device='cuda:0') 
ABS Max:  tensor(321.1584, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([1.0000, 0.9999, 0.9866, 1.0002, 0.9999, 1.0001, 0.9995, 0.9986, 0.9981,
        1.0077], device='cuda:0') tensor(135, device='cuda:0')
max of Lambda2 tensor(107119.7578, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2131, device='cuda:0')
min of grad d_p:  tensor(-0.0701, device='cuda:0')
max|min: (J_L, Jta/N)  (0.2130824327468872, 0.21308447420597076, ratio: 1.000009536743164)|(-0.07008000463247299, -0.07008043676614761)

 check Jacobi res:  torch.Size([793601]) max:  tensor(6.3330e-07, device='cuda:0') mean:  tensor(-1.9603e-10, device='cuda:0') min:  tensor(-2.0415e-06, device='cuda:0') norm:  tensor(7.8672e-06, device='cuda:0') MSE:  tensor(9.9133e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0016, device='cuda:0') mean:  tensor(3.9413e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0095, device='cuda:0') MSE:  tensor(1.1929e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1347, device='cuda:0')
min of d_p_list:  tensor(-0.1446, device='cuda:0')
Epoch:  51  
Training Loss: 0.35703665018081665
Test Loss:  0.36923322081565857
Test Acc:  0.0
Valid Loss:  0.3916574716567993
Valid Acc:  0.0
std:  0.11903196078832726 
thres:  0.00040292643010616304
Preserved_eigens number check:  512
  5%|▌         | 51/1000 [16:37<4:35:37, 17.43s/it]Epoch:   52
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  496
Criterion check: 
Mean:  tensor(1.7904, device='cuda:0') 
Std:  tensor(45.0061, device='cuda:0') 
ABS Max:  tensor(789.9144, device='cuda:0') 
ABS Min:  tensor(6.0865e-05, device='cuda:0')
Criterion check:  tensor([0.9999, 0.9982, 1.0001, 0.9928, 1.0001, 1.0000, 1.0006, 1.0196, 0.9997,
        1.0015], device='cuda:0') tensor(183, device='cuda:0')
max of Lambda2 tensor(106461.2500, device='cuda:0')
min of Lambda2 tensor(1.9094e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2468, device='cuda:0')
min of grad d_p:  tensor(-0.1322, device='cuda:0')
max|min: (J_L, Jta/N)  (0.2468089908361435, 0.24680882692337036, ratio: 0.9999993443489075)|(-0.1322287917137146, -0.1322287768125534)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.0862e-07, device='cuda:0') mean:  tensor(2.4598e-11, device='cuda:0') min:  tensor(-2.2352e-07, device='cuda:0') norm:  tensor(1.9019e-06, device='cuda:0') MSE:  tensor(2.3965e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0029, device='cuda:0') mean:  tensor(1.1064e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0257, device='cuda:0') MSE:  tensor(3.2354e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1358, device='cuda:0')
min of d_p_list:  tensor(-0.1624, device='cuda:0')
Epoch:  52  
Training Loss: 0.4128530025482178
Test Loss:  0.4215066134929657
Test Acc:  0.0
Valid Loss:  0.4034860134124756
Valid Acc:  0.0
std:  0.11716911415393991 
thres:  0.0004133027583360672
Preserved_eigens number check:  512
  5%|▌         | 52/1000 [16:55<4:36:05, 17.47s/it]Epoch:   53
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  498
Criterion check: 
Mean:  tensor(0.0960, device='cuda:0') 
Std:  tensor(3.5579, device='cuda:0') 
ABS Max:  tensor(36.5718, device='cuda:0') 
ABS Min:  tensor(5.4670e-05, device='cuda:0')
Criterion check:  tensor([0.9996, 0.9994, 1.0000, 0.9996, 1.0001, 1.0000, 0.9996, 0.9858, 1.0016,
        1.0016], device='cuda:0') tensor(126, device='cuda:0')
max of Lambda2 tensor(107090.0625, device='cuda:0')
min of Lambda2 tensor(1.0525e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0905, device='cuda:0')
min of grad d_p:  tensor(-0.1545, device='cuda:0')
max|min: (J_L, Jta/N)  (0.09046964347362518, 0.09046972543001175, ratio: 1.0000009536743164)|(-0.15449145436286926, -0.15449132025241852)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.1921e-07, device='cuda:0') mean:  tensor(8.0233e-12, device='cuda:0') min:  tensor(-1.7136e-07, device='cuda:0') norm:  tensor(1.3370e-06, device='cuda:0') MSE:  tensor(1.6848e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0006, device='cuda:0') mean:  tensor(2.3859e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0056, device='cuda:0') MSE:  tensor(6.9973e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0593, device='cuda:0')
min of d_p_list:  tensor(-0.0412, device='cuda:0')
Epoch:  53  
Training Loss: 0.1199389398097992
Test Loss:  0.10316397249698639
Test Acc:  0.0
Valid Loss:  0.11356979608535767
Valid Acc:  0.0
std:  0.154654663426028 
thres:  0.0003907218337059021
Preserved_eigens number check:  512
  5%|▌         | 53/1000 [17:13<4:36:36, 17.53s/it]Epoch:   54
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  497
Criterion check: 
Mean:  tensor(1.1730, device='cuda:0') 
Std:  tensor(42.9790, device='cuda:0') 
ABS Max:  tensor(939.1005, device='cuda:0') 
ABS Min:  tensor(7.3718e-05, device='cuda:0')
Criterion check:  tensor([0.9987, 1.0000, 1.0009, 0.9997, 0.9997, 1.0002, 0.9997, 1.0297, 0.9986,
        0.9804], device='cuda:0') tensor(131, device='cuda:0')
max of Lambda2 tensor(106856.0312, device='cuda:0')
min of Lambda2 tensor(8.5551e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0415, device='cuda:0')
min of grad d_p:  tensor(-0.0252, device='cuda:0')
max|min: (J_L, Jta/N)  (0.04145260900259018, 0.041452258825302124, ratio: 0.9999915361404419)|(-0.025228198617696762, -0.02522817999124527)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.5018e-07, device='cuda:0') mean:  tensor(3.8401e-11, device='cuda:0') min:  tensor(-1.9744e-07, device='cuda:0') norm:  tensor(2.4072e-06, device='cuda:0') MSE:  tensor(3.0332e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0006, device='cuda:0') mean:  tensor(1.6876e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0041, device='cuda:0') MSE:  tensor(5.1169e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0293, device='cuda:0')
min of d_p_list:  tensor(-0.0289, device='cuda:0')
Epoch:  54  
Training Loss: 0.05747709423303604
Test Loss:  0.04607980698347092
Test Acc:  0.0
Valid Loss:  0.05495047941803932
Valid Acc:  0.0
std:  0.16717418048558927 
thres:  0.0002860561445355415
Preserved_eigens number check:  512
  5%|▌         | 54/1000 [17:30<4:37:05, 17.57s/it]Epoch:   55
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  496
Criterion check: 
Mean:  tensor(0.3179, device='cuda:0') 
Std:  tensor(3.6712, device='cuda:0') 
ABS Max:  tensor(47.0365, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([0.9953, 0.9932, 1.0025, 0.9957, 1.0201, 1.0013, 0.9991, 0.9968, 1.0032,
        0.6699], device='cuda:0') tensor(130, device='cuda:0')
max of Lambda2 tensor(106849.2578, device='cuda:0')
min of Lambda2 tensor(1.8738e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0201, device='cuda:0')
min of grad d_p:  tensor(-0.0077, device='cuda:0')
max|min: (J_L, Jta/N)  (0.020118528977036476, 0.020119059830904007, ratio: 1.0000263452529907)|(-0.007680542767047882, -0.007680813781917095)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.7101e-07, device='cuda:0') mean:  tensor(-7.1999e-11, device='cuda:0') min:  tensor(-5.3085e-07, device='cuda:0') norm:  tensor(3.0061e-06, device='cuda:0') MSE:  tensor(3.7879e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(1.9575e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0046, device='cuda:0') MSE:  tensor(5.7429e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0491, device='cuda:0')
min of d_p_list:  tensor(-0.0352, device='cuda:0')
Epoch:  55  
Training Loss: 0.03206414729356766
Test Loss:  0.027313508093357086
Test Acc:  0.0
Valid Loss:  0.0310070738196373
Valid Acc:  0.0
std:  0.15799164034579846 
thres:  0.00019587396681308746
Preserved_eigens number check:  512
  6%|▌         | 55/1000 [17:48<4:35:22, 17.48s/it]Epoch:   56
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  497
Criterion check: 
Mean:  tensor(0.0330, device='cuda:0') 
Std:  tensor(6.0939, device='cuda:0') 
ABS Max:  tensor(101.9495, device='cuda:0') 
ABS Min:  tensor(5.5106e-05, device='cuda:0')
Criterion check:  tensor([0.9996, 1.0000, 0.9997, 0.9995, 1.0002, 1.0016, 0.9971, 1.0319, 0.9855,
        0.9962], device='cuda:0') tensor(122, device='cuda:0')
max of Lambda2 tensor(106776.4141, device='cuda:0')
min of Lambda2 tensor(6.6132e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0312, device='cuda:0')
min of grad d_p:  tensor(-0.0297, device='cuda:0')
max|min: (J_L, Jta/N)  (0.031206898391246796, 0.031207408756017685, ratio: 1.0000163316726685)|(-0.029722923412919044, -0.02972310781478882)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.0326e-07, device='cuda:0') mean:  tensor(-7.1402e-11, device='cuda:0') min:  tensor(-5.2620e-07, device='cuda:0') norm:  tensor(3.0287e-06, device='cuda:0') MSE:  tensor(3.8164e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0006, device='cuda:0') mean:  tensor(1.6419e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0039, device='cuda:0') MSE:  tensor(4.8979e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.4065, device='cuda:0')
min of d_p_list:  tensor(-0.2762, device='cuda:0')
Epoch:  56  
Training Loss: 1.1336829662322998
Test Loss:  1.0317497253417969
Test Acc:  0.0
Valid Loss:  1.117645025253296
Valid Acc:  0.0
std:  0.41416982046737544 
thres:  0.0003512032300233841
Preserved_eigens number check:  512
  6%|▌         | 56/1000 [18:05<4:34:43, 17.46s/it]Epoch:   57
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  496
Criterion check: 
Mean:  tensor(-2.7011, device='cuda:0') 
Std:  tensor(68.0619, device='cuda:0') 
ABS Max:  tensor(1430.8285, device='cuda:0') 
ABS Min:  tensor(0.0019, device='cuda:0')
Criterion check:  tensor([1.0001, 1.0001, 1.0000, 1.0037, 0.9999, 1.0000, 1.0001, 0.9987, 1.0020,
        0.9997], device='cuda:0') tensor(164, device='cuda:0')
max of Lambda2 tensor(106372.8984, device='cuda:0')
min of Lambda2 tensor(2.8910e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.2454, device='cuda:0')
min of grad d_p:  tensor(-0.8445, device='cuda:0')
max|min: (J_L, Jta/N)  (1.2453659772872925, 1.2453655004501343, ratio: 0.9999996423721313)|(-0.8445085287094116, -0.8445090651512146)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.3644e-07, device='cuda:0') mean:  tensor(-3.8224e-11, device='cuda:0') min:  tensor(-6.8545e-07, device='cuda:0') norm:  tensor(4.5341e-06, device='cuda:0') MSE:  tensor(5.7134e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0021, device='cuda:0') mean:  tensor(8.3063e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0191, device='cuda:0') MSE:  tensor(2.4101e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(3.9504, device='cuda:0')
min of d_p_list:  tensor(-3.0746, device='cuda:0')
Epoch:  57  
Training Loss: 101.38493347167969
Test Loss:  109.87836456298828
Test Acc:  0.0
Valid Loss:  91.71920013427734
Valid Acc:  0.0
std:  40.42176721074253 
thres:  0.020545619323849677
Preserved_eigens number check:  512
  6%|▌         | 57/1000 [18:23<4:36:19, 17.58s/it]Epoch:   58
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  498
Criterion check: 
Mean:  tensor(0.5638, device='cuda:0') 
Std:  tensor(15.7486, device='cuda:0') 
ABS Max:  tensor(272.6019, device='cuda:0') 
ABS Min:  tensor(0.0004, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0000, 1.0000, 0.9999, 1.0001, 0.9996, 0.9985, 1.0000,
        0.9923], device='cuda:0') tensor(146, device='cuda:0')
max of Lambda2 tensor(151069.1250, device='cuda:0')
min of Lambda2 tensor(6.9294e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(14.6063, device='cuda:0')
min of grad d_p:  tensor(-7.0078, device='cuda:0')
max|min: (J_L, Jta/N)  (14.606328964233398, 14.606329917907715, ratio: 1.0000001192092896)|(-7.007765769958496, -7.0077667236328125)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.3379e-06, device='cuda:0') mean:  tensor(-4.5493e-11, device='cuda:0') min:  tensor(-3.8147e-06, device='cuda:0') norm:  tensor(2.3716e-05, device='cuda:0') MSE:  tensor(2.9884e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0085, device='cuda:0') mean:  tensor(2.2993e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0589, device='cuda:0') MSE:  tensor(7.4257e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1447, device='cuda:0')
min of d_p_list:  tensor(-0.2193, device='cuda:0')
Epoch:  58  
Training Loss: 17.12955093383789
Test Loss:  18.21631622314453
Test Acc:  0.0
Valid Loss:  17.06671142578125
Valid Acc:  0.0
std:  39.25860936470906 
thres:  0.023947541722655296
Preserved_eigens number check:  512
  6%|▌         | 58/1000 [18:40<4:34:41, 17.50s/it]Epoch:   59
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  498
Criterion check: 
Mean:  tensor(0.0951, device='cuda:0') 
Std:  tensor(11.7772, device='cuda:0') 
ABS Max:  tensor(191.5019, device='cuda:0') 
ABS Min:  tensor(0.0006, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0002, 0.9767, 0.9984, 0.9986, 0.9995,
        1.0179], device='cuda:0') tensor(146, device='cuda:0')
max of Lambda2 tensor(150767.8906, device='cuda:0')
min of Lambda2 tensor(2.9696e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.6055, device='cuda:0')
min of grad d_p:  tensor(-0.8772, device='cuda:0')
max|min: (J_L, Jta/N)  (1.605535864830017, 1.605535626411438, ratio: 0.9999998807907104)|(-0.8771587610244751, -0.8771587610244751)

 check Jacobi res:  torch.Size([793601]) max:  tensor(9.5367e-07, device='cuda:0') mean:  tensor(1.2069e-10, device='cuda:0') min:  tensor(-6.5565e-07, device='cuda:0') norm:  tensor(5.8969e-06, device='cuda:0') MSE:  tensor(7.4306e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0018, device='cuda:0') mean:  tensor(6.0384e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0154, device='cuda:0') MSE:  tensor(1.9461e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0999, device='cuda:0')
min of d_p_list:  tensor(-0.1088, device='cuda:0')
Epoch:  59  
Training Loss: 5.51201057434082
Test Loss:  5.954109191894531
Test Acc:  0.0
Valid Loss:  5.962510108947754
Valid Acc:  0.0
std:  38.65067989033898 
thres:  0.025038448418676855
Preserved_eigens number check:  512
  6%|▌         | 59/1000 [18:57<4:32:57, 17.40s/it]Epoch:   60
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  499
Criterion check: 
Mean:  tensor(-7.6744, device='cuda:0') 
Std:  tensor(148.0940, device='cuda:0') 
ABS Max:  tensor(2888.4126, device='cuda:0') 
ABS Min:  tensor(1.4100e-05, device='cuda:0')
Criterion check:  tensor([0.9996, 0.9992, 1.0009, 0.9995, 0.9994, 0.9945, 0.9987, 0.9970, 1.0013,
        0.9826], device='cuda:0') tensor(179, device='cuda:0')
max of Lambda2 tensor(150604.3438, device='cuda:0')
min of Lambda2 tensor(5.6730e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1454, device='cuda:0')
min of grad d_p:  tensor(-0.2709, device='cuda:0')
max|min: (J_L, Jta/N)  (0.1453503966331482, 0.1453503668308258, ratio: 0.9999998211860657)|(-0.2709430456161499, -0.2709430754184723)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.0862e-07, device='cuda:0') mean:  tensor(-4.6569e-11, device='cuda:0') min:  tensor(-4.5821e-07, device='cuda:0') norm:  tensor(2.4124e-06, device='cuda:0') MSE:  tensor(3.0398e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0080, device='cuda:0') mean:  tensor(2.2019e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0571, device='cuda:0') MSE:  tensor(7.2004e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0902, device='cuda:0')
min of d_p_list:  tensor(-0.1282, device='cuda:0')
Epoch:  60  
Training Loss: 2.0521910190582275
Test Loss:  2.2026519775390625
Test Acc:  0.0
Valid Loss:  2.211669921875
Valid Acc:  0.0
std:  38.39689537534278 
thres:  0.025442473793029784
Preserved_eigens number check:  512
  6%|▌         | 60/1000 [19:15<4:32:35, 17.40s/it]Epoch:   61
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  498
Criterion check: 
Mean:  tensor(35.1725, device='cuda:0') 
Std:  tensor(921.6264, device='cuda:0') 
ABS Max:  tensor(20534.8828, device='cuda:0') 
ABS Min:  tensor(0.0019, device='cuda:0')
Criterion check:  tensor([0.9927, 1.0834, 0.9967, 1.0033, 1.2168, 2.1963, 2.1099, 1.1520, 0.6376,
        0.7919], device='cuda:0') tensor(209, device='cuda:0')
max of Lambda2 tensor(150729.0781, device='cuda:0')
min of Lambda2 tensor(2.8518e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0455, device='cuda:0')
min of grad d_p:  tensor(-0.0824, device='cuda:0')
max|min: (J_L, Jta/N)  (0.0455467514693737, 0.04554658755660057, ratio: 0.9999964237213135)|(-0.08235035836696625, -0.08234982937574387)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.4587e-07, device='cuda:0') mean:  tensor(-6.1673e-11, device='cuda:0') min:  tensor(-5.4389e-07, device='cuda:0') norm:  tensor(3.3511e-06, device='cuda:0') MSE:  tensor(4.2226e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0636, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.3268, device='cuda:0') MSE:  tensor(4.1180e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.3614, device='cuda:0')
min of d_p_list:  tensor(-0.3544, device='cuda:0')
Epoch:  61  
Training Loss: 2.1678380966186523
Test Loss:  2.3712449073791504
Test Acc:  0.0
Valid Loss:  2.1801819801330566
Valid Acc:  0.0
std:  38.26796397065833 
thres:  0.025649304819107054
Preserved_eigens number check:  512
  6%|▌         | 61/1000 [19:33<4:34:34, 17.54s/it]Epoch:   62
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  496
Criterion check: 
Mean:  tensor(-15.2719, device='cuda:0') 
Std:  tensor(375.9544, device='cuda:0') 
ABS Max:  tensor(5446.7305, device='cuda:0') 
ABS Min:  tensor(0.0026, device='cuda:0')
Criterion check:  tensor([1.0043, 1.0009, 1.0014, 1.0013, 1.0004, 1.0085, 0.0870, 1.2343, 0.3010,
        0.7758], device='cuda:0') tensor(214, device='cuda:0')
max of Lambda2 tensor(150819.7188, device='cuda:0')
min of Lambda2 tensor(9.7018e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.1441, device='cuda:0')
min of grad d_p:  tensor(-0.7613, device='cuda:0')
max|min: (J_L, Jta/N)  (1.1440752744674683, 1.1440750360488892, ratio: 0.9999998211860657)|(-0.7613009214401245, -0.7613011002540588)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.7684e-07, device='cuda:0') mean:  tensor(5.3705e-11, device='cuda:0') min:  tensor(-1.7881e-07, device='cuda:0') norm:  tensor(2.8947e-06, device='cuda:0') MSE:  tensor(3.6476e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0480, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.3281, device='cuda:0') MSE:  tensor(4.1349e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0980, device='cuda:0')
min of d_p_list:  tensor(-0.0811, device='cuda:0')
Epoch:  62  
Training Loss: 0.7051783204078674
Test Loss:  0.764307975769043
Test Acc:  0.0
Valid Loss:  0.7453796863555908
Valid Acc:  0.0
std:  6.020410487944117 
thres:  0.005513353788852692
Preserved_eigens number check:  512
  6%|▌         | 62/1000 [19:50<4:32:30, 17.43s/it]Epoch:   63
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  496
Criterion check: 
Mean:  tensor(4.8428, device='cuda:0') 
Std:  tensor(83.6459, device='cuda:0') 
ABS Max:  tensor(1704.3754, device='cuda:0') 
ABS Min:  tensor(0.0004, device='cuda:0')
Criterion check:  tensor([1.0018, 0.9998, 0.9998, 0.9941, 1.0014, 1.0000, 0.9949, 1.0168, 1.0343,
        0.9513], device='cuda:0') tensor(116, device='cuda:0')
max of Lambda2 tensor(150482.7656, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1226, device='cuda:0')
min of grad d_p:  tensor(-0.0996, device='cuda:0')
max|min: (J_L, Jta/N)  (0.12259560823440552, 0.12259529531002045, ratio: 0.9999974370002747)|(-0.09956792742013931, -0.0995674654841423)

 check Jacobi res:  torch.Size([793601]) max:  tensor(9.4622e-07, device='cuda:0') mean:  tensor(-1.1426e-10, device='cuda:0') min:  tensor(-1.8850e-06, device='cuda:0') norm:  tensor(9.9328e-06, device='cuda:0') MSE:  tensor(1.2516e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0016, device='cuda:0') mean:  tensor(4.1252e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0114, device='cuda:0') MSE:  tensor(1.4397e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1573, device='cuda:0')
min of d_p_list:  tensor(-0.1709, device='cuda:0')
Epoch:  63  
Training Loss: 0.3637300729751587
Test Loss:  0.38562092185020447
Test Acc:  0.0
Valid Loss:  0.3961946368217468
Valid Acc:  0.0
std:  1.821579023429709 
thres:  0.002160189616680145
Preserved_eigens number check:  512
  6%|▋         | 63/1000 [20:07<4:32:51, 17.47s/it]Epoch:   64
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  494
Criterion check: 
Mean:  tensor(1.1515, device='cuda:0') 
Std:  tensor(17.6012, device='cuda:0') 
ABS Max:  tensor(312.4373, device='cuda:0') 
ABS Min:  tensor(0.0001, device='cuda:0')
Criterion check:  tensor([1.0005, 1.0001, 1.0014, 1.0010, 1.0002, 0.9948, 1.0069, 1.0240, 1.0004,
        0.9655], device='cuda:0') tensor(130, device='cuda:0')
max of Lambda2 tensor(150554.9375, device='cuda:0')
min of Lambda2 tensor(1.8634e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1628, device='cuda:0')
min of grad d_p:  tensor(-0.1043, device='cuda:0')
max|min: (J_L, Jta/N)  (0.16283248364925385, 0.1628323197364807, ratio: 0.9999989867210388)|(-0.1042913943529129, -0.10429111123085022)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.8801e-07, device='cuda:0') mean:  tensor(-4.4724e-11, device='cuda:0') min:  tensor(-9.6112e-07, device='cuda:0') norm:  tensor(5.1851e-06, device='cuda:0') MSE:  tensor(6.5337e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0039, device='cuda:0') mean:  tensor(6.7657e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0193, device='cuda:0') MSE:  tensor(2.4271e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.2026, device='cuda:0')
min of d_p_list:  tensor(-0.1777, device='cuda:0')
Epoch:  64  
Training Loss: 0.5074160099029541
Test Loss:  0.541663646697998
Test Acc:  0.0
Valid Loss:  0.5191826224327087
Valid Acc:  0.0
std:  0.7846673441862368 
thres:  0.001159270703792572
Preserved_eigens number check:  512
  6%|▋         | 64/1000 [20:25<4:32:52, 17.49s/it]Epoch:   65
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  496
Criterion check: 
Mean:  tensor(0.5419, device='cuda:0') 
Std:  tensor(17.0979, device='cuda:0') 
ABS Max:  tensor(229.7365, device='cuda:0') 
ABS Min:  tensor(6.6653e-05, device='cuda:0')
Criterion check:  tensor([1.0013, 1.0007, 1.0006, 1.0007, 0.9973, 1.0011, 0.9964, 1.0042, 1.1619,
        1.5611], device='cuda:0') tensor(144, device='cuda:0')
max of Lambda2 tensor(150541.8125, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.4671, device='cuda:0')
min of grad d_p:  tensor(-0.2984, device='cuda:0')
max|min: (J_L, Jta/N)  (0.46708759665489197, 0.46708783507347107, ratio: 1.0000004768371582)|(-0.2984426021575928, -0.29844236373901367)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.4901e-07, device='cuda:0') mean:  tensor(-1.5660e-11, device='cuda:0') min:  tensor(-2.6822e-07, device='cuda:0') norm:  tensor(1.7272e-06, device='cuda:0') MSE:  tensor(2.1765e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0057, device='cuda:0') mean:  tensor(1.5685e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0436, device='cuda:0') MSE:  tensor(5.4934e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1305, device='cuda:0')
min of d_p_list:  tensor(-0.0891, device='cuda:0')
Epoch:  65  
Training Loss: 0.1889255940914154
Test Loss:  0.19266414642333984
Test Acc:  0.0
Valid Loss:  0.20802758634090424
Valid Acc:  0.0
std:  0.7111153969494532 
thres:  0.0007866176187992096
Preserved_eigens number check:  512
  6%|▋         | 65/1000 [20:43<4:33:55, 17.58s/it]Epoch:   66
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  493
Criterion check: 
Mean:  tensor(0.2412, device='cuda:0') 
Std:  tensor(6.2168, device='cuda:0') 
ABS Max:  tensor(132.9906, device='cuda:0') 
ABS Min:  tensor(1.2998e-05, device='cuda:0')
Criterion check:  tensor([1.0003, 1.0003, 1.0004, 1.0000, 0.9990, 0.9991, 1.0041, 0.9943, 0.9909,
        0.9756], device='cuda:0') tensor(91, device='cuda:0')
max of Lambda2 tensor(150454.3594, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1818, device='cuda:0')
min of grad d_p:  tensor(-0.1246, device='cuda:0')
max|min: (J_L, Jta/N)  (0.18180474638938904, 0.18180491030216217, ratio: 1.0000009536743164)|(-0.12459002435207367, -0.12459011375904083)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.8626e-07, device='cuda:0') mean:  tensor(1.5797e-12, device='cuda:0') min:  tensor(-1.6391e-07, device='cuda:0') norm:  tensor(1.0906e-06, device='cuda:0') MSE:  tensor(1.3742e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0010, device='cuda:0') mean:  tensor(2.7378e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0081, device='cuda:0') MSE:  tensor(1.0170e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1033, device='cuda:0')
min of d_p_list:  tensor(-0.1235, device='cuda:0')
Epoch:  66  
Training Loss: 0.05491362512111664
Test Loss:  0.05158553645014763
Test Acc:  0.0
Valid Loss:  0.053550951182842255
Valid Acc:  0.0
std:  0.22941503893989404 
thres:  0.0003640327244997025
Preserved_eigens number check:  512
  7%|▋         | 66/1000 [21:00<4:32:26, 17.50s/it]Epoch:   67
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  497
Criterion check: 
Mean:  tensor(0.1843, device='cuda:0') 
Std:  tensor(8.1056, device='cuda:0') 
ABS Max:  tensor(85.0667, device='cuda:0') 
ABS Min:  tensor(3.2307e-05, device='cuda:0')
Criterion check:  tensor([0.9970, 1.0030, 1.0105, 1.0009, 1.0011, 1.0113, 1.0128, 0.9238, 0.9876,
        0.9653], device='cuda:0') tensor(120, device='cuda:0')
max of Lambda2 tensor(150504.0781, device='cuda:0')
min of Lambda2 tensor(2.9698e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0374, device='cuda:0')
min of grad d_p:  tensor(-0.0353, device='cuda:0')
max|min: (J_L, Jta/N)  (0.037445828318595886, 0.03744596242904663, ratio: 1.0000035762786865)|(-0.03532179072499275, -0.035321466624736786)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.7625e-07, device='cuda:0') mean:  tensor(-8.9683e-11, device='cuda:0') min:  tensor(-9.1270e-07, device='cuda:0') norm:  tensor(4.8472e-06, device='cuda:0') MSE:  tensor(6.1079e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0036, device='cuda:0') mean:  tensor(8.1788e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0240, device='cuda:0') MSE:  tensor(3.0286e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1149, device='cuda:0')
min of d_p_list:  tensor(-0.0963, device='cuda:0')
Epoch:  67  
Training Loss: 0.018767256289720535
Test Loss:  0.01707901433110237
Test Acc:  0.0
Valid Loss:  0.017177937552332878
Valid Acc:  0.0
std:  0.1853387151142066 
thres:  0.00022675051167607308
Preserved_eigens number check:  512
  7%|▋         | 67/1000 [21:17<4:31:49, 17.48s/it]Epoch:   68
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  496
Criterion check: 
Mean:  tensor(1.0375, device='cuda:0') 
Std:  tensor(40.2164, device='cuda:0') 
ABS Max:  tensor(670.2301, device='cuda:0') 
ABS Min:  tensor(0.0004, device='cuda:0')
Criterion check:  tensor([ 1.0109,  0.9979,  0.9991,  1.0127,  0.9969,  1.0016,  1.0406,  0.9364,
         1.4461, 24.7172], device='cuda:0') tensor(146, device='cuda:0')
max of Lambda2 tensor(150429.8125, device='cuda:0')
min of Lambda2 tensor(2.1015e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0745, device='cuda:0')
min of grad d_p:  tensor(-0.0625, device='cuda:0')
max|min: (J_L, Jta/N)  (0.0744609385728836, 0.07446154206991196, ratio: 1.0000081062316895)|(-0.062477439641952515, -0.06247733533382416)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.2410e-07, device='cuda:0') mean:  tensor(-4.1037e-11, device='cuda:0') min:  tensor(-9.4622e-07, device='cuda:0') norm:  tensor(4.4716e-06, device='cuda:0') MSE:  tensor(5.6345e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0044, device='cuda:0') mean:  tensor(1.1050e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0328, device='cuda:0') MSE:  tensor(4.1278e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.3365, device='cuda:0')
min of d_p_list:  tensor(-0.2226, device='cuda:0')
Epoch:  68  
Training Loss: 0.03740775212645531
Test Loss:  0.03961741551756859
Test Acc:  0.0
Valid Loss:  0.03206789866089821
Valid Acc:  0.0
std:  0.1830531210137007 
thres:  0.00016148604750633238
Preserved_eigens number check:  512
  7%|▋         | 68/1000 [21:35<4:32:17, 17.53s/it]Epoch:   69
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  493
Criterion check: 
Mean:  tensor(-431.3784, device='cuda:0') 
Std:  tensor(7318.9863, device='cuda:0') 
ABS Max:  tensor(112743.6484, device='cuda:0') 
ABS Min:  tensor(0.1021, device='cuda:0')
Criterion check:  tensor([ 1.0063e+00,  9.8912e-01,  9.9052e-01,  9.7556e-01,  1.2441e+00,
         7.7496e-01,  1.3876e+00,  2.8765e-01,  3.8306e+00, -4.4200e+02],
       device='cuda:0') tensor(239, device='cuda:0')
max of Lambda2 tensor(150557.3906, device='cuda:0')
min of Lambda2 tensor(1.2734e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.5476, device='cuda:0')
min of grad d_p:  tensor(-0.1686, device='cuda:0')
max|min: (J_L, Jta/N)  (0.5475704669952393, 0.5475706458091736, ratio: 1.0000003576278687)|(-0.16862653195858002, -0.1686265766620636)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.7881e-07, device='cuda:0') mean:  tensor(-1.3385e-11, device='cuda:0') min:  tensor(-2.6822e-07, device='cuda:0') norm:  tensor(1.7183e-06, device='cuda:0') MSE:  tensor(2.1651e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.8633, device='cuda:0') mean:  tensor(0.0012, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(3.3411, device='cuda:0') MSE:  tensor(4.2101e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.2502, device='cuda:0')
min of d_p_list:  tensor(-0.1804, device='cuda:0')
Epoch:  69  
Training Loss: 0.03039347007870674
Test Loss:  0.02387154847383499
Test Acc:  0.0
Valid Loss:  0.032764170318841934
Valid Acc:  0.0
std:  0.06252975265759102 
thres:  6.608153954148292e-05
Preserved_eigens number check:  512
  7%|▋         | 69/1000 [21:52<4:29:51, 17.39s/it]Epoch:   70
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  496
Criterion check: 
Mean:  tensor(0.1596, device='cuda:0') 
Std:  tensor(12.5717, device='cuda:0') 
ABS Max:  tensor(175.5704, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([1.0002, 1.0001, 0.9999, 1.0010, 1.0009, 0.9978, 0.9944, 0.9858, 1.0076,
        0.9804], device='cuda:0') tensor(118, device='cuda:0')
max of Lambda2 tensor(151214.8438, device='cuda:0')
min of Lambda2 tensor(4.0288e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.4317, device='cuda:0')
min of grad d_p:  tensor(-0.3061, device='cuda:0')
max|min: (J_L, Jta/N)  (0.43172502517700195, 0.4317275285720825, ratio: 1.000005841255188)|(-0.30610084533691406, -0.306100994348526)

 check Jacobi res:  torch.Size([793601]) max:  tensor(9.1642e-07, device='cuda:0') mean:  tensor(-2.7327e-10, device='cuda:0') min:  tensor(-2.5034e-06, device='cuda:0') norm:  tensor(1.1839e-05, device='cuda:0') MSE:  tensor(1.4917e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0037, device='cuda:0') mean:  tensor(7.6441e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0217, device='cuda:0') MSE:  tensor(2.7344e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.7865, device='cuda:0')
min of d_p_list:  tensor(-0.5892, device='cuda:0')
Epoch:  70  
Training Loss: 0.9065631628036499
Test Loss:  0.9423044919967651
Test Acc:  0.0
Valid Loss:  0.8464924097061157
Valid Acc:  0.0
std:  0.3486740056656924 
thres:  0.00020960905328392982
Preserved_eigens number check:  512
  7%|▋         | 70/1000 [22:09<4:29:19, 17.38s/it]Epoch:   71
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  492
Criterion check: 
Mean:  tensor(-1.1314, device='cuda:0') 
Std:  tensor(21.8693, device='cuda:0') 
ABS Max:  tensor(369.8618, device='cuda:0') 
ABS Min:  tensor(5.4581e-05, device='cuda:0')
Criterion check:  tensor([0.9998, 1.0000, 1.0000, 0.9995, 1.0004, 0.9998, 0.9972, 1.0016, 0.4618,
        0.9973], device='cuda:0') tensor(128, device='cuda:0')
max of Lambda2 tensor(152770.0312, device='cuda:0')
min of Lambda2 tensor(4.6723e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(2.0527, device='cuda:0')
min of grad d_p:  tensor(-1.7805, device='cuda:0')
max|min: (J_L, Jta/N)  (2.0526833534240723, 2.0526840686798096, ratio: 1.0000003576278687)|(-1.7804820537567139, -1.7804815769195557)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.9605e-07, device='cuda:0') mean:  tensor(-1.8135e-10, device='cuda:0') min:  tensor(-1.4901e-06, device='cuda:0') norm:  tensor(8.8632e-06, device='cuda:0') MSE:  tensor(1.1168e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0030, device='cuda:0') mean:  tensor(7.5507e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0210, device='cuda:0') MSE:  tensor(2.6508e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1022, device='cuda:0')
min of d_p_list:  tensor(-0.1065, device='cuda:0')
Epoch:  71  
Training Loss: 0.32885992527008057
Test Loss:  0.35929253697395325
Test Acc:  0.0
Valid Loss:  0.33140304684638977
Valid Acc:  0.0
std:  0.3415109342427315 
thres:  0.0002643983133137226
Preserved_eigens number check:  512
  7%|▋         | 71/1000 [22:27<4:30:29, 17.47s/it]Epoch:   72
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  494
Criterion check: 
Mean:  tensor(-2.2194, device='cuda:0') 
Std:  tensor(28.7938, device='cuda:0') 
ABS Max:  tensor(461.7789, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([1.0177, 1.0006, 0.9966, 0.9973, 1.0020, 1.0031, 0.9856, 1.0154, 0.9662,
        1.0484], device='cuda:0') tensor(123, device='cuda:0')
max of Lambda2 tensor(152661.9062, device='cuda:0')
min of Lambda2 tensor(5.7061e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2100, device='cuda:0')
min of grad d_p:  tensor(-0.1646, device='cuda:0')
max|min: (J_L, Jta/N)  (0.21000972390174866, 0.21000869572162628, ratio: 0.9999951124191284)|(-0.16463488340377808, -0.16463537514209747)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.2573e-06, device='cuda:0') mean:  tensor(1.4746e-10, device='cuda:0') min:  tensor(-4.6194e-07, device='cuda:0') norm:  tensor(7.0316e-06, device='cuda:0') MSE:  tensor(8.8604e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0033, device='cuda:0') mean:  tensor(7.9761e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0219, device='cuda:0') MSE:  tensor(2.7549e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.2515, device='cuda:0')
min of d_p_list:  tensor(-0.3813, device='cuda:0')
Epoch:  72  
Training Loss: 0.09284452348947525
Test Loss:  0.09488075971603394
Test Acc:  0.0
Valid Loss:  0.08528479933738708
Valid Acc:  0.0
std:  0.3320081894658302 
thres:  0.00027921376675367357
Preserved_eigens number check:  512
  7%|▋         | 72/1000 [22:45<4:29:32, 17.43s/it]Epoch:   73
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  495
Criterion check: 
Mean:  tensor(-0.4315, device='cuda:0') 
Std:  tensor(10.4691, device='cuda:0') 
ABS Max:  tensor(203.0420, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([1.0172, 0.9998, 0.9996, 1.0000, 1.0055, 1.1047, 1.0056, 1.0092, 0.8737,
        1.0143], device='cuda:0') tensor(108, device='cuda:0')
max of Lambda2 tensor(153951.6094, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2212, device='cuda:0')
min of grad d_p:  tensor(-0.1785, device='cuda:0')
max|min: (J_L, Jta/N)  (0.2212274968624115, 0.2212274819612503, ratio: 0.9999999403953552)|(-0.17853304743766785, -0.17853309214115143)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.2352e-07, device='cuda:0') mean:  tensor(1.8169e-11, device='cuda:0') min:  tensor(-1.5274e-07, device='cuda:0') norm:  tensor(1.4119e-06, device='cuda:0') MSE:  tensor(1.7791e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0019, device='cuda:0') mean:  tensor(5.0455e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0140, device='cuda:0') MSE:  tensor(1.7588e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.3852, device='cuda:0')
min of d_p_list:  tensor(-0.4811, device='cuda:0')
Epoch:  73  
Training Loss: 0.08377453684806824
Test Loss:  0.08764903992414474
Test Acc:  0.0
Valid Loss:  0.07370099425315857
Valid Acc:  0.0
std:  0.32571262103056636 
thres:  0.0002884871236979961
Preserved_eigens number check:  512
  7%|▋         | 73/1000 [23:02<4:29:22, 17.44s/it]Epoch:   74
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  492
Criterion check: 
Mean:  tensor(1.9281, device='cuda:0') 
Std:  tensor(98.0018, device='cuda:0') 
ABS Max:  tensor(1432.2153, device='cuda:0') 
ABS Min:  tensor(0.0020, device='cuda:0')
Criterion check:  tensor([1.0667, 0.9261, 0.9976, 0.9995, 1.0070, 1.0537, 1.0714, 1.0248, 1.1345,
        0.7643], device='cuda:0') tensor(179, device='cuda:0')
max of Lambda2 tensor(154177.5938, device='cuda:0')
min of Lambda2 tensor(1.5342e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2480, device='cuda:0')
min of grad d_p:  tensor(-0.1755, device='cuda:0')
max|min: (J_L, Jta/N)  (0.2479979395866394, 0.24799804389476776, ratio: 1.0000004768371582)|(-0.17553488910198212, -0.17553502321243286)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.7625e-07, device='cuda:0') mean:  tensor(-1.1315e-10, device='cuda:0') min:  tensor(-1.2368e-06, device='cuda:0') norm:  tensor(6.0472e-06, device='cuda:0') MSE:  tensor(7.6200e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0140, device='cuda:0') mean:  tensor(3.1622e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0954, device='cuda:0') MSE:  tensor(1.2015e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.7247, device='cuda:0')
min of d_p_list:  tensor(-0.7580, device='cuda:0')
Epoch:  74  
Training Loss: 1.391336441040039
Test Loss:  1.3384246826171875
Test Acc:  0.0
Valid Loss:  1.3313982486724854
Valid Acc:  0.0
std:  0.5117957964216688 
thres:  0.0005606757178902626
Preserved_eigens number check:  512
  7%|▋         | 74/1000 [23:20<4:29:33, 17.47s/it]Epoch:   75
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  492
Criterion check: 
Mean:  tensor(-0.7863, device='cuda:0') 
Std:  tensor(10.1431, device='cuda:0') 
ABS Max:  tensor(150.8207, device='cuda:0') 
ABS Min:  tensor(0.0001, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 0.9999, 1.0000, 0.9997, 0.9999, 1.0007, 1.0197, 1.0066,
        0.9945], device='cuda:0') tensor(104, device='cuda:0')
max of Lambda2 tensor(156670.6406, device='cuda:0')
min of Lambda2 tensor(3.5793e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.7802, device='cuda:0')
min of grad d_p:  tensor(-1.1136, device='cuda:0')
max|min: (J_L, Jta/N)  (0.7801826596260071, 0.7801821231842041, ratio: 0.9999992847442627)|(-1.1135865449905396, -1.11358642578125)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.3644e-07, device='cuda:0') mean:  tensor(-3.8713e-11, device='cuda:0') min:  tensor(-4.7684e-07, device='cuda:0') norm:  tensor(2.9216e-06, device='cuda:0') MSE:  tensor(3.6814e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0024, device='cuda:0') mean:  tensor(5.3147e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0161, device='cuda:0') MSE:  tensor(2.0242e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.2521, device='cuda:0')
min of d_p_list:  tensor(-0.1787, device='cuda:0')
Epoch:  75  
Training Loss: 0.24720756709575653
Test Loss:  0.254442036151886
Test Acc:  0.0
Valid Loss:  0.24319569766521454
Valid Acc:  0.0
std:  0.4901732107877796 
thres:  0.00042880459874868396
Preserved_eigens number check:  512
  8%|▊         | 75/1000 [23:37<4:31:32, 17.61s/it]Epoch:   76
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  490
Criterion check: 
Mean:  tensor(-1.3246, device='cuda:0') 
Std:  tensor(20.4169, device='cuda:0') 
ABS Max:  tensor(302.0353, device='cuda:0') 
ABS Min:  tensor(0.0001, device='cuda:0')
Criterion check:  tensor([1.0335, 1.0040, 0.9988, 0.9985, 1.0021, 0.8960, 0.9950, 1.0208, 1.0998,
        1.5632], device='cuda:0') tensor(108, device='cuda:0')
max of Lambda2 tensor(156812.5469, device='cuda:0')
min of Lambda2 tensor(7.2880e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0915, device='cuda:0')
min of grad d_p:  tensor(-0.0674, device='cuda:0')
max|min: (J_L, Jta/N)  (0.0915430560708046, 0.09154350310564041, ratio: 1.0000048875808716)|(-0.06742531061172485, -0.06742475181818008)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.8685e-07, device='cuda:0') mean:  tensor(-5.2390e-11, device='cuda:0') min:  tensor(-5.9232e-07, device='cuda:0') norm:  tensor(3.6193e-06, device='cuda:0') MSE:  tensor(4.5606e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0034, device='cuda:0') mean:  tensor(8.3283e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0249, device='cuda:0') MSE:  tensor(3.1313e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.4751, device='cuda:0')
min of d_p_list:  tensor(-0.9085, device='cuda:0')
Epoch:  76  
Training Loss: 0.27028992772102356
Test Loss:  0.2958598732948303
Test Acc:  0.0
Valid Loss:  0.26304304599761963
Valid Acc:  0.0
std:  0.4931127167538246 
thres:  0.00041709059923887256
Preserved_eigens number check:  512
  8%|▊         | 76/1000 [23:55<4:31:06, 17.60s/it]Epoch:   77
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  492
Criterion check: 
Mean:  tensor(-1.5847, device='cuda:0') 
Std:  tensor(25.7686, device='cuda:0') 
ABS Max:  tensor(519.1127, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([0.9989, 1.0001, 1.0006, 0.9997, 1.0629, 1.0072, 1.0250, 0.9779, 1.0036,
        1.0281], device='cuda:0') tensor(123, device='cuda:0')
max of Lambda2 tensor(158927.3906, device='cuda:0')
min of Lambda2 tensor(3.0074e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.9273, device='cuda:0')
min of grad d_p:  tensor(-1.0122, device='cuda:0')
max|min: (J_L, Jta/N)  (0.9272682070732117, 0.92726731300354, ratio: 0.9999990463256836)|(-1.0122179985046387, -1.0122190713882446)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.2219e-06, device='cuda:0') mean:  tensor(1.2700e-10, device='cuda:0') min:  tensor(-6.2585e-07, device='cuda:0') norm:  tensor(7.1074e-06, device='cuda:0') MSE:  tensor(8.9559e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0094, device='cuda:0') mean:  tensor(1.3136e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0396, device='cuda:0') MSE:  tensor(4.9891e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.2500, device='cuda:0')
min of d_p_list:  tensor(-0.2166, device='cuda:0')
Epoch:  77  
Training Loss: 0.15691958367824554
Test Loss:  0.1610318422317505
Test Acc:  0.0
Valid Loss:  0.17108222842216492
Valid Acc:  0.0
std:  0.485290237724398 
thres:  0.0004299056112766266
Preserved_eigens number check:  512
  8%|▊         | 77/1000 [24:13<4:30:52, 17.61s/it]Epoch:   78
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  495
Criterion check: 
Mean:  tensor(-4.0073, device='cuda:0') 
Std:  tensor(94.0571, device='cuda:0') 
ABS Max:  tensor(1826.1398, device='cuda:0') 
ABS Min:  tensor(0.0001, device='cuda:0')
Criterion check:  tensor([0.9969, 0.9946, 0.9953, 0.9995, 0.9991, 1.0170, 1.0163, 0.9785, 1.6121,
        1.0921], device='cuda:0') tensor(114, device='cuda:0')
max of Lambda2 tensor(158856.5938, device='cuda:0')
min of Lambda2 tensor(5.1478e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1123, device='cuda:0')
min of grad d_p:  tensor(-0.0512, device='cuda:0')
max|min: (J_L, Jta/N)  (0.11227000504732132, 0.1122697964310646, ratio: 0.999998152256012)|(-0.0511605404317379, -0.05116067826747894)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.5472e-07, device='cuda:0') mean:  tensor(1.6913e-11, device='cuda:0') min:  tensor(-3.1944e-07, device='cuda:0') norm:  tensor(3.4393e-06, device='cuda:0') MSE:  tensor(4.3338e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0062, device='cuda:0') mean:  tensor(1.2896e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0374, device='cuda:0') MSE:  tensor(4.7151e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0604, device='cuda:0')
min of d_p_list:  tensor(-0.0986, device='cuda:0')
Epoch:  78  
Training Loss: 0.0661967396736145
Test Loss:  0.07215913385152817
Test Acc:  0.0
Valid Loss:  0.07659351080656052
Valid Acc:  0.0
std:  0.4878419213146776 
thres:  0.00042639005184173584
Preserved_eigens number check:  512
  8%|▊         | 78/1000 [24:30<4:28:29, 17.47s/it]Epoch:   79
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  491
Criterion check: 
Mean:  tensor(-0.2802, device='cuda:0') 
Std:  tensor(472.0516, device='cuda:0') 
ABS Max:  tensor(7854.2505, device='cuda:0') 
ABS Min:  tensor(0.0011, device='cuda:0')
Criterion check:  tensor([  0.9995,   1.0229,   0.9869,   1.0537,   0.8968,   1.7663,   3.1724,
          3.3232, -17.5799,  -1.4160], device='cuda:0') tensor(151, device='cuda:0')
max of Lambda2 tensor(159022.2344, device='cuda:0')
min of Lambda2 tensor(4.1973e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0191, device='cuda:0')
min of grad d_p:  tensor(-0.0455, device='cuda:0')
max|min: (J_L, Jta/N)  (0.019054237753152847, 0.019054288044571877, ratio: 1.0000026226043701)|(-0.04552287608385086, -0.045524198561906815)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.4137e-06, device='cuda:0') mean:  tensor(1.7537e-10, device='cuda:0') min:  tensor(-6.0070e-07, device='cuda:0') norm:  tensor(7.9422e-06, device='cuda:0') MSE:  tensor(1.0008e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0139, device='cuda:0') mean:  tensor(3.0048e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0925, device='cuda:0') MSE:  tensor(1.1651e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.3265, device='cuda:0')
min of d_p_list:  tensor(-0.3165, device='cuda:0')
Epoch:  79  
Training Loss: 0.14424000680446625
Test Loss:  0.16959406435489655
Test Acc:  0.0
Valid Loss:  0.1341833919286728
Valid Acc:  0.0
std:  0.07400798820540173 
thres:  0.0001769707649946213
Preserved_eigens number check:  512
  8%|▊         | 79/1000 [24:47<4:28:35, 17.50s/it]Epoch:   80
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  491
Criterion check: 
Mean:  tensor(-4.1297, device='cuda:0') 
Std:  tensor(65.7620, device='cuda:0') 
ABS Max:  tensor(1343.7828, device='cuda:0') 
ABS Min:  tensor(6.2506e-05, device='cuda:0')
Criterion check:  tensor([0.9976, 1.0004, 0.9983, 1.0001, 1.0016, 1.0081, 0.9881, 0.9275, 1.0162,
        1.0868], device='cuda:0') tensor(128, device='cuda:0')
max of Lambda2 tensor(159051.0469, device='cuda:0')
min of Lambda2 tensor(1.8725e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.4757, device='cuda:0')
min of grad d_p:  tensor(-0.3738, device='cuda:0')
max|min: (J_L, Jta/N)  (0.4757007956504822, 0.4757010340690613, ratio: 1.0000004768371582)|(-0.3738079071044922, -0.373807817697525)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.8312e-07, device='cuda:0') mean:  tensor(-7.6551e-11, device='cuda:0') min:  tensor(-6.8545e-07, device='cuda:0') norm:  tensor(3.7751e-06, device='cuda:0') MSE:  tensor(4.7569e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0042, device='cuda:0') mean:  tensor(9.1550e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0274, device='cuda:0') MSE:  tensor(3.4534e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(1.0312, device='cuda:0')
min of d_p_list:  tensor(-1.0736, device='cuda:0')
Epoch:  80  
Training Loss: 1.1376060247421265
Test Loss:  1.1756117343902588
Test Acc:  0.0
Valid Loss:  1.152715802192688
Valid Acc:  0.0
std:  0.396663818066637 
thres:  0.0003550504565238953
Preserved_eigens number check:  512
  8%|▊         | 80/1000 [25:05<4:28:35, 17.52s/it]Epoch:   81
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  495
Criterion check: 
Mean:  tensor(0.5464, device='cuda:0') 
Std:  tensor(18.5134, device='cuda:0') 
ABS Max:  tensor(353.5246, device='cuda:0') 
ABS Min:  tensor(0.0006, device='cuda:0')
Criterion check:  tensor([1.0001, 1.0001, 1.0002, 1.0011, 1.0001, 0.9943, 1.0006, 0.9999, 1.0054,
        0.9275], device='cuda:0') tensor(121, device='cuda:0')
max of Lambda2 tensor(165987.2812, device='cuda:0')
min of Lambda2 tensor(4.4390e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.1717, device='cuda:0')
min of grad d_p:  tensor(-2.4293, device='cuda:0')
max|min: (J_L, Jta/N)  (1.1717320680618286, 1.1717321872711182, ratio: 1.0000001192092896)|(-2.429300308227539, -2.429300308227539)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.1921e-06, device='cuda:0') mean:  tensor(4.7745e-11, device='cuda:0') min:  tensor(-8.3447e-07, device='cuda:0') norm:  tensor(5.8242e-06, device='cuda:0') MSE:  tensor(7.3390e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0034, device='cuda:0') mean:  tensor(8.2270e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0213, device='cuda:0') MSE:  tensor(2.6827e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(3.3989, device='cuda:0')
min of d_p_list:  tensor(-3.7299, device='cuda:0')
Epoch:  81  
Training Loss: 13.91395378112793
Test Loss:  14.115129470825195
Test Acc:  0.0
Valid Loss:  14.770641326904297
Valid Acc:  0.0
std:  5.429428575321328 
thres:  0.0030837832272052764
Preserved_eigens number check:  512
  8%|▊         | 81/1000 [25:23<4:28:58, 17.56s/it]Epoch:   82
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  494
Criterion check: 
Mean:  tensor(0.6707, device='cuda:0') 
Std:  tensor(14.5264, device='cuda:0') 
ABS Max:  tensor(289.7860, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0001, 0.9998, 1.0161, 0.9991, 0.9944,
        0.9645], device='cuda:0') tensor(141, device='cuda:0')
max of Lambda2 tensor(204052.8281, device='cuda:0')
min of Lambda2 tensor(5.6206e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(3.6042, device='cuda:0')
min of grad d_p:  tensor(-9.7792, device='cuda:0')
max|min: (J_L, Jta/N)  (3.6041641235351562, 3.6041624546051025, ratio: 0.9999995231628418)|(-9.77919864654541, -9.779199600219727)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.2452e-06, device='cuda:0') mean:  tensor(2.2067e-10, device='cuda:0') min:  tensor(-1.6689e-06, device='cuda:0') norm:  tensor(1.6288e-05, device='cuda:0') MSE:  tensor(2.0524e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0157, device='cuda:0') mean:  tensor(3.6643e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1014, device='cuda:0') MSE:  tensor(1.2783e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.2255, device='cuda:0')
min of d_p_list:  tensor(-0.1929, device='cuda:0')
Epoch:  82  
Training Loss: 4.176056861877441
Test Loss:  4.44791316986084
Test Acc:  0.0
Valid Loss:  4.82640266418457
Valid Acc:  0.0
std:  5.230474381651754 
thres:  0.0038876106828451156
Preserved_eigens number check:  512
  8%|▊         | 82/1000 [25:40<4:26:47, 17.44s/it]Epoch:   83
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  497
Criterion check: 
Mean:  tensor(-0.4049, device='cuda:0') 
Std:  tensor(5.2536, device='cuda:0') 
ABS Max:  tensor(97.6787, device='cuda:0') 
ABS Min:  tensor(6.1042e-05, device='cuda:0')
Criterion check:  tensor([1.0001, 1.0000, 1.0000, 0.9999, 0.9999, 0.9998, 0.9926, 1.0024, 0.9791,
        0.9909], device='cuda:0') tensor(82, device='cuda:0')
max of Lambda2 tensor(203461., device='cuda:0')
min of Lambda2 tensor(3.7774e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.5049, device='cuda:0')
min of grad d_p:  tensor(-0.7088, device='cuda:0')
max|min: (J_L, Jta/N)  (0.5049387216567993, 0.5049389600753784, ratio: 1.0000004768371582)|(-0.7088270783424377, -0.708825945854187)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.9605e-07, device='cuda:0') mean:  tensor(-1.8320e-10, device='cuda:0') min:  tensor(-1.7285e-06, device='cuda:0') norm:  tensor(8.8744e-06, device='cuda:0') MSE:  tensor(1.1183e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0017, device='cuda:0') mean:  tensor(3.9339e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0110, device='cuda:0') MSE:  tensor(1.3890e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0946, device='cuda:0')
min of d_p_list:  tensor(-0.1339, device='cuda:0')
Epoch:  83  
Training Loss: 1.6259793043136597
Test Loss:  1.714375376701355
Test Acc:  0.0
Valid Loss:  1.8633500337600708
Valid Acc:  0.0
std:  5.036159229473946 
thres:  0.004199567195773125
Preserved_eigens number check:  512
  8%|▊         | 83/1000 [25:57<4:26:44, 17.45s/it]Epoch:   84
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  496
Criterion check: 
Mean:  tensor(-0.0937, device='cuda:0') 
Std:  tensor(10.4078, device='cuda:0') 
ABS Max:  tensor(110.6380, device='cuda:0') 
ABS Min:  tensor(0.0004, device='cuda:0')
Criterion check:  tensor([0.9843, 0.9990, 1.0023, 1.0114, 1.0537, 1.0111, 1.0646, 1.0855, 0.9625,
        1.5238], device='cuda:0') tensor(118, device='cuda:0')
max of Lambda2 tensor(203468.8125, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1197, device='cuda:0')
min of grad d_p:  tensor(-0.0342, device='cuda:0')
max|min: (J_L, Jta/N)  (0.11965537071228027, 0.11965777724981308, ratio: 1.000020146369934)|(-0.03417438268661499, -0.034174684435129166)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.0140e-06, device='cuda:0') mean:  tensor(-2.8774e-10, device='cuda:0') min:  tensor(-2.4065e-06, device='cuda:0') norm:  tensor(1.4710e-05, device='cuda:0') MSE:  tensor(1.8536e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0066, device='cuda:0') mean:  tensor(1.2237e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0366, device='cuda:0') MSE:  tensor(4.6155e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.2228, device='cuda:0')
min of d_p_list:  tensor(-0.1619, device='cuda:0')
Epoch:  84  
Training Loss: 0.8232153654098511
Test Loss:  0.8515774011611938
Test Acc:  0.0
Valid Loss:  0.9239737391471863
Valid Acc:  0.0
std:  4.933079575445106 
thres:  0.004335362267494202
Preserved_eigens number check:  512
  8%|▊         | 84/1000 [26:14<4:25:21, 17.38s/it]Epoch:   85
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  495
Criterion check: 
Mean:  tensor(-0.0084, device='cuda:0') 
Std:  tensor(20.9594, device='cuda:0') 
ABS Max:  tensor(366.6500, device='cuda:0') 
ABS Min:  tensor(0.0008, device='cuda:0')
Criterion check:  tensor([0.8740, 1.0001, 1.0035, 0.9972, 0.9970, 1.0075, 1.1559, 0.9515, 0.9724,
        2.2625], device='cuda:0') tensor(116, device='cuda:0')
max of Lambda2 tensor(203463.2500, device='cuda:0')
min of Lambda2 tensor(3.5577e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1864, device='cuda:0')
min of grad d_p:  tensor(-0.1994, device='cuda:0')
max|min: (J_L, Jta/N)  (0.18643228709697723, 0.18643216788768768, ratio: 0.9999993443489075)|(-0.19941523671150208, -0.1994159072637558)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.5682e-07, device='cuda:0') mean:  tensor(9.3669e-11, device='cuda:0') min:  tensor(-3.4086e-07, device='cuda:0') norm:  tensor(5.0272e-06, device='cuda:0') MSE:  tensor(6.3347e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0087, device='cuda:0') mean:  tensor(1.5785e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0455, device='cuda:0') MSE:  tensor(5.7321e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.2888, device='cuda:0')
min of d_p_list:  tensor(-0.1936, device='cuda:0')
Epoch:  85  
Training Loss: 0.24088600277900696
Test Loss:  0.28163278102874756
Test Acc:  0.0
Valid Loss:  0.29494819045066833
Valid Acc:  0.0
std:  5.060724059323263 
thres:  0.004156018263101578
Preserved_eigens number check:  512
  8%|▊         | 85/1000 [26:32<4:25:26, 17.41s/it]Epoch:   86
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  500
Criterion check: 
Mean:  tensor(6.3616, device='cuda:0') 
Std:  tensor(353.4826, device='cuda:0') 
ABS Max:  tensor(5676.4248, device='cuda:0') 
ABS Min:  tensor(5.0482e-05, device='cuda:0')
Criterion check:  tensor([ 0.9184,  0.9928,  0.9477,  0.9933,  0.9289,  1.0882,  0.7495,  3.7146,
         2.7102, -7.5088], device='cuda:0') tensor(239, device='cuda:0')
max of Lambda2 tensor(203775.1406, device='cuda:0')
min of Lambda2 tensor(1.4769e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3921, device='cuda:0')
min of grad d_p:  tensor(-0.5001, device='cuda:0')
max|min: (J_L, Jta/N)  (0.3921075463294983, 0.3921080529689789, ratio: 1.000001311302185)|(-0.5000724792480469, -0.5000712275505066)

 check Jacobi res:  torch.Size([793601]) max:  tensor(7.7486e-07, device='cuda:0') mean:  tensor(-2.0252e-10, device='cuda:0') min:  tensor(-1.7975e-06, device='cuda:0') norm:  tensor(1.0503e-05, device='cuda:0') MSE:  tensor(1.3235e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.1264, device='cuda:0') mean:  tensor(0.0002, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.6632, device='cuda:0') MSE:  tensor(8.3569e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.6705, device='cuda:0')
min of d_p_list:  tensor(-0.3467, device='cuda:0')
Epoch:  86  
Training Loss: 2.088031768798828
Test Loss:  2.2161221504211426
Test Acc:  0.0
Valid Loss:  2.2760674953460693
Valid Acc:  0.0
std:  1.3522881572643475 
thres:  0.0017908338606357575
Preserved_eigens number check:  512
  9%|▊         | 86/1000 [26:49<4:25:01, 17.40s/it]Epoch:   87
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  497
Criterion check: 
Mean:  tensor(0.3380, device='cuda:0') 
Std:  tensor(7.1489, device='cuda:0') 
ABS Max:  tensor(110.6284, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 0.9999, 1.0004, 1.0000, 0.9982, 1.0028, 0.9886, 1.0304,
        1.0262], device='cuda:0') tensor(95, device='cuda:0')
max of Lambda2 tensor(204358.8750, device='cuda:0')
min of Lambda2 tensor(4.3070e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.5641, device='cuda:0')
min of grad d_p:  tensor(-0.3965, device='cuda:0')
max|min: (J_L, Jta/N)  (1.5641214847564697, 1.5641202926635742, ratio: 0.9999992251396179)|(-0.3965115249156952, -0.39651161432266235)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.1921e-06, device='cuda:0') mean:  tensor(9.6615e-11, device='cuda:0') min:  tensor(-3.8743e-07, device='cuda:0') norm:  tensor(4.8705e-06, device='cuda:0') MSE:  tensor(6.1372e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0037, device='cuda:0') mean:  tensor(5.8765e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0174, device='cuda:0') MSE:  tensor(2.1888e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.2712, device='cuda:0')
min of d_p_list:  tensor(-0.1843, device='cuda:0')
Epoch:  87  
Training Loss: 0.5381080508232117
Test Loss:  0.5869649648666382
Test Acc:  0.0
Valid Loss:  0.5925533771514893
Valid Acc:  0.0
std:  0.6894222479634611 
thres:  0.0010632440984249115
Preserved_eigens number check:  512
  9%|▊         | 87/1000 [27:07<4:24:15, 17.37s/it]Epoch:   88
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  495
Criterion check: 
Mean:  tensor(1.9416, device='cuda:0') 
Std:  tensor(85.2625, device='cuda:0') 
ABS Max:  tensor(1824.1268, device='cuda:0') 
ABS Min:  tensor(1.1799e-05, device='cuda:0')
Criterion check:  tensor([ 1.0015,  1.0006,  0.9984,  1.0060,  0.9987,  0.9991,  1.0461,  0.9586,
        -1.5451,  0.8118], device='cuda:0') tensor(131, device='cuda:0')
max of Lambda2 tensor(204532.9062, device='cuda:0')
min of Lambda2 tensor(8.3725e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1044, device='cuda:0')
min of grad d_p:  tensor(-0.2083, device='cuda:0')
max|min: (J_L, Jta/N)  (0.10440628975629807, 0.10440655052661896, ratio: 1.0000025033950806)|(-0.20829522609710693, -0.208295077085495)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.9791e-07, device='cuda:0') mean:  tensor(2.8817e-11, device='cuda:0') min:  tensor(-2.9802e-07, device='cuda:0') norm:  tensor(3.4785e-06, device='cuda:0') MSE:  tensor(4.3832e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0051, device='cuda:0') mean:  tensor(1.3187e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0393, device='cuda:0') MSE:  tensor(4.9497e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0684, device='cuda:0')
min of d_p_list:  tensor(-0.0713, device='cuda:0')
Epoch:  88  
Training Loss: 0.26101958751678467
Test Loss:  0.28133535385131836
Test Acc:  0.0
Valid Loss:  0.26487860083580017
Valid Acc:  0.0
std:  0.6827569740682917 
thres:  0.0007902521550655364
Preserved_eigens number check:  512
  9%|▉         | 88/1000 [27:25<4:27:16, 17.58s/it]Epoch:   89
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  494
Criterion check: 
Mean:  tensor(-0.8529, device='cuda:0') 
Std:  tensor(66.2822, device='cuda:0') 
ABS Max:  tensor(1300.7600, device='cuda:0') 
ABS Min:  tensor(0.0005, device='cuda:0')
Criterion check:  tensor([1.1141, 1.0084, 0.9968, 0.9946, 1.0107, 0.9774, 0.7747, 1.1030, 0.7605,
        0.2300], device='cuda:0') tensor(104, device='cuda:0')
max of Lambda2 tensor(204477.1406, device='cuda:0')
min of Lambda2 tensor(7.6018e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0116, device='cuda:0')
min of grad d_p:  tensor(-0.0076, device='cuda:0')
max|min: (J_L, Jta/N)  (0.01161588728427887, 0.011615329422056675, ratio: 0.999951958656311)|(-0.007638454437255859, -0.007638595532625914)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.7684e-07, device='cuda:0') mean:  tensor(3.7886e-11, device='cuda:0') min:  tensor(-5.4529e-07, device='cuda:0') norm:  tensor(5.3590e-06, device='cuda:0') MSE:  tensor(6.7528e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0073, device='cuda:0') mean:  tensor(9.7586e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0313, device='cuda:0') MSE:  tensor(3.9461e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1907, device='cuda:0')
min of d_p_list:  tensor(-0.1725, device='cuda:0')
Epoch:  89  
Training Loss: 0.039175327867269516
Test Loss:  0.03734384849667549
Test Acc:  0.0
Valid Loss:  0.03620489686727524
Valid Acc:  0.0
std:  0.7444288413567152 
thres:  0.0006334441475570201
Preserved_eigens number check:  512
  9%|▉         | 89/1000 [27:42<4:24:36, 17.43s/it]Epoch:   90
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  497
Criterion check: 
Mean:  tensor(18.3386, device='cuda:0') 
Std:  tensor(423.7993, device='cuda:0') 
ABS Max:  tensor(9572.9453, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([1.0005, 0.9995, 0.9995, 1.0007, 1.0001, 0.9748, 1.0236, 1.0146, 0.9994,
        1.1328], device='cuda:0') tensor(104, device='cuda:0')
max of Lambda2 tensor(204471.3906, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1665, device='cuda:0')
min of grad d_p:  tensor(-0.1052, device='cuda:0')
max|min: (J_L, Jta/N)  (0.16649305820465088, 0.16649268567562103, ratio: 0.9999977350234985)|(-0.10518651455640793, -0.10518654435873032)

 check Jacobi res:  torch.Size([793601]) max:  tensor(7.1526e-07, device='cuda:0') mean:  tensor(4.5240e-11, device='cuda:0') min:  tensor(-2.6077e-07, device='cuda:0') norm:  tensor(3.4434e-06, device='cuda:0') MSE:  tensor(4.3390e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0017, device='cuda:0') mean:  tensor(4.1789e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0125, device='cuda:0') MSE:  tensor(1.5718e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(1.9889, device='cuda:0')
min of d_p_list:  tensor(-1.2299, device='cuda:0')
Epoch:  90  
Training Loss: 5.068763732910156
Test Loss:  6.098329544067383
Test Acc:  0.0
Valid Loss:  5.2586750984191895
Valid Acc:  0.0
std:  1.87761277962123 
thres:  0.0015990196935832502
Preserved_eigens number check:  512
  9%|▉         | 90/1000 [27:59<4:24:11, 17.42s/it]Epoch:   91
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  495
Criterion check: 
Mean:  tensor(-0.7367, device='cuda:0') 
Std:  tensor(22.6619, device='cuda:0') 
ABS Max:  tensor(445.2373, device='cuda:0') 
ABS Min:  tensor(0.0001, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0001, 0.9998, 0.9994, 0.9998, 1.0053, 1.0089, 0.9788,
        1.3686], device='cuda:0') tensor(122, device='cuda:0')
max of Lambda2 tensor(218916.5625, device='cuda:0')
min of Lambda2 tensor(1.3602e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(2.5907, device='cuda:0')
min of grad d_p:  tensor(-6.3811, device='cuda:0')
max|min: (J_L, Jta/N)  (2.590712547302246, 2.590711832046509, ratio: 0.9999997019767761)|(-6.381110191345215, -6.38110876083374)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.6689e-06, device='cuda:0') mean:  tensor(-1.8537e-10, device='cuda:0') min:  tensor(-4.2915e-06, device='cuda:0') norm:  tensor(1.5797e-05, device='cuda:0') MSE:  tensor(1.9906e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0134, device='cuda:0') mean:  tensor(2.0720e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0715, device='cuda:0') MSE:  tensor(9.0112e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.2248, device='cuda:0')
min of d_p_list:  tensor(-0.1922, device='cuda:0')
Epoch:  91  
Training Loss: 1.0329663753509521
Test Loss:  1.1339800357818604
Test Acc:  0.0
Valid Loss:  1.24277663230896
Valid Acc:  0.0
std:  1.8700695015677729 
thres:  0.001388006614893675
Preserved_eigens number check:  512
  9%|▉         | 91/1000 [28:17<4:25:32, 17.53s/it]Epoch:   92
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  494
Criterion check: 
Mean:  tensor(-0.1082, device='cuda:0') 
Std:  tensor(14.4596, device='cuda:0') 
ABS Max:  tensor(302.5103, device='cuda:0') 
ABS Min:  tensor(7.7257e-05, device='cuda:0')
Criterion check:  tensor([0.9998, 0.9999, 1.0005, 0.9978, 1.0012, 0.9954, 0.9901, 0.9869, 0.9732,
        0.6371], device='cuda:0') tensor(91, device='cuda:0')
max of Lambda2 tensor(219162.8125, device='cuda:0')
min of Lambda2 tensor(8.9149e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2507, device='cuda:0')
min of grad d_p:  tensor(-0.8087, device='cuda:0')
max|min: (J_L, Jta/N)  (0.2506532669067383, 0.25065332651138306, ratio: 1.000000238418579)|(-0.8087154626846313, -0.8087154626846313)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.9802e-07, device='cuda:0') mean:  tensor(-3.3610e-11, device='cuda:0') min:  tensor(-2.6822e-07, device='cuda:0') norm:  tensor(2.2674e-06, device='cuda:0') MSE:  tensor(2.8572e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0026, device='cuda:0') mean:  tensor(4.0536e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0130, device='cuda:0') MSE:  tensor(1.6408e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1543, device='cuda:0')
min of d_p_list:  tensor(-0.2332, device='cuda:0')
Epoch:  92  
Training Loss: 0.3591863512992859
Test Loss:  0.3828936219215393
Test Acc:  0.0
Valid Loss:  0.43087732791900635
Valid Acc:  0.0
std:  1.8876197007941498 
thres:  0.0013522222749888897
Preserved_eigens number check:  512
  9%|▉         | 92/1000 [28:35<4:25:37, 17.55s/it]Epoch:   93
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  494
Criterion check: 
Mean:  tensor(0.5652, device='cuda:0') 
Std:  tensor(14.9766, device='cuda:0') 
ABS Max:  tensor(290.0051, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([ 1.0010,  1.0234,  0.9993,  0.9999,  1.0005,  1.0176,  0.9926,  0.9875,
         0.9378, -0.8794], device='cuda:0') tensor(106, device='cuda:0')
max of Lambda2 tensor(218929.5000, device='cuda:0')
min of Lambda2 tensor(4.9455e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0444, device='cuda:0')
min of grad d_p:  tensor(-0.1888, device='cuda:0')
max|min: (J_L, Jta/N)  (0.04443434253334999, 0.044434480369091034, ratio: 1.0000030994415283)|(-0.1888149380683899, -0.18881553411483765)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.9605e-07, device='cuda:0') mean:  tensor(4.0442e-11, device='cuda:0') min:  tensor(-3.9861e-07, device='cuda:0') norm:  tensor(3.4576e-06, device='cuda:0') MSE:  tensor(4.3569e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0084, device='cuda:0') mean:  tensor(1.0731e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0354, device='cuda:0') MSE:  tensor(4.4633e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1280, device='cuda:0')
min of d_p_list:  tensor(-0.0974, device='cuda:0')
Epoch:  93  
Training Loss: 0.13026216626167297
Test Loss:  0.13677643239498138
Test Acc:  0.0
Valid Loss:  0.15735435485839844
Valid Acc:  0.0
std:  1.9033961424602401 
thres:  0.0013260707907378673
Preserved_eigens number check:  512
  9%|▉         | 93/1000 [28:52<4:25:26, 17.56s/it]Epoch:   94
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  494
Criterion check: 
Mean:  tensor(0.0727, device='cuda:0') 
Std:  tensor(1.9088, device='cuda:0') 
ABS Max:  tensor(21.9149, device='cuda:0') 
ABS Min:  tensor(7.3630e-05, device='cuda:0')
Criterion check:  tensor([1.0035, 1.0004, 0.9996, 1.0007, 0.9861, 1.0822, 0.7555, 0.8707, 1.0359,
        1.4460], device='cuda:0') tensor(73, device='cuda:0')
max of Lambda2 tensor(219335.7969, device='cuda:0')
min of Lambda2 tensor(1.6273e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0570, device='cuda:0')
min of grad d_p:  tensor(-0.0554, device='cuda:0')
max|min: (J_L, Jta/N)  (0.05704868584871292, 0.057050127536058426, ratio: 1.0000252723693848)|(-0.055354513227939606, -0.055353548377752304)

 check Jacobi res:  torch.Size([793601]) max:  tensor(6.1258e-07, device='cuda:0') mean:  tensor(-2.2395e-10, device='cuda:0') min:  tensor(-2.0685e-06, device='cuda:0') norm:  tensor(1.0411e-05, device='cuda:0') MSE:  tensor(1.3119e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0034, device='cuda:0') mean:  tensor(5.2454e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0168, device='cuda:0') MSE:  tensor(2.1107e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0771, device='cuda:0')
min of d_p_list:  tensor(-0.0979, device='cuda:0')
Epoch:  94  
Training Loss: 0.07980357110500336
Test Loss:  0.08359478414058685
Test Acc:  0.0
Valid Loss:  0.09299732744693756
Valid Acc:  0.0
std:  1.897963977277092 
thres:  0.0013341964393854143
Preserved_eigens number check:  512
  9%|▉         | 94/1000 [29:10<4:25:28, 17.58s/it]Epoch:   95
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  493
Criterion check: 
Mean:  tensor(-4.7214, device='cuda:0') 
Std:  tensor(107.4026, device='cuda:0') 
ABS Max:  tensor(2428.8579, device='cuda:0') 
ABS Min:  tensor(9.2967e-05, device='cuda:0')
Criterion check:  tensor([1.0005, 0.9993, 1.0000, 0.9994, 0.9933, 1.0051, 1.0826, 1.0171, 0.8480,
        0.9817], device='cuda:0') tensor(57, device='cuda:0')
max of Lambda2 tensor(219288.2969, device='cuda:0')
min of Lambda2 tensor(2.5542e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0580, device='cuda:0')
min of grad d_p:  tensor(-0.0979, device='cuda:0')
max|min: (J_L, Jta/N)  (0.058039624243974686, 0.05803908035159111, ratio: 0.9999906420707703)|(-0.09787476807832718, -0.09787376970052719)

 check Jacobi res:  torch.Size([793601]) max:  tensor(6.5938e-07, device='cuda:0') mean:  tensor(-3.5957e-11, device='cuda:0') min:  tensor(-1.1846e-06, device='cuda:0') norm:  tensor(7.0334e-06, device='cuda:0') MSE:  tensor(8.8626e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0030, device='cuda:0') mean:  tensor(4.0915e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0134, device='cuda:0') MSE:  tensor(1.6944e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0688, device='cuda:0')
min of d_p_list:  tensor(-0.0730, device='cuda:0')
Epoch:  95  
Training Loss: 0.0532679483294487
Test Loss:  0.05760212242603302
Test Acc:  0.0
Valid Loss:  0.0644015371799469
Valid Acc:  0.0
std:  0.3671734280996422 
thres:  0.0003310972824692726
Preserved_eigens number check:  512
 10%|▉         | 95/1000 [29:27<4:23:58, 17.50s/it]Epoch:   96
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  495
Criterion check: 
Mean:  tensor(-0.1069, device='cuda:0') 
Std:  tensor(3.2788, device='cuda:0') 
ABS Max:  tensor(62.8237, device='cuda:0') 
ABS Min:  tensor(2.3330e-05, device='cuda:0')
Criterion check:  tensor([1.0161, 0.9933, 1.0045, 0.9951, 1.0140, 1.0050, 1.0544, 8.4686, 1.0398,
        0.9141], device='cuda:0') tensor(51, device='cuda:0')
max of Lambda2 tensor(219312.4531, device='cuda:0')
min of Lambda2 tensor(7.0201e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0104, device='cuda:0')
min of grad d_p:  tensor(-0.0039, device='cuda:0')
max|min: (J_L, Jta/N)  (0.010360104031860828, 0.010358573868870735, ratio: 0.9998522996902466)|(-0.003880128264427185, -0.0038805792573839426)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.5302e-06, device='cuda:0') mean:  tensor(1.6968e-10, device='cuda:0') min:  tensor(-4.9244e-07, device='cuda:0') norm:  tensor(8.0545e-06, device='cuda:0') MSE:  tensor(1.0149e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0021, device='cuda:0') mean:  tensor(2.6999e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0083, device='cuda:0') MSE:  tensor(1.0411e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1616, device='cuda:0')
min of d_p_list:  tensor(-0.1185, device='cuda:0')
Epoch:  96  
Training Loss: 0.03980424255132675
Test Loss:  0.04266270995140076
Test Acc:  0.0
Valid Loss:  0.04727189987897873
Valid Acc:  0.0
std:  0.11750645826411561 
thres:  0.00013246485590934754
Preserved_eigens number check:  512
 10%|▉         | 96/1000 [29:45<4:23:38, 17.50s/it]Epoch:   97
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  494
Criterion check: 
Mean:  tensor(-212.0951, device='cuda:0') 
Std:  tensor(9079.9531, device='cuda:0') 
ABS Max:  tensor(154730.6406, device='cuda:0') 
ABS Min:  tensor(0.0631, device='cuda:0')
Criterion check:  tensor([-2.6407e+00,  7.9835e-01,  1.0105e+00, -8.5797e-01,  5.0870e+00,
         3.2734e+00,  4.9449e+01,  4.1203e+01, -2.6088e+03,  6.6612e+02],
       device='cuda:0') tensor(253, device='cuda:0')
max of Lambda2 tensor(219562.8125, device='cuda:0')
min of Lambda2 tensor(3.3829e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0765, device='cuda:0')
min of grad d_p:  tensor(-0.1207, device='cuda:0')
max|min: (J_L, Jta/N)  (0.0764719694852829, 0.07647253572940826, ratio: 1.0000073909759521)|(-0.12070231139659882, -0.12070184201002121)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.7474e-07, device='cuda:0') mean:  tensor(-1.1567e-10, device='cuda:0') min:  tensor(-1.0896e-06, device='cuda:0') norm:  tensor(4.9701e-06, device='cuda:0') MSE:  tensor(6.2627e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(3.2594, device='cuda:0') mean:  tensor(0.0072, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(21.9627, device='cuda:0') MSE:  tensor(2.7675e-05, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0490, device='cuda:0')
min of d_p_list:  tensor(-0.0555, device='cuda:0')
Epoch:  97  
Training Loss: 0.013125952333211899
Test Loss:  0.013562548905611038
Test Acc:  0.0
Valid Loss:  0.015510921366512775
Valid Acc:  0.0
std:  0.039815615422279786 
thres:  6.325277611613274e-05
Preserved_eigens number check:  512
 10%|▉         | 97/1000 [30:02<4:22:18, 17.43s/it]Epoch:   98
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  492
Criterion check: 
Mean:  tensor(0.0011, device='cuda:0') 
Std:  tensor(14.6795, device='cuda:0') 
ABS Max:  tensor(190.3785, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([1.0617, 1.0079, 1.0141, 1.0142, 1.0010, 0.4575, 0.7247, 1.3226, 0.9314,
        0.8487], device='cuda:0') tensor(90, device='cuda:0')
max of Lambda2 tensor(219342.7188, device='cuda:0')
min of Lambda2 tensor(8.5422e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0204, device='cuda:0')
min of grad d_p:  tensor(-0.0135, device='cuda:0')
max|min: (J_L, Jta/N)  (0.02035524882376194, 0.020355721935629845, ratio: 1.0000232458114624)|(-0.013472949154675007, -0.01347326673567295)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.2282e-07, device='cuda:0') mean:  tensor(-1.4858e-11, device='cuda:0') min:  tensor(-5.2713e-07, device='cuda:0') norm:  tensor(3.5052e-06, device='cuda:0') MSE:  tensor(4.4168e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0098, device='cuda:0') mean:  tensor(1.7096e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0571, device='cuda:0') MSE:  tensor(7.2005e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.3282, device='cuda:0')
min of d_p_list:  tensor(-0.2677, device='cuda:0')
Epoch:  98  
Training Loss: 0.04864133149385452
Test Loss:  0.05289719998836517
Test Acc:  0.0
Valid Loss:  0.06369852274656296
Valid Acc:  0.0
std:  0.021527935200143986 
thres:  4.692860916256904e-05
Preserved_eigens number check:  512
 10%|▉         | 98/1000 [30:19<4:20:38, 17.34s/it]Epoch:   99
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  496
Criterion check: 
Mean:  tensor(0.5190, device='cuda:0') 
Std:  tensor(6.5094, device='cuda:0') 
ABS Max:  tensor(56.9674, device='cuda:0') 
ABS Min:  tensor(0.0012, device='cuda:0')
Criterion check:  tensor([1.0022, 1.0031, 0.9999, 1.0021, 1.0024, 1.0113, 0.9571, 0.9776, 0.9648,
        0.0689], device='cuda:0') tensor(109, device='cuda:0')
max of Lambda2 tensor(219568.1094, device='cuda:0')
min of Lambda2 tensor(5.8064e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0959, device='cuda:0')
min of grad d_p:  tensor(-0.2872, device='cuda:0')
max|min: (J_L, Jta/N)  (0.09589633345603943, 0.09589621424674988, ratio: 0.9999987483024597)|(-0.2872310280799866, -0.287230521440506)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.0117e-07, device='cuda:0') mean:  tensor(-6.4526e-11, device='cuda:0') min:  tensor(-5.0664e-07, device='cuda:0') norm:  tensor(3.0334e-06, device='cuda:0') MSE:  tensor(3.8223e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0121, device='cuda:0') mean:  tensor(1.4549e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0446, device='cuda:0') MSE:  tensor(5.6160e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(1.4759, device='cuda:0')
min of d_p_list:  tensor(-0.9406, device='cuda:0')
Epoch:  99  
Training Loss: 4.556274890899658
Test Loss:  5.02468204498291
Test Acc:  0.0
Valid Loss:  5.470844745635986
Valid Acc:  0.0
std:  1.8070794830374497 
thres:  0.0009422228731215001
Preserved_eigens number check:  512
 10%|▉         | 99/1000 [30:37<4:21:34, 17.42s/it]Epoch:   100
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  491
Criterion check: 
Mean:  tensor(-0.0992, device='cuda:0') 
Std:  tensor(4.0918, device='cuda:0') 
ABS Max:  tensor(86.3936, device='cuda:0') 
ABS Min:  tensor(0.0001, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0013, 1.0000, 1.0041, 0.9596, 1.1234,
        1.0054], device='cuda:0') tensor(78, device='cuda:0')
max of Lambda2 tensor(225020.3594, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(3.5665, device='cuda:0')
min of grad d_p:  tensor(-1.5486, device='cuda:0')
max|min: (J_L, Jta/N)  (3.5664868354797363, 3.56648850440979, ratio: 1.0000004768371582)|(-1.5486332178115845, -1.5486332178115845)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.1921e-06, device='cuda:0') mean:  tensor(4.1265e-11, device='cuda:0') min:  tensor(-2.3842e-06, device='cuda:0') norm:  tensor(8.3533e-06, device='cuda:0') MSE:  tensor(1.0526e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0028, device='cuda:0') mean:  tensor(6.8711e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0211, device='cuda:0') MSE:  tensor(2.6560e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.2489, device='cuda:0')
min of d_p_list:  tensor(-0.3776, device='cuda:0')
Epoch:  100  
Training Loss: 0.8998153209686279
Test Loss:  0.9992380738258362
Test Acc:  0.0
Valid Loss:  1.063830018043518
Valid Acc:  0.0
std:  1.7547598320805944 
thres:  0.001111532347649336
Preserved_eigens number check:  512
 10%|█         | 100/1000 [30:55<4:24:21, 17.62s/it]Epoch:   101
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  495
Criterion check: 
Mean:  tensor(0.0019, device='cuda:0') 
Std:  tensor(12.2638, device='cuda:0') 
ABS Max:  tensor(113.0016, device='cuda:0') 
ABS Min:  tensor(0.0010, device='cuda:0')
Criterion check:  tensor([1.0008, 0.9985, 0.9995, 1.0172, 0.9791, 0.9900, 1.0363, 0.8786, 1.1645,
        1.2179], device='cuda:0') tensor(116, device='cuda:0')
max of Lambda2 tensor(224570.2969, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.4528, device='cuda:0')
min of grad d_p:  tensor(-0.2287, device='cuda:0')
max|min: (J_L, Jta/N)  (0.45276638865470886, 0.45276761054992676, ratio: 1.0000027418136597)|(-0.2286556512117386, -0.22865670919418335)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.0580e-06, device='cuda:0') mean:  tensor(-1.6604e-10, device='cuda:0') min:  tensor(-1.7583e-06, device='cuda:0') norm:  tensor(1.0932e-05, device='cuda:0') MSE:  tensor(1.3775e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0118, device='cuda:0') mean:  tensor(2.4200e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0740, device='cuda:0') MSE:  tensor(9.3200e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.2499, device='cuda:0')
min of d_p_list:  tensor(-0.2222, device='cuda:0')
Epoch:  101  
Training Loss: 0.40666842460632324
Test Loss:  0.45296406745910645
Test Acc:  0.0
Valid Loss:  0.4715655744075775
Valid Acc:  0.0
std:  1.7156470787754234 
thres:  0.001184905184060335
Preserved_eigens number check:  512
 10%|█         | 101/1000 [31:12<4:21:18, 17.44s/it]Epoch:   102
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  495
Criterion check: 
Mean:  tensor(0.3712, device='cuda:0') 
Std:  tensor(3.4331, device='cuda:0') 
ABS Max:  tensor(36.5463, device='cuda:0') 
ABS Min:  tensor(3.1294e-05, device='cuda:0')
Criterion check:  tensor([0.9996, 0.9995, 1.0002, 0.9999, 1.0037, 0.9923, 1.0209, 1.0318, 0.9473,
        0.9776], device='cuda:0') tensor(81, device='cuda:0')
max of Lambda2 tensor(224097.3750, device='cuda:0')
min of Lambda2 tensor(1.5449e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1449, device='cuda:0')
min of grad d_p:  tensor(-0.1382, device='cuda:0')
max|min: (J_L, Jta/N)  (0.14485254883766174, 0.14485172927379608, ratio: 0.9999943375587463)|(-0.13821053504943848, -0.13821060955524445)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.2368e-06, device='cuda:0') mean:  tensor(1.2633e-10, device='cuda:0') min:  tensor(-5.4389e-07, device='cuda:0') norm:  tensor(7.1200e-06, device='cuda:0') MSE:  tensor(8.9717e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0062, device='cuda:0') mean:  tensor(4.7013e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0187, device='cuda:0') MSE:  tensor(2.3600e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.7072, device='cuda:0')
min of d_p_list:  tensor(-0.6020, device='cuda:0')
Epoch:  102  
Training Loss: 0.3874190151691437
Test Loss:  0.36452770233154297
Test Acc:  0.0
Valid Loss:  0.38872402906417847
Valid Acc:  0.0
std:  1.6704564081017823 
thres:  0.0012597637966275214
Preserved_eigens number check:  512
 10%|█         | 102/1000 [31:29<4:21:56, 17.50s/it]Epoch:   103
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  499
Criterion check: 
Mean:  tensor(-6.4638, device='cuda:0') 
Std:  tensor(129.0181, device='cuda:0') 
ABS Max:  tensor(2890.1904, device='cuda:0') 
ABS Min:  tensor(0.0022, device='cuda:0')
Criterion check:  tensor([0.9989, 1.0004, 1.0139, 0.9974, 0.9980, 1.0691, 0.9967, 0.9891, 1.0057,
        0.6367], device='cuda:0') tensor(138, device='cuda:0')
max of Lambda2 tensor(230535.4688, device='cuda:0')
min of Lambda2 tensor(1.7137e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.0125, device='cuda:0')
min of grad d_p:  tensor(-0.3044, device='cuda:0')
max|min: (J_L, Jta/N)  (1.012494683265686, 1.012494444847107, ratio: 0.9999997615814209)|(-0.3043648600578308, -0.304364949464798)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.9802e-07, device='cuda:0') mean:  tensor(-1.7472e-11, device='cuda:0') min:  tensor(-4.7684e-07, device='cuda:0') norm:  tensor(2.2952e-06, device='cuda:0') MSE:  tensor(2.8922e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0187, device='cuda:0') mean:  tensor(2.4463e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0943, device='cuda:0') MSE:  tensor(1.1882e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.5715, device='cuda:0')
min of d_p_list:  tensor(-0.6635, device='cuda:0')
Epoch:  103  
Training Loss: 0.798801839351654
Test Loss:  0.7810966968536377
Test Acc:  0.0
Valid Loss:  0.7342681884765625
Valid Acc:  0.0
std:  1.586520923268004 
thres:  0.0014097958981990814
Preserved_eigens number check:  512
 10%|█         | 103/1000 [31:47<4:20:47, 17.44s/it]Epoch:   104
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  495
Criterion check: 
Mean:  tensor(-0.2087, device='cuda:0') 
Std:  tensor(3.1146, device='cuda:0') 
ABS Max:  tensor(50.8410, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([0.9999, 1.0000, 1.0002, 1.0001, 1.0002, 1.0022, 1.0033, 0.9702, 1.0197,
        1.0920], device='cuda:0') tensor(64, device='cuda:0')
max of Lambda2 tensor(231222.3594, device='cuda:0')
min of Lambda2 tensor(1.1000e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.9555, device='cuda:0')
min of grad d_p:  tensor(-0.4784, device='cuda:0')
max|min: (J_L, Jta/N)  (0.955512523651123, 0.9555124044418335, ratio: 0.9999998807907104)|(-0.4783610701560974, -0.4783613681793213)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.3958e-07, device='cuda:0') mean:  tensor(2.8580e-11, device='cuda:0') min:  tensor(-3.5763e-07, device='cuda:0') norm:  tensor(3.4315e-06, device='cuda:0') MSE:  tensor(4.3239e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0027, device='cuda:0') mean:  tensor(4.7509e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0159, device='cuda:0') MSE:  tensor(2.0008e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.3468, device='cuda:0')
min of d_p_list:  tensor(-0.2901, device='cuda:0')
Epoch:  104  
Training Loss: 0.2710609436035156
Test Loss:  0.2662697434425354
Test Acc:  0.0
Valid Loss:  0.2535322308540344
Valid Acc:  0.0
std:  0.24860359222153192 
thres:  0.000552753108739853
Preserved_eigens number check:  512
 10%|█         | 104/1000 [32:04<4:20:10, 17.42s/it]Epoch:   105
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  494
Criterion check: 
Mean:  tensor(1.2743, device='cuda:0') 
Std:  tensor(20.1393, device='cuda:0') 
ABS Max:  tensor(327.1896, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([1.0008, 1.0013, 2.4478, 1.0022, 0.9937, 0.9896, 0.9791, 1.0198, 0.8683,
        6.2595], device='cuda:0') tensor(88, device='cuda:0')
max of Lambda2 tensor(231467.7031, device='cuda:0')
min of Lambda2 tensor(4.9530e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2238, device='cuda:0')
min of grad d_p:  tensor(-0.0736, device='cuda:0')
max|min: (J_L, Jta/N)  (0.22380807995796204, 0.22380976378917694, ratio: 1.0000075101852417)|(-0.07364540547132492, -0.07364606857299805)

 check Jacobi res:  torch.Size([793601]) max:  tensor(7.0035e-07, device='cuda:0') mean:  tensor(-2.1922e-10, device='cuda:0') min:  tensor(-1.6838e-06, device='cuda:0') norm:  tensor(1.0868e-05, device='cuda:0') MSE:  tensor(1.3695e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0050, device='cuda:0') mean:  tensor(1.0052e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0334, device='cuda:0') MSE:  tensor(4.2042e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.2289, device='cuda:0')
min of d_p_list:  tensor(-0.2488, device='cuda:0')
Epoch:  105  
Training Loss: 0.11338910460472107
Test Loss:  0.11348167061805725
Test Acc:  0.0
Valid Loss:  0.10648579150438309
Valid Acc:  0.0
std:  0.2271184891385479 
thres:  0.00039546786546707153
Preserved_eigens number check:  512
 10%|█         | 105/1000 [32:22<4:20:39, 17.47s/it]Epoch:   106
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  494
Criterion check: 
Mean:  tensor(0.1666, device='cuda:0') 
Std:  tensor(2.7471, device='cuda:0') 
ABS Max:  tensor(42.6132, device='cuda:0') 
ABS Min:  tensor(8.3493e-05, device='cuda:0')
Criterion check:  tensor([0.9990, 0.9999, 0.9987, 1.0004, 0.9875, 1.1047, 1.0076, 0.9885, 0.9012,
        1.1993], device='cuda:0') tensor(68, device='cuda:0')
max of Lambda2 tensor(231336.6719, device='cuda:0')
min of Lambda2 tensor(1.0623e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1693, device='cuda:0')
min of grad d_p:  tensor(-0.1146, device='cuda:0')
max|min: (J_L, Jta/N)  (0.16931907832622528, 0.1693197339773178, ratio: 1.0000038146972656)|(-0.1145630031824112, -0.11456335335969925)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.2713e-07, device='cuda:0') mean:  tensor(-1.9566e-10, device='cuda:0') min:  tensor(-1.7434e-06, device='cuda:0') norm:  tensor(9.5579e-06, device='cuda:0') MSE:  tensor(1.2044e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0030, device='cuda:0') mean:  tensor(3.1006e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0115, device='cuda:0') MSE:  tensor(1.4491e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1127, device='cuda:0')
min of d_p_list:  tensor(-0.0855, device='cuda:0')
Epoch:  106  
Training Loss: 0.059540100395679474
Test Loss:  0.05788877606391907
Test Acc:  0.0
Valid Loss:  0.05832618474960327
Valid Acc:  0.0
std:  0.26326277240424784 
thres:  0.0003260422006249428
Preserved_eigens number check:  512
 11%|█         | 106/1000 [32:39<4:19:02, 17.39s/it]Epoch:   107
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  494
Criterion check: 
Mean:  tensor(-0.1946, device='cuda:0') 
Std:  tensor(3.4663, device='cuda:0') 
ABS Max:  tensor(60.0455, device='cuda:0') 
ABS Min:  tensor(5.3638e-05, device='cuda:0')
Criterion check:  tensor([1.0063, 0.9989, 0.9989, 0.9915, 0.9931, 0.9979, 0.9620, 1.0451, 0.7215,
        0.7790], device='cuda:0') tensor(38, device='cuda:0')
max of Lambda2 tensor(231472.0312, device='cuda:0')
min of Lambda2 tensor(3.6700e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0358, device='cuda:0')
min of grad d_p:  tensor(-0.0270, device='cuda:0')
max|min: (J_L, Jta/N)  (0.03578442335128784, 0.035784341394901276, ratio: 0.9999977350234985)|(-0.02704702690243721, -0.027046533301472664)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.9802e-07, device='cuda:0') mean:  tensor(-1.6107e-11, device='cuda:0') min:  tensor(-5.0245e-07, device='cuda:0') norm:  tensor(2.5182e-06, device='cuda:0') MSE:  tensor(3.1732e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0021, device='cuda:0') mean:  tensor(3.9782e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0128, device='cuda:0') MSE:  tensor(1.6151e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0790, device='cuda:0')
min of d_p_list:  tensor(-0.1154, device='cuda:0')
Epoch:  107  
Training Loss: 0.06533491611480713
Test Loss:  0.0626942589879036
Test Acc:  0.0
Valid Loss:  0.06124880164861679
Valid Acc:  0.0
std:  0.27928121244730403 
thres:  0.0002616253808140755
Preserved_eigens number check:  512
 11%|█         | 107/1000 [32:56<4:19:56, 17.47s/it]Epoch:   108
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  492
Criterion check: 
Mean:  tensor(-20.3211, device='cuda:0') 
Std:  tensor(460.6830, device='cuda:0') 
ABS Max:  tensor(10420.5029, device='cuda:0') 
ABS Min:  tensor(7.1009e-05, device='cuda:0')
Criterion check:  tensor([1.0127, 0.9965, 0.9990, 0.8732, 1.0093, 0.9625, 0.9790, 1.3640, 0.9713,
        1.1493], device='cuda:0') tensor(98, device='cuda:0')
max of Lambda2 tensor(231713.9844, device='cuda:0')
min of Lambda2 tensor(5.1196e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0551, device='cuda:0')
min of grad d_p:  tensor(-0.0349, device='cuda:0')
max|min: (J_L, Jta/N)  (0.055134471505880356, 0.055133190006017685, ratio: 0.9999767541885376)|(-0.03494877368211746, -0.034948524087667465)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.2815e-06, device='cuda:0') mean:  tensor(1.4126e-10, device='cuda:0') min:  tensor(-3.5623e-07, device='cuda:0') norm:  tensor(6.4367e-06, device='cuda:0') MSE:  tensor(8.1108e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0086, device='cuda:0') mean:  tensor(1.1107e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0390, device='cuda:0') MSE:  tensor(4.9116e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0927, device='cuda:0')
min of d_p_list:  tensor(-0.1000, device='cuda:0')
Epoch:  108  
Training Loss: 0.02941765822470188
Test Loss:  0.02745431661605835
Test Acc:  0.0
Valid Loss:  0.02812933176755905
Valid Acc:  0.0
std:  0.08597843138796063 
thres:  0.00010774854458868503
Preserved_eigens number check:  512
 11%|█         | 108/1000 [33:14<4:20:57, 17.55s/it]Epoch:   109
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  493
Criterion check: 
Mean:  tensor(0.0571, device='cuda:0') 
Std:  tensor(1.0143, device='cuda:0') 
ABS Max:  tensor(13.7453, device='cuda:0') 
ABS Min:  tensor(8.7499e-05, device='cuda:0')
Criterion check:  tensor([1.0072, 0.9989, 1.0014, 0.9993, 0.9881, 0.7951, 1.0395, 1.2409, 0.8418,
        1.0410], device='cuda:0') tensor(42, device='cuda:0')
max of Lambda2 tensor(231492.0156, device='cuda:0')
min of Lambda2 tensor(2.0400e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0339, device='cuda:0')
min of grad d_p:  tensor(-0.0132, device='cuda:0')
max|min: (J_L, Jta/N)  (0.03386147320270538, 0.0338616743683815, ratio: 1.0000059604644775)|(-0.013161049224436283, -0.01316093560308218)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.2422e-07, device='cuda:0') mean:  tensor(-7.8027e-11, device='cuda:0') min:  tensor(-9.1502e-07, device='cuda:0') norm:  tensor(6.4596e-06, device='cuda:0') MSE:  tensor(8.1396e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0009, device='cuda:0') mean:  tensor(2.2546e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0076, device='cuda:0') MSE:  tensor(9.5538e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1863, device='cuda:0')
min of d_p_list:  tensor(-0.1727, device='cuda:0')
Epoch:  109  
Training Loss: 0.02372293546795845
Test Loss:  0.020502455532550812
Test Acc:  0.0
Valid Loss:  0.02492484077811241
Valid Acc:  0.0
std:  0.03198624261181099 
thres:  5.82809429615736e-05
Preserved_eigens number check:  512
 11%|█         | 109/1000 [33:31<4:19:01, 17.44s/it]Epoch:   110
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  494
Criterion check: 
Mean:  tensor(3.4912, device='cuda:0') 
Std:  tensor(65.3179, device='cuda:0') 
ABS Max:  tensor(1467.3823, device='cuda:0') 
ABS Min:  tensor(8.0809e-05, device='cuda:0')
Criterion check:  tensor([ 1.0081,  1.0030,  0.9967,  1.0621,  0.9735,  0.4658,  1.6020, -0.7932,
         1.6359,  5.3619], device='cuda:0') tensor(96, device='cuda:0')
max of Lambda2 tensor(231969.7188, device='cuda:0')
min of Lambda2 tensor(4.5864e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0519, device='cuda:0')
min of grad d_p:  tensor(-0.0242, device='cuda:0')
max|min: (J_L, Jta/N)  (0.05185946822166443, 0.05185926705598831, ratio: 0.9999961256980896)|(-0.024218890815973282, -0.02421894297003746)

 check Jacobi res:  torch.Size([793601]) max:  tensor(6.1654e-07, device='cuda:0') mean:  tensor(2.7668e-11, device='cuda:0') min:  tensor(-2.8871e-07, device='cuda:0') norm:  tensor(2.8449e-06, device='cuda:0') MSE:  tensor(3.5848e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0066, device='cuda:0') mean:  tensor(1.2841e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0402, device='cuda:0') MSE:  tensor(5.0710e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.6441, device='cuda:0')
min of d_p_list:  tensor(-0.7651, device='cuda:0')
Epoch:  110  
Training Loss: 0.35659998655319214
Test Loss:  0.33305275440216064
Test Acc:  0.0
Valid Loss:  0.34343820810317993
Valid Acc:  0.0
std:  0.12589093235988705 
thres:  0.00010692311935126782
Preserved_eigens number check:  512
 11%|█         | 110/1000 [33:49<4:19:22, 17.49s/it]Epoch:   111
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  493
Criterion check: 
Mean:  tensor(-0.1559, device='cuda:0') 
Std:  tensor(15.5602, device='cuda:0') 
ABS Max:  tensor(222.5121, device='cuda:0') 
ABS Min:  tensor(4.4372e-05, device='cuda:0')
Criterion check:  tensor([1.0015, 0.9986, 0.9939, 0.9981, 0.9964, 0.9930, 1.0173, 1.6942, 0.9428,
        1.3092], device='cuda:0') tensor(125, device='cuda:0')
max of Lambda2 tensor(233346.3125, device='cuda:0')
min of Lambda2 tensor(1.0136e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.9720, device='cuda:0')
min of grad d_p:  tensor(-0.2867, device='cuda:0')
max|min: (J_L, Jta/N)  (0.9719892144203186, 0.9719905853271484, ratio: 1.0000014305114746)|(-0.28669604659080505, -0.2866966724395752)

 check Jacobi res:  torch.Size([793601]) max:  tensor(6.2585e-07, device='cuda:0') mean:  tensor(-2.0118e-10, device='cuda:0') min:  tensor(-1.5497e-06, device='cuda:0') norm:  tensor(9.7355e-06, device='cuda:0') MSE:  tensor(1.2267e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0126, device='cuda:0') mean:  tensor(2.1408e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0754, device='cuda:0') MSE:  tensor(9.5046e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1194, device='cuda:0')
min of d_p_list:  tensor(-0.1989, device='cuda:0')
Epoch:  111  
Training Loss: 0.2939830422401428
Test Loss:  0.31105268001556396
Test Acc:  0.0
Valid Loss:  0.33438748121261597
Valid Acc:  0.0
std:  0.14212403028476023 
thres:  0.00015381170772016048
Preserved_eigens number check:  512
 11%|█         | 111/1000 [34:06<4:18:09, 17.42s/it]Epoch:   112
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  491
Criterion check: 
Mean:  tensor(-0.1124, device='cuda:0') 
Std:  tensor(10.4773, device='cuda:0') 
ABS Max:  tensor(195.1613, device='cuda:0') 
ABS Min:  tensor(6.3138e-05, device='cuda:0')
Criterion check:  tensor([1.0067, 1.0039, 1.0050, 0.9947, 0.8969, 1.0202, 0.8302, 0.1834, 0.8930,
        1.6625], device='cuda:0') tensor(82, device='cuda:0')
max of Lambda2 tensor(233269.6719, device='cuda:0')
min of Lambda2 tensor(1.4562e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1000, device='cuda:0')
min of grad d_p:  tensor(-0.0289, device='cuda:0')
max|min: (J_L, Jta/N)  (0.10000607371330261, 0.10000721365213394, ratio: 1.0000114440917969)|(-0.028853949159383774, -0.028853967785835266)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.7625e-07, device='cuda:0') mean:  tensor(-1.1486e-10, device='cuda:0') min:  tensor(-1.1399e-06, device='cuda:0') norm:  tensor(6.1845e-06, device='cuda:0') MSE:  tensor(7.7930e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0065, device='cuda:0') mean:  tensor(9.1548e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0313, device='cuda:0') MSE:  tensor(3.9432e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.6935, device='cuda:0')
min of d_p_list:  tensor(-0.6696, device='cuda:0')
Epoch:  112  
Training Loss: 0.09458087384700775
Test Loss:  0.099238321185112
Test Acc:  0.0
Valid Loss:  0.09483151882886887
Valid Acc:  0.0
std:  0.1389282431629468 
thres:  0.0001596608992666006
Preserved_eigens number check:  512
 11%|█         | 112/1000 [34:23<4:17:07, 17.37s/it]Epoch:   113
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  496
Criterion check: 
Mean:  tensor(-3.9511, device='cuda:0') 
Std:  tensor(157.7103, device='cuda:0') 
ABS Max:  tensor(2555.8508, device='cuda:0') 
ABS Min:  tensor(0.0016, device='cuda:0')
Criterion check:  tensor([ 9.9644e-01,  1.0002e+00,  1.0088e+00,  1.0193e+00,  9.7137e-01,
         1.2967e+00, -1.5724e-03,  1.0569e+01, -4.1103e-01,  2.5559e+03],
       device='cuda:0') tensor(223, device='cuda:0')
max of Lambda2 tensor(232752., device='cuda:0')
min of Lambda2 tensor(4.4629e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.4404, device='cuda:0')
min of grad d_p:  tensor(-0.4064, device='cuda:0')
max|min: (J_L, Jta/N)  (1.4403613805770874, 1.4403611421585083, ratio: 0.9999998211860657)|(-0.4063618779182434, -0.40636229515075684)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.6194e-07, device='cuda:0') mean:  tensor(-1.4019e-10, device='cuda:0') min:  tensor(-1.4901e-06, device='cuda:0') norm:  tensor(7.3669e-06, device='cuda:0') MSE:  tensor(9.2829e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.2419, device='cuda:0') mean:  tensor(0.0003, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.9684, device='cuda:0') MSE:  tensor(1.2203e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.7539, device='cuda:0')
min of d_p_list:  tensor(-0.6274, device='cuda:0')
Epoch:  113  
Training Loss: 0.3697473406791687
Test Loss:  0.4209041893482208
Test Acc:  0.0
Valid Loss:  0.4767117500305176
Valid Acc:  0.0
std:  0.1417839456483709 
thres:  0.00022772683575749398
Preserved_eigens number check:  512
 11%|█▏        | 113/1000 [34:41<4:19:35, 17.56s/it]Epoch:   114
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  496
Criterion check: 
Mean:  tensor(0.7081, device='cuda:0') 
Std:  tensor(23.2866, device='cuda:0') 
ABS Max:  tensor(492.2083, device='cuda:0') 
ABS Min:  tensor(0.0004, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 0.9999, 1.0004, 0.9991, 1.0235, 1.0049, 0.9767, 1.0803,
        0.9972], device='cuda:0') tensor(80, device='cuda:0')
max of Lambda2 tensor(235847.6250, device='cuda:0')
min of Lambda2 tensor(3.4464e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.1425, device='cuda:0')
min of grad d_p:  tensor(-0.6813, device='cuda:0')
max|min: (J_L, Jta/N)  (1.1424877643585205, 1.1424875259399414, ratio: 0.9999997615814209)|(-0.6813298463821411, -0.6813296675682068)

 check Jacobi res:  torch.Size([793601]) max:  tensor(6.8545e-07, device='cuda:0') mean:  tensor(-1.1836e-10, device='cuda:0') min:  tensor(-1.1921e-06, device='cuda:0') norm:  tensor(7.1762e-06, device='cuda:0') MSE:  tensor(9.0425e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0054, device='cuda:0') mean:  tensor(1.1047e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0373, device='cuda:0') MSE:  tensor(4.6994e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(1.7122, device='cuda:0')
min of d_p_list:  tensor(-1.8823, device='cuda:0')
Epoch:  114  
Training Loss: 4.192392349243164
Test Loss:  4.704833984375
Test Acc:  0.0
Valid Loss:  4.31041145324707
Valid Acc:  0.0
std:  1.5685603298845963 
thres:  0.001061460718512535
Preserved_eigens number check:  512
 11%|█▏        | 114/1000 [34:59<4:19:44, 17.59s/it]Epoch:   115
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  498
Criterion check: 
Mean:  tensor(0.9006, device='cuda:0') 
Std:  tensor(26.8889, device='cuda:0') 
ABS Max:  tensor(424.1500, device='cuda:0') 
ABS Min:  tensor(0.0004, device='cuda:0')
Criterion check:  tensor([0.9998, 1.0000, 1.0001, 0.9998, 0.9997, 1.0337, 1.0006, 0.9960, 1.1336,
        0.9306], device='cuda:0') tensor(108, device='cuda:0')
max of Lambda2 tensor(249031.9688, device='cuda:0')
min of Lambda2 tensor(1.3360e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(5.8354, device='cuda:0')
min of grad d_p:  tensor(-5.5709, device='cuda:0')
max|min: (J_L, Jta/N)  (5.83544921875, 5.835450649261475, ratio: 1.000000238418579)|(-5.570943832397461, -5.5709404945373535)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.3379e-06, device='cuda:0') mean:  tensor(1.1275e-10, device='cuda:0') min:  tensor(-3.3379e-06, device='cuda:0') norm:  tensor(1.5871e-05, device='cuda:0') MSE:  tensor(1.9999e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0100, device='cuda:0') mean:  tensor(1.7667e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0588, device='cuda:0') MSE:  tensor(7.4038e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.2301, device='cuda:0')
min of d_p_list:  tensor(-0.4027, device='cuda:0')
Epoch:  115  
Training Loss: 0.8267748355865479
Test Loss:  0.7893564701080322
Test Acc:  0.0
Valid Loss:  0.7862081527709961
Valid Acc:  0.0
std:  1.53726663119266 
thres:  0.0011554956883192062
Preserved_eigens number check:  512
 12%|█▏        | 115/1000 [35:17<4:19:50, 17.62s/it]Epoch:   116
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  496
Criterion check: 
Mean:  tensor(0.2188, device='cuda:0') 
Std:  tensor(4.3361, device='cuda:0') 
ABS Max:  tensor(56.6568, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([1.0003, 1.0000, 0.9999, 1.0050, 1.0004, 0.9989, 0.9965, 1.0251, 0.9890,
        0.9451], device='cuda:0') tensor(64, device='cuda:0')
max of Lambda2 tensor(249322.8281, device='cuda:0')
min of Lambda2 tensor(3.4692e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.9683, device='cuda:0')
min of grad d_p:  tensor(-0.6760, device='cuda:0')
max|min: (J_L, Jta/N)  (0.9683173894882202, 0.9683173298835754, ratio: 0.9999999403953552)|(-0.6760204434394836, -0.676020085811615)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.3447e-07, device='cuda:0') mean:  tensor(-1.6558e-11, device='cuda:0') min:  tensor(-7.1526e-07, device='cuda:0') norm:  tensor(4.6534e-06, device='cuda:0') MSE:  tensor(5.8637e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0053, device='cuda:0') mean:  tensor(7.5377e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0255, device='cuda:0') MSE:  tensor(3.2151e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.5815, device='cuda:0')
min of d_p_list:  tensor(-0.2562, device='cuda:0')
Epoch:  116  
Training Loss: 0.47303682565689087
Test Loss:  0.47872868180274963
Test Acc:  0.0
Valid Loss:  0.49229055643081665
Valid Acc:  0.0
std:  1.518754587502087 
thres:  0.001191306445002556
Preserved_eigens number check:  512
 12%|█▏        | 116/1000 [35:34<4:19:33, 17.62s/it]Epoch:   117
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  495
Criterion check: 
Mean:  tensor(5.7284, device='cuda:0') 
Std:  tensor(108.4953, device='cuda:0') 
ABS Max:  tensor(2408.6108, device='cuda:0') 
ABS Min:  tensor(0.0001, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0001, 1.0003, 1.0017, 0.9983, 0.8977, 0.9893, 0.7013,
        1.0781], device='cuda:0') tensor(84, device='cuda:0')
max of Lambda2 tensor(249252.4219, device='cuda:0')
min of Lambda2 tensor(3.5262e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.6311, device='cuda:0')
min of grad d_p:  tensor(-1.0505, device='cuda:0')
max|min: (J_L, Jta/N)  (0.6310986280441284, 0.6310985684394836, ratio: 0.9999998807907104)|(-1.0505034923553467, -1.0505038499832153)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.6624e-07, device='cuda:0') mean:  tensor(2.1843e-11, device='cuda:0') min:  tensor(-3.5763e-07, device='cuda:0') norm:  tensor(2.6810e-06, device='cuda:0') MSE:  tensor(3.3783e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0067, device='cuda:0') mean:  tensor(9.1880e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0318, device='cuda:0') MSE:  tensor(4.0029e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.3363, device='cuda:0')
min of d_p_list:  tensor(-0.2627, device='cuda:0')
Epoch:  117  
Training Loss: 0.27274930477142334
Test Loss:  0.28105399012565613
Test Acc:  0.0
Valid Loss:  0.31754404306411743
Valid Acc:  0.0
std:  1.4945011829222947 
thres:  0.001226940131187439
Preserved_eigens number check:  512
 12%|█▏        | 117/1000 [35:52<4:19:59, 17.67s/it]Epoch:   118
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  494
Criterion check: 
Mean:  tensor(-0.1241, device='cuda:0') 
Std:  tensor(3.5787, device='cuda:0') 
ABS Max:  tensor(55.9626, device='cuda:0') 
ABS Min:  tensor(9.0911e-05, device='cuda:0')
Criterion check:  tensor([0.9837, 1.0004, 1.0011, 1.0008, 1.1084, 1.0022, 1.1894, 1.0986, 1.3274,
        1.1117], device='cuda:0') tensor(85, device='cuda:0')
max of Lambda2 tensor(250562.3750, device='cuda:0')
min of Lambda2 tensor(3.3505e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0969, device='cuda:0')
min of grad d_p:  tensor(-0.0809, device='cuda:0')
max|min: (J_L, Jta/N)  (0.09689274430274963, 0.09689274430274963, ratio: 1.0)|(-0.08086223155260086, -0.08086192607879639)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.6019e-07, device='cuda:0') mean:  tensor(-2.6279e-11, device='cuda:0') min:  tensor(-3.5018e-07, device='cuda:0') norm:  tensor(1.9884e-06, device='cuda:0') MSE:  tensor(2.5056e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0139, device='cuda:0') mean:  tensor(1.4623e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0504, device='cuda:0') MSE:  tensor(6.3494e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1444, device='cuda:0')
min of d_p_list:  tensor(-0.4732, device='cuda:0')
Epoch:  118  
Training Loss: 0.24022015929222107
Test Loss:  0.2521955966949463
Test Acc:  0.0
Valid Loss:  0.252864807844162
Valid Acc:  0.0
std:  1.5101755059247002 
thres:  0.0012010346949100496
Preserved_eigens number check:  512
 12%|█▏        | 118/1000 [36:10<4:18:15, 17.57s/it]Epoch:   119
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  494
Criterion check: 
Mean:  tensor(0.0674, device='cuda:0') 
Std:  tensor(10.1322, device='cuda:0') 
ABS Max:  tensor(98.6756, device='cuda:0') 
ABS Min:  tensor(6.8579e-05, device='cuda:0')
Criterion check:  tensor([1.0093, 0.9941, 0.9942, 1.0010, 1.0190, 0.9348, 0.8425, 1.4008, 2.1809,
        0.5632], device='cuda:0') tensor(133, device='cuda:0')
max of Lambda2 tensor(250710.7344, device='cuda:0')
min of Lambda2 tensor(2.6333e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1281, device='cuda:0')
min of grad d_p:  tensor(-0.3412, device='cuda:0')
max|min: (J_L, Jta/N)  (0.12808601558208466, 0.12808576226234436, ratio: 0.9999980330467224)|(-0.34119176864624023, -0.3411905765533447)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.7998e-07, device='cuda:0') mean:  tensor(-6.4394e-11, device='cuda:0') min:  tensor(-1.1921e-06, device='cuda:0') norm:  tensor(5.2839e-06, device='cuda:0') MSE:  tensor(6.6581e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0289, device='cuda:0') mean:  tensor(5.2404e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1645, device='cuda:0') MSE:  tensor(2.0732e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.2500, device='cuda:0')
min of d_p_list:  tensor(-0.1282, device='cuda:0')
Epoch:  119  
Training Loss: 0.09327828884124756
Test Loss:  0.1026315689086914
Test Acc:  0.0
Valid Loss:  0.10617931932210922
Valid Acc:  0.0
std:  0.2535770953721339 
thres:  0.00038121188282966615
Preserved_eigens number check:  512
 12%|█▏        | 119/1000 [36:27<4:18:58, 17.64s/it]Epoch:   120
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  493
Criterion check: 
Mean:  tensor(0.3197, device='cuda:0') 
Std:  tensor(3.1401, device='cuda:0') 
ABS Max:  tensor(39.4058, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([0.9988, 1.0006, 1.0019, 1.0237, 1.0024, 1.0705, 0.9134, 1.2487, 1.0091,
        0.0469], device='cuda:0') tensor(78, device='cuda:0')
max of Lambda2 tensor(250596.7969, device='cuda:0')
min of Lambda2 tensor(5.3186e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0938, device='cuda:0')
min of grad d_p:  tensor(-0.0592, device='cuda:0')
max|min: (J_L, Jta/N)  (0.09384089708328247, 0.09384065866470337, ratio: 0.9999974370002747)|(-0.059221141040325165, -0.05922253057360649)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.2464e-06, device='cuda:0') mean:  tensor(1.8491e-10, device='cuda:0') min:  tensor(-5.9977e-07, device='cuda:0') norm:  tensor(1.0179e-05, device='cuda:0') MSE:  tensor(1.2826e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0045, device='cuda:0') mean:  tensor(7.6925e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0260, device='cuda:0') MSE:  tensor(3.2704e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.2148, device='cuda:0')
min of d_p_list:  tensor(-0.2706, device='cuda:0')
Epoch:  120  
Training Loss: 0.027932006865739822
Test Loss:  0.03245776519179344
Test Acc:  0.0
Valid Loss:  0.029902853071689606
Valid Acc:  0.0
std:  0.155020688541088 
thres:  0.00022144331708550451
Preserved_eigens number check:  512
 12%|█▏        | 120/1000 [36:45<4:18:00, 17.59s/it]Epoch:   121
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  494
Criterion check: 
Mean:  tensor(0.7796, device='cuda:0') 
Std:  tensor(37.8361, device='cuda:0') 
ABS Max:  tensor(760.3509, device='cuda:0') 
ABS Min:  tensor(7.9461e-05, device='cuda:0')
Criterion check:  tensor([1.0358, 0.9998, 1.0005, 0.9874, 1.0015, 0.9620, 0.9745, 0.9932, 0.8215,
        0.8971], device='cuda:0') tensor(87, device='cuda:0')
max of Lambda2 tensor(251051.1562, device='cuda:0')
min of Lambda2 tensor(2.1002e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1775, device='cuda:0')
min of grad d_p:  tensor(-0.2177, device='cuda:0')
max|min: (J_L, Jta/N)  (0.17750582098960876, 0.17750583589076996, ratio: 1.0000001192092896)|(-0.21772325038909912, -0.21772272884845734)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.5227e-07, device='cuda:0') mean:  tensor(-9.4497e-12, device='cuda:0') min:  tensor(-5.9605e-07, device='cuda:0') norm:  tensor(4.2883e-06, device='cuda:0') MSE:  tensor(5.4035e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0095, device='cuda:0') mean:  tensor(1.1893e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0424, device='cuda:0') MSE:  tensor(5.3391e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1048, device='cuda:0')
min of d_p_list:  tensor(-0.0693, device='cuda:0')
Epoch:  121  
Training Loss: 0.017995037138462067
Test Loss:  0.020441934466362
Test Acc:  0.0
Valid Loss:  0.019793767482042313
Valid Acc:  0.0
std:  0.1066174212568517 
thres:  0.00013043495938181877
Preserved_eigens number check:  512
 12%|█▏        | 121/1000 [37:02<4:17:08, 17.55s/it]Epoch:   122
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  497
Criterion check: 
Mean:  tensor(-0.0586, device='cuda:0') 
Std:  tensor(7.3305, device='cuda:0') 
ABS Max:  tensor(83.6496, device='cuda:0') 
ABS Min:  tensor(0.0005, device='cuda:0')
Criterion check:  tensor([ 0.9961,  1.0022,  0.9962,  0.9871,  0.8466,  0.9188,  3.1179,  0.7927,
         0.7245, -0.4896], device='cuda:0') tensor(86, device='cuda:0')
max of Lambda2 tensor(250693.9844, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0672, device='cuda:0')
min of grad d_p:  tensor(-0.0371, device='cuda:0')
max|min: (J_L, Jta/N)  (0.06715922057628632, 0.06715935468673706, ratio: 1.0000020265579224)|(-0.03708585724234581, -0.03708609193563461)

 check Jacobi res:  torch.Size([793601]) max:  tensor(9.5367e-07, device='cuda:0') mean:  tensor(1.2562e-10, device='cuda:0') min:  tensor(-4.4424e-07, device='cuda:0') norm:  tensor(7.1163e-06, device='cuda:0') MSE:  tensor(8.9672e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0061, device='cuda:0') mean:  tensor(9.0495e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0343, device='cuda:0') MSE:  tensor(4.3160e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.4973, device='cuda:0')
min of d_p_list:  tensor(-0.5654, device='cuda:0')
Epoch:  122  
Training Loss: 0.11884471774101257
Test Loss:  0.11401291936635971
Test Acc:  0.0
Valid Loss:  0.11781251430511475
Valid Acc:  0.0
std:  0.07997500733744912 
thres:  9.965404197573661e-05
Preserved_eigens number check:  512
 12%|█▏        | 122/1000 [37:19<4:15:16, 17.44s/it]Epoch:   123
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  495
Criterion check: 
Mean:  tensor(1.4620, device='cuda:0') 
Std:  tensor(25.7964, device='cuda:0') 
ABS Max:  tensor(491.3147, device='cuda:0') 
ABS Min:  tensor(0.0006, device='cuda:0')
Criterion check:  tensor([1.0002, 1.0000, 1.0027, 1.0001, 1.0122, 0.8859, 0.8415, 1.0294, 0.8846,
        0.8489], device='cuda:0') tensor(101, device='cuda:0')
max of Lambda2 tensor(250311.1562, device='cuda:0')
min of Lambda2 tensor(2.3239e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.4653, device='cuda:0')
min of grad d_p:  tensor(-0.5956, device='cuda:0')
max|min: (J_L, Jta/N)  (0.46526849269866943, 0.46526873111724854, ratio: 1.0000004768371582)|(-0.5955623388290405, -0.5955610275268555)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.9407e-07, device='cuda:0') mean:  tensor(-2.3537e-10, device='cuda:0') min:  tensor(-1.9372e-06, device='cuda:0') norm:  tensor(1.2448e-05, device='cuda:0') MSE:  tensor(1.5685e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0124, device='cuda:0') mean:  tensor(2.1458e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0704, device='cuda:0') MSE:  tensor(8.8742e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.9345, device='cuda:0')
min of d_p_list:  tensor(-1.5282, device='cuda:0')
Epoch:  123  
Training Loss: 0.4096696972846985
Test Loss:  0.44297537207603455
Test Acc:  0.0
Valid Loss:  0.41657519340515137
Valid Acc:  0.0
std:  0.14323983594459036 
thres:  0.00013354394957423212
Preserved_eigens number check:  512
 12%|█▏        | 123/1000 [37:37<4:17:02, 17.59s/it]Epoch:   124
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  498
Criterion check: 
Mean:  tensor(0.5808, device='cuda:0') 
Std:  tensor(10.9054, device='cuda:0') 
ABS Max:  tensor(242.3564, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([0.9994, 1.0000, 0.9998, 0.9999, 1.0005, 1.0000, 1.0092, 0.9946, 1.0137,
        1.1721], device='cuda:0') tensor(66, device='cuda:0')
max of Lambda2 tensor(259716.3750, device='cuda:0')
min of Lambda2 tensor(5.1227e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.6707, device='cuda:0')
min of grad d_p:  tensor(-0.5346, device='cuda:0')
max|min: (J_L, Jta/N)  (1.6706936359405518, 1.670695424079895, ratio: 1.000001072883606)|(-0.5346245169639587, -0.5346241593360901)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.5682e-07, device='cuda:0') mean:  tensor(-2.6574e-10, device='cuda:0') min:  tensor(-1.9073e-06, device='cuda:0') norm:  tensor(1.2772e-05, device='cuda:0') MSE:  tensor(1.6094e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0050, device='cuda:0') mean:  tensor(8.3126e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0296, device='cuda:0') MSE:  tensor(3.7319e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1247, device='cuda:0')
min of d_p_list:  tensor(-0.1369, device='cuda:0')
Epoch:  124  
Training Loss: 0.5271350145339966
Test Loss:  0.5778124332427979
Test Acc:  0.0
Valid Loss:  0.4953083395957947
Valid Acc:  0.0
std:  0.20891841675797607 
thres:  0.0002203152947127819
Preserved_eigens number check:  512
 12%|█▏        | 124/1000 [37:55<4:14:58, 17.46s/it]Epoch:   125
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  496
Criterion check: 
Mean:  tensor(0.5791, device='cuda:0') 
Std:  tensor(16.6595, device='cuda:0') 
ABS Max:  tensor(249.1652, device='cuda:0') 
ABS Min:  tensor(9.5191e-05, device='cuda:0')
Criterion check:  tensor([ 1.0495,  0.9998,  1.0010,  0.9992,  0.9955,  0.8964,  1.0756, 40.6289,
         0.9483,  1.3956], device='cuda:0') tensor(97, device='cuda:0')
max of Lambda2 tensor(259346.5938, device='cuda:0')
min of Lambda2 tensor(7.2803e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1979, device='cuda:0')
min of grad d_p:  tensor(-0.1375, device='cuda:0')
max|min: (J_L, Jta/N)  (0.19792090356349945, 0.1979203075170517, ratio: 0.9999969601631165)|(-0.13745780289173126, -0.13745804131031036)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.1846e-06, device='cuda:0') mean:  tensor(1.3358e-10, device='cuda:0') min:  tensor(-4.6939e-07, device='cuda:0') norm:  tensor(7.8497e-06, device='cuda:0') MSE:  tensor(9.8913e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0102, device='cuda:0') mean:  tensor(1.3938e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0485, device='cuda:0') MSE:  tensor(6.1074e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.7448, device='cuda:0')
min of d_p_list:  tensor(-0.8646, device='cuda:0')
Epoch:  125  
Training Loss: 0.6579633951187134
Test Loss:  0.567317008972168
Test Acc:  0.0
Valid Loss:  0.7963447570800781
Valid Acc:  0.0
std:  0.24222763864290364 
thres:  0.00034632157236337666
Preserved_eigens number check:  512
 12%|█▎        | 125/1000 [38:12<4:15:22, 17.51s/it]Epoch:   126
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  495
Criterion check: 
Mean:  tensor(-0.3361, device='cuda:0') 
Std:  tensor(34.8782, device='cuda:0') 
ABS Max:  tensor(636.8264, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([1.0001, 1.0011, 0.9997, 1.0002, 1.0029, 0.9939, 0.9989, 1.0050, 1.0086,
        1.3809], device='cuda:0') tensor(104, device='cuda:0')
max of Lambda2 tensor(261291.9375, device='cuda:0')
min of Lambda2 tensor(3.1569e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.1496, device='cuda:0')
min of grad d_p:  tensor(-0.3665, device='cuda:0')
max|min: (J_L, Jta/N)  (1.1496044397354126, 1.149604082107544, ratio: 0.9999997019767761)|(-0.36653122305870056, -0.36653101444244385)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.1921e-06, device='cuda:0') mean:  tensor(-4.0374e-12, device='cuda:0') min:  tensor(-4.4703e-07, device='cuda:0') norm:  tensor(3.7045e-06, device='cuda:0') MSE:  tensor(4.6680e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0138, device='cuda:0') mean:  tensor(1.8038e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0712, device='cuda:0') MSE:  tensor(8.9702e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(3.5492, device='cuda:0')
min of d_p_list:  tensor(-4.6879, device='cuda:0')
Epoch:  126  
Training Loss: 105.01819610595703
Test Loss:  110.36190032958984
Test Acc:  0.0
Valid Loss:  114.65107727050781
Valid Acc:  0.0
std:  41.836296313867905 
thres:  0.02134636178612709
Preserved_eigens number check:  512
 13%|█▎        | 126/1000 [38:30<4:17:31, 17.68s/it]Epoch:   127
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  501
Criterion check: 
Mean:  tensor(-0.5428, device='cuda:0') 
Std:  tensor(22.4558, device='cuda:0') 
ABS Max:  tensor(492.8651, device='cuda:0') 
ABS Min:  tensor(5.5167e-05, device='cuda:0')
Criterion check:  tensor([1.0000, 0.9998, 1.0000, 1.0000, 0.9999, 0.9987, 1.0009, 1.0370, 0.9964,
        0.9584], device='cuda:0') tensor(103, device='cuda:0')
max of Lambda2 tensor(307057.7188, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(19.6516, device='cuda:0')
min of grad d_p:  tensor(-7.0135, device='cuda:0')
max|min: (J_L, Jta/N)  (19.651573181152344, 19.651565551757812, ratio: 0.9999995827674866)|(-7.013503551483154, -7.0135040283203125)

 check Jacobi res:  torch.Size([793601]) max:  tensor(7.6294e-06, device='cuda:0') mean:  tensor(-7.4520e-10, device='cuda:0') min:  tensor(-6.1989e-06, device='cuda:0') norm:  tensor(3.8021e-05, device='cuda:0') MSE:  tensor(4.7910e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0157, device='cuda:0') mean:  tensor(2.3681e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0821, device='cuda:0') MSE:  tensor(1.0339e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.3439, device='cuda:0')
min of d_p_list:  tensor(-0.5011, device='cuda:0')
Epoch:  127  
Training Loss: 6.174705505371094
Test Loss:  6.956836700439453
Test Acc:  0.0
Valid Loss:  6.1302995681762695
Valid Acc:  0.0
std:  41.288292359325624 
thres:  0.022557533943653105
Preserved_eigens number check:  512
 13%|█▎        | 127/1000 [38:48<4:16:53, 17.66s/it]Epoch:   128
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  497
Criterion check: 
Mean:  tensor(-0.2083, device='cuda:0') 
Std:  tensor(23.4589, device='cuda:0') 
ABS Max:  tensor(282.6750, device='cuda:0') 
ABS Min:  tensor(0.0009, device='cuda:0')
Criterion check:  tensor([ 0.9988,  0.9992,  0.9972,  1.0022,  0.9768,  1.1006,  1.2575,  1.2397,
         1.0253, -4.3712], device='cuda:0') tensor(117, device='cuda:0')
max of Lambda2 tensor(306823.4688, device='cuda:0')
min of Lambda2 tensor(6.4951e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(3.0706, device='cuda:0')
min of grad d_p:  tensor(-0.6566, device='cuda:0')
max|min: (J_L, Jta/N)  (3.0705652236938477, 3.0705618858337402, ratio: 0.999998927116394)|(-0.6566056609153748, -0.6566057801246643)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.3379e-06, device='cuda:0') mean:  tensor(5.0942e-11, device='cuda:0') min:  tensor(-5.3644e-07, device='cuda:0') norm:  tensor(7.9009e-06, device='cuda:0') MSE:  tensor(9.9558e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0227, device='cuda:0') mean:  tensor(4.1526e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1348, device='cuda:0') MSE:  tensor(1.6989e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.2369, device='cuda:0')
min of d_p_list:  tensor(-0.2839, device='cuda:0')
Epoch:  128  
Training Loss: 2.36434268951416
Test Loss:  2.575272560119629
Test Acc:  0.0
Valid Loss:  2.3522891998291016
Valid Acc:  0.0
std:  41.08549223946355 
thres:  0.022948468542099
Preserved_eigens number check:  512
 13%|█▎        | 128/1000 [39:05<4:13:52, 17.47s/it]Epoch:   129
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  500
Criterion check: 
Mean:  tensor(5.0477, device='cuda:0') 
Std:  tensor(102.0463, device='cuda:0') 
ABS Max:  tensor(2169.4863, device='cuda:0') 
ABS Min:  tensor(0.0013, device='cuda:0')
Criterion check:  tensor([ 1.0006,  0.9984,  1.0089,  1.0020,  1.0123,  1.0408,  0.8593, -1.7061,
         8.2725,  0.1018], device='cuda:0') tensor(167, device='cuda:0')
max of Lambda2 tensor(307654.4688, device='cuda:0')
min of Lambda2 tensor(1.8427e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.6191, device='cuda:0')
min of grad d_p:  tensor(-0.1172, device='cuda:0')
max|min: (J_L, Jta/N)  (0.6190922856330872, 0.6190903782844543, ratio: 0.9999969005584717)|(-0.11722458899021149, -0.11722423136234283)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.9073e-06, device='cuda:0') mean:  tensor(1.8880e-10, device='cuda:0') min:  tensor(-5.5134e-07, device='cuda:0') norm:  tensor(1.0012e-05, device='cuda:0') MSE:  tensor(1.2615e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0601, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.4388, device='cuda:0') MSE:  tensor(5.5287e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(1.1259, device='cuda:0')
min of d_p_list:  tensor(-0.8754, device='cuda:0')
Epoch:  129  
Training Loss: 0.5199962258338928
Test Loss:  0.5513595342636108
Test Acc:  0.0
Valid Loss:  0.6012378931045532
Valid Acc:  0.0
std:  41.08627149277431 
thres:  0.02294704078435898
Preserved_eigens number check:  512
 13%|█▎        | 129/1000 [39:22<4:13:26, 17.46s/it]Epoch:   130
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  499
Criterion check: 
Mean:  tensor(-0.4940, device='cuda:0') 
Std:  tensor(31.0308, device='cuda:0') 
ABS Max:  tensor(565.2444, device='cuda:0') 
ABS Min:  tensor(8.3669e-05, device='cuda:0')
Criterion check:  tensor([1.0004, 0.9971, 1.0006, 0.9999, 1.0061, 0.9995, 0.9912, 0.9426, 0.9892,
        1.2558], device='cuda:0') tensor(133, device='cuda:0')
max of Lambda2 tensor(311023.8750, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.7540, device='cuda:0')
min of grad d_p:  tensor(-0.5416, device='cuda:0')
max|min: (J_L, Jta/N)  (1.7539831399917603, 1.7539867162704468, ratio: 1.0000020265579224)|(-0.5415921807289124, -0.5415931940078735)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.6689e-06, device='cuda:0') mean:  tensor(-5.1072e-10, device='cuda:0') min:  tensor(-4.1723e-06, device='cuda:0') norm:  tensor(2.6281e-05, device='cuda:0') MSE:  tensor(3.3116e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0533, device='cuda:0') mean:  tensor(5.6807e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.2027, device='cuda:0') MSE:  tensor(2.5538e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.5535, device='cuda:0')
min of d_p_list:  tensor(-0.4418, device='cuda:0')
Epoch:  130  
Training Loss: 0.18011125922203064
Test Loss:  0.20169910788536072
Test Acc:  0.0
Valid Loss:  0.20358560979366302
Valid Acc:  0.0
std:  41.1385293040382 
thres:  0.022851470357179642
Preserved_eigens number check:  512
 13%|█▎        | 130/1000 [39:40<4:13:24, 17.48s/it]Epoch:   131
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  500
Criterion check: 
Mean:  tensor(-0.6337, device='cuda:0') 
Std:  tensor(14.4736, device='cuda:0') 
ABS Max:  tensor(323.9023, device='cuda:0') 
ABS Min:  tensor(3.6238e-05, device='cuda:0')
Criterion check:  tensor([0.9980, 0.9994, 0.9992, 0.9991, 0.9977, 1.0119, 0.9294, 0.8615, 1.0171,
        1.2215], device='cuda:0') tensor(93, device='cuda:0')
max of Lambda2 tensor(311128.0312, device='cuda:0')
min of Lambda2 tensor(1.5351e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.9065, device='cuda:0')
min of grad d_p:  tensor(-0.2209, device='cuda:0')
max|min: (J_L, Jta/N)  (0.9065182209014893, 0.9065142273902893, ratio: 0.9999955892562866)|(-0.22087550163269043, -0.2208753079175949)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.9935e-06, device='cuda:0') mean:  tensor(2.1701e-10, device='cuda:0') min:  tensor(-9.2387e-07, device='cuda:0') norm:  tensor(1.4854e-05, device='cuda:0') MSE:  tensor(1.8717e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0112, device='cuda:0') mean:  tensor(2.1676e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0671, device='cuda:0') MSE:  tensor(8.4488e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.8094, device='cuda:0')
min of d_p_list:  tensor(-0.6713, device='cuda:0')
Epoch:  131  
Training Loss: 0.5086140036582947
Test Loss:  0.5630590319633484
Test Acc:  0.0
Valid Loss:  0.6130130887031555
Valid Acc:  0.0
std:  2.2483249772182097 
thres:  0.0019495539367198945
Preserved_eigens number check:  512
 13%|█▎        | 131/1000 [39:57<4:13:37, 17.51s/it]Epoch:   132
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  500
Criterion check: 
Mean:  tensor(0.2466, device='cuda:0') 
Std:  tensor(3.8965, device='cuda:0') 
ABS Max:  tensor(45.6597, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([0.9998, 1.0012, 1.0000, 1.0002, 0.9990, 0.9977, 0.9966, 0.9213, 0.9370,
        0.9778], device='cuda:0') tensor(70, device='cuda:0')
max of Lambda2 tensor(312529.1562, device='cuda:0')
min of Lambda2 tensor(1.7676e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(2.0366, device='cuda:0')
min of grad d_p:  tensor(-0.5919, device='cuda:0')
max|min: (J_L, Jta/N)  (2.036588191986084, 2.036588430404663, ratio: 1.0000001192092896)|(-0.5919135808944702, -0.5919137597084045)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.8743e-07, device='cuda:0') mean:  tensor(-5.2709e-11, device='cuda:0') min:  tensor(-1.5497e-06, device='cuda:0') norm:  tensor(4.5678e-06, device='cuda:0') MSE:  tensor(5.7557e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0068, device='cuda:0') mean:  tensor(1.0070e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0332, device='cuda:0') MSE:  tensor(4.1807e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(5.5208, device='cuda:0')
min of d_p_list:  tensor(-4.2070, device='cuda:0')
Epoch:  132  
Training Loss: 215.8802490234375
Test Loss:  236.3501434326172
Test Acc:  0.0
Valid Loss:  203.22967529296875
Valid Acc:  0.0
std:  85.99823512617273 
thres:  0.04389066264033318
Preserved_eigens number check:  512
 13%|█▎        | 132/1000 [40:15<4:12:03, 17.42s/it]Epoch:   133
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  504
Criterion check: 
Mean:  tensor(4.1584, device='cuda:0') 
Std:  tensor(103.2897, device='cuda:0') 
ABS Max:  tensor(2323.2905, device='cuda:0') 
ABS Min:  tensor(7.4394e-05, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0006, 1.0000, 1.0006, 0.9957, 0.9975, 1.0076, 1.0089,
        1.0276], device='cuda:0') tensor(129, device='cuda:0')
max of Lambda2 tensor(407664.8750, device='cuda:0')
min of Lambda2 tensor(8.8896e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(31.5085, device='cuda:0')
min of grad d_p:  tensor(-8.7717, device='cuda:0')
max|min: (J_L, Jta/N)  (31.50848960876465, 31.50848960876465, ratio: 1.0)|(-8.77171802520752, -8.771713256835938)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.7166e-05, device='cuda:0') mean:  tensor(1.4384e-10, device='cuda:0') min:  tensor(-7.6294e-06, device='cuda:0') norm:  tensor(4.8170e-05, device='cuda:0') MSE:  tensor(6.0698e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0318, device='cuda:0') mean:  tensor(4.3076e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1495, device='cuda:0') MSE:  tensor(1.8837e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.3164, device='cuda:0')
min of d_p_list:  tensor(-0.2310, device='cuda:0')
Epoch:  133  
Training Loss: 15.51997184753418
Test Loss:  16.833782196044922
Test Acc:  0.0
Valid Loss:  14.217697143554688
Valid Acc:  0.0
std:  84.88148084921305 
thres:  0.04652178847193718
Preserved_eigens number check:  512
 13%|█▎        | 133/1000 [40:32<4:12:35, 17.48s/it]Epoch:   134
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  502
Criterion check: 
Mean:  tensor(-0.6240, device='cuda:0') 
Std:  tensor(19.7347, device='cuda:0') 
ABS Max:  tensor(355.9686, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([0.9988, 1.0001, 1.0009, 0.9998, 1.0016, 1.0018, 1.0902, 0.9767, 1.2142,
        0.8731], device='cuda:0') tensor(111, device='cuda:0')
max of Lambda2 tensor(407226.4688, device='cuda:0')
min of Lambda2 tensor(1.8540e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(4.0227, device='cuda:0')
min of grad d_p:  tensor(-2.4883, device='cuda:0')
max|min: (J_L, Jta/N)  (4.022731781005859, 4.022731304168701, ratio: 0.9999998807907104)|(-2.4883008003234863, -2.488302230834961)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.1458e-06, device='cuda:0') mean:  tensor(8.4028e-11, device='cuda:0') min:  tensor(-7.1526e-07, device='cuda:0') norm:  tensor(1.1948e-05, device='cuda:0') MSE:  tensor(1.5056e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0272, device='cuda:0') mean:  tensor(2.9618e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1049, device='cuda:0') MSE:  tensor(1.3213e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.3028, device='cuda:0')
min of d_p_list:  tensor(-0.4494, device='cuda:0')
Epoch:  134  
Training Loss: 3.9718661308288574
Test Loss:  4.342939376831055
Test Acc:  0.0
Valid Loss:  3.678615093231201
Valid Acc:  0.0
std:  84.51778141431434 
thres:  0.04721216245293617
Preserved_eigens number check:  512
 13%|█▎        | 134/1000 [40:50<4:14:35, 17.64s/it]Epoch:   135
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  501
Criterion check: 
Mean:  tensor(-16.9713, device='cuda:0') 
Std:  tensor(406.7181, device='cuda:0') 
ABS Max:  tensor(9190.5098, device='cuda:0') 
ABS Min:  tensor(0.0001, device='cuda:0')
Criterion check:  tensor([0.9844, 1.0023, 0.9983, 1.0046, 0.9893, 0.9592, 1.0045, 1.1547, 1.2065,
        1.1424], device='cuda:0') tensor(119, device='cuda:0')
max of Lambda2 tensor(408402.2812, device='cuda:0')
min of Lambda2 tensor(1.8963e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.0418, device='cuda:0')
min of grad d_p:  tensor(-0.7803, device='cuda:0')
max|min: (J_L, Jta/N)  (1.0417546033859253, 1.0417546033859253, ratio: 1.0)|(-0.7802801132202148, -0.7802836894989014)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.5763e-06, device='cuda:0') mean:  tensor(3.5801e-10, device='cuda:0') min:  tensor(-1.0580e-06, device='cuda:0') norm:  tensor(1.9427e-05, device='cuda:0') MSE:  tensor(2.4479e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0324, device='cuda:0') mean:  tensor(5.0223e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1718, device='cuda:0') MSE:  tensor(2.1645e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.7289, device='cuda:0')
min of d_p_list:  tensor(-0.4242, device='cuda:0')
Epoch:  135  
Training Loss: 2.6594483852386475
Test Loss:  2.753385066986084
Test Acc:  0.0
Valid Loss:  2.463656187057495
Valid Acc:  0.0
std:  84.24722896900774 
thres:  0.0477080298781395
Preserved_eigens number check:  512
 14%|█▎        | 135/1000 [41:08<4:13:54, 17.61s/it]Epoch:   136
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  500
Criterion check: 
Mean:  tensor(-0.1198, device='cuda:0') 
Std:  tensor(10.5837, device='cuda:0') 
ABS Max:  tensor(138.8399, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([1.0007, 1.0000, 1.0009, 0.9998, 1.0001, 1.0011, 1.0614, 1.0394, 0.9466,
        1.0314], device='cuda:0') tensor(97, device='cuda:0')
max of Lambda2 tensor(410379.5625, device='cuda:0')
min of Lambda2 tensor(7.1176e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.9364, device='cuda:0')
min of grad d_p:  tensor(-3.2953, device='cuda:0')
max|min: (J_L, Jta/N)  (0.9363953471183777, 0.9363950490951538, ratio: 0.9999997019767761)|(-3.295269250869751, -3.29526424407959)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.0729e-06, device='cuda:0') mean:  tensor(-3.5882e-10, device='cuda:0') min:  tensor(-5.0068e-06, device='cuda:0') norm:  tensor(2.3444e-05, device='cuda:0') MSE:  tensor(2.9541e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0203, device='cuda:0') mean:  tensor(2.8464e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1056, device='cuda:0') MSE:  tensor(1.3308e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(1.9282, device='cuda:0')
min of d_p_list:  tensor(-1.5188, device='cuda:0')
Epoch:  136  
Training Loss: 13.628914833068848
Test Loss:  13.733963012695312
Test Acc:  0.0
Valid Loss:  13.541635513305664
Valid Acc:  0.0
std:  82.93027277101427 
thres:  0.05033209004402161
Preserved_eigens number check:  512
 14%|█▎        | 136/1000 [41:25<4:11:39, 17.48s/it]Epoch:   137
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  502
Criterion check: 
Mean:  tensor(-0.2413, device='cuda:0') 
Std:  tensor(7.0284, device='cuda:0') 
ABS Max:  tensor(115.5517, device='cuda:0') 
ABS Min:  tensor(0.0001, device='cuda:0')
Criterion check:  tensor([0.9998, 1.0004, 0.9998, 0.9967, 0.9851, 0.9758, 0.9984, 0.9957, 0.9753,
        1.0218], device='cuda:0') tensor(86, device='cuda:0')
max of Lambda2 tensor(419773.4375, device='cuda:0')
min of Lambda2 tensor(9.3941e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(4.2973, device='cuda:0')
min of grad d_p:  tensor(-1.1419, device='cuda:0')
max|min: (J_L, Jta/N)  (4.297253131866455, 4.297255992889404, ratio: 1.0000007152557373)|(-1.1418648958206177, -1.1418660879135132)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.1458e-06, device='cuda:0') mean:  tensor(-1.9191e-10, device='cuda:0') min:  tensor(-5.7220e-06, device='cuda:0') norm:  tensor(3.4349e-05, device='cuda:0') MSE:  tensor(4.3282e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0098, device='cuda:0') mean:  tensor(1.6753e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0561, device='cuda:0') MSE:  tensor(7.0710e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.4459, device='cuda:0')
min of d_p_list:  tensor(-0.3641, device='cuda:0')
Epoch:  137  
Training Loss: 3.683936357498169
Test Loss:  3.7227065563201904
Test Acc:  0.0
Valid Loss:  3.5862972736358643
Valid Acc:  0.0
std:  5.505506124917101 
thres:  0.00789282751083374
Preserved_eigens number check:  512
 14%|█▎        | 137/1000 [41:43<4:13:14, 17.61s/it]Epoch:   138
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  501
Criterion check: 
Mean:  tensor(0.1958, device='cuda:0') 
Std:  tensor(5.7090, device='cuda:0') 
ABS Max:  tensor(93.0651, device='cuda:0') 
ABS Min:  tensor(8.2931e-05, device='cuda:0')
Criterion check:  tensor([ 0.9846,  1.0005,  1.0005,  0.9987,  1.0152,  1.0754,  0.9781,  0.9658,
         1.1077, -0.3831], device='cuda:0') tensor(100, device='cuda:0')
max of Lambda2 tensor(420758.6250, device='cuda:0')
min of Lambda2 tensor(7.1187e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.5905, device='cuda:0')
min of grad d_p:  tensor(-1.5812, device='cuda:0')
max|min: (J_L, Jta/N)  (1.5904546976089478, 1.590456485748291, ratio: 1.000001072883606)|(-1.5811752080917358, -1.5811742544174194)

 check Jacobi res:  torch.Size([793601]) max:  tensor(7.3016e-07, device='cuda:0') mean:  tensor(-1.7047e-10, device='cuda:0') min:  tensor(-1.7881e-06, device='cuda:0') norm:  tensor(1.1035e-05, device='cuda:0') MSE:  tensor(1.3905e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0618, device='cuda:0') mean:  tensor(2.9798e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1226, device='cuda:0') MSE:  tensor(1.5453e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.9231, device='cuda:0')
min of d_p_list:  tensor(-0.7578, device='cuda:0')
Epoch:  138  
Training Loss: 4.112452983856201
Test Loss:  4.281976699829102
Test Acc:  0.0
Valid Loss:  4.2919206619262695
Valid Acc:  0.0
std:  4.040905640170873 
thres:  0.005611323738098145
Preserved_eigens number check:  512
 14%|█▍        | 138/1000 [42:00<4:10:53, 17.46s/it]Epoch:   139
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  502
Criterion check: 
Mean:  tensor(0.7078, device='cuda:0') 
Std:  tensor(10.1576, device='cuda:0') 
ABS Max:  tensor(181.3056, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([  1.0096,   1.0002,   0.9999,   1.0000,   0.9961,   1.4855,   0.9394,
          0.9978,   0.8607, -14.3494], device='cuda:0') tensor(103, device='cuda:0')
max of Lambda2 tensor(425177.2500, device='cuda:0')
min of Lambda2 tensor(1.1038e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(3.1290, device='cuda:0')
min of grad d_p:  tensor(-2.6850, device='cuda:0')
max|min: (J_L, Jta/N)  (3.12904691696167, 3.1290442943573, ratio: 0.9999991655349731)|(-2.6849818229675293, -2.684978723526001)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.6226e-06, device='cuda:0') mean:  tensor(-1.8573e-11, device='cuda:0') min:  tensor(-5.1260e-06, device='cuda:0') norm:  tensor(1.8608e-05, device='cuda:0') MSE:  tensor(2.3448e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0317, device='cuda:0') mean:  tensor(3.2853e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1301, device='cuda:0') MSE:  tensor(1.6396e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.4700, device='cuda:0')
min of d_p_list:  tensor(-0.4117, device='cuda:0')
Epoch:  139  
Training Loss: 4.59099006652832
Test Loss:  4.743566036224365
Test Acc:  0.0
Valid Loss:  4.908084869384766
Valid Acc:  0.0
std:  3.998029230247791 
thres:  0.005735148525238037
Preserved_eigens number check:  512
 14%|█▍        | 139/1000 [42:18<4:10:40, 17.47s/it]Epoch:   140
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  503
Criterion check: 
Mean:  tensor(6.0813, device='cuda:0') 
Std:  tensor(75.1524, device='cuda:0') 
ABS Max:  tensor(1374.0878, device='cuda:0') 
ABS Min:  tensor(0.0060, device='cuda:0')
Criterion check:  tensor([ 0.9985,  1.0048,  0.9957,  1.0080,  0.5682,  1.6102,  1.0622,  1.4457,
         0.8220, -4.3459], device='cuda:0') tensor(197, device='cuda:0')
max of Lambda2 tensor(425650.6562, device='cuda:0')
min of Lambda2 tensor(5.8015e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.4730, device='cuda:0')
min of grad d_p:  tensor(-2.0822, device='cuda:0')
max|min: (J_L, Jta/N)  (1.4729684591293335, 1.4729692935943604, ratio: 1.0000005960464478)|(-2.0821566581726074, -2.082151412963867)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.0133e-06, device='cuda:0') mean:  tensor(-2.3559e-10, device='cuda:0') min:  tensor(-5.2452e-06, device='cuda:0') norm:  tensor(1.8544e-05, device='cuda:0') MSE:  tensor(2.3367e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.1233, device='cuda:0') mean:  tensor(0.0002, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.7538, device='cuda:0') MSE:  tensor(9.4987e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.3167, device='cuda:0')
min of d_p_list:  tensor(-0.4290, device='cuda:0')
Epoch:  140  
Training Loss: 1.5453150272369385
Test Loss:  1.4969717264175415
Test Acc:  0.0
Valid Loss:  1.5714384317398071
Valid Acc:  0.0
std:  4.189694580550619 
thres:  0.005512321853637696
Preserved_eigens number check:  512
 14%|█▍        | 140/1000 [42:35<4:12:17, 17.60s/it]Epoch:   141
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  502
Criterion check: 
Mean:  tensor(0.0184, device='cuda:0') 
Std:  tensor(3.1367, device='cuda:0') 
ABS Max:  tensor(53.7817, device='cuda:0') 
ABS Min:  tensor(4.7925e-05, device='cuda:0')
Criterion check:  tensor([0.9977, 1.1651, 0.9997, 1.0061, 1.0024, 1.4145, 0.8460, 1.1256, 1.0415,
        0.7750], device='cuda:0') tensor(71, device='cuda:0')
max of Lambda2 tensor(426575.9375, device='cuda:0')
min of Lambda2 tensor(2.8183e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2727, device='cuda:0')
min of grad d_p:  tensor(-1.3400, device='cuda:0')
max|min: (J_L, Jta/N)  (0.2726992666721344, 0.2726992070674896, ratio: 0.9999997615814209)|(-1.340047836303711, -1.3400497436523438)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.9802e-06, device='cuda:0') mean:  tensor(3.4869e-10, device='cuda:0') min:  tensor(-1.0580e-06, device='cuda:0') norm:  tensor(1.6514e-05, device='cuda:0') MSE:  tensor(2.0809e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0118, device='cuda:0') mean:  tensor(1.7567e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0611, device='cuda:0') MSE:  tensor(7.6930e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.2312, device='cuda:0')
min of d_p_list:  tensor(-0.2174, device='cuda:0')
Epoch:  141  
Training Loss: 1.4189881086349487
Test Loss:  1.4518647193908691
Test Acc:  0.0
Valid Loss:  1.541227102279663
Valid Acc:  0.0
std:  1.3287242620268696 
thres:  0.0030703365087509154
Preserved_eigens number check:  512
 14%|█▍        | 141/1000 [42:52<4:09:33, 17.43s/it]Epoch:   142
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  502
Criterion check: 
Mean:  tensor(1.4053, device='cuda:0') 
Std:  tensor(33.0570, device='cuda:0') 
ABS Max:  tensor(736.9820, device='cuda:0') 
ABS Min:  tensor(0.0006, device='cuda:0')
Criterion check:  tensor([ 1.0337,  0.9982,  0.9842,  0.9991,  0.9689,  6.1849,  0.9902,  1.5207,
        -8.4745,  3.3583], device='cuda:0') tensor(92, device='cuda:0')
max of Lambda2 tensor(427030.0938, device='cuda:0')
min of Lambda2 tensor(1.1194e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1407, device='cuda:0')
min of grad d_p:  tensor(-0.1064, device='cuda:0')
max|min: (J_L, Jta/N)  (0.1407446265220642, 0.1407439410686493, ratio: 0.9999951124191284)|(-0.10643606632947922, -0.10643398016691208)

 check Jacobi res:  torch.Size([793601]) max:  tensor(7.9349e-07, device='cuda:0') mean:  tensor(-2.9098e-11, device='cuda:0') min:  tensor(-2.0862e-06, device='cuda:0') norm:  tensor(7.4037e-06, device='cuda:0') MSE:  tensor(9.3292e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0319, device='cuda:0') mean:  tensor(4.1980e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1522, device='cuda:0') MSE:  tensor(1.9184e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.5387, device='cuda:0')
min of d_p_list:  tensor(-1.0177, device='cuda:0')
Epoch:  142  
Training Loss: 2.606269359588623
Test Loss:  2.7975192070007324
Test Acc:  0.0
Valid Loss:  2.6355409622192383
Valid Acc:  0.0
std:  1.2987779745103885 
thres:  0.0028548031091690062
Preserved_eigens number check:  512
 14%|█▍        | 142/1000 [43:10<4:08:15, 17.36s/it]Epoch:   143
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  501
Criterion check: 
Mean:  tensor(-0.0065, device='cuda:0') 
Std:  tensor(0.8772, device='cuda:0') 
ABS Max:  tensor(9.9622, device='cuda:0') 
ABS Min:  tensor(3.1642e-05, device='cuda:0')
Criterion check:  tensor([1.0009, 1.0000, 1.0000, 0.9996, 1.0014, 0.9979, 1.0467, 1.0862, 1.0144,
        1.0202], device='cuda:0') tensor(37, device='cuda:0')
max of Lambda2 tensor(430884.5000, device='cuda:0')
min of Lambda2 tensor(7.5924e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(2.4395, device='cuda:0')
min of grad d_p:  tensor(-2.8324, device='cuda:0')
max|min: (J_L, Jta/N)  (2.439499855041504, 2.439497232437134, ratio: 0.999998927116394)|(-2.8323564529418945, -2.832360029220581)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.5763e-06, device='cuda:0') mean:  tensor(3.1986e-10, device='cuda:0') min:  tensor(-1.1008e-06, device='cuda:0') norm:  tensor(1.7066e-05, device='cuda:0') MSE:  tensor(2.1505e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0081, device='cuda:0') mean:  tensor(8.0344e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0309, device='cuda:0') MSE:  tensor(3.8935e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.2695, device='cuda:0')
min of d_p_list:  tensor(-0.4596, device='cuda:0')
Epoch:  143  
Training Loss: 1.7251344919204712
Test Loss:  1.7201157808303833
Test Acc:  0.0
Valid Loss:  1.7675694227218628
Valid Acc:  0.0
std:  1.182263185291192 
thres:  0.0023773394107818604
Preserved_eigens number check:  512
 14%|█▍        | 143/1000 [43:28<4:10:19, 17.53s/it]Epoch:   144
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  501
Criterion check: 
Mean:  tensor(-0.0160, device='cuda:0') 
Std:  tensor(2.0791, device='cuda:0') 
ABS Max:  tensor(37.3957, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([1.0021, 1.0002, 0.9989, 0.9994, 1.0028, 3.0959, 1.2080, 0.9980, 1.0025,
        1.3633], device='cuda:0') tensor(45, device='cuda:0')
max of Lambda2 tensor(431788.5312, device='cuda:0')
min of Lambda2 tensor(9.4865e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1602, device='cuda:0')
min of grad d_p:  tensor(-0.2830, device='cuda:0')
max|min: (J_L, Jta/N)  (0.16024954617023468, 0.16024979948997498, ratio: 1.0000015497207642)|(-0.282988041639328, -0.2829910218715668)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.9802e-06, device='cuda:0') mean:  tensor(2.8165e-10, device='cuda:0') min:  tensor(-1.0021e-06, device='cuda:0') norm:  tensor(1.6495e-05, device='cuda:0') MSE:  tensor(2.0785e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0065, device='cuda:0') mean:  tensor(8.7085e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0329, device='cuda:0') MSE:  tensor(4.1505e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.6414, device='cuda:0')
min of d_p_list:  tensor(-0.4360, device='cuda:0')
Epoch:  144  
Training Loss: 1.4119088649749756
Test Loss:  1.4834065437316895
Test Acc:  0.0
Valid Loss:  1.3803045749664307
Valid Acc:  0.0
std:  0.4470406362626678 
thres:  0.0017415231704711914
Preserved_eigens number check:  512
 14%|█▍        | 144/1000 [43:45<4:09:25, 17.48s/it]Epoch:   145
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  500
Criterion check: 
Mean:  tensor(-13.8963, device='cuda:0') 
Std:  tensor(530.3928, device='cuda:0') 
ABS Max:  tensor(8310.8174, device='cuda:0') 
ABS Min:  tensor(0.0006, device='cuda:0')
Criterion check:  tensor([ 0.9793,  1.0075,  0.9985,  1.0088,  0.9515,  1.2533,  0.9308,  2.3198,
        -0.4213,  8.0423], device='cuda:0') tensor(156, device='cuda:0')
max of Lambda2 tensor(433831.9062, device='cuda:0')
min of Lambda2 tensor(4.3418e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.4943, device='cuda:0')
min of grad d_p:  tensor(-0.3098, device='cuda:0')
max|min: (J_L, Jta/N)  (0.4942989647388458, 0.4942990839481354, ratio: 1.000000238418579)|(-0.30982232093811035, -0.3098222017288208)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.4976e-06, device='cuda:0') mean:  tensor(2.0087e-12, device='cuda:0') min:  tensor(-1.0766e-06, device='cuda:0') norm:  tensor(6.0335e-06, device='cuda:0') MSE:  tensor(7.6027e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.1512, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.5302, device='cuda:0') MSE:  tensor(6.6810e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.2470, device='cuda:0')
min of d_p_list:  tensor(-0.3452, device='cuda:0')
Epoch:  145  
Training Loss: 0.29774558544158936
Test Loss:  0.3193047344684601
Test Acc:  0.0
Valid Loss:  0.292366087436676
Valid Acc:  0.0
std:  0.7394507190466203 
thres:  0.0014920092821121215
Preserved_eigens number check:  512
 14%|█▍        | 145/1000 [44:02<4:07:30, 17.37s/it]Epoch:   146
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  505
Criterion check: 
Mean:  tensor(0.0502, device='cuda:0') 
Std:  tensor(2.3136, device='cuda:0') 
ABS Max:  tensor(36.0896, device='cuda:0') 
ABS Min:  tensor(0.0001, device='cuda:0')
Criterion check:  tensor([ 1.0020,  1.0001,  0.9981,  1.0010,  0.9231,  1.1798,  1.1630, -1.2510,
         1.3728,  0.8066], device='cuda:0') tensor(54, device='cuda:0')
max of Lambda2 tensor(435359.3750, device='cuda:0')
min of Lambda2 tensor(1.5321e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2612, device='cuda:0')
min of grad d_p:  tensor(-0.0933, device='cuda:0')
max|min: (J_L, Jta/N)  (0.26117807626724243, 0.26117509603500366, ratio: 0.9999886155128479)|(-0.09334863722324371, -0.09334742277860641)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.9802e-06, device='cuda:0') mean:  tensor(3.2847e-10, device='cuda:0') min:  tensor(-1.2144e-06, device='cuda:0') norm:  tensor(1.7522e-05, device='cuda:0') MSE:  tensor(2.2080e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0182, device='cuda:0') mean:  tensor(1.1053e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0495, device='cuda:0') MSE:  tensor(6.2314e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1440, device='cuda:0')
min of d_p_list:  tensor(-0.0906, device='cuda:0')
Epoch:  146  
Training Loss: 0.10833200812339783
Test Loss:  0.12091264128684998
Test Acc:  0.0
Valid Loss:  0.11368938535451889
Valid Acc:  0.0
std:  0.9273191094232959 
thres:  0.0012298780620098114
Preserved_eigens number check:  512
 15%|█▍        | 146/1000 [44:20<4:08:21, 17.45s/it]Epoch:   147
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  498
Criterion check: 
Mean:  tensor(0.2746, device='cuda:0') 
Std:  tensor(4.2565, device='cuda:0') 
ABS Max:  tensor(84.8016, device='cuda:0') 
ABS Min:  tensor(1.4912e-05, device='cuda:0')
Criterion check:  tensor([ 1.0024,  0.9959,  0.9977,  1.0035,  1.0524,  0.9634,  1.0705, -4.2123,
         3.1929,  0.8003], device='cuda:0') tensor(34, device='cuda:0')
max of Lambda2 tensor(435359.5000, device='cuda:0')
min of Lambda2 tensor(3.2287e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0543, device='cuda:0')
min of grad d_p:  tensor(-0.0162, device='cuda:0')
max|min: (J_L, Jta/N)  (0.05425002798438072, 0.05425100401043892, ratio: 1.0000180006027222)|(-0.016187500208616257, -0.016187595203518867)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.2655e-07, device='cuda:0') mean:  tensor(-9.6786e-11, device='cuda:0') min:  tensor(-1.1176e-06, device='cuda:0') norm:  tensor(6.7823e-06, device='cuda:0') MSE:  tensor(8.5463e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0064, device='cuda:0') mean:  tensor(5.7176e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0222, device='cuda:0') MSE:  tensor(2.8029e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.8640, device='cuda:0')
min of d_p_list:  tensor(-0.7608, device='cuda:0')
Epoch:  147  
Training Loss: 0.9879574775695801
Test Loss:  0.9871799945831299
Test Acc:  0.0
Valid Loss:  0.9947936534881592
Valid Acc:  0.0
std:  0.6228787280260079 
thres:  0.0009062156856060029
Preserved_eigens number check:  512
 15%|█▍        | 147/1000 [44:37<4:07:52, 17.44s/it]Epoch:   148
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  501
Criterion check: 
Mean:  tensor(-0.0337, device='cuda:0') 
Std:  tensor(2.7166, device='cuda:0') 
ABS Max:  tensor(30.3645, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([0.9955, 1.0171, 0.9997, 1.0075, 0.7239, 1.0692, 1.0941, 0.8725, 1.1896,
        1.0587], device='cuda:0') tensor(71, device='cuda:0')
max of Lambda2 tensor(434398.7812, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.5609, device='cuda:0')
min of grad d_p:  tensor(-1.6410, device='cuda:0')
max|min: (J_L, Jta/N)  (0.5609405636787415, 0.5609400272369385, ratio: 0.9999990463256836)|(-1.6409761905670166, -1.640978455543518)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.2650e-06, device='cuda:0') mean:  tensor(1.1846e-10, device='cuda:0') min:  tensor(-5.4389e-07, device='cuda:0') norm:  tensor(9.2728e-06, device='cuda:0') MSE:  tensor(1.1684e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0416, device='cuda:0') mean:  tensor(2.5759e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1095, device='cuda:0') MSE:  tensor(1.3803e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.3963, device='cuda:0')
min of d_p_list:  tensor(-0.3559, device='cuda:0')
Epoch:  148  
Training Loss: 0.20870515704154968
Test Loss:  0.18040324747562408
Test Acc:  0.0
Valid Loss:  0.22591203451156616
Valid Acc:  0.0
std:  0.5090915221692404 
thres:  0.0006029298186302186
Preserved_eigens number check:  512
 15%|█▍        | 148/1000 [44:55<4:08:08, 17.47s/it]Epoch:   149
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  502
Criterion check: 
Mean:  tensor(0.4293, device='cuda:0') 
Std:  tensor(8.7375, device='cuda:0') 
ABS Max:  tensor(154.9091, device='cuda:0') 
ABS Min:  tensor(0.0001, device='cuda:0')
Criterion check:  tensor([0.9981, 1.0005, 0.9999, 0.9988, 1.0018, 0.4504, 1.0346, 0.7916, 1.1436,
        2.2770], device='cuda:0') tensor(62, device='cuda:0')
max of Lambda2 tensor(433821.7188, device='cuda:0')
min of Lambda2 tensor(1.3453e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.7143, device='cuda:0')
min of grad d_p:  tensor(-0.3579, device='cuda:0')
max|min: (J_L, Jta/N)  (0.7143186330795288, 0.7143165469169617, ratio: 0.999997079372406)|(-0.3578885495662689, -0.35788941383361816)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.0862e-06, device='cuda:0') mean:  tensor(2.1729e-10, device='cuda:0') min:  tensor(-7.7486e-07, device='cuda:0') norm:  tensor(1.1951e-05, device='cuda:0') MSE:  tensor(1.5059e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0178, device='cuda:0') mean:  tensor(2.0628e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0738, device='cuda:0') MSE:  tensor(9.2964e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1619, device='cuda:0')
min of d_p_list:  tensor(-0.2029, device='cuda:0')
Epoch:  149  
Training Loss: 0.1555696725845337
Test Loss:  0.14265000820159912
Test Acc:  0.0
Valid Loss:  0.16953855752944946
Valid Acc:  0.0
std:  0.3243076500179609 
thres:  0.00035166198015213016
Preserved_eigens number check:  512
 15%|█▍        | 149/1000 [45:12<4:07:27, 17.45s/it]Epoch:   150
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  499
Criterion check: 
Mean:  tensor(0.2362, device='cuda:0') 
Std:  tensor(13.7574, device='cuda:0') 
ABS Max:  tensor(256.9573, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([  0.8715,   0.9758,   1.0178,   0.9830,   0.8710,   0.9424,   1.0243,
          0.8052,   0.6448, -68.5480], device='cuda:0') tensor(70, device='cuda:0')
max of Lambda2 tensor(433829.2500, device='cuda:0')
min of Lambda2 tensor(1.7215e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0448, device='cuda:0')
min of grad d_p:  tensor(-0.0284, device='cuda:0')
max|min: (J_L, Jta/N)  (0.04478544369339943, 0.044786155223846436, ratio: 1.0000158548355103)|(-0.028403736650943756, -0.028402041643857956)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.3551e-07, device='cuda:0') mean:  tensor(-1.5320e-10, device='cuda:0') min:  tensor(-1.6950e-06, device='cuda:0') norm:  tensor(8.7014e-06, device='cuda:0') MSE:  tensor(1.0964e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0209, device='cuda:0') mean:  tensor(3.7097e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1295, device='cuda:0') MSE:  tensor(1.6314e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(6.9849, device='cuda:0')
min of d_p_list:  tensor(-5.6308, device='cuda:0')
Epoch:  150  
Training Loss: 76.25109100341797
Test Loss:  78.89104461669922
Test Acc:  0.0
Valid Loss:  70.29049682617188
Valid Acc:  0.0
std:  30.35610040931794 
thres:  0.015542331063747406
Preserved_eigens number check:  512
 15%|█▌        | 150/1000 [45:30<4:09:00, 17.58s/it]Epoch:   151
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  502
Criterion check: 
Mean:  tensor(7.7180, device='cuda:0') 
Std:  tensor(146.7070, device='cuda:0') 
ABS Max:  tensor(3268.4409, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0001, 1.0000, 0.9983, 1.0067, 0.9971, 1.0082, 0.9948,
        0.9980], device='cuda:0') tensor(155, device='cuda:0')
max of Lambda2 tensor(499143.3750, device='cuda:0')
min of Lambda2 tensor(1.7314e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(41.6026, device='cuda:0')
min of grad d_p:  tensor(-19.5559, device='cuda:0')
max|min: (J_L, Jta/N)  (41.60256576538086, 41.60255432128906, ratio: 0.9999997019767761)|(-19.555931091308594, -19.555925369262695)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.1444e-05, device='cuda:0') mean:  tensor(-5.2253e-10, device='cuda:0') min:  tensor(-1.1444e-05, device='cuda:0') norm:  tensor(5.4613e-05, device='cuda:0') MSE:  tensor(6.8817e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0634, device='cuda:0') mean:  tensor(7.1589e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.2869, device='cuda:0') MSE:  tensor(3.6155e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.9890, device='cuda:0')
min of d_p_list:  tensor(-1.2860, device='cuda:0')
Epoch:  151  
Training Loss: 18.88125228881836
Test Loss:  19.524778366088867
Test Acc:  0.0
Valid Loss:  17.913169860839844
Valid Acc:  0.0
std:  29.359563079951055 
thres:  0.0192969151198864
Preserved_eigens number check:  512
 15%|█▌        | 151/1000 [45:47<4:07:15, 17.47s/it]Epoch:   152
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  502
Criterion check: 
Mean:  tensor(0.4510, device='cuda:0') 
Std:  tensor(13.0005, device='cuda:0') 
ABS Max:  tensor(272.5699, device='cuda:0') 
ABS Min:  tensor(0.0004, device='cuda:0')
Criterion check:  tensor([1.0005, 1.0001, 1.0001, 0.9999, 1.0009, 0.9996, 0.9950, 0.9948, 1.0014,
        1.0138], device='cuda:0') tensor(83, device='cuda:0')
max of Lambda2 tensor(500509.3750, device='cuda:0')
min of Lambda2 tensor(1.0884e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(7.1009, device='cuda:0')
min of grad d_p:  tensor(-5.0972, device='cuda:0')
max|min: (J_L, Jta/N)  (7.100918769836426, 7.100926399230957, ratio: 1.000001072883606)|(-5.097172737121582, -5.097168922424316)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.4736e-06, device='cuda:0') mean:  tensor(-7.3744e-10, device='cuda:0') min:  tensor(-9.4175e-06, device='cuda:0') norm:  tensor(4.2644e-05, device='cuda:0') MSE:  tensor(5.3735e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0180, device='cuda:0') mean:  tensor(2.1917e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0813, device='cuda:0') MSE:  tensor(1.0246e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.2912, device='cuda:0')
min of d_p_list:  tensor(-0.3031, device='cuda:0')
Epoch:  152  
Training Loss: 12.538942337036133
Test Loss:  13.233202934265137
Test Acc:  0.0
Valid Loss:  12.101472854614258
Valid Acc:  0.0
std:  28.261942386074576 
thres:  0.02160711209177971
Preserved_eigens number check:  512
 15%|█▌        | 152/1000 [46:04<4:06:14, 17.42s/it]Epoch:   153
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  504
Criterion check: 
Mean:  tensor(1.3337, device='cuda:0') 
Std:  tensor(18.8126, device='cuda:0') 
ABS Max:  tensor(378.3453, device='cuda:0') 
ABS Min:  tensor(0.0004, device='cuda:0')
Criterion check:  tensor([0.9971, 1.0006, 1.0005, 0.9999, 1.0036, 1.0014, 1.0026, 1.0264, 0.9952,
        1.0303], device='cuda:0') tensor(72, device='cuda:0')
max of Lambda2 tensor(499417.4375, device='cuda:0')
min of Lambda2 tensor(9.8169e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3931, device='cuda:0')
min of grad d_p:  tensor(-0.3821, device='cuda:0')
max|min: (J_L, Jta/N)  (0.39305731654167175, 0.3930577337741852, ratio: 1.000001072883606)|(-0.3821009397506714, -0.38210102915763855)

 check Jacobi res:  torch.Size([793601]) max:  tensor(6.7055e-07, device='cuda:0') mean:  tensor(-3.7260e-12, device='cuda:0') min:  tensor(-7.4506e-07, device='cuda:0') norm:  tensor(4.2401e-06, device='cuda:0') MSE:  tensor(5.3429e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0153, device='cuda:0') mean:  tensor(1.9802e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0743, device='cuda:0') MSE:  tensor(9.3569e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.2929, device='cuda:0')
min of d_p_list:  tensor(-0.1609, device='cuda:0')
Epoch:  153  
Training Loss: 7.122401237487793
Test Loss:  7.339689254760742
Test Acc:  0.0
Valid Loss:  6.940590858459473
Valid Acc:  0.0
std:  27.335113417208387 
thres:  0.022989851307868958
Preserved_eigens number check:  512
 15%|█▌        | 153/1000 [46:21<4:04:17, 17.31s/it]Epoch:   154
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  503
Criterion check: 
Mean:  tensor(0.0288, device='cuda:0') 
Std:  tensor(7.2730, device='cuda:0') 
ABS Max:  tensor(113.7040, device='cuda:0') 
ABS Min:  tensor(0.0006, device='cuda:0')
Criterion check:  tensor([1.0149, 0.9993, 0.9997, 1.0027, 0.9954, 0.9972, 0.9862, 1.0179, 1.0298,
        1.2748], device='cuda:0') tensor(92, device='cuda:0')
max of Lambda2 tensor(499308.3438, device='cuda:0')
min of Lambda2 tensor(1.9618e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.7270, device='cuda:0')
min of grad d_p:  tensor(-0.5422, device='cuda:0')
max|min: (J_L, Jta/N)  (0.7270352840423584, 0.7270365357398987, ratio: 1.0000016689300537)|(-0.5421993732452393, -0.5421947240829468)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.5832e-06, device='cuda:0') mean:  tensor(-4.6051e-10, device='cuda:0') min:  tensor(-6.0797e-06, device='cuda:0') norm:  tensor(2.6325e-05, device='cuda:0') MSE:  tensor(3.3172e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0199, device='cuda:0') mean:  tensor(2.8283e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1117, device='cuda:0') MSE:  tensor(1.4077e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1175, device='cuda:0')
min of d_p_list:  tensor(-0.1752, device='cuda:0')
Epoch:  154  
Training Loss: 3.3580095767974854
Test Loss:  3.520972728729248
Test Acc:  0.0
Valid Loss:  3.2848117351531982
Valid Acc:  0.0
std:  26.825345460383403 
thres:  0.023630339288711548
Preserved_eigens number check:  512
 15%|█▌        | 154/1000 [46:39<4:05:22, 17.40s/it]Epoch:   155
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  501
Criterion check: 
Mean:  tensor(0.0007, device='cuda:0') 
Std:  tensor(4.6228, device='cuda:0') 
ABS Max:  tensor(66.8863, device='cuda:0') 
ABS Min:  tensor(0.0001, device='cuda:0')
Criterion check:  tensor([0.9901, 1.0001, 0.9978, 0.9819, 0.9293, 1.0615, 0.8776, 1.0593, 0.8590,
        1.2587], device='cuda:0') tensor(77, device='cuda:0')
max of Lambda2 tensor(498176., device='cuda:0')
min of Lambda2 tensor(6.1000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2560, device='cuda:0')
min of grad d_p:  tensor(-0.2141, device='cuda:0')
max|min: (J_L, Jta/N)  (0.2560364603996277, 0.256034791469574, ratio: 0.9999935030937195)|(-0.2140626460313797, -0.21406248211860657)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.9558e-06, device='cuda:0') mean:  tensor(2.1337e-10, device='cuda:0') min:  tensor(-5.5134e-07, device='cuda:0') norm:  tensor(1.1212e-05, device='cuda:0') MSE:  tensor(1.4128e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0134, device='cuda:0') mean:  tensor(2.0680e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0818, device='cuda:0') MSE:  tensor(1.0307e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.2221, device='cuda:0')
min of d_p_list:  tensor(-0.4283, device='cuda:0')
Epoch:  155  
Training Loss: 1.3873801231384277
Test Loss:  1.4570562839508057
Test Acc:  0.0
Valid Loss:  1.3536261320114136
Valid Acc:  0.0
std:  6.370031011100656 
thres:  0.008657597112655641
Preserved_eigens number check:  512
 16%|█▌        | 155/1000 [46:57<4:06:20, 17.49s/it]Epoch:   156
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  503
Criterion check: 
Mean:  tensor(0.6289, device='cuda:0') 
Std:  tensor(9.9963, device='cuda:0') 
ABS Max:  tensor(175.7818, device='cuda:0') 
ABS Min:  tensor(8.6718e-05, device='cuda:0')
Criterion check:  tensor([ 0.9998,  0.9980,  0.9997,  1.0002,  1.0071,  1.1152, -0.1987,  1.0000,
         0.9495,  1.2048], device='cuda:0') tensor(50, device='cuda:0')
max of Lambda2 tensor(498174.1250, device='cuda:0')
min of Lambda2 tensor(1.2723e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1673, device='cuda:0')
min of grad d_p:  tensor(-0.2100, device='cuda:0')
max|min: (J_L, Jta/N)  (0.16732165217399597, 0.16732193529605865, ratio: 1.0000016689300537)|(-0.20995138585567474, -0.20995081961154938)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.5390e-07, device='cuda:0') mean:  tensor(-8.4632e-11, device='cuda:0') min:  tensor(-1.3188e-06, device='cuda:0') norm:  tensor(6.1001e-06, device='cuda:0') MSE:  tensor(7.6867e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0040, device='cuda:0') mean:  tensor(7.1029e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0276, device='cuda:0') MSE:  tensor(3.4756e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.7651, device='cuda:0')
min of d_p_list:  tensor(-0.7259, device='cuda:0')
Epoch:  156  
Training Loss: 1.7160077095031738
Test Loss:  1.7999396324157715
Test Acc:  0.0
Valid Loss:  1.6583354473114014
Valid Acc:  0.0
std:  4.186165056451028 
thres:  0.005224548196792602
Preserved_eigens number check:  512
 16%|█▌        | 156/1000 [47:15<4:06:59, 17.56s/it]Epoch:   157
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  503
Criterion check: 
Mean:  tensor(-5.9059, device='cuda:0') 
Std:  tensor(127.2759, device='cuda:0') 
ABS Max:  tensor(2878.7043, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([0.9997, 0.9999, 1.0000, 1.0002, 0.9976, 0.9953, 1.0059, 1.0157, 1.0437,
        1.0039], device='cuda:0') tensor(53, device='cuda:0')
max of Lambda2 tensor(503914.9375, device='cuda:0')
min of Lambda2 tensor(2.0923e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.5802, device='cuda:0')
min of grad d_p:  tensor(-3.5128, device='cuda:0')
max|min: (J_L, Jta/N)  (1.5801926851272583, 1.5801922082901, ratio: 0.9999997019767761)|(-3.5127978324890137, -3.512796640396118)

 check Jacobi res:  torch.Size([793601]) max:  tensor(7.7486e-07, device='cuda:0') mean:  tensor(-6.0493e-11, device='cuda:0') min:  tensor(-2.1458e-06, device='cuda:0') norm:  tensor(9.3039e-06, device='cuda:0') MSE:  tensor(1.1724e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0131, device='cuda:0') mean:  tensor(2.0504e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0724, device='cuda:0') MSE:  tensor(9.1174e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.4006, device='cuda:0')
min of d_p_list:  tensor(-0.4193, device='cuda:0')
Epoch:  157  
Training Loss: 2.424190044403076
Test Loss:  2.483578681945801
Test Acc:  0.0
Valid Loss:  2.9369852542877197
Valid Acc:  0.0
std:  2.0736388670073986 
thres:  0.003201597738265991
Preserved_eigens number check:  512
 16%|█▌        | 157/1000 [47:32<4:04:52, 17.43s/it]Epoch:   158
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  503
Criterion check: 
Mean:  tensor(-4.5564, device='cuda:0') 
Std:  tensor(89.5203, device='cuda:0') 
ABS Max:  tensor(1255.1337, device='cuda:0') 
ABS Min:  tensor(0.0007, device='cuda:0')
Criterion check:  tensor([ 1.0102e+00,  1.0012e+00,  1.0011e+00,  1.0135e+00,  1.0177e+00,
         1.0254e+00,  1.2159e+00,  5.8953e-01,  1.0773e+00, -1.2280e+03],
       device='cuda:0') tensor(193, device='cuda:0')
max of Lambda2 tensor(503260.3125, device='cuda:0')
min of Lambda2 tensor(5.8495e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(4.2502, device='cuda:0')
min of grad d_p:  tensor(-6.1089, device='cuda:0')
max|min: (J_L, Jta/N)  (4.2502336502075195, 4.250234127044678, ratio: 1.0000001192092896)|(-6.108911514282227, -6.1089091300964355)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.6689e-06, device='cuda:0') mean:  tensor(-1.6683e-10, device='cuda:0') min:  tensor(-2.3842e-06, device='cuda:0') norm:  tensor(1.2331e-05, device='cuda:0') MSE:  tensor(1.5538e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.1898, device='cuda:0') mean:  tensor(0.0003, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(1.0414, device='cuda:0') MSE:  tensor(1.3122e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(27.0895, device='cuda:0')
min of d_p_list:  tensor(-28.1753, device='cuda:0')
Epoch:  158  
Training Loss: 10311738.0
Test Loss:  10609790.0
Test Acc:  0.0
Valid Loss:  10955958.0
Valid Acc:  0.0
std:  4124694.31144131 
thres:  2062.349377117491
Preserved_eigens number check:  512
 16%|█▌        | 158/1000 [47:49<4:04:52, 17.45s/it]Epoch:   159
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.3327, device='cuda:0') 
Std:  tensor(33.8733, device='cuda:0') 
ABS Max:  tensor(367.1841, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0001, 1.0006, 1.0000, 1.0003, 1.0001, 1.0002, 1.0001, 1.0006,
        0.9991], device='cuda:0') tensor(168, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0001, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1669.5044, device='cuda:0')
min of grad d_p:  tensor(-5208.0459, device='cuda:0')
max|min: (J_L, Jta/N)  (1669.50439453125, 1669.5045166015625, ratio: 1.0000001192092896)|(-5208.0458984375, -5208.04736328125)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0020, device='cuda:0') mean:  tensor(4.1941e-08, device='cuda:0') min:  tensor(-0.0010, device='cuda:0') norm:  tensor(0.0047, device='cuda:0') MSE:  tensor(5.9496e-09, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.5420, device='cuda:0') mean:  tensor(0.0012, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(3.9513, device='cuda:0') MSE:  tensor(4.9790e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(2.9479, device='cuda:0')
min of d_p_list:  tensor(-4.0968, device='cuda:0')
Epoch:  159  
Training Loss: 45843.34375
Test Loss:  49325.6796875
Test Acc:  0.0
Valid Loss:  53992.6328125
Valid Acc:  0.0
std:  4120148.5660932227 
thres:  2071.517374265575
Preserved_eigens number check:  512
 16%|█▌        | 159/1000 [48:06<4:03:54, 17.40s/it]Epoch:   160
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(-0.4020, device='cuda:0') 
Std:  tensor(7.7368, device='cuda:0') 
ABS Max:  tensor(98.2831, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([1.0001, 1.0001, 1.0000, 0.9999, 1.0004, 0.9962, 1.0013, 0.9989, 0.9966,
        1.0011], device='cuda:0') tensor(135, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(3.5290e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(863.1927, device='cuda:0')
min of grad d_p:  tensor(-443.4931, device='cuda:0')
max|min: (J_L, Jta/N)  (863.1927490234375, 863.1925659179688, ratio: 0.9999997615814209)|(-443.4930725097656, -443.4930725097656)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(-8.0198e-09, device='cuda:0') min:  tensor(-9.1553e-05, device='cuda:0') norm:  tensor(0.0008, device='cuda:0') MSE:  tensor(9.4888e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.2094, device='cuda:0') mean:  tensor(0.0003, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(1.2906, device='cuda:0') MSE:  tensor(1.6262e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(1.2386, device='cuda:0')
min of d_p_list:  tensor(-0.8106, device='cuda:0')
Epoch:  160  
Training Loss: 3867.3291015625
Test Loss:  4202.59228515625
Test Acc:  0.0
Valid Loss:  4433.4482421875
Valid Acc:  0.0
std:  4119760.09664747 
thres:  2072.290562609863
Preserved_eigens number check:  512
 16%|█▌        | 160/1000 [48:24<4:04:11, 17.44s/it]Epoch:   161
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(-1.4202, device='cuda:0') 
Std:  tensor(22.4994, device='cuda:0') 
ABS Max:  tensor(211.4455, device='cuda:0') 
ABS Min:  tensor(0.0027, device='cuda:0')
Criterion check:  tensor([1.0003, 0.9933, 1.0000, 1.0000, 0.9992, 0.9959, 0.9999, 1.0022, 1.0032,
        0.8668], device='cuda:0') tensor(153, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(6.4783e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(170.5893, device='cuda:0')
min of grad d_p:  tensor(-165.1008, device='cuda:0')
max|min: (J_L, Jta/N)  (170.58932495117188, 170.5894775390625, ratio: 1.0000009536743164)|(-165.1007843017578, -165.10079956054688)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.3406e-05, device='cuda:0') mean:  tensor(-1.6584e-09, device='cuda:0') min:  tensor(-0.0002, device='cuda:0') norm:  tensor(0.0003, device='cuda:0') MSE:  tensor(3.6366e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.4853, device='cuda:0') mean:  tensor(0.0010, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(3.4827, device='cuda:0') MSE:  tensor(4.3885e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.6455, device='cuda:0')
min of d_p_list:  tensor(-0.6260, device='cuda:0')
Epoch:  161  
Training Loss: 1058.156982421875
Test Loss:  1138.07568359375
Test Acc:  0.0
Valid Loss:  1249.6485595703125
Valid Acc:  0.0
std:  4119653.8364479095 
thres:  2072.5018508048056
Preserved_eigens number check:  512
 16%|█▌        | 161/1000 [48:42<4:04:54, 17.51s/it]Epoch:   162
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(-0.1081, device='cuda:0') 
Std:  tensor(22.1034, device='cuda:0') 
ABS Max:  tensor(350.2301, device='cuda:0') 
ABS Min:  tensor(0.0001, device='cuda:0')
Criterion check:  tensor([1.0023, 1.0001, 1.0000, 1.0098, 1.0001, 0.9991, 0.9950, 0.9995, 0.9982,
        0.9938], device='cuda:0') tensor(139, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(1.5041e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(47.6077, device='cuda:0')
min of grad d_p:  tensor(-71.1030, device='cuda:0')
max|min: (J_L, Jta/N)  (47.607696533203125, 47.60762405395508, ratio: 0.9999984502792358)|(-71.10303497314453, -71.10294342041016)

 check Jacobi res:  torch.Size([793601]) max:  tensor(7.2479e-05, device='cuda:0') mean:  tensor(-2.8086e-09, device='cuda:0') min:  tensor(-9.1553e-05, device='cuda:0') norm:  tensor(0.0003, device='cuda:0') MSE:  tensor(4.3142e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.3651, device='cuda:0') mean:  tensor(0.0004, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(1.6617, device='cuda:0') MSE:  tensor(2.0939e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.6764, device='cuda:0')
min of d_p_list:  tensor(-0.7338, device='cuda:0')
Epoch:  162  
Training Loss: 392.82550048828125
Test Loss:  445.47076416015625
Test Acc:  0.0
Valid Loss:  501.8545227050781
Valid Acc:  0.0
std:  4119614.558905878 
thres:  2072.5799310668945
Preserved_eigens number check:  512
 16%|█▌        | 162/1000 [48:59<4:03:41, 17.45s/it]Epoch:   163
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  510
Criterion check: 
Mean:  tensor(-6.3493, device='cuda:0') 
Std:  tensor(130.3087, device='cuda:0') 
ABS Max:  tensor(2842.8845, device='cuda:0') 
ABS Min:  tensor(8.3379e-05, device='cuda:0')
Criterion check:  tensor([0.9999, 1.0017, 1.0003, 1.0005, 1.0003, 1.0120, 0.9996, 1.0095, 1.0179,
        1.0451], device='cuda:0') tensor(168, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(4.0041e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(28.4819, device='cuda:0')
min of grad d_p:  tensor(-18.5477, device='cuda:0')
max|min: (J_L, Jta/N)  (28.481889724731445, 28.481950759887695, ratio: 1.000002145767212)|(-18.54771614074707, -18.54776954650879)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.3406e-05, device='cuda:0') mean:  tensor(7.2544e-10, device='cuda:0') min:  tensor(-7.5340e-05, device='cuda:0') norm:  tensor(0.0003, device='cuda:0') MSE:  tensor(4.2730e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.6314, device='cuda:0') mean:  tensor(0.0011, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(4.4195, device='cuda:0') MSE:  tensor(5.5689e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.4566, device='cuda:0')
min of d_p_list:  tensor(-0.3915, device='cuda:0')
Epoch:  163  
Training Loss: 207.23095703125
Test Loss:  232.7452392578125
Test Acc:  0.0
Valid Loss:  234.9315185546875
Valid Acc:  0.0
std:  17833.299512638703 
thres:  10.27377725830078
Preserved_eigens number check:  512
 16%|█▋        | 163/1000 [49:16<4:02:40, 17.40s/it]Epoch:   164
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  510
Criterion check: 
Mean:  tensor(-2.5419, device='cuda:0') 
Std:  tensor(54.7562, device='cuda:0') 
ABS Max:  tensor(921.5187, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([0.9975, 0.9779, 1.0009, 1.0006, 0.9986, 0.9900, 1.0188, 0.9811, 1.0178,
        0.9907], device='cuda:0') tensor(173, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(7.0898e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(35.6499, device='cuda:0')
min of grad d_p:  tensor(-29.5292, device='cuda:0')
max|min: (J_L, Jta/N)  (35.64994430541992, 35.64995193481445, ratio: 1.000000238418579)|(-29.5291748046875, -29.529218673706055)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.3869e-05, device='cuda:0') mean:  tensor(-2.0237e-09, device='cuda:0') min:  tensor(-6.1035e-05, device='cuda:0') norm:  tensor(0.0002, device='cuda:0') MSE:  tensor(2.7606e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.6291, device='cuda:0') mean:  tensor(0.0010, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(3.7171, device='cuda:0') MSE:  tensor(4.6838e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(1.0449, device='cuda:0')
min of d_p_list:  tensor(-0.7741, device='cuda:0')
Epoch:  164  
Training Loss: 12.628173828125
Test Loss:  13.21505355834961
Test Acc:  0.0
Valid Loss:  11.07088851928711
Valid Acc:  0.0
std:  1424.0140181169784 
thres:  1.1076341430664063
Preserved_eigens number check:  512
 16%|█▋        | 164/1000 [49:34<4:05:15, 17.60s/it]Epoch:   165
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(-1.5165, device='cuda:0') 
Std:  tensor(27.6724, device='cuda:0') 
ABS Max:  tensor(414.8406, device='cuda:0') 
ABS Min:  tensor(8.6306e-06, device='cuda:0')
Criterion check:  tensor([1.0004, 0.9995, 0.9999, 0.9998, 0.9990, 1.0008, 1.0000, 0.9987, 1.0265,
        0.9874], device='cuda:0') tensor(121, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(7.3721e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(25.7334, device='cuda:0')
min of grad d_p:  tensor(-73.5526, device='cuda:0')
max|min: (J_L, Jta/N)  (25.733417510986328, 25.733516693115234, ratio: 1.0000038146972656)|(-73.5526123046875, -73.5525131225586)

 check Jacobi res:  torch.Size([793601]) max:  tensor(6.1035e-05, device='cuda:0') mean:  tensor(-5.0728e-10, device='cuda:0') min:  tensor(-9.9182e-05, device='cuda:0') norm:  tensor(0.0004, device='cuda:0') MSE:  tensor(5.5802e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0862, device='cuda:0') mean:  tensor(0.0002, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.7031, device='cuda:0') MSE:  tensor(8.8595e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1269, device='cuda:0')
min of d_p_list:  tensor(-0.1215, device='cuda:0')
Epoch:  165  
Training Loss: 19.54200553894043
Test Loss:  22.530559539794922
Test Acc:  0.0
Valid Loss:  20.40230941772461
Valid Acc:  0.0
std:  386.2679762816381 
thres:  0.33807672386169435
Preserved_eigens number check:  512
 16%|█▋        | 165/1000 [49:52<4:03:13, 17.48s/it]Epoch:   166
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  510
Criterion check: 
Mean:  tensor(-0.8585, device='cuda:0') 
Std:  tensor(45.7125, device='cuda:0') 
ABS Max:  tensor(938.8346, device='cuda:0') 
ABS Min:  tensor(0.0005, device='cuda:0')
Criterion check:  tensor([0.9944, 0.8852, 1.0015, 0.9819, 1.0032, 0.9773, 1.0018, 1.0551, 1.1046,
        1.1425], device='cuda:0') tensor(164, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(2.8746e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(3.3445, device='cuda:0')
min of grad d_p:  tensor(-10.2454, device='cuda:0')
max|min: (J_L, Jta/N)  (3.34450626373291, 3.344528913497925, ratio: 1.0000067949295044)|(-10.245379447937012, -10.245485305786133)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(3.0327e-09, device='cuda:0') min:  tensor(-3.4332e-05, device='cuda:0') norm:  tensor(0.0003, device='cuda:0') MSE:  tensor(3.4596e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.2691, device='cuda:0') mean:  tensor(0.0006, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(2.1048, device='cuda:0') MSE:  tensor(2.6523e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(2.2028, device='cuda:0')
min of d_p_list:  tensor(-1.2994, device='cuda:0')
Epoch:  166  
Training Loss: 964.0872802734375
Test Loss:  945.7737426757812
Test Acc:  0.0
Valid Loss:  894.224609375
Valid Acc:  0.0
std:  351.45940411431445 
thres:  0.3192627834320068
Preserved_eigens number check:  512
 17%|█▋        | 166/1000 [50:09<4:02:24, 17.44s/it]Epoch:   167
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  510
Criterion check: 
Mean:  tensor(-1.8172, device='cuda:0') 
Std:  tensor(33.1678, device='cuda:0') 
ABS Max:  tensor(691.5978, device='cuda:0') 
ABS Min:  tensor(0.0006, device='cuda:0')
Criterion check:  tensor([0.9930, 1.0000, 0.9999, 0.9994, 1.0005, 1.0001, 0.9984, 0.9998, 0.9989,
        1.0006], device='cuda:0') tensor(112, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(5.0626e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(170.2755, device='cuda:0')
min of grad d_p:  tensor(-126.6862, device='cuda:0')
max|min: (J_L, Jta/N)  (170.27545166015625, 170.27540588378906, ratio: 0.9999997019767761)|(-126.68618774414062, -126.6861343383789)

 check Jacobi res:  torch.Size([793601]) max:  tensor(9.1553e-05, device='cuda:0') mean:  tensor(-4.5807e-09, device='cuda:0') min:  tensor(-0.0002, device='cuda:0') norm:  tensor(0.0006, device='cuda:0') MSE:  tensor(8.1123e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.1600, device='cuda:0') mean:  tensor(0.0002, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.9337, device='cuda:0') MSE:  tensor(1.1765e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(1.8395, device='cuda:0')
min of d_p_list:  tensor(-2.9259, device='cuda:0')
Epoch:  167  
Training Loss: 163.43411254882812
Test Loss:  144.86402893066406
Test Acc:  0.0
Valid Loss:  139.40036010742188
Valid Acc:  0.0
std:  353.82639337909876 
thres:  0.2733845058441162
Preserved_eigens number check:  512
 17%|█▋        | 167/1000 [50:26<4:00:41, 17.34s/it]Epoch:   168
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(0.9835, device='cuda:0') 
Std:  tensor(23.1783, device='cuda:0') 
ABS Max:  tensor(339.7430, device='cuda:0') 
ABS Min:  tensor(9.8922e-05, device='cuda:0')
Criterion check:  tensor([0.9998, 1.0004, 0.9999, 0.9995, 1.0000, 1.0006, 1.0106, 1.0008, 0.9979,
        1.0323], device='cuda:0') tensor(138, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0002, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(58.9541, device='cuda:0')
min of grad d_p:  tensor(-77.5941, device='cuda:0')
max|min: (J_L, Jta/N)  (58.954071044921875, 58.95400619506836, ratio: 0.999998927116394)|(-77.5940933227539, -77.59400177001953)

 check Jacobi res:  torch.Size([793601]) max:  tensor(6.4850e-05, device='cuda:0') mean:  tensor(-3.8862e-09, device='cuda:0') min:  tensor(-9.1553e-05, device='cuda:0') norm:  tensor(0.0005, device='cuda:0') MSE:  tensor(6.3102e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.2007, device='cuda:0') mean:  tensor(0.0002, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.7137, device='cuda:0') MSE:  tensor(8.9935e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(1.1023, device='cuda:0')
min of d_p_list:  tensor(-0.9656, device='cuda:0')
Epoch:  168  
Training Loss: 1647.394775390625
Test Loss:  1760.486083984375
Test Acc:  0.0
Valid Loss:  1628.1190185546875
Valid Acc:  0.0
std:  647.2525237208034 
thres:  0.5614172695159911
Preserved_eigens number check:  512
 17%|█▋        | 168/1000 [50:43<4:00:41, 17.36s/it]Epoch:   169
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  509
Criterion check: 
Mean:  tensor(-15.9992, device='cuda:0') 
Std:  tensor(521.1162, device='cuda:0') 
ABS Max:  tensor(7035.9580, device='cuda:0') 
ABS Min:  tensor(0.0445, device='cuda:0')
Criterion check:  tensor([0.9883, 0.9985, 0.9993, 1.0645, 0.9958, 1.0204, 0.9815, 1.0927, 0.8336,
        2.2091], device='cuda:0') tensor(241, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(1.6886e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(97.7243, device='cuda:0')
min of grad d_p:  tensor(-207.2198, device='cuda:0')
max|min: (J_L, Jta/N)  (97.72428894042969, 97.72418975830078, ratio: 0.9999989867210388)|(-207.2198486328125, -207.2199249267578)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(4.7990e-09, device='cuda:0') min:  tensor(-7.6294e-05, device='cuda:0') norm:  tensor(0.0005, device='cuda:0') MSE:  tensor(6.2347e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(4.6184, device='cuda:0') mean:  tensor(0.0055, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(24.9606, device='cuda:0') MSE:  tensor(3.1452e-05, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.4923, device='cuda:0')
min of d_p_list:  tensor(-0.2623, device='cuda:0')
Epoch:  169  
Training Loss: 806.0274047851562
Test Loss:  881.3180541992188
Test Acc:  0.0
Valid Loss:  818.843505859375
Valid Acc:  0.0
std:  587.7835190116507 
thres:  0.7200971157073975
Preserved_eigens number check:  512
 17%|█▋        | 169/1000 [51:01<4:00:17, 17.35s/it]Epoch:   170
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  510
Criterion check: 
Mean:  tensor(-2.2726, device='cuda:0') 
Std:  tensor(67.8020, device='cuda:0') 
ABS Max:  tensor(1403.4971, device='cuda:0') 
ABS Min:  tensor(0.0009, device='cuda:0')
Criterion check:  tensor([1.0003, 1.0001, 1.0001, 1.0008, 1.0019, 1.0116, 1.0022, 0.9628, 1.0233,
        0.8647], device='cuda:0') tensor(130, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(1.5195e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(35.4621, device='cuda:0')
min of grad d_p:  tensor(-63.2969, device='cuda:0')
max|min: (J_L, Jta/N)  (35.4621467590332, 35.46219253540039, ratio: 1.000001311302185)|(-63.296939849853516, -63.29690170288086)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.0504e-05, device='cuda:0') mean:  tensor(-1.1590e-09, device='cuda:0') min:  tensor(-4.5776e-05, device='cuda:0') norm:  tensor(0.0002, device='cuda:0') MSE:  tensor(2.5643e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.2504, device='cuda:0') mean:  tensor(0.0005, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(1.7415, device='cuda:0') MSE:  tensor(2.1945e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.8607, device='cuda:0')
min of d_p_list:  tensor(-0.6942, device='cuda:0')
Epoch:  170  
Training Loss: 35.66221237182617
Test Loss:  36.77787399291992
Test Acc:  0.0
Valid Loss:  28.862220764160156
Valid Acc:  0.0
std:  583.9638736113329 
thres:  0.7233211570739746
Preserved_eigens number check:  512
 17%|█▋        | 170/1000 [51:18<3:59:35, 17.32s/it]Epoch:   171
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  509
Criterion check: 
Mean:  tensor(1.1473, device='cuda:0') 
Std:  tensor(23.5779, device='cuda:0') 
ABS Max:  tensor(497.5331, device='cuda:0') 
ABS Min:  tensor(0.0016, device='cuda:0')
Criterion check:  tensor([0.9996, 0.9997, 0.9999, 1.0004, 0.9999, 1.0157, 1.0036, 1.0035, 1.0064,
        1.0658], device='cuda:0') tensor(123, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(2.2667e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(51.4382, device='cuda:0')
min of grad d_p:  tensor(-117.7316, device='cuda:0')
max|min: (J_L, Jta/N)  (51.43817138671875, 51.438167572021484, ratio: 0.9999999403953552)|(-117.7315673828125, -117.73148345947266)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.3869e-05, device='cuda:0') mean:  tensor(-3.7470e-09, device='cuda:0') min:  tensor(-8.3923e-05, device='cuda:0') norm:  tensor(0.0003, device='cuda:0') MSE:  tensor(3.9554e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.2184, device='cuda:0') mean:  tensor(0.0002, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.8401, device='cuda:0') MSE:  tensor(1.0586e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.5162, device='cuda:0')
min of d_p_list:  tensor(-0.5637, device='cuda:0')
Epoch:  171  
Training Loss: 55.34617614746094
Test Loss:  56.30039596557617
Test Acc:  0.0
Valid Loss:  53.61974334716797
Valid Acc:  0.0
std:  620.9877935375899 
thres:  0.5415729362487793
Preserved_eigens number check:  512
 17%|█▋        | 171/1000 [51:35<3:59:58, 17.37s/it]Epoch:   172
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  510
Criterion check: 
Mean:  tensor(-104.6250, device='cuda:0') 
Std:  tensor(2399.9292, device='cuda:0') 
ABS Max:  tensor(54270.9961, device='cuda:0') 
ABS Min:  tensor(0.0006, device='cuda:0')
Criterion check:  tensor([0.9972, 0.9980, 0.9988, 0.9987, 0.9993, 1.0003, 0.9825, 0.9956, 0.8186,
        0.9115], device='cuda:0') tensor(151, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(4.4297e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(24.8518, device='cuda:0')
min of grad d_p:  tensor(-16.1075, device='cuda:0')
max|min: (J_L, Jta/N)  (24.85181999206543, 24.851858139038086, ratio: 1.0000015497207642)|(-16.107486724853516, -16.107498168945312)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.4639e-05, device='cuda:0') mean:  tensor(-2.9617e-09, device='cuda:0') min:  tensor(-6.5804e-05, device='cuda:0') norm:  tensor(0.0003, device='cuda:0') MSE:  tensor(3.7094e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.2908, device='cuda:0') mean:  tensor(0.0006, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(2.1027, device='cuda:0') MSE:  tensor(2.6496e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(2.8917, device='cuda:0')
min of d_p_list:  tensor(-1.4706, device='cuda:0')
Epoch:  172  
Training Loss: 58.76066207885742
Test Loss:  61.048248291015625
Test Acc:  0.0
Valid Loss:  51.948577880859375
Valid Acc:  0.0
std:  634.9892305333553 
thres:  0.5206382461547852
Preserved_eigens number check:  512
 17%|█▋        | 172/1000 [51:53<4:00:58, 17.46s/it]Epoch:   173
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  509
Criterion check: 
Mean:  tensor(1.8035, device='cuda:0') 
Std:  tensor(38.7807, device='cuda:0') 
ABS Max:  tensor(426.4385, device='cuda:0') 
ABS Min:  tensor(0.0009, device='cuda:0')
Criterion check:  tensor([1.0038, 0.9976, 0.9984, 1.0002, 1.0014, 0.9980, 1.0049, 0.9498, 1.1404,
        1.3188], device='cuda:0') tensor(211, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(3.9303e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(43.8912, device='cuda:0')
min of grad d_p:  tensor(-81.5043, device='cuda:0')
max|min: (J_L, Jta/N)  (43.89122772216797, 43.89126205444336, ratio: 1.0000008344650269)|(-81.50433349609375, -81.50440216064453)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(5.9693e-09, device='cuda:0') min:  tensor(-4.2439e-05, device='cuda:0') norm:  tensor(0.0003, device='cuda:0') MSE:  tensor(4.0308e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(1.9455, device='cuda:0') mean:  tensor(0.0015, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(6.7020, device='cuda:0') MSE:  tensor(8.4451e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(5.9095, device='cuda:0')
min of d_p_list:  tensor(-3.7042, device='cuda:0')
Epoch:  173  
Training Loss: 768.2984619140625
Test Loss:  855.4180908203125
Test Acc:  0.0
Valid Loss:  758.3472900390625
Valid Acc:  0.0
std:  361.4553513471429 
thres:  0.34481898345947265
Preserved_eigens number check:  512
 17%|█▋        | 173/1000 [52:10<3:59:26, 17.37s/it]Epoch:   174
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  509
Criterion check: 
Mean:  tensor(-2.4515, device='cuda:0') 
Std:  tensor(41.5722, device='cuda:0') 
ABS Max:  tensor(884.4509, device='cuda:0') 
ABS Min:  tensor(0.0005, device='cuda:0')
Criterion check:  tensor([1.0003, 1.0001, 1.0001, 1.0001, 1.0002, 0.9996, 1.0021, 0.9978, 0.9796,
        1.0097], device='cuda:0') tensor(143, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(2.4418e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(347.2056, device='cuda:0')
min of grad d_p:  tensor(-256.2269, device='cuda:0')
max|min: (J_L, Jta/N)  (347.20562744140625, 347.2058410644531, ratio: 1.0000005960464478)|(-256.22686767578125, -256.22686767578125)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0300, device='cuda:0') mean:  tensor(-1.0580e-07, device='cuda:0') min:  tensor(-0.0190, device='cuda:0') norm:  tensor(0.0450, device='cuda:0') MSE:  tensor(5.6704e-08, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.3779, device='cuda:0') mean:  tensor(0.0005, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(2.1554, device='cuda:0') MSE:  tensor(2.7160e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(1.9767, device='cuda:0')
min of d_p_list:  tensor(-1.7112, device='cuda:0')
Epoch:  174  
Training Loss: 210.49118041992188
Test Loss:  183.24037170410156
Test Acc:  0.0
Valid Loss:  196.3608856201172
Valid Acc:  0.0
std:  278.4413499999222 
thres:  0.2257117385864258
Preserved_eigens number check:  512
 17%|█▋        | 174/1000 [52:28<3:59:01, 17.36s/it]Epoch:   175
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(-2.7092, device='cuda:0') 
Std:  tensor(64.0669, device='cuda:0') 
ABS Max:  tensor(1448.3160, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([1.0016, 1.0002, 1.0001, 1.0001, 1.0000, 0.9997, 1.0002, 0.9705, 1.0000,
        1.0028], device='cuda:0') tensor(103, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(2.1593e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(36.2214, device='cuda:0')
min of grad d_p:  tensor(-94.5937, device='cuda:0')
max|min: (J_L, Jta/N)  (36.22142791748047, 36.221458435058594, ratio: 1.0000008344650269)|(-94.59368133544922, -94.59363555908203)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.0472e-05, device='cuda:0') mean:  tensor(-4.8312e-09, device='cuda:0') min:  tensor(-5.1498e-05, device='cuda:0') norm:  tensor(0.0003, device='cuda:0') MSE:  tensor(3.8735e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0995, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.6741, device='cuda:0') MSE:  tensor(8.4940e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.3658, device='cuda:0')
min of d_p_list:  tensor(-0.5065, device='cuda:0')
Epoch:  175  
Training Loss: 128.24215698242188
Test Loss:  123.61918640136719
Test Acc:  0.0
Valid Loss:  126.11488342285156
Valid Acc:  0.0
std:  268.07283138868866 
thres:  0.24422772750854493
Preserved_eigens number check:  512
 18%|█▊        | 175/1000 [52:45<4:00:46, 17.51s/it]Epoch:   176
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(4.0060, device='cuda:0') 
Std:  tensor(87.6407, device='cuda:0') 
ABS Max:  tensor(1977.4749, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([1.0006, 1.0004, 0.9999, 1.0001, 0.9998, 0.9966, 0.9993, 1.0623, 0.9816,
        0.9872], device='cuda:0') tensor(94, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(4.1646e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(9.9828, device='cuda:0')
min of grad d_p:  tensor(-56.2528, device='cuda:0')
max|min: (J_L, Jta/N)  (9.982781410217285, 9.982699394226074, ratio: 0.999991774559021)|(-56.25282287597656, -56.2525634765625)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.2016e-05, device='cuda:0') mean:  tensor(-5.7837e-09, device='cuda:0') min:  tensor(-0.0003, device='cuda:0') norm:  tensor(0.0006, device='cuda:0') MSE:  tensor(7.9708e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.1665, device='cuda:0') mean:  tensor(0.0002, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.8488, device='cuda:0') MSE:  tensor(1.0695e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(2.1421, device='cuda:0')
min of d_p_list:  tensor(-1.6753, device='cuda:0')
Epoch:  176  
Training Loss: 667.2984619140625
Test Loss:  675.6917114257812
Test Acc:  0.0
Valid Loss:  655.309814453125
Valid Acc:  0.0
std:  292.4827176086143 
thres:  0.36661818466186524
Preserved_eigens number check:  512
 18%|█▊        | 176/1000 [53:04<4:02:39, 17.67s/it]Epoch:   177
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(0.7587, device='cuda:0') 
Std:  tensor(31.5469, device='cuda:0') 
ABS Max:  tensor(509.6438, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([0.9999, 0.9999, 0.9999, 1.0015, 1.0002, 1.0003, 0.9999, 0.9981, 0.9964,
        1.1002], device='cuda:0') tensor(115, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0001, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(58.2273, device='cuda:0')
min of grad d_p:  tensor(-308.5143, device='cuda:0')
max|min: (J_L, Jta/N)  (58.227272033691406, 58.227256774902344, ratio: 0.9999997615814209)|(-308.5142822265625, -308.5142822265625)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.3923e-05, device='cuda:0') mean:  tensor(-1.4930e-09, device='cuda:0') min:  tensor(-4.5776e-05, device='cuda:0') norm:  tensor(0.0004, device='cuda:0') MSE:  tensor(4.5029e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.4931, device='cuda:0') mean:  tensor(0.0003, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(1.4786, device='cuda:0') MSE:  tensor(1.8631e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(5.1805, device='cuda:0')
min of d_p_list:  tensor(-5.2167, device='cuda:0')
Epoch:  177  
Training Loss: 10652.3203125
Test Loss:  11628.5732421875
Test Acc:  0.0
Valid Loss:  11116.02734375
Valid Acc:  0.0
std:  4091.061512504925 
thres:  2.4853301147460938
Preserved_eigens number check:  512
 18%|█▊        | 177/1000 [53:21<4:03:02, 17.72s/it]Epoch:   178
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.4131, device='cuda:0') 
Std:  tensor(14.4943, device='cuda:0') 
ABS Max:  tensor(183.8279, device='cuda:0') 
ABS Min:  tensor(0.0004, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0001, 1.0001, 1.0000, 1.0000, 1.0001, 1.0000, 1.0016, 1.0006,
        1.0003], device='cuda:0') tensor(127, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0002, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(612.4261, device='cuda:0')
min of grad d_p:  tensor(-638.0176, device='cuda:0')
max|min: (J_L, Jta/N)  (612.4261474609375, 612.4261474609375, ratio: 1.0)|(-638.017578125, -638.0171508789062)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(-2.9651e-08, device='cuda:0') min:  tensor(-0.0008, device='cuda:0') norm:  tensor(0.0034, device='cuda:0') MSE:  tensor(4.2224e-09, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.1572, device='cuda:0') mean:  tensor(0.0003, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(1.2588, device='cuda:0') MSE:  tensor(1.5862e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(2.4411, device='cuda:0')
min of d_p_list:  tensor(-2.7549, device='cuda:0')
Epoch:  178  
Training Loss: 3461.60986328125
Test Loss:  3758.1298828125
Test Acc:  0.0
Valid Loss:  3359.82421875
Valid Acc:  0.0
std:  4005.9470961339784 
thres:  3.023992395019531
Preserved_eigens number check:  512
 18%|█▊        | 178/1000 [53:38<4:00:19, 17.54s/it]Epoch:   179
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  508
Criterion check: 
Mean:  tensor(1.3871, device='cuda:0') 
Std:  tensor(102.9580, device='cuda:0') 
ABS Max:  tensor(1724.0706, device='cuda:0') 
ABS Min:  tensor(0.0033, device='cuda:0')
Criterion check:  tensor([0.9996, 1.0053, 1.0001, 0.9994, 0.9972, 1.0090, 0.9995, 1.0047, 1.0157,
        1.0335], device='cuda:0') tensor(246, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(4.7666e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(129.7542, device='cuda:0')
min of grad d_p:  tensor(-108.5909, device='cuda:0')
max|min: (J_L, Jta/N)  (129.75418090820312, 129.75376892089844, ratio: 0.9999968409538269)|(-108.59092712402344, -108.5910873413086)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(1.5391e-08, device='cuda:0') min:  tensor(-0.0002, device='cuda:0') norm:  tensor(0.0011, device='cuda:0') MSE:  tensor(1.4381e-09, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(3.4197, device='cuda:0') mean:  tensor(0.0046, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(22.1520, device='cuda:0') MSE:  tensor(2.7913e-05, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(3.0142, device='cuda:0')
min of d_p_list:  tensor(-3.1134, device='cuda:0')
Epoch:  179  
Training Loss: 2039.4775390625
Test Loss:  2264.45703125
Test Acc:  0.0
Valid Loss:  1842.233642578125
Valid Acc:  0.0
std:  3811.102278400509 
thres:  3.389789666748047
Preserved_eigens number check:  512
 18%|█▊        | 179/1000 [53:56<4:00:07, 17.55s/it]Epoch:   180
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(-0.0532, device='cuda:0') 
Std:  tensor(29.8616, device='cuda:0') 
ABS Max:  tensor(372.1372, device='cuda:0') 
ABS Min:  tensor(0.0058, device='cuda:0')
Criterion check:  tensor([0.9999, 1.0001, 0.9999, 1.0000, 1.0002, 1.0017, 1.0139, 0.9882, 0.9890,
        0.9719], device='cuda:0') tensor(184, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(2.6575e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(211.5951, device='cuda:0')
min of grad d_p:  tensor(-421.7078, device='cuda:0')
max|min: (J_L, Jta/N)  (211.59506225585938, 211.59512329101562, ratio: 1.000000238418579)|(-421.7077941894531, -421.7080078125)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(-1.8143e-08, device='cuda:0') min:  tensor(-0.0002, device='cuda:0') norm:  tensor(0.0018, device='cuda:0') MSE:  tensor(2.2493e-09, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.4737, device='cuda:0') mean:  tensor(0.0008, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(3.8317, device='cuda:0') MSE:  tensor(4.8282e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.9059, device='cuda:0')
min of d_p_list:  tensor(-1.2063, device='cuda:0')
Epoch:  180  
Training Loss: 337.45941162109375
Test Loss:  365.8376770019531
Test Acc:  0.0
Valid Loss:  325.7926330566406
Valid Acc:  0.0
std:  3776.050220485026 
thres:  3.4316331176757813
Preserved_eigens number check:  512
 18%|█▊        | 180/1000 [54:13<3:58:43, 17.47s/it]Epoch:   181
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(-0.4898, device='cuda:0') 
Std:  tensor(22.5672, device='cuda:0') 
ABS Max:  tensor(472.5555, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([0.9996, 1.0000, 1.0000, 1.0000, 1.0001, 0.9976, 0.9992, 0.9973, 0.9972,
        1.0035], device='cuda:0') tensor(99, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(3.7363e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(103.8677, device='cuda:0')
min of grad d_p:  tensor(-158.8681, device='cuda:0')
max|min: (J_L, Jta/N)  (103.86769104003906, 103.86772918701172, ratio: 1.0000003576278687)|(-158.86807250976562, -158.86813354492188)

 check Jacobi res:  torch.Size([793601]) max:  tensor(6.1035e-05, device='cuda:0') mean:  tensor(-6.5661e-09, device='cuda:0') min:  tensor(-0.0001, device='cuda:0') norm:  tensor(0.0005, device='cuda:0') MSE:  tensor(6.5428e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0898, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.6688, device='cuda:0') MSE:  tensor(8.4277e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.5712, device='cuda:0')
min of d_p_list:  tensor(-0.4181, device='cuda:0')
Epoch:  181  
Training Loss: 196.5399627685547
Test Loss:  211.1806640625
Test Acc:  0.0
Valid Loss:  211.08425903320312
Valid Acc:  0.0
std:  3848.9670109551175 
thres:  3.3374814178466794
Preserved_eigens number check:  512
 18%|█▊        | 181/1000 [54:31<3:58:44, 17.49s/it]Epoch:   182
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  508
Criterion check: 
Mean:  tensor(18.9615, device='cuda:0') 
Std:  tensor(318.6731, device='cuda:0') 
ABS Max:  tensor(6901.9644, device='cuda:0') 
ABS Min:  tensor(0.0140, device='cuda:0')
Criterion check:  tensor([1.0227, 0.9987, 1.0009, 0.9990, 0.9964, 0.9984, 0.9082, 1.1052, 0.6326,
        1.1264], device='cuda:0') tensor(205, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(1.2125e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(41.3327, device='cuda:0')
min of grad d_p:  tensor(-42.9549, device='cuda:0')
max|min: (J_L, Jta/N)  (41.332725524902344, 41.332733154296875, ratio: 1.000000238418579)|(-42.95487976074219, -42.9549446105957)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(6.4540e-09, device='cuda:0') min:  tensor(-5.0068e-05, device='cuda:0') norm:  tensor(0.0005, device='cuda:0') MSE:  tensor(6.1229e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(1.8933, device='cuda:0') mean:  tensor(0.0026, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(11.6860, device='cuda:0') MSE:  tensor(1.4725e-05, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(64.5770, device='cuda:0')
min of d_p_list:  tensor(-43.5943, device='cuda:0')
Epoch:  182  
Training Loss: 12059468800.0
Test Loss:  12252228608.0
Test Acc:  0.0
Valid Loss:  12491055104.0
Valid Acc:  0.0
std:  4823786916.491471 
thres:  2411894.9670173554
Preserved_eigens number check:  512
 18%|█▊        | 182/1000 [54:48<3:57:43, 17.44s/it]Epoch:   183
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(0.9724, device='cuda:0') 
Std:  tensor(52.1490, device='cuda:0') 
ABS Max:  tensor(787.3507, device='cuda:0') 
ABS Min:  tensor(0.0030, device='cuda:0')
Criterion check:  tensor([0.9809, 1.0048, 1.0059, 1.0002, 0.9978, 0.9949, 1.0077, 0.9955, 1.0148,
        0.9946], device='cuda:0') tensor(251, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0466, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(52564.0156, device='cuda:0')
min of grad d_p:  tensor(-113331.2422, device='cuda:0')
max|min: (J_L, Jta/N)  (52564.015625, 52563.90625, ratio: 0.9999979138374329)|(-113331.2421875, -113331.34375)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.1095, device='cuda:0') mean:  tensor(3.1424e-06, device='cuda:0') min:  tensor(-0.0865, device='cuda:0') norm:  tensor(0.5830, device='cuda:0') MSE:  tensor(7.3467e-07, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(2982.7656, device='cuda:0') mean:  tensor(1.7167, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(14151.4189, device='cuda:0') MSE:  tensor(0.0178, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(3.6467, device='cuda:0')
min of d_p_list:  tensor(-6.1010, device='cuda:0')
Epoch:  183  
Training Loss: 21786262.0
Test Loss:  22776922.0
Test Acc:  0.0
Valid Loss:  24433918.0
Valid Acc:  0.0
std:  4821616018.897312 
thres:  2416251.5270953826
Preserved_eigens number check:  512
 18%|█▊        | 183/1000 [55:06<3:58:11, 17.49s/it]Epoch:   184
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(0.7646, device='cuda:0') 
Std:  tensor(19.0734, device='cuda:0') 
ABS Max:  tensor(257.8247, device='cuda:0') 
ABS Min:  tensor(0.0007, device='cuda:0')
Criterion check:  tensor([1.0001, 1.0001, 0.9999, 0.9998, 1.0001, 1.0001, 0.9979, 1.0005, 0.9901,
        1.0001], device='cuda:0') tensor(196, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0022, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(40142.2148, device='cuda:0')
min of grad d_p:  tensor(-93118.0547, device='cuda:0')
max|min: (J_L, Jta/N)  (40142.21484375, 40142.203125, ratio: 0.9999997019767761)|(-93118.0546875, -93118.1484375)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.1426, device='cuda:0') mean:  tensor(9.3849e-06, device='cuda:0') min:  tensor(-0.0607, device='cuda:0') norm:  tensor(0.4363, device='cuda:0') MSE:  tensor(5.4978e-07, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(73.1367, device='cuda:0') mean:  tensor(0.0432, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(314.4249, device='cuda:0') MSE:  tensor(0.0004, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(137.3031, device='cuda:0')
min of d_p_list:  tensor(-165.2192, device='cuda:0')
Epoch:  184  
Training Loss: 4836051910656.0
Test Loss:  4805668896768.0
Test Acc:  0.0
Valid Loss:  4711111458816.0
Valid Acc:  0.0
std:  1933218273981.4663 
thres:  969626633.2503998
Preserved_eigens number check:  512
 18%|█▊        | 184/1000 [55:23<3:58:28, 17.54s/it]Epoch:   185
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-2.9652, device='cuda:0') 
Std:  tensor(58.4320, device='cuda:0') 
ABS Max:  tensor(762.1580, device='cuda:0') 
ABS Min:  tensor(0.0091, device='cuda:0')
Criterion check:  tensor([0.9989, 0.9979, 1.0002, 1.0003, 1.0010, 1.0000, 1.0000, 1.0008, 1.0002,
        1.0001], device='cuda:0') tensor(232, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0089, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(26986.1836, device='cuda:0')
min of grad d_p:  tensor(-29863.3281, device='cuda:0')
max|min: (J_L, Jta/N)  (26986.18359375, 26986.18359375, ratio: 1.0)|(-29863.328125, -29863.3515625)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0395, device='cuda:0') mean:  tensor(-2.0798e-07, device='cuda:0') min:  tensor(-0.0255, device='cuda:0') norm:  tensor(0.1406, device='cuda:0') MSE:  tensor(1.7717e-07, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(56.5110, device='cuda:0') mean:  tensor(0.0466, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(390.7641, device='cuda:0') MSE:  tensor(0.0005, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(8.2707, device='cuda:0')
min of d_p_list:  tensor(-11.3771, device='cuda:0')
Epoch:  185  
Training Loss: 37294116.0
Test Loss:  37599608.0
Test Acc:  0.0
Valid Loss:  35984192.0
Valid Acc:  0.0
std:  1933214533015.4248 
thres:  969634092.006108
Preserved_eigens number check:  512
 18%|█▊        | 185/1000 [55:41<3:58:42, 17.57s/it]Epoch:   186
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.7145, device='cuda:0') 
Std:  tensor(31.1738, device='cuda:0') 
ABS Max:  tensor(443.9482, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([0.9995, 0.9995, 1.0000, 1.0006, 0.9994, 1.0000, 1.0000, 1.0001, 0.9997,
        1.0003], device='cuda:0') tensor(144, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0003, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(8088.8730, device='cuda:0')
min of grad d_p:  tensor(-13006.1768, device='cuda:0')
max|min: (J_L, Jta/N)  (8088.873046875, 8129.42138671875, ratio: 1.0050128698349)|(-13006.1767578125, -13005.7451171875)

 check Jacobi res:  torch.Size([793601]) max:  tensor(40.0942, device='cuda:0') mean:  tensor(-0.0006, device='cuda:0') min:  tensor(-40.5483, device='cuda:0') norm:  tensor(118.4508, device='cuda:0') MSE:  tensor(0.0001, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(51.7067, device='cuda:0') mean:  tensor(0.0227, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(209.9218, device='cuda:0') MSE:  tensor(0.0003, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(46.4403, device='cuda:0')
min of d_p_list:  tensor(-20.8717, device='cuda:0')
Epoch:  186  
Training Loss: 42475360.0
Test Loss:  43439760.0
Test Acc:  0.0
Valid Loss:  42186516.0
Valid Acc:  0.0
std:  1933210272268.4075 
thres:  969642587.0388001
Preserved_eigens number check:  512
 19%|█▊        | 186/1000 [55:58<3:57:05, 17.48s/it]Epoch:   187
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-2.5390, device='cuda:0') 
Std:  tensor(40.8745, device='cuda:0') 
ABS Max:  tensor(487.0961, device='cuda:0') 
ABS Min:  tensor(0.0236, device='cuda:0')
Criterion check:  tensor([ 1.0019,  1.0403,  1.0183,  1.3669,  0.9702,  0.7671,  0.9347, -1.3212,
         2.2751, 22.5282], device='cuda:0') tensor(219, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0052, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(12428.4199, device='cuda:0')
min of grad d_p:  tensor(-598582.9375, device='cuda:0')
max|min: (J_L, Jta/N)  (12428.419921875, 12428.419921875, ratio: 1.0)|(-598582.9375, -598566.9375)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0278, device='cuda:0') mean:  tensor(-2.6290e-05, device='cuda:0') min:  tensor(-16., device='cuda:0') norm:  tensor(16.8107, device='cuda:0') MSE:  tensor(2.1183e-05, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(3677.4375, device='cuda:0') mean:  tensor(1.2795, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(16615.5410, device='cuda:0') MSE:  tensor(0.0209, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(2.1210, device='cuda:0')
min of d_p_list:  tensor(-4.4319, device='cuda:0')
Epoch:  187  
Training Loss: 7829788.0
Test Loss:  8230378.0
Test Acc:  0.0
Valid Loss:  7400180.5
Valid Acc:  0.0
std:  1934409825748.0369 
thres:  967232259.2364
Preserved_eigens number check:  512
 19%|█▊        | 187/1000 [56:16<3:58:52, 17.63s/it]Epoch:   188
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.7525, device='cuda:0') 
Std:  tensor(14.1589, device='cuda:0') 
ABS Max:  tensor(273.9507, device='cuda:0') 
ABS Min:  tensor(0.0001, device='cuda:0')
Criterion check:  tensor([1.0002, 0.9998, 1.0000, 1.0001, 1.0000, 1.0000, 1.0001, 1.0007, 0.9999,
        0.9995], device='cuda:0') tensor(139, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0003, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(5361.6162, device='cuda:0')
min of grad d_p:  tensor(-8185.5679, device='cuda:0')
max|min: (J_L, Jta/N)  (5361.6162109375, 5361.62060546875, ratio: 1.0000008344650269)|(-8185.56787109375, -8185.568359375)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0085, device='cuda:0') mean:  tensor(8.4592e-08, device='cuda:0') min:  tensor(-0.0291, device='cuda:0') norm:  tensor(0.0355, device='cuda:0') MSE:  tensor(4.4755e-08, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(5.3121, device='cuda:0') mean:  tensor(0.0025, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(22.8985, device='cuda:0') MSE:  tensor(2.8854e-05, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(7.9180, device='cuda:0')
min of d_p_list:  tensor(-8.8295, device='cuda:0')
Epoch:  188  
Training Loss: 5696223.0
Test Loss:  6054873.0
Test Acc:  0.0
Valid Loss:  5565456.5
Valid Acc:  0.0
std:  1934411434771.2236 
thres:  967229041.2286
Preserved_eigens number check:  512
 19%|█▉        | 188/1000 [56:34<3:56:53, 17.50s/it]Epoch:   189
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  510
Criterion check: 
Mean:  tensor(0.5860, device='cuda:0') 
Std:  tensor(14.2859, device='cuda:0') 
ABS Max:  tensor(288.1018, device='cuda:0') 
ABS Min:  tensor(0.0005, device='cuda:0')
Criterion check:  tensor([1.0003, 0.9999, 1.0044, 0.9999, 0.9999, 1.0002, 1.0008, 0.9997, 1.0004,
        1.0047], device='cuda:0') tensor(128, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(4.6383e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(2317.0286, device='cuda:0')
min of grad d_p:  tensor(-3415.5420, device='cuda:0')
max|min: (J_L, Jta/N)  (2317.028564453125, 2317.028564453125, ratio: 1.0)|(-3415.5419921875, -3415.541015625)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0029, device='cuda:0') mean:  tensor(-8.4865e-08, device='cuda:0') min:  tensor(-0.0027, device='cuda:0') norm:  tensor(0.0095, device='cuda:0') MSE:  tensor(1.1928e-08, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(5.6859, device='cuda:0') mean:  tensor(0.0019, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(19.6629, device='cuda:0') MSE:  tensor(2.4777e-05, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(4.3164, device='cuda:0')
min of d_p_list:  tensor(-6.4799, device='cuda:0')
Epoch:  189  
Training Loss: 360638.09375
Test Loss:  383828.875
Test Acc:  0.0
Valid Loss:  360971.125
Valid Acc:  0.0
std:  17519109.214004934 
thres:  18731.22501875
Preserved_eigens number check:  512
 19%|█▉        | 189/1000 [56:51<3:56:39, 17.51s/it]Epoch:   190
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(5.3229, device='cuda:0') 
Std:  tensor(114.9170, device='cuda:0') 
ABS Max:  tensor(2599.4465, device='cuda:0') 
ABS Min:  tensor(0.0012, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0002, 1.0000, 1.0001, 1.0006, 1.0001, 0.9993, 1.0075, 1.0005,
        0.9890], device='cuda:0') tensor(116, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(2.7777e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1719.6188, device='cuda:0')
min of grad d_p:  tensor(-1135.8010, device='cuda:0')
max|min: (J_L, Jta/N)  (1719.6187744140625, 1719.6168212890625, ratio: 0.9999988675117493)|(-1135.801025390625, -1135.800048828125)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0020, device='cuda:0') mean:  tensor(5.6901e-08, device='cuda:0') min:  tensor(-0.0023, device='cuda:0') norm:  tensor(0.0078, device='cuda:0') MSE:  tensor(9.7722e-09, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(1.3944, device='cuda:0') mean:  tensor(0.0007, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(6.4730, device='cuda:0') MSE:  tensor(8.1564e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(2.4653, device='cuda:0')
min of d_p_list:  tensor(-1.3964, device='cuda:0')
Epoch:  190  
Training Loss: 172879.15625
Test Loss:  192376.90625
Test Acc:  0.0
Valid Loss:  161106.875
Valid Acc:  0.0
std:  15867135.676420018 
thres:  11306.97765
Preserved_eigens number check:  512
 19%|█▉        | 190/1000 [57:09<3:57:12, 17.57s/it]Epoch:   191
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  510
Criterion check: 
Mean:  tensor(-1.5135, device='cuda:0') 
Std:  tensor(92.4697, device='cuda:0') 
ABS Max:  tensor(1855.1426, device='cuda:0') 
ABS Min:  tensor(7.2716e-05, device='cuda:0')
Criterion check:  tensor([0.9990, 1.0011, 1.0005, 0.9994, 0.9991, 1.0002, 1.0003, 1.0026, 1.0403,
        0.9890], device='cuda:0') tensor(99, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(7.0882e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(200.1160, device='cuda:0')
min of grad d_p:  tensor(-80.6431, device='cuda:0')
max|min: (J_L, Jta/N)  (200.11602783203125, 200.1166534423828, ratio: 1.0000030994415283)|(-80.64311218261719, -80.64306640625)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(-3.6202e-08, device='cuda:0') min:  tensor(-0.0006, device='cuda:0') norm:  tensor(0.0029, device='cuda:0') MSE:  tensor(3.6372e-09, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(1.5315, device='cuda:0') mean:  tensor(0.0009, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(8.6747, device='cuda:0') MSE:  tensor(1.0931e-05, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(1.7925, device='cuda:0')
min of d_p_list:  tensor(-1.3795, device='cuda:0')
Epoch:  191  
Training Loss: 67334.96875
Test Loss:  75279.46875
Test Acc:  0.0
Valid Loss:  62720.3125
Valid Acc:  0.0
std:  3286437.7293892116 
thres:  2825.37264375
Preserved_eigens number check:  512
 19%|█▉        | 191/1000 [57:26<3:57:29, 17.61s/it]Epoch:   192
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(0.9208, device='cuda:0') 
Std:  tensor(15.7039, device='cuda:0') 
ABS Max:  tensor(351.5470, device='cuda:0') 
ABS Min:  tensor(0.0001, device='cuda:0')
Criterion check:  tensor([1.0015, 1.0011, 1.0128, 0.9994, 1.0000, 1.0005, 1.0018, 0.9985, 1.2027,
        0.9110], device='cuda:0') tensor(79, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0001, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(41.9024, device='cuda:0')
min of grad d_p:  tensor(-98.9024, device='cuda:0')
max|min: (J_L, Jta/N)  (41.90235137939453, 41.90217208862305, ratio: 0.9999957084655762)|(-98.9023666381836, -98.90221405029297)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0008, device='cuda:0') mean:  tensor(1.5172e-08, device='cuda:0') min:  tensor(-0.0005, device='cuda:0') norm:  tensor(0.0029, device='cuda:0') MSE:  tensor(3.6012e-09, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.8482, device='cuda:0') mean:  tensor(0.0005, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(4.8944, device='cuda:0') MSE:  tensor(6.1673e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(5.5763, device='cuda:0')
min of d_p_list:  tensor(-6.9480, device='cuda:0')
Epoch:  192  
Training Loss: 29320.48046875
Test Loss:  31587.435546875
Test Acc:  0.0
Valid Loss:  33995.7890625
Valid Acc:  0.0
std:  2218451.743132184 
thres:  1265.27913984375
Preserved_eigens number check:  512
 19%|█▉        | 192/1000 [57:44<3:55:03, 17.46s/it]Epoch:   193
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(0.1798, device='cuda:0') 
Std:  tensor(3.8385, device='cuda:0') 
ABS Max:  tensor(41.6827, device='cuda:0') 
ABS Min:  tensor(7.6146e-05, device='cuda:0')
Criterion check:  tensor([1.0001, 1.0001, 1.0000, 0.9997, 1.0001, 1.0004, 0.9831, 1.0005, 0.9964,
        1.0003], device='cuda:0') tensor(103, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0001, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(11439.3037, device='cuda:0')
min of grad d_p:  tensor(-10337.8027, device='cuda:0')
max|min: (J_L, Jta/N)  (11439.3037109375, 11439.302734375, ratio: 0.9999999403953552)|(-10337.802734375, -10337.8134765625)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0107, device='cuda:0') mean:  tensor(-6.9738e-08, device='cuda:0') min:  tensor(-0.0139, device='cuda:0') norm:  tensor(0.0354, device='cuda:0') MSE:  tensor(4.4558e-08, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(5.4926, device='cuda:0') mean:  tensor(0.0025, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(28.8874, device='cuda:0') MSE:  tensor(3.6400e-05, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(31.7090, device='cuda:0')
min of d_p_list:  tensor(-34.7564, device='cuda:0')
Epoch:  193  
Training Loss: 5766450.0
Test Loss:  5931998.0
Test Acc:  0.0
Valid Loss:  5425030.0
Valid Acc:  0.0
std:  2246505.2831982705 
thres:  1279.32453984375
Preserved_eigens number check:  512
 19%|█▉        | 193/1000 [58:01<3:54:47, 17.46s/it]Epoch:   194
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(2.9444, device='cuda:0') 
Std:  tensor(77.5603, device='cuda:0') 
ABS Max:  tensor(1666.0532, device='cuda:0') 
ABS Min:  tensor(0.0052, device='cuda:0')
Criterion check:  tensor([1.0000, 0.9997, 0.9996, 1.0003, 0.9998, 1.0000, 1.0000, 1.0001, 1.0256,
        0.9511], device='cuda:0') tensor(221, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0003, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(74718.5078, device='cuda:0')
min of grad d_p:  tensor(-42802.2109, device='cuda:0')
max|min: (J_L, Jta/N)  (74718.5078125, 74718.640625, ratio: 1.0000017881393433)|(-42802.2109375, -42802.1640625)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0217, device='cuda:0') mean:  tensor(-3.1531e-07, device='cuda:0') min:  tensor(-0.1328, device='cuda:0') norm:  tensor(0.3140, device='cuda:0') MSE:  tensor(3.9561e-07, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(72.1836, device='cuda:0') mean:  tensor(0.0347, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(337.8199, device='cuda:0') MSE:  tensor(0.0004, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(9.8192, device='cuda:0')
min of d_p_list:  tensor(-8.9503, device='cuda:0')
Epoch:  194  
Training Loss: 447648.78125
Test Loss:  485413.75
Test Acc:  0.0
Valid Loss:  437998.0625
Valid Acc:  0.0
std:  2239647.987806878 
thres:  1296.72667734375
Preserved_eigens number check:  512
 19%|█▉        | 194/1000 [58:19<3:55:47, 17.55s/it]Epoch:   195
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(3.6165, device='cuda:0') 
Std:  tensor(61.0660, device='cuda:0') 
ABS Max:  tensor(1357.2839, device='cuda:0') 
ABS Min:  tensor(0.0014, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 0.9999, 1.0000, 1.0000, 0.9999, 1.0001, 1.0000, 1.0023,
        1.0000], device='cuda:0') tensor(168, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0005, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(8363.2158, device='cuda:0')
min of grad d_p:  tensor(-7145.1006, device='cuda:0')
max|min: (J_L, Jta/N)  (8363.2158203125, 8363.2099609375, ratio: 0.9999992847442627)|(-7145.1005859375, -7145.10107421875)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0125, device='cuda:0') mean:  tensor(1.7032e-07, device='cuda:0') min:  tensor(-0.0109, device='cuda:0') norm:  tensor(0.0336, device='cuda:0') MSE:  tensor(4.2365e-08, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(4.6266, device='cuda:0') mean:  tensor(0.0030, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(30.1464, device='cuda:0') MSE:  tensor(3.7987e-05, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(2.9288, device='cuda:0')
min of d_p_list:  tensor(-3.1030, device='cuda:0')
Epoch:  195  
Training Loss: 91898.140625
Test Loss:  102296.3125
Test Acc:  0.0
Valid Loss:  97698.7578125
Valid Acc:  0.0
std:  2247993.884052265 
thres:  1280.53047421875
Preserved_eigens number check:  512
 20%|█▉        | 195/1000 [58:36<3:54:03, 17.45s/it]Epoch:   196
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(1.0527, device='cuda:0') 
Std:  tensor(18.5180, device='cuda:0') 
ABS Max:  tensor(219.9889, device='cuda:0') 
ABS Min:  tensor(0.0005, device='cuda:0')
Criterion check:  tensor([1.0005, 1.0143, 0.9983, 1.0000, 1.0005, 0.9998, 1.0024, 1.0000, 0.9982,
        0.9984], device='cuda:0') tensor(128, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0002, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(813.9302, device='cuda:0')
min of grad d_p:  tensor(-666.3555, device='cuda:0')
max|min: (J_L, Jta/N)  (813.9302368164062, 813.9326171875, ratio: 1.0000029802322388)|(-666.3555297851562, -666.3571166992188)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0016, device='cuda:0') mean:  tensor(-1.0220e-07, device='cuda:0') min:  tensor(-0.0024, device='cuda:0') norm:  tensor(0.0105, device='cuda:0') MSE:  tensor(1.3255e-08, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(3.4878, device='cuda:0') mean:  tensor(0.0023, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(21.8706, device='cuda:0') MSE:  tensor(2.7559e-05, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(15.4294, device='cuda:0')
min of d_p_list:  tensor(-12.9038, device='cuda:0')
Epoch:  196  
Training Loss: 835307.5625
Test Loss:  881196.375
Test Acc:  0.0
Valid Loss:  763970.75
Valid Acc:  0.0
std:  2185214.233861818 
thres:  1434.12499296875
Preserved_eigens number check:  512
 20%|█▉        | 196/1000 [58:54<3:54:50, 17.53s/it]Epoch:   197
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(0.5760, device='cuda:0') 
Std:  tensor(12.9834, device='cuda:0') 
ABS Max:  tensor(253.9286, device='cuda:0') 
ABS Min:  tensor(0.0001, device='cuda:0')
Criterion check:  tensor([0.9964, 0.9988, 1.0001, 0.9999, 1.0001, 1.0017, 1.0070, 0.9964, 1.0059,
        0.9718], device='cuda:0') tensor(126, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0003, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(4300.5889, device='cuda:0')
min of grad d_p:  tensor(-2490.1152, device='cuda:0')
max|min: (J_L, Jta/N)  (4300.5888671875, 4300.5888671875, ratio: 1.0)|(-2490.115234375, -2490.114501953125)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0124, device='cuda:0') mean:  tensor(-4.2455e-08, device='cuda:0') min:  tensor(-0.0049, device='cuda:0') norm:  tensor(0.0217, device='cuda:0') MSE:  tensor(2.7353e-08, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(10.1191, device='cuda:0') mean:  tensor(0.0035, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(43.3733, device='cuda:0') MSE:  tensor(5.4654e-05, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(4.7051, device='cuda:0')
min of d_p_list:  tensor(-4.0401, device='cuda:0')
Epoch:  197  
Training Loss: 68737.96875
Test Loss:  76853.765625
Test Acc:  0.0
Valid Loss:  63698.3515625
Valid Acc:  0.0
std:  2180197.3075503767 
thres:  1442.0084906250001
Preserved_eigens number check:  512
 20%|█▉        | 197/1000 [59:11<3:53:40, 17.46s/it]Epoch:   198
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-2.6816, device='cuda:0') 
Std:  tensor(52.7529, device='cuda:0') 
ABS Max:  tensor(1089.3212, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([1.0039, 1.0118, 1.0001, 1.0001, 0.9991, 1.0042, 1.0105, 0.9971, 1.0089,
        1.0034], device='cuda:0') tensor(124, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0004, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1388.4185, device='cuda:0')
min of grad d_p:  tensor(-997.5833, device='cuda:0')
max|min: (J_L, Jta/N)  (1388.41845703125, 1388.4166259765625, ratio: 0.9999986886978149)|(-997.5833129882812, -997.5814208984375)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0044, device='cuda:0') mean:  tensor(-2.1057e-07, device='cuda:0') min:  tensor(-0.0060, device='cuda:0') norm:  tensor(0.0223, device='cuda:0') MSE:  tensor(2.8075e-08, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(5.5960, device='cuda:0') mean:  tensor(0.0035, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(38.1763, device='cuda:0') MSE:  tensor(4.8105e-05, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(8.2668, device='cuda:0')
min of d_p_list:  tensor(-9.8583, device='cuda:0')
Epoch:  198  
Training Loss: 20761.23046875
Test Loss:  24350.94140625
Test Acc:  0.0
Valid Loss:  22248.84765625
Valid Acc:  0.0
std:  310761.32915218704 
thres:  292.87073671875
Preserved_eigens number check:  512
 20%|█▉        | 198/1000 [59:29<3:54:36, 17.55s/it]Epoch:   199
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(0.1069, device='cuda:0') 
Std:  tensor(7.8769, device='cuda:0') 
ABS Max:  tensor(103.6411, device='cuda:0') 
ABS Min:  tensor(9.2835e-05, device='cuda:0')
Criterion check:  tensor([0.9970, 1.0002, 0.9997, 1.0001, 0.9999, 0.9933, 1.0036, 0.9948, 0.9931,
        1.0089], device='cuda:0') tensor(83, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0003, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(2537.2168, device='cuda:0')
min of grad d_p:  tensor(-2609.3660, device='cuda:0')
max|min: (J_L, Jta/N)  (2537.216796875, 2537.216552734375, ratio: 0.9999998807907104)|(-2609.365966796875, -2609.3701171875)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0085, device='cuda:0') mean:  tensor(-2.1124e-09, device='cuda:0') min:  tensor(-0.0062, device='cuda:0') norm:  tensor(0.0196, device='cuda:0') MSE:  tensor(2.4752e-08, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(5.8572, device='cuda:0') mean:  tensor(0.0023, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(25.5958, device='cuda:0') MSE:  tensor(3.2253e-05, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(5.0205, device='cuda:0')
min of d_p_list:  tensor(-6.9422, device='cuda:0')
Epoch:  199  
Training Loss: 58669.828125
Test Loss:  65499.97265625
Test Acc:  0.0
Valid Loss:  54166.3671875
Valid Acc:  0.0
std:  310964.9227178352 
thres:  215.07494609375001
Preserved_eigens number check:  512
 20%|█▉        | 199/1000 [59:55<4:30:06, 20.23s/it]Epoch:   200
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(1.3791, device='cuda:0') 
Std:  tensor(42.7773, device='cuda:0') 
ABS Max:  tensor(878.7274, device='cuda:0') 
ABS Min:  tensor(0.0013, device='cuda:0')
Criterion check:  tensor([1.0018, 0.9989, 0.9959, 0.9997, 1.0013, 1.0034, 1.0060, 1.0036, 1.0046,
        1.1705], device='cuda:0') tensor(156, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(4.6244e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1686.9755, device='cuda:0')
min of grad d_p:  tensor(-2136.3721, device='cuda:0')
max|min: (J_L, Jta/N)  (1686.9754638671875, 1686.97119140625, ratio: 0.9999974966049194)|(-2136.3720703125, -2136.365478515625)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0059, device='cuda:0') mean:  tensor(-1.8056e-07, device='cuda:0') min:  tensor(-0.0066, device='cuda:0') norm:  tensor(0.0225, device='cuda:0') MSE:  tensor(2.8353e-08, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(9.2605, device='cuda:0') mean:  tensor(0.0053, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(52.1494, device='cuda:0') MSE:  tensor(6.5712e-05, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(8.6425, device='cuda:0')
min of d_p_list:  tensor(-8.8806, device='cuda:0')
Epoch:  200  
Training Loss: 16037.28515625
Test Loss:  18006.373046875
Test Acc:  0.0
Valid Loss:  16883.53515625
Valid Acc:  0.0
std:  318367.21156301274 
thres:  199.902775
Preserved_eigens number check:  512
 20%|██        | 200/1000 [1:00:13<4:18:51, 19.41s/it]Epoch:   201
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(-196.9964, device='cuda:0') 
Std:  tensor(4425.0806, device='cuda:0') 
ABS Max:  tensor(100124.4609, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([0.9997, 1.0017, 0.9997, 1.0009, 0.9994, 0.9991, 1.0058, 0.9976, 1.0041,
        1.0611], device='cuda:0') tensor(203, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(6.6388e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(2438.9072, device='cuda:0')
min of grad d_p:  tensor(-3132.3345, device='cuda:0')
max|min: (J_L, Jta/N)  (2438.9072265625, 2438.907958984375, ratio: 1.0000003576278687)|(-3132.33447265625, -3132.336181640625)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0039, device='cuda:0') mean:  tensor(1.3603e-07, device='cuda:0') min:  tensor(-0.0066, device='cuda:0') norm:  tensor(0.0156, device='cuda:0') MSE:  tensor(1.9607e-08, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(33.2479, device='cuda:0') mean:  tensor(0.0079, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(99.3004, device='cuda:0') MSE:  tensor(0.0001, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(3.5066, device='cuda:0')
min of d_p_list:  tensor(-2.1295, device='cuda:0')
Epoch:  201  
Training Loss: 3500.545654296875
Test Loss:  3807.033447265625
Test Acc:  0.0
Valid Loss:  3510.42529296875
Valid Acc:  0.0
std:  25465.3335000081 
thres:  33.54137163085937
Preserved_eigens number check:  512
 20%|██        | 201/1000 [1:00:30<4:09:02, 18.70s/it]Epoch:   202
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(0.9521, device='cuda:0') 
Std:  tensor(12.8943, device='cuda:0') 
ABS Max:  tensor(231.1802, device='cuda:0') 
ABS Min:  tensor(0.0015, device='cuda:0')
Criterion check:  tensor([1.0038, 0.9997, 1.0003, 1.0001, 1.0003, 1.0015, 0.9993, 1.0107, 0.9959,
        1.0144], device='cuda:0') tensor(130, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0002, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1453.0442, device='cuda:0')
min of grad d_p:  tensor(-1285.2839, device='cuda:0')
max|min: (J_L, Jta/N)  (1453.044189453125, 1453.04736328125, ratio: 1.000002145767212)|(-1285.283935546875, -1285.2796630859375)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0017, device='cuda:0') mean:  tensor(-2.5674e-07, device='cuda:0') min:  tensor(-0.0043, device='cuda:0') norm:  tensor(0.0166, device='cuda:0') MSE:  tensor(2.0939e-08, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(4.4744, device='cuda:0') mean:  tensor(0.0018, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(17.2315, device='cuda:0') MSE:  tensor(2.1713e-05, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(1.9066, device='cuda:0')
min of d_p_list:  tensor(-1.8733, device='cuda:0')
Epoch:  202  
Training Loss: 1949.351806640625
Test Loss:  2044.9613037109375
Test Acc:  0.0
Valid Loss:  2208.698974609375
Valid Acc:  0.0
std:  20540.338110647295 
thres:  20.183648242187502
Preserved_eigens number check:  512
 20%|██        | 202/1000 [1:00:47<4:04:12, 18.36s/it]Epoch:   203
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  510
Criterion check: 
Mean:  tensor(-0.2651, device='cuda:0') 
Std:  tensor(11.4025, device='cuda:0') 
ABS Max:  tensor(149.7336, device='cuda:0') 
ABS Min:  tensor(0.0001, device='cuda:0')
Criterion check:  tensor([0.9994, 0.9993, 0.9999, 1.0002, 1.0017, 0.9995, 0.9943, 1.0009, 0.9918,
        0.9839], device='cuda:0') tensor(75, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(1.6378e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(198.0999, device='cuda:0')
min of grad d_p:  tensor(-297.8709, device='cuda:0')
max|min: (J_L, Jta/N)  (198.09994506835938, 198.09963989257812, ratio: 0.9999984502792358)|(-297.87091064453125, -297.8719177246094)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0010, device='cuda:0') mean:  tensor(5.6952e-08, device='cuda:0') min:  tensor(-0.0006, device='cuda:0') norm:  tensor(0.0040, device='cuda:0') MSE:  tensor(5.0356e-09, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(1.0089, device='cuda:0') mean:  tensor(0.0005, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(5.5069, device='cuda:0') MSE:  tensor(6.9391e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(79.0216, device='cuda:0')
min of d_p_list:  tensor(-25.7744, device='cuda:0')
Epoch:  203  
Training Loss: 2145496.5
Test Loss:  2089645.125
Test Acc:  0.0
Valid Loss:  2080874.875
Valid Acc:  0.0
std:  850430.9400035007 
thres:  445.13070214843754
Preserved_eigens number check:  512
 20%|██        | 203/1000 [1:01:05<4:01:25, 18.18s/it]Epoch:   204
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(11.6068, device='cuda:0') 
Std:  tensor(141.8647, device='cuda:0') 
ABS Max:  tensor(1681.9559, device='cuda:0') 
ABS Min:  tensor(0.0026, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0004, 0.9998, 0.9989, 1.0002, 0.9973, 1.0157, 0.9997, 1.2099,
        0.9806], device='cuda:0') tensor(241, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0005, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(9631.0801, device='cuda:0')
min of grad d_p:  tensor(-10416.6699, device='cuda:0')
max|min: (J_L, Jta/N)  (9631.080078125, 9631.0869140625, ratio: 1.0000007152557373)|(-10416.669921875, -10416.669921875)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0070, device='cuda:0') mean:  tensor(-1.3637e-07, device='cuda:0') min:  tensor(-0.0100, device='cuda:0') norm:  tensor(0.0442, device='cuda:0') MSE:  tensor(5.5745e-08, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(101.2002, device='cuda:0') mean:  tensor(0.0518, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(594.0892, device='cuda:0') MSE:  tensor(0.0007, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(6.8012, device='cuda:0')
min of d_p_list:  tensor(-5.2211, device='cuda:0')
Epoch:  204  
Training Loss: 622326.3125
Test Loss:  639651.5625
Test Acc:  0.0
Valid Loss:  588035.625
Valid Acc:  0.0
std:  828814.6317817387 
thres:  557.8619990234375
Preserved_eigens number check:  512
 20%|██        | 204/1000 [1:01:23<4:00:10, 18.10s/it]Epoch:   205
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(0.4883, device='cuda:0') 
Std:  tensor(13.1032, device='cuda:0') 
ABS Max:  tensor(178.5882, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([1.0027, 1.0002, 1.0000, 0.9988, 0.9999, 0.9976, 1.0036, 0.9987, 0.9991,
        0.9991], device='cuda:0') tensor(107, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(3.9600e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1383.3765, device='cuda:0')
min of grad d_p:  tensor(-2345.9761, device='cuda:0')
max|min: (J_L, Jta/N)  (1383.37646484375, 1383.3790283203125, ratio: 1.0000019073486328)|(-2345.97607421875, -2345.97705078125)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0017, device='cuda:0') mean:  tensor(-1.9430e-07, device='cuda:0') min:  tensor(-0.0029, device='cuda:0') norm:  tensor(0.0167, device='cuda:0') MSE:  tensor(2.1066e-08, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(4.5421, device='cuda:0') mean:  tensor(0.0017, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(19.1180, device='cuda:0') MSE:  tensor(2.4090e-05, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(29.7833, device='cuda:0')
min of d_p_list:  tensor(-29.2585, device='cuda:0')
Epoch:  205  
Training Loss: 3854803.5
Test Loss:  4545498.0
Test Acc:  0.0
Valid Loss:  5131241.0
Valid Acc:  0.0
std:  1487527.646743862 
thres:  1325.6152419921875
Preserved_eigens number check:  512
 20%|██        | 205/1000 [1:01:41<3:59:09, 18.05s/it]