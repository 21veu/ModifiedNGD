/nishome/yui/ModifiedNGD/utils/readData.py:18: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  return torch.tensor(x, dtype=torch.float32), torch.tensor(y, dtype=torch.float32)
/nishome/yui/anaconda3/envs/ng/lib/python3.12/site-packages/torch/autograd/graph.py:744: UserWarning: Using backward() with create_graph=True will create a reference cycle between the parameter and its gradient which can cause a memory leak. We recommend using autograd.grad when creating the graph to avoid this. If you have to use this function, make sure to reset the .grad fields of your parameters to None after use to break the cycle and avoid the leak. (Triggered internally at /opt/conda/conda-bld/pytorch_1716905971214/work/torch/csrc/autograd/engine.cpp:1203.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
Train info: 
 train data shape: torch.Size([512, 2]), 
 train lable shape: torch.Size([512, 1]), 
 positive / negative: -0.02499326691031456 / 1.0249933004379272
Test info: 
 test data shape: torch.Size([128, 2]), 
 test lable shape: torch.Size([128, 1]), , 
 positive / negative: -0.006046447902917862 / 1.0060464143753052
Valid info: 
 valid data shape: torch.Size([128, 2]), valid lable shape: torch.Size([128, 1]), 
 positive / negative: 0.050523675978183746 / 0.9494763016700745
torch.Size([512, 2]) torch.Size([512])
seed is  2190
---------------------------------------- MNGD ----------------------------------------
OUTPUT CHECK:  torch.Size([512]) tensor(-0.0934, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1214, device='cuda:0', grad_fn=<MinBackward1>) 
TARGET:  torch.Size([512]) tensor(0.5000, device='cuda:0') tensor(-0.5000, device='cuda:0')
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  5
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch:   1
Test train Loss:  0.06703334301710129
Test train Acc:  0.0
Test Loss:  0.07140271365642548
Test Acc:  0.0
Valid Loss:  0.08514202386140823
Valid Acc:  0.0
max of grad d_p:  tensor(0.0067, device='cuda:0')
min of grad d_p:  tensor(-0.0852, device='cuda:0')

 check Jacobi res:  torch.Size([266401]) max:  tensor(0.0023, device='cuda:0') mean:  tensor(-3.1503e-06, device='cuda:0') min:  tensor(-0.0022, device='cuda:0') norm:  tensor(0.0614, device='cuda:0') MSE:  tensor(2.3039e-07, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([266401, 1]) max:  tensor(5.8077e-05, device='cuda:0') mean:  tensor(6.1226e-07, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0006, device='cuda:0') MSE:  tensor(2.3268e-09, device='cuda:0')
Shape check:  torch.Size([266401, 1])
max of d_p_list:  tensor(0.0204, device='cuda:0')
min of d_p_list:  tensor(-0.0074, device='cuda:0')
Epoch:  1  
Training Loss: 0.06257871827983763
Test Loss:  0.06626077741384506
Test Acc:  0.0
Valid Loss:  0.07920993119478226
Valid Acc:  0.0
local minima detector shape:  (0,)
Preserved_eigens number check:  5
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  7
  0%|          | 1/1000 [00:03<1:03:38,  3.82s/it]Epoch:   2
max of grad d_p:  tensor(0.0059, device='cuda:0')
min of grad d_p:  tensor(-0.0850, device='cuda:0')

 check Jacobi res:  torch.Size([266401]) max:  tensor(0.0028, device='cuda:0') mean:  tensor(-5.3926e-06, device='cuda:0') min:  tensor(-0.0033, device='cuda:0') norm:  tensor(0.0635, device='cuda:0') MSE:  tensor(2.3853e-07, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([266401, 1]) max:  tensor(1.3366e-05, device='cuda:0') mean:  tensor(2.9553e-07, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0003, device='cuda:0') MSE:  tensor(1.1437e-09, device='cuda:0')
Shape check:  torch.Size([266401, 1])
max of d_p_list:  tensor(0.0033, device='cuda:0')
min of d_p_list:  tensor(-0.0041, device='cuda:0')
Epoch:  2  
Training Loss: 0.061651621013879776
Test Loss:  0.06548731029033661
Test Acc:  0.0
Valid Loss:  0.0781988799571991
Valid Acc:  0.0
local minima detector shape:  (1,)
Preserved_eigens number check:  7
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  5
  0%|          | 2/1000 [00:07<1:05:08,  3.92s/it]Epoch:   3
max of grad d_p:  tensor(0.0058, device='cuda:0')
min of grad d_p:  tensor(-0.0845, device='cuda:0')

 check Jacobi res:  torch.Size([266401]) max:  tensor(0.0028, device='cuda:0') mean:  tensor(-5.3936e-06, device='cuda:0') min:  tensor(-0.0039, device='cuda:0') norm:  tensor(0.0599, device='cuda:0') MSE:  tensor(2.2469e-07, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([266401, 1]) max:  tensor(2.6718e-05, device='cuda:0') mean:  tensor(3.2833e-07, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0003, device='cuda:0') MSE:  tensor(1.2861e-09, device='cuda:0')
Shape check:  torch.Size([266401, 1])
max of d_p_list:  tensor(0.0528, device='cuda:0')
min of d_p_list:  tensor(-0.0409, device='cuda:0')
Epoch:  3  
Training Loss: 0.058730997145175934
Test Loss:  0.06329488009214401
Test Acc:  0.0
Valid Loss:  0.07485443353652954
Valid Acc:  0.0
local minima detector shape:  (2,)
Preserved_eigens number check:  5
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  2
  0%|          | 3/1000 [00:11<1:04:39,  3.89s/it]Epoch:   4
max of grad d_p:  tensor(0.0151, device='cuda:0')
min of grad d_p:  tensor(-0.0820, device='cuda:0')

 check Jacobi res:  torch.Size([266401]) max:  tensor(0.0140, device='cuda:0') mean:  tensor(-7.1145e-06, device='cuda:0') min:  tensor(-0.0068, device='cuda:0') norm:  tensor(0.0934, device='cuda:0') MSE:  tensor(3.5070e-07, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([266401, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(5.2502e-07, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0006, device='cuda:0') MSE:  tensor(2.1934e-09, device='cuda:0')
Shape check:  torch.Size([266401, 1])
max of d_p_list:  tensor(0.0482, device='cuda:0')
min of d_p_list:  tensor(-0.0120, device='cuda:0')
Epoch:  4  
Training Loss: 0.05425383523106575
Test Loss:  0.05806794762611389
Test Acc:  0.0
Valid Loss:  0.06880711764097214
Valid Acc:  0.0
local minima detector shape:  (3,)
Preserved_eigens number check:  2
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  6
  0%|          | 4/1000 [00:15<1:04:19,  3.88s/it]Epoch:   5
max of grad d_p:  tensor(0.0161, device='cuda:0')
min of grad d_p:  tensor(-0.0806, device='cuda:0')

 check Jacobi res:  torch.Size([266401]) max:  tensor(0.0113, device='cuda:0') mean:  tensor(-9.7837e-06, device='cuda:0') min:  tensor(-0.0109, device='cuda:0') norm:  tensor(0.0921, device='cuda:0') MSE:  tensor(3.4575e-07, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([266401, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(8.4397e-07, device='cuda:0') min:  tensor(1.8190e-12, device='cuda:0') norm:  tensor(0.0010, device='cuda:0') MSE:  tensor(3.6325e-09, device='cuda:0')
Shape check:  torch.Size([266401, 1])
max of d_p_list:  tensor(0.0120, device='cuda:0')
min of d_p_list:  tensor(-0.0078, device='cuda:0')
Epoch:  5  
Training Loss: 0.05364259332418442
Test Loss:  0.05755239725112915
Test Acc:  0.0
Valid Loss:  0.06807833164930344
Valid Acc:  0.0
local minima detector shape:  (4,)
Preserved_eigens number check:  6
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  5
  0%|          | 5/1000 [00:19<1:02:23,  3.76s/it]Epoch:   6
max of grad d_p:  tensor(0.0162, device='cuda:0')
min of grad d_p:  tensor(-0.0800, device='cuda:0')

 check Jacobi res:  torch.Size([266401]) max:  tensor(0.0126, device='cuda:0') mean:  tensor(-9.0609e-06, device='cuda:0') min:  tensor(-0.0125, device='cuda:0') norm:  tensor(0.0935, device='cuda:0') MSE:  tensor(3.5110e-07, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([266401, 1]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(2.0178e-06, device='cuda:0') min:  tensor(3.6380e-12, device='cuda:0') norm:  tensor(0.0022, device='cuda:0') MSE:  tensor(8.2401e-09, device='cuda:0')
Shape check:  torch.Size([266401, 1])
max of d_p_list:  tensor(0.0539, device='cuda:0')
min of d_p_list:  tensor(-0.1009, device='cuda:0')
Epoch:  6  
Training Loss: 0.05302530527114868
Test Loss:  0.05641299486160278
Test Acc:  0.0
Valid Loss:  0.06670533120632172
Valid Acc:  0.0
std:  0.0033619686208053046 
thres:  5.6260870397090916e-05
Preserved_eigens number check:  5
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  5
  1%|          | 6/1000 [00:23<1:04:10,  3.87s/it]Epoch:   7
max of grad d_p:  tensor(0.0145, device='cuda:0')
min of grad d_p:  tensor(-0.0762, device='cuda:0')

 check Jacobi res:  torch.Size([266401]) max:  tensor(0.0143, device='cuda:0') mean:  tensor(-1.0781e-05, device='cuda:0') min:  tensor(-0.0177, device='cuda:0') norm:  tensor(0.1032, device='cuda:0') MSE:  tensor(3.8752e-07, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([266401, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(8.4416e-07, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0010, device='cuda:0') MSE:  tensor(3.7088e-09, device='cuda:0')
Shape check:  torch.Size([266401, 1])
max of d_p_list:  tensor(0.0455, device='cuda:0')
min of d_p_list:  tensor(-0.0179, device='cuda:0')
Epoch:  7  
Training Loss: 0.0490516722202301
Test Loss:  0.05209283158183098
Test Acc:  0.0
Valid Loss:  0.06149212270975113
Valid Acc:  0.0
std:  0.0030878720587719476 
thres:  5.3740880638360984e-05
Preserved_eigens number check:  5
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  8
  1%|          | 7/1000 [00:26<1:02:33,  3.78s/it]Epoch:   8
max of grad d_p:  tensor(0.0161, device='cuda:0')
min of grad d_p:  tensor(-0.0743, device='cuda:0')

 check Jacobi res:  torch.Size([266401]) max:  tensor(0.0111, device='cuda:0') mean:  tensor(-1.1091e-05, device='cuda:0') min:  tensor(-0.0221, device='cuda:0') norm:  tensor(0.0969, device='cuda:0') MSE:  tensor(3.6366e-07, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([266401, 1]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(2.7660e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0030, device='cuda:0') MSE:  tensor(1.1406e-08, device='cuda:0')
Shape check:  torch.Size([266401, 1])
max of d_p_list:  tensor(0.1121, device='cuda:0')
min of d_p_list:  tensor(-0.0977, device='cuda:0')
Epoch:  8  
Training Loss: 0.045290157198905945
Test Loss:  0.04795835539698601
Test Acc:  0.0
Valid Loss:  0.055639319121837616
Valid Acc:  0.0
std:  0.0034075503653809933 
thres:  5.1052712649106975e-05
Preserved_eigens number check:  8
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  6
  1%|          | 8/1000 [00:30<1:03:00,  3.81s/it]Epoch:   9
max of grad d_p:  tensor(0.0117, device='cuda:0')
min of grad d_p:  tensor(-0.0458, device='cuda:0')

 check Jacobi res:  torch.Size([266401]) max:  tensor(0.0130, device='cuda:0') mean:  tensor(-1.3543e-05, device='cuda:0') min:  tensor(-0.0253, device='cuda:0') norm:  tensor(0.1063, device='cuda:0') MSE:  tensor(3.9884e-07, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([266401, 1]) max:  tensor(0.0019, device='cuda:0') mean:  tensor(9.9908e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0114, device='cuda:0') MSE:  tensor(4.2893e-08, device='cuda:0')
Shape check:  torch.Size([266401, 1])
max of d_p_list:  tensor(0.0097, device='cuda:0')
min of d_p_list:  tensor(-0.0069, device='cuda:0')
Epoch:  9  
Training Loss: 0.04482879862189293
Test Loss:  0.04734998196363449
Test Acc:  0.0
Valid Loss:  0.05491647124290466
Valid Acc:  0.0
std:  0.0037089258412542187 
thres:  4.9167705327272417e-05
Preserved_eigens number check:  6
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  9
  1%|          | 9/1000 [00:34<1:01:14,  3.71s/it]Epoch:   10
max of grad d_p:  tensor(0.0119, device='cuda:0')
min of grad d_p:  tensor(-0.0451, device='cuda:0')

 check Jacobi res:  torch.Size([266401]) max:  tensor(0.0179, device='cuda:0') mean:  tensor(-1.4206e-05, device='cuda:0') min:  tensor(-0.0258, device='cuda:0') norm:  tensor(0.1116, device='cuda:0') MSE:  tensor(4.1878e-07, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([266401, 1]) max:  tensor(8.7489e-05, device='cuda:0') mean:  tensor(5.8410e-07, device='cuda:0') min:  tensor(4.5475e-13, device='cuda:0') norm:  tensor(0.0007, device='cuda:0') MSE:  tensor(2.4508e-09, device='cuda:0')
Shape check:  torch.Size([266401, 1])
max of d_p_list:  tensor(0.0105, device='cuda:0')
min of d_p_list:  tensor(-0.0083, device='cuda:0')
Epoch:  10  
Training Loss: 0.044377632439136505
Test Loss:  0.046797238290309906
Test Acc:  0.0
Valid Loss:  0.054307207465171814
Valid Acc:  0.0
std:  0.0033025120780421258 
thres:  4.731471315026283e-05
Preserved_eigens number check:  9
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  8
  1%|          | 10/1000 [00:38<1:03:39,  3.86s/it]Epoch:   11
max of grad d_p:  tensor(0.0127, device='cuda:0')
min of grad d_p:  tensor(-0.0448, device='cuda:0')

 check Jacobi res:  torch.Size([266401]) max:  tensor(0.0116, device='cuda:0') mean:  tensor(-1.2875e-05, device='cuda:0') min:  tensor(-0.0237, device='cuda:0') norm:  tensor(0.1043, device='cuda:0') MSE:  tensor(3.9169e-07, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([266401, 1]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(2.0904e-06, device='cuda:0') min:  tensor(7.2760e-12, device='cuda:0') norm:  tensor(0.0024, device='cuda:0') MSE:  tensor(9.0733e-09, device='cuda:0')
Shape check:  torch.Size([266401, 1])
max of d_p_list:  tensor(0.0202, device='cuda:0')
min of d_p_list:  tensor(-0.0181, device='cuda:0')
Epoch:  11  
Training Loss: 0.04114675521850586
Test Loss:  0.04299551993608475
Test Acc:  0.0
Valid Loss:  0.05000773444771767
Valid Acc:  0.0
std:  0.002519753263089172 
thres:  4.493900313973427e-05
Preserved_eigens number check:  8
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  6
  1%|          | 11/1000 [00:42<1:04:38,  3.92s/it]Epoch:   12
max of grad d_p:  tensor(0.0131, device='cuda:0')
min of grad d_p:  tensor(-0.0451, device='cuda:0')

 check Jacobi res:  torch.Size([266401]) max:  tensor(0.0179, device='cuda:0') mean:  tensor(-1.4022e-05, device='cuda:0') min:  tensor(-0.0246, device='cuda:0') norm:  tensor(0.1070, device='cuda:0') MSE:  tensor(4.0182e-07, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([266401, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(5.9742e-07, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0007, device='cuda:0') MSE:  tensor(2.5721e-09, device='cuda:0')
Shape check:  torch.Size([266401, 1])
max of d_p_list:  tensor(0.0043, device='cuda:0')
min of d_p_list:  tensor(-0.0051, device='cuda:0')
Epoch:  12  
Training Loss: 0.04078592732548714
Test Loss:  0.042563870549201965
Test Acc:  0.0
Valid Loss:  0.04950282722711563
Valid Acc:  0.0
std:  0.0019191282684837296 
thres:  4.328585416078568e-05
Preserved_eigens number check:  6
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  7
  1%|          | 12/1000 [00:46<1:04:48,  3.94s/it]Epoch:   13
max of grad d_p:  tensor(0.0136, device='cuda:0')
min of grad d_p:  tensor(-0.0448, device='cuda:0')

 check Jacobi res:  torch.Size([266401]) max:  tensor(0.0162, device='cuda:0') mean:  tensor(-1.5620e-05, device='cuda:0') min:  tensor(-0.0275, device='cuda:0') norm:  tensor(0.1171, device='cuda:0') MSE:  tensor(4.3949e-07, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([266401, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(7.0162e-07, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0008, device='cuda:0') MSE:  tensor(3.0165e-09, device='cuda:0')
Shape check:  torch.Size([266401, 1])
max of d_p_list:  tensor(0.0476, device='cuda:0')
min of d_p_list:  tensor(-0.0293, device='cuda:0')
Epoch:  13  
Training Loss: 0.04036738723516464
Test Loss:  0.04220263287425041
Test Acc:  0.0
Valid Loss:  0.04888801649212837
Valid Acc:  0.0
std:  0.001900986704772541 
thres:  4.230130016803742e-05
Preserved_eigens number check:  7
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  4
  1%|▏         | 13/1000 [00:49<1:02:32,  3.80s/it]Epoch:   14
max of grad d_p:  tensor(0.0114, device='cuda:0')
min of grad d_p:  tensor(-0.0433, device='cuda:0')

 check Jacobi res:  torch.Size([266401]) max:  tensor(0.0179, device='cuda:0') mean:  tensor(-1.6636e-05, device='cuda:0') min:  tensor(-0.0291, device='cuda:0') norm:  tensor(0.1293, device='cuda:0') MSE:  tensor(4.8553e-07, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([266401, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(7.2471e-07, device='cuda:0') min:  tensor(2.2737e-13, device='cuda:0') norm:  tensor(0.0009, device='cuda:0') MSE:  tensor(3.2422e-09, device='cuda:0')
Shape check:  torch.Size([266401, 1])
max of d_p_list:  tensor(0.0086, device='cuda:0')
min of d_p_list:  tensor(-0.0058, device='cuda:0')
Epoch:  14  
Training Loss: 0.03989732265472412
Test Loss:  0.041610877960920334
Test Acc:  0.0
Valid Loss:  0.04821073263883591
Valid Acc:  0.0
std:  0.0015871811910384438 
thres:  4.131500497460365e-05
Preserved_eigens number check:  4
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  6
  1%|▏         | 14/1000 [00:53<1:04:04,  3.90s/it]Epoch:   15
max of grad d_p:  tensor(0.0119, device='cuda:0')
min of grad d_p:  tensor(-0.0427, device='cuda:0')

 check Jacobi res:  torch.Size([266401]) max:  tensor(0.0144, device='cuda:0') mean:  tensor(-1.6043e-05, device='cuda:0') min:  tensor(-0.0415, device='cuda:0') norm:  tensor(0.1336, device='cuda:0') MSE:  tensor(5.0132e-07, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([266401, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(1.6085e-06, device='cuda:0') min:  tensor(4.5475e-13, device='cuda:0') norm:  tensor(0.0020, device='cuda:0') MSE:  tensor(7.4899e-09, device='cuda:0')
Shape check:  torch.Size([266401, 1])
max of d_p_list:  tensor(0.0483, device='cuda:0')
min of d_p_list:  tensor(-0.0346, device='cuda:0')
Epoch:  15  
Training Loss: 0.03704997897148132
Test Loss:  0.03830878064036369
Test Acc:  0.0
Valid Loss:  0.04439608380198479
Valid Acc:  0.0
std:  0.0014606559771775127 
thres:  3.984947428107262e-05
Preserved_eigens number check:  6
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  8
  2%|▏         | 15/1000 [00:58<1:04:45,  3.94s/it]Epoch:   16
max of grad d_p:  tensor(0.0103, device='cuda:0')
min of grad d_p:  tensor(-0.0424, device='cuda:0')

 check Jacobi res:  torch.Size([266401]) max:  tensor(0.0166, device='cuda:0') mean:  tensor(-1.7318e-05, device='cuda:0') min:  tensor(-0.0312, device='cuda:0') norm:  tensor(0.1286, device='cuda:0') MSE:  tensor(4.8276e-07, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([266401, 1]) max:  tensor(7.9239e-05, device='cuda:0') mean:  tensor(7.1208e-07, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0008, device='cuda:0') MSE:  tensor(3.0860e-09, device='cuda:0')
Shape check:  torch.Size([266401, 1])
max of d_p_list:  tensor(0.0013, device='cuda:0')
min of d_p_list:  tensor(-0.0028, device='cuda:0')
Epoch:  16  
Training Loss: 0.03677276521921158
Test Loss:  0.03793073445558548
Test Acc:  0.0
Valid Loss:  0.0439867228269577
Valid Acc:  0.0
std:  0.0017102293727010334 
thres:  3.897467628121376e-05
Preserved_eigens number check:  8
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  6
  2%|▏         | 16/1000 [01:01<1:04:08,  3.91s/it]Epoch:   17
max of grad d_p:  tensor(0.0102, device='cuda:0')
min of grad d_p:  tensor(-0.0422, device='cuda:0')

 check Jacobi res:  torch.Size([266401]) max:  tensor(0.0162, device='cuda:0') mean:  tensor(-1.5476e-05, device='cuda:0') min:  tensor(-0.0285, device='cuda:0') norm:  tensor(0.1195, device='cuda:0') MSE:  tensor(4.4869e-07, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([266401, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(2.3830e-06, device='cuda:0') min:  tensor(2.9843e-12, device='cuda:0') norm:  tensor(0.0026, device='cuda:0') MSE:  tensor(9.9145e-09, device='cuda:0')
Shape check:  torch.Size([266401, 1])
max of d_p_list:  tensor(0.0316, device='cuda:0')
min of d_p_list:  tensor(-0.0408, device='cuda:0')
Epoch:  17  
Training Loss: 0.0364907830953598
Test Loss:  0.0377361886203289
Test Acc:  0.0
Valid Loss:  0.043626535683870316
Valid Acc:  0.0
std:  0.0016627606417087188 
thres:  3.811564743518829e-05
Preserved_eigens number check:  6
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  12
  2%|▏         | 17/1000 [01:05<1:03:46,  3.89s/it]Epoch:   18
max of grad d_p:  tensor(0.0124, device='cuda:0')
min of grad d_p:  tensor(-0.0403, device='cuda:0')

 check Jacobi res:  torch.Size([266401]) max:  tensor(0.0184, device='cuda:0') mean:  tensor(-1.7046e-05, device='cuda:0') min:  tensor(-0.0306, device='cuda:0') norm:  tensor(0.1358, device='cuda:0') MSE:  tensor(5.0985e-07, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([266401, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(6.5456e-07, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0007, device='cuda:0') MSE:  tensor(2.7994e-09, device='cuda:0')
Shape check:  torch.Size([266401, 1])
max of d_p_list:  tensor(0.0046, device='cuda:0')
min of d_p_list:  tensor(-0.0050, device='cuda:0')
Epoch:  18  
Training Loss: 0.036214157938957214
Test Loss:  0.037416793406009674
Test Acc:  0.0
Valid Loss:  0.04325208067893982
Valid Acc:  0.0
std:  0.0013356146314100052 
thres:  3.728500157594681e-05
Preserved_eigens number check:  12
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  9
  2%|▏         | 18/1000 [01:09<1:04:41,  3.95s/it]Epoch:   19
max of grad d_p:  tensor(0.0120, device='cuda:0')
min of grad d_p:  tensor(-0.0401, device='cuda:0')

 check Jacobi res:  torch.Size([266401]) max:  tensor(0.0241, device='cuda:0') mean:  tensor(-1.8123e-05, device='cuda:0') min:  tensor(-0.0294, device='cuda:0') norm:  tensor(0.1411, device='cuda:0') MSE:  tensor(5.2975e-07, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([266401, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(8.8151e-07, device='cuda:0') min:  tensor(1.8190e-12, device='cuda:0') norm:  tensor(0.0011, device='cuda:0') MSE:  tensor(4.0083e-09, device='cuda:0')
Shape check:  torch.Size([266401, 1])
max of d_p_list:  tensor(0.2060, device='cuda:0')
min of d_p_list:  tensor(-0.5133, device='cuda:0')
Epoch:  19  
Training Loss: 0.055140748620033264
Test Loss:  0.049331218004226685
Test Acc:  0.0
Valid Loss:  0.04957877844572067
Valid Acc:  0.0
std:  0.007408784060424331 
thres:  4.0333686769008634e-05
Preserved_eigens number check:  9
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  8
  2%|▏         | 19/1000 [01:13<1:04:11,  3.93s/it]Epoch:   20
max of grad d_p:  tensor(0.2305, device='cuda:0')
min of grad d_p:  tensor(-0.0581, device='cuda:0')

 check Jacobi res:  torch.Size([266401]) max:  tensor(0.0433, device='cuda:0') mean:  tensor(-2.4665e-05, device='cuda:0') min:  tensor(-0.1019, device='cuda:0') norm:  tensor(0.3073, device='cuda:0') MSE:  tensor(1.1536e-06, device='cuda:0')
BAD Jacobian OCCURS! Gradient Descent instead!
Shape check:  torch.Size([266401, 1])
max of d_p_list:  tensor(0.2305, device='cuda:0')
min of d_p_list:  tensor(-0.0581, device='cuda:0')
Epoch:  20  
Training Loss: 0.07252149283885956
Test Loss:  0.08370134979486465
Test Acc:  0.0
Valid Loss:  0.09204265475273132
Valid Acc:  0.0
std:  0.01447809980454657 
thres:  4.742798954248428e-05
Preserved_eigens number check:  8
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  7
  2%|▏         | 20/1000 [01:17<1:04:03,  3.92s/it]Epoch:   21
max of grad d_p:  tensor(0.0675, device='cuda:0')
min of grad d_p:  tensor(-0.2703, device='cuda:0')

 check Jacobi res:  torch.Size([266401]) max:  tensor(0.0233, device='cuda:0') mean:  tensor(-1.9766e-05, device='cuda:0') min:  tensor(-0.0684, device='cuda:0') norm:  tensor(0.2404, device='cuda:0') MSE:  tensor(9.0246e-07, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([266401, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(6.6493e-07, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0010, device='cuda:0') MSE:  tensor(3.5886e-09, device='cuda:0')
Shape check:  torch.Size([266401, 1])
max of d_p_list:  tensor(0.2090, device='cuda:0')
min of d_p_list:  tensor(-0.3397, device='cuda:0')
Epoch:  21  
Training Loss: 0.04590502381324768
Test Loss:  0.05180388689041138
Test Acc:  0.0
Valid Loss:  0.056508056819438934
Valid Acc:  0.0
std:  0.013566007957977575 
thres:  4.92544412612915e-05
Preserved_eigens number check:  7
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  15
  2%|▏         | 21/1000 [01:21<1:03:38,  3.90s/it]Epoch:   22
max of grad d_p:  tensor(0.0529, device='cuda:0')
min of grad d_p:  tensor(-0.1811, device='cuda:0')

 check Jacobi res:  torch.Size([266401]) max:  tensor(0.0325, device='cuda:0') mean:  tensor(-2.5693e-05, device='cuda:0') min:  tensor(-0.0875, device='cuda:0') norm:  tensor(0.2779, device='cuda:0') MSE:  tensor(1.0430e-06, device='cuda:0')
BAD Jacobian OCCURS! Gradient Descent instead!
Shape check:  torch.Size([266401, 1])
max of d_p_list:  tensor(0.0529, device='cuda:0')
min of d_p_list:  tensor(-0.1811, device='cuda:0')
Epoch:  22  
Training Loss: 0.0568518228828907
Test Loss:  0.04630553722381592
Test Acc:  0.0
Valid Loss:  0.047979727387428284
Valid Acc:  0.0
std:  0.012100228998338252 
thres:  5.332664921879768e-05
Preserved_eigens number check:  15
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  13
  2%|▏         | 22/1000 [01:25<1:03:34,  3.90s/it]Epoch:   23
max of grad d_p:  tensor(0.2914, device='cuda:0')
min of grad d_p:  tensor(-0.0882, device='cuda:0')

 check Jacobi res:  torch.Size([266401]) max:  tensor(0.0309, device='cuda:0') mean:  tensor(-3.1199e-05, device='cuda:0') min:  tensor(-0.1051, device='cuda:0') norm:  tensor(0.2978, device='cuda:0') MSE:  tensor(1.1178e-06, device='cuda:0')
BAD Jacobian OCCURS! Gradient Descent instead!
Shape check:  torch.Size([266401, 1])
max of d_p_list:  tensor(0.2914, device='cuda:0')
min of d_p_list:  tensor(-0.0882, device='cuda:0')
Epoch:  23  
Training Loss: 0.10903773456811905
Test Loss:  0.11817428469657898
Test Acc:  0.0
Valid Loss:  0.133750781416893
Valid Acc:  0.0
std:  0.022281430472234954 
thres:  6.789136454463004e-05
Preserved_eigens number check:  13
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  7
  2%|▏         | 23/1000 [01:29<1:02:42,  3.85s/it]Epoch:   24
max of grad d_p:  tensor(0.0694, device='cuda:0')
min of grad d_p:  tensor(-0.3816, device='cuda:0')

 check Jacobi res:  torch.Size([266401]) max:  tensor(0.0448, device='cuda:0') mean:  tensor(-2.4010e-05, device='cuda:0') min:  tensor(-0.0750, device='cuda:0') norm:  tensor(0.2607, device='cuda:0') MSE:  tensor(9.7863e-07, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([266401, 1]) max:  tensor(9.2117e-05, device='cuda:0') mean:  tensor(2.4088e-07, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0004, device='cuda:0') MSE:  tensor(1.3633e-09, device='cuda:0')
Shape check:  torch.Size([266401, 1])
max of d_p_list:  tensor(0.0315, device='cuda:0')
min of d_p_list:  tensor(-0.0259, device='cuda:0')
Epoch:  24  
Training Loss: 0.10695283114910126
Test Loss:  0.1157006323337555
Test Acc:  0.0
Valid Loss:  0.13086842000484467
Valid Acc:  0.0
std:  0.025724044421828577 
thres:  7.825378105044365e-05
Preserved_eigens number check:  7
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  13
  2%|▏         | 24/1000 [01:32<1:02:30,  3.84s/it]Epoch:   25
max of grad d_p:  tensor(0.0723, device='cuda:0')
min of grad d_p:  tensor(-0.3791, device='cuda:0')

 check Jacobi res:  torch.Size([266401]) max:  tensor(0.0375, device='cuda:0') mean:  tensor(-2.0061e-05, device='cuda:0') min:  tensor(-0.0577, device='cuda:0') norm:  tensor(0.2154, device='cuda:0') MSE:  tensor(8.0863e-07, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([266401, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(7.5940e-07, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0011, device='cuda:0') MSE:  tensor(4.0254e-09, device='cuda:0')
Shape check:  torch.Size([266401, 1])
max of d_p_list:  tensor(0.0706, device='cuda:0')
min of d_p_list:  tensor(-0.0941, device='cuda:0')
Epoch:  25  
Training Loss: 0.10427812486886978
Test Loss:  0.11274659633636475
Test Acc:  0.0
Valid Loss:  0.12774892151355743
Valid Acc:  0.0
std:  0.02739103106691 
thres:  8.46051074564457e-05
Preserved_eigens number check:  13
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  10
  2%|▎         | 25/1000 [01:36<1:01:42,  3.80s/it]Epoch:   26
max of grad d_p:  tensor(0.0660, device='cuda:0')
min of grad d_p:  tensor(-0.3731, device='cuda:0')

 check Jacobi res:  torch.Size([266401]) max:  tensor(0.0365, device='cuda:0') mean:  tensor(-1.9329e-05, device='cuda:0') min:  tensor(-0.0786, device='cuda:0') norm:  tensor(0.2018, device='cuda:0') MSE:  tensor(7.5741e-07, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([266401, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(7.4196e-07, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0010, device='cuda:0') MSE:  tensor(3.6968e-09, device='cuda:0')
Shape check:  torch.Size([266401, 1])
max of d_p_list:  tensor(1.0568, device='cuda:0')
min of d_p_list:  tensor(-0.8005, device='cuda:0')
Epoch:  26  
Training Loss: 0.15473854541778564
Test Loss:  0.1889990270137787
Test Acc:  0.0
Valid Loss:  0.17916038632392883
Valid Acc:  0.0
std:  0.030994833362544973 
thres:  0.0001063718117773533
Preserved_eigens number check:  10
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  13
  3%|▎         | 26/1000 [01:40<1:03:53,  3.94s/it]Epoch:   27
max of grad d_p:  tensor(0.6003, device='cuda:0')
min of grad d_p:  tensor(-0.0661, device='cuda:0')

 check Jacobi res:  torch.Size([266401]) max:  tensor(0.1892, device='cuda:0') mean:  tensor(-1.4444e-05, device='cuda:0') min:  tensor(-0.1085, device='cuda:0') norm:  tensor(0.3881, device='cuda:0') MSE:  tensor(1.4568e-06, device='cuda:0')
BAD Jacobian OCCURS! Gradient Descent instead!
Shape check:  torch.Size([266401, 1])
max of d_p_list:  tensor(0.6003, device='cuda:0')
min of d_p_list:  tensor(-0.0661, device='cuda:0')
Epoch:  27  
Training Loss: 0.1524389386177063
Test Loss:  0.16339804232120514
Test Acc:  0.0
Valid Loss:  0.15246853232383728
Valid Acc:  0.0
std:  0.023004217057648033 
thres:  0.00012548923492431641
Preserved_eigens number check:  13
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  13
  3%|▎         | 27/1000 [01:44<1:03:08,  3.89s/it]Epoch:   28
max of grad d_p:  tensor(0.0909, device='cuda:0')
min of grad d_p:  tensor(-0.2681, device='cuda:0')

 check Jacobi res:  torch.Size([266401]) max:  tensor(0.0676, device='cuda:0') mean:  tensor(-3.4535e-05, device='cuda:0') min:  tensor(-0.0883, device='cuda:0') norm:  tensor(0.3555, device='cuda:0') MSE:  tensor(1.3345e-06, device='cuda:0')
BAD Jacobian OCCURS! Gradient Descent instead!
Shape check:  torch.Size([266401, 1])
max of d_p_list:  tensor(0.0909, device='cuda:0')
min of d_p_list:  tensor(-0.2681, device='cuda:0')
Epoch:  28  
Training Loss: 0.045591410249471664
Test Loss:  0.02239408902823925
Test Acc:  0.0
Valid Loss:  0.029733603820204735
Valid Acc:  0.0
std:  0.03988456674471918 
thres:  0.00011279997006058693
Preserved_eigens number check:  13
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  16
  3%|▎         | 28/1000 [01:48<1:02:52,  3.88s/it]Epoch:   29
max of grad d_p:  tensor(0.3295, device='cuda:0')
min of grad d_p:  tensor(-0.0785, device='cuda:0')

 check Jacobi res:  torch.Size([266401]) max:  tensor(0.0703, device='cuda:0') mean:  tensor(-3.3593e-05, device='cuda:0') min:  tensor(-0.1372, device='cuda:0') norm:  tensor(0.4274, device='cuda:0') MSE:  tensor(1.6042e-06, device='cuda:0')
BAD Jacobian OCCURS! Gradient Descent instead!
Shape check:  torch.Size([266401, 1])
max of d_p_list:  tensor(0.3295, device='cuda:0')
min of d_p_list:  tensor(-0.0785, device='cuda:0')
Epoch:  29  
Training Loss: 0.23460811376571655
Test Loss:  0.1695145070552826
Test Acc:  0.0
Valid Loss:  0.2234600931406021
Valid Acc:  0.0
std:  0.06244638328281872 
thres:  0.00013833102658391001
Preserved_eigens number check:  16
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  20
  3%|▎         | 29/1000 [01:52<1:03:25,  3.92s/it]Epoch:   30
max of grad d_p:  tensor(0.1825, device='cuda:0')
min of grad d_p:  tensor(-0.5995, device='cuda:0')

 check Jacobi res:  torch.Size([266401]) max:  tensor(0.0653, device='cuda:0') mean:  tensor(-2.1936e-05, device='cuda:0') min:  tensor(-0.0710, device='cuda:0') norm:  tensor(0.2740, device='cuda:0') MSE:  tensor(1.0285e-06, device='cuda:0')
BAD Jacobian OCCURS! Gradient Descent instead!
Shape check:  torch.Size([266401, 1])
max of d_p_list:  tensor(0.1825, device='cuda:0')
min of d_p_list:  tensor(-0.5995, device='cuda:0')
Epoch:  30  
Training Loss: 0.17099225521087646
Test Loss:  0.2318016141653061
Test Acc:  0.0
Valid Loss:  0.22242048382759094
Valid Acc:  0.0
std:  0.06085187692795391 
thres:  0.00015167385265231131
Preserved_eigens number check:  20
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  16
  3%|▎         | 30/1000 [01:56<1:02:01,  3.84s/it]Epoch:   31
max of grad d_p:  tensor(0.5010, device='cuda:0')
min of grad d_p:  tensor(-0.2114, device='cuda:0')

 check Jacobi res:  torch.Size([266401]) max:  tensor(0.0815, device='cuda:0') mean:  tensor(-2.6714e-05, device='cuda:0') min:  tensor(-0.1555, device='cuda:0') norm:  tensor(0.4102, device='cuda:0') MSE:  tensor(1.5399e-06, device='cuda:0')
BAD Jacobian OCCURS! Gradient Descent instead!
Shape check:  torch.Size([266401, 1])
max of d_p_list:  tensor(0.5010, device='cuda:0')
min of d_p_list:  tensor(-0.2114, device='cuda:0')
Epoch:  31  
Training Loss: 0.2047182023525238
Test Loss:  0.2538563013076782
Test Acc:  0.0
Valid Loss:  0.2787797152996063
Valid Acc:  0.0
std:  0.06452824513371351 
thres:  0.00016166978403925897
Preserved_eigens number check:  16
max of Lambda2 tensor(871.2745, device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  21
  3%|▎         | 31/1000 [01:59<59:46,  3.70s/it]  Epoch:   32
max of grad d_p:  tensor(0.0784, device='cuda:0')
min of grad d_p:  tensor(-0.5288, device='cuda:0')

 check Jacobi res:  torch.Size([266401]) max:  tensor(0.0607, device='cuda:0') mean:  tensor(-1.2273e-05, device='cuda:0') min:  tensor(-0.0783, device='cuda:0') norm:  tensor(0.1643, device='cuda:0') MSE:  tensor(6.1677e-07, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([266401, 1]) max:  tensor(2.6427e-05, device='cuda:0') mean:  tensor(1.5619e-07, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0002, device='cuda:0') MSE:  tensor(7.4551e-10, device='cuda:0')
Shape check:  torch.Size([266401, 1])
max of d_p_list:  tensor(0.0831, device='cuda:0')
min of d_p_list:  tensor(-0.1450, device='cuda:0')
Epoch:  32  
Training Loss: 0.1958959698677063
Test Loss:  0.2445220649242401
Test Acc:  0.0
Valid Loss:  0.26781585812568665
Valid Acc:  0.0
std:  0.06561705978834652 
thres:  0.00017036119028925894
Preserved_eigens number check:  21
max of Lambda2 tensor(944.3484, device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  12
  3%|▎         | 32/1000 [02:03<59:35,  3.69s/it]Epoch:   33
max of grad d_p:  tensor(0.0788, device='cuda:0')
min of grad d_p:  tensor(-0.5156, device='cuda:0')

 check Jacobi res:  torch.Size([266401]) max:  tensor(0.0635, device='cuda:0') mean:  tensor(-1.1376e-05, device='cuda:0') min:  tensor(-0.0776, device='cuda:0') norm:  tensor(0.1684, device='cuda:0') MSE:  tensor(6.3222e-07, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([266401, 1]) max:  tensor(8.3378e-05, device='cuda:0') mean:  tensor(1.6382e-07, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0002, device='cuda:0') MSE:  tensor(8.4205e-10, device='cuda:0')
Shape check:  torch.Size([266401, 1])
max of d_p_list:  tensor(0.0349, device='cuda:0')
min of d_p_list:  tensor(-0.0438, device='cuda:0')
Epoch:  33  
Training Loss: 0.18747884035110474
Test Loss:  0.2315337359905243
Test Acc:  0.0
Valid Loss:  0.2540939748287201
Valid Acc:  0.0
std:  0.021104975928112113 
thres:  0.0001987386763095856
Preserved_eigens number check:  12
max of Lambda2 tensor(961.1699, device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  11
  3%|▎         | 33/1000 [02:07<1:01:30,  3.82s/it]Epoch:   34
max of grad d_p:  tensor(0.0776, device='cuda:0')
min of grad d_p:  tensor(-0.5095, device='cuda:0')

 check Jacobi res:  torch.Size([266401]) max:  tensor(0.0608, device='cuda:0') mean:  tensor(-1.1713e-05, device='cuda:0') min:  tensor(-0.1013, device='cuda:0') norm:  tensor(0.1864, device='cuda:0') MSE:  tensor(6.9955e-07, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([266401, 1]) max:  tensor(3.0967e-05, device='cuda:0') mean:  tensor(1.1238e-07, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0002, device='cuda:0') MSE:  tensor(5.7571e-10, device='cuda:0')
Shape check:  torch.Size([266401, 1])
max of d_p_list:  tensor(0.4529, device='cuda:0')
min of d_p_list:  tensor(-0.4004, device='cuda:0')
Epoch:  34  
Training Loss: 0.13707830011844635
Test Loss:  0.17474457621574402
Test Acc:  0.0
Valid Loss:  0.188967764377594
Valid Acc:  0.0
std:  0.023833055126148743 
thres:  0.00017923271358013154
Preserved_eigens number check:  11
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  11
  3%|▎         | 34/1000 [02:11<1:03:39,  3.95s/it]Epoch:   35
max of grad d_p:  tensor(0.0666, device='cuda:0')
min of grad d_p:  tensor(-0.4297, device='cuda:0')

 check Jacobi res:  torch.Size([266401]) max:  tensor(0.0516, device='cuda:0') mean:  tensor(-2.2133e-05, device='cuda:0') min:  tensor(-0.0611, device='cuda:0') norm:  tensor(0.2539, device='cuda:0') MSE:  tensor(9.5325e-07, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([266401, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(3.8426e-07, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0005, device='cuda:0') MSE:  tensor(1.8842e-09, device='cuda:0')
Shape check:  torch.Size([266401, 1])
max of d_p_list:  tensor(0.1058, device='cuda:0')
min of d_p_list:  tensor(-0.1229, device='cuda:0')
Epoch:  35  
Training Loss: 0.1341456174850464
Test Loss:  0.1696694791316986
Test Acc:  0.0
Valid Loss:  0.1838240921497345
Valid Acc:  0.0
std:  0.030111388945189915 
thres:  0.0001718633860349655
Preserved_eigens number check:  11
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  14
  4%|▎         | 35/1000 [02:15<1:03:14,  3.93s/it]Epoch:   36
max of grad d_p:  tensor(0.0732, device='cuda:0')
min of grad d_p:  tensor(-0.4253, device='cuda:0')

 check Jacobi res:  torch.Size([266401]) max:  tensor(0.0570, device='cuda:0') mean:  tensor(-1.8623e-05, device='cuda:0') min:  tensor(-0.0566, device='cuda:0') norm:  tensor(0.2590, device='cuda:0') MSE:  tensor(9.7220e-07, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([266401, 1]) max:  tensor(5.0295e-05, device='cuda:0') mean:  tensor(1.6220e-07, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0002, device='cuda:0') MSE:  tensor(8.0228e-10, device='cuda:0')
Shape check:  torch.Size([266401, 1])
max of d_p_list:  tensor(0.1587, device='cuda:0')
min of d_p_list:  tensor(-0.0801, device='cuda:0')
Epoch:  36  
Training Loss: 0.12809538841247559
Test Loss:  0.16355422139167786
Test Acc:  0.0
Valid Loss:  0.17624515295028687
Valid Acc:  0.0
std:  0.02896710637411361 
thres:  0.00015653882324695586
Preserved_eigens number check:  14
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  16
  4%|▎         | 36/1000 [02:19<1:03:43,  3.97s/it]Epoch:   37
max of grad d_p:  tensor(0.0694, device='cuda:0')
min of grad d_p:  tensor(-0.4151, device='cuda:0')

 check Jacobi res:  torch.Size([266401]) max:  tensor(0.0614, device='cuda:0') mean:  tensor(-1.6632e-05, device='cuda:0') min:  tensor(-0.0595, device='cuda:0') norm:  tensor(0.2567, device='cuda:0') MSE:  tensor(9.6346e-07, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([266401, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(7.4248e-07, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0010, device='cuda:0') MSE:  tensor(3.6409e-09, device='cuda:0')
Shape check:  torch.Size([266401, 1])
max of d_p_list:  tensor(0.2141, device='cuda:0')
min of d_p_list:  tensor(-0.0930, device='cuda:0')
Epoch:  37  
Training Loss: 0.09271838515996933
Test Loss:  0.12066479027271271
Test Acc:  0.0
Valid Loss:  0.12917259335517883
Valid Acc:  0.0
std:  0.03029985738814378 
thres:  0.0001359033063054085
Preserved_eigens number check:  16
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  18
  4%|▎         | 37/1000 [02:23<1:04:49,  4.04s/it]Epoch:   38
max of grad d_p:  tensor(0.0970, device='cuda:0')
min of grad d_p:  tensor(-0.3380, device='cuda:0')

 check Jacobi res:  torch.Size([266401]) max:  tensor(0.0533, device='cuda:0') mean:  tensor(-2.4412e-05, device='cuda:0') min:  tensor(-0.0737, device='cuda:0') norm:  tensor(0.3194, device='cuda:0') MSE:  tensor(1.1988e-06, device='cuda:0')
BAD Jacobian OCCURS! Gradient Descent instead!
Shape check:  torch.Size([266401, 1])
max of d_p_list:  tensor(0.0970, device='cuda:0')
min of d_p_list:  tensor(-0.3380, device='cuda:0')
Epoch:  38  
Training Loss: 0.08292892575263977
Test Loss:  0.05334203690290451
Test Acc:  0.0
Valid Loss:  0.06407372653484344
Valid Acc:  0.0
std:  0.022585478268351007 
thres:  0.00011499332338571548
Preserved_eigens number check:  18
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  19
  4%|▍         | 38/1000 [02:27<1:02:35,  3.90s/it]Epoch:   39
max of grad d_p:  tensor(0.3308, device='cuda:0')
min of grad d_p:  tensor(-0.1296, device='cuda:0')

 check Jacobi res:  torch.Size([266401]) max:  tensor(0.0601, device='cuda:0') mean:  tensor(-2.9323e-05, device='cuda:0') min:  tensor(-0.1850, device='cuda:0') norm:  tensor(0.4309, device='cuda:0') MSE:  tensor(1.6174e-06, device='cuda:0')
BAD Jacobian OCCURS! Gradient Descent instead!
Shape check:  torch.Size([266401, 1])
max of d_p_list:  tensor(0.3308, device='cuda:0')
min of d_p_list:  tensor(-0.1296, device='cuda:0')
Epoch:  39  
Training Loss: 0.14126743376255035
Test Loss:  0.13195639848709106
Test Acc:  0.0
Valid Loss:  0.16828283667564392
Valid Acc:  0.0
std:  0.02345033924582748 
thres:  0.00011583115011453629
Preserved_eigens number check:  19
max of Lambda2 tensor(963.5737, device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  15
  4%|▍         | 39/1000 [02:30<1:00:35,  3.78s/it]Epoch:   40
max of grad d_p:  tensor(0.0637, device='cuda:0')
min of grad d_p:  tensor(-0.4200, device='cuda:0')

 check Jacobi res:  torch.Size([266401]) max:  tensor(0.0517, device='cuda:0') mean:  tensor(-1.2566e-05, device='cuda:0') min:  tensor(-0.0375, device='cuda:0') norm:  tensor(0.1965, device='cuda:0') MSE:  tensor(7.3765e-07, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([266401, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(3.7631e-07, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0005, device='cuda:0') MSE:  tensor(2.0080e-09, device='cuda:0')
Shape check:  torch.Size([266401, 1])
max of d_p_list:  tensor(0.0193, device='cuda:0')
min of d_p_list:  tensor(-0.0247, device='cuda:0')
Epoch:  40  
Training Loss: 0.13953274488449097
Test Loss:  0.13082095980644226
Test Acc:  0.0
Valid Loss:  0.16647088527679443
Valid Acc:  0.0
std:  0.024372663805879234 
thres:  0.0001169085755944252
Preserved_eigens number check:  15
max of Lambda2 tensor(953.4351, device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  12
  4%|▍         | 40/1000 [02:34<58:47,  3.67s/it]  Epoch:   41
max of grad d_p:  tensor(0.0634, device='cuda:0')
min of grad d_p:  tensor(-0.4174, device='cuda:0')

 check Jacobi res:  torch.Size([266401]) max:  tensor(0.0528, device='cuda:0') mean:  tensor(-1.3401e-05, device='cuda:0') min:  tensor(-0.0430, device='cuda:0') norm:  tensor(0.2146, device='cuda:0') MSE:  tensor(8.0546e-07, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([266401, 1]) max:  tensor(0.0012, device='cuda:0') mean:  tensor(4.4527e-06, device='cuda:0') min:  tensor(5.4570e-12, device='cuda:0') norm:  tensor(0.0063, device='cuda:0') MSE:  tensor(2.3529e-08, device='cuda:0')
Shape check:  torch.Size([266401, 1])
max of d_p_list:  tensor(0.0499, device='cuda:0')
min of d_p_list:  tensor(-0.0819, device='cuda:0')
Epoch:  41  
Training Loss: 0.1365627944469452
Test Loss:  0.12879988551139832
Test Acc:  0.0
Valid Loss:  0.16321027278900146
Valid Acc:  0.0
std:  0.025365085648025 
thres:  0.00011860205680131913
Preserved_eigens number check:  12
max of Lambda2 tensor(904.0750, device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  18
  4%|▍         | 41/1000 [02:38<59:22,  3.71s/it]Epoch:   42
max of grad d_p:  tensor(0.0626, device='cuda:0')
min of grad d_p:  tensor(-0.4140, device='cuda:0')

 check Jacobi res:  torch.Size([266401]) max:  tensor(0.0536, device='cuda:0') mean:  tensor(-1.4561e-05, device='cuda:0') min:  tensor(-0.0418, device='cuda:0') norm:  tensor(0.1992, device='cuda:0') MSE:  tensor(7.4786e-07, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([266401, 1]) max:  tensor(7.7305e-05, device='cuda:0') mean:  tensor(2.1660e-07, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0003, device='cuda:0') MSE:  tensor(1.1330e-09, device='cuda:0')
Shape check:  torch.Size([266401, 1])
max of d_p_list:  tensor(0.0293, device='cuda:0')
min of d_p_list:  tensor(-0.0336, device='cuda:0')
Epoch:  42  
Training Loss: 0.13513705134391785
Test Loss:  0.12755277752876282
Test Acc:  0.0
Valid Loss:  0.16168582439422607
Valid Acc:  0.0
std:  0.02218337570515237 
thres:  0.00012708579003810883
Preserved_eigens number check:  18
max of Lambda2 tensor(915.3395, device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  20
  4%|▍         | 42/1000 [02:42<1:00:36,  3.80s/it]Epoch:   43
max of grad d_p:  tensor(0.0623, device='cuda:0')
min of grad d_p:  tensor(-0.4116, device='cuda:0')

 check Jacobi res:  torch.Size([266401]) max:  tensor(0.0533, device='cuda:0') mean:  tensor(-1.4715e-05, device='cuda:0') min:  tensor(-0.0415, device='cuda:0') norm:  tensor(0.2044, device='cuda:0') MSE:  tensor(7.6710e-07, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([266401, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(6.9072e-07, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0010, device='cuda:0') MSE:  tensor(3.7021e-09, device='cuda:0')
Shape check:  torch.Size([266401, 1])
max of d_p_list:  tensor(0.0673, device='cuda:0')
min of d_p_list:  tensor(-0.0713, device='cuda:0')
Epoch:  43  
Training Loss: 0.13227933645248413
Test Loss:  0.12362270802259445
Test Acc:  0.0
Valid Loss:  0.15705077350139618
Valid Acc:  0.0
std:  0.003180013898208534 
thres:  0.0001369558721780777
Preserved_eigens number check:  20
max of Lambda2 tensor(967.1261, device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  17
  4%|▍         | 43/1000 [02:45<59:51,  3.75s/it]  Epoch:   44
max of grad d_p:  tensor(0.0614, device='cuda:0')
min of grad d_p:  tensor(-0.4081, device='cuda:0')

 check Jacobi res:  torch.Size([266401]) max:  tensor(0.0548, device='cuda:0') mean:  tensor(-1.4686e-05, device='cuda:0') min:  tensor(-0.0463, device='cuda:0') norm:  tensor(0.2199, device='cuda:0') MSE:  tensor(8.2563e-07, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([266401, 1]) max:  tensor(6.4925e-05, device='cuda:0') mean:  tensor(2.1837e-07, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0003, device='cuda:0') MSE:  tensor(1.1690e-09, device='cuda:0')
Shape check:  torch.Size([266401, 1])
max of d_p_list:  tensor(0.0150, device='cuda:0')
min of d_p_list:  tensor(-0.0203, device='cuda:0')
Epoch:  44  
Training Loss: 0.13078615069389343
Test Loss:  0.1222274899482727
Test Acc:  0.0
Valid Loss:  0.15522807836532593
Valid Acc:  0.0
std:  0.0031005445620612792 
thres:  0.0001348596155643463
Preserved_eigens number check:  17
max of Lambda2 tensor(991.1584, device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  23
  4%|▍         | 44/1000 [02:49<1:00:26,  3.79s/it]Epoch:   45
max of grad d_p:  tensor(0.0623, device='cuda:0')
min of grad d_p:  tensor(-0.4057, device='cuda:0')

 check Jacobi res:  torch.Size([266401]) max:  tensor(0.0595, device='cuda:0') mean:  tensor(-1.4749e-05, device='cuda:0') min:  tensor(-0.0443, device='cuda:0') norm:  tensor(0.2204, device='cuda:0') MSE:  tensor(8.2722e-07, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([266401, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(5.9193e-07, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0008, device='cuda:0') MSE:  tensor(3.1649e-09, device='cuda:0')
Shape check:  torch.Size([266401, 1])
max of d_p_list:  tensor(2.4798, device='cuda:0')
min of d_p_list:  tensor(-2.0089, device='cuda:0')
Epoch:  45  
Training Loss: 8.096044540405273
Test Loss:  8.191267013549805
Test Acc:  0.0
Valid Loss:  7.771219253540039
Valid Acc:  0.0
std:  3.1849419349748733 
thres:  0.001726161974668503
Preserved_eigens number check:  23
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  17
  4%|▍         | 45/1000 [02:53<59:51,  3.76s/it]  Epoch:   46
max of grad d_p:  tensor(4.3854, device='cuda:0')
min of grad d_p:  tensor(-18.2422, device='cuda:0')

 check Jacobi res:  torch.Size([266401]) max:  tensor(0.3381, device='cuda:0') mean:  tensor(-3.0940e-05, device='cuda:0') min:  tensor(-0.1585, device='cuda:0') norm:  tensor(1.0678, device='cuda:0') MSE:  tensor(4.0081e-06, device='cuda:0')
BAD Jacobian OCCURS! Gradient Descent instead!
Shape check:  torch.Size([266401, 1])
max of d_p_list:  tensor(4.3854, device='cuda:0')
min of d_p_list:  tensor(-18.2422, device='cuda:0')
Epoch:  46  
Training Loss: 13268.9609375
Test Loss:  12542.91796875
Test Acc:  0.0
Valid Loss:  12814.837890625
Valid Acc:  0.0
std:  5306.735846525673 
thres:  2.6554910369157794
Preserved_eigens number check:  17
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  11
  5%|▍         | 46/1000 [02:57<1:01:03,  3.84s/it]Epoch:   47
max of grad d_p:  tensor(2555.8555, device='cuda:0')
min of grad d_p:  tensor(-1635.3262, device='cuda:0')

 check Jacobi res:  torch.Size([266401]) max:  tensor(2.0887, device='cuda:0') mean:  tensor(0.0002, device='cuda:0') min:  tensor(-1.0256, device='cuda:0') norm:  tensor(4.8367, device='cuda:0') MSE:  tensor(1.8156e-05, device='cuda:0')
BAD Jacobian OCCURS! Gradient Descent instead!
Shape check:  torch.Size([266401, 1])
max of d_p_list:  tensor(2555.8555, device='cuda:0')
min of d_p_list:  tensor(-1635.3262, device='cuda:0')
Epoch:  47  
Training Loss: 5.97122018898346e+17
Test Loss:  6.118676380579267e+17
Test Acc:  0.0
Valid Loss:  5.970969362893373e+17
Valid Acc:  0.0
std:  2.3884880755933706e+17 
thres:  119424403779671.86
Preserved_eigens number check:  11
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  190
  5%|▍         | 47/1000 [03:00<1:00:20,  3.80s/it]/nishome/yui/ModifiedNGD/utils/modified_fisher_inverse.py:129: UserWarning: torch.linalg.svd: During SVD computation with the selected cusolver driver, batches 0 failed to converge. A more accurate method will be used to compute the SVD as a fallback. Check doc at https://pytorch.org/docs/stable/generated/torch.linalg.svd.html (Triggered internally at /opt/conda/conda-bld/pytorch_1716905971214/work/aten/src/ATen/native/cuda/linalg/BatchLinearAlgebraLib.cpp:697.)
  U, Lambda2, Vh = torch.linalg.svd(K)
Epoch:   48
max of grad d_p:  tensor(4.9985e+15, device='cuda:0')
min of grad d_p:  tensor(-8.9533e+16, device='cuda:0')

 check Jacobi res:  torch.Size([266401]) max:  tensor(3.4360e+10, device='cuda:0') mean:  tensor(-83167.3672, device='cuda:0') min:  tensor(-1.5032e+10, device='cuda:0') norm:  tensor(4.8086e+10, device='cuda:0') MSE:  tensor(180502.5469, device='cuda:0')
BAD Jacobian OCCURS! Gradient Descent instead!
Shape check:  torch.Size([266401, 1])
max of d_p_list:  tensor(4.9985e+15, device='cuda:0')
min of d_p_list:  tensor(-8.9533e+16, device='cuda:0')
Epoch:  48  
Training Loss: nan
Test Loss:  nan
Test Acc:  0.0
Valid Loss:  nan
Valid Acc:  0.0
std:  nan 
thres:  nan
Preserved_eigens number check:  190
  5%|▍         | 47/1000 [03:04<1:02:30,  3.94s/it]
Traceback (most recent call last):
  File "/nishome/yui/ModifiedNGD/train.py", line 363, in <module>
    train(model,mode, lr_decay=True)
  File "/nishome/yui/ModifiedNGD/train.py", line 211, in train
    F_modified, preserved_eigens = modified_Fisher_inverse(model=model, 
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nishome/yui/ModifiedNGD/utils/modified_fisher_inverse.py", line 129, in modified_Fisher_inverse
    U, Lambda2, Vh = torch.linalg.svd(K)
                     ^^^^^^^^^^^^^^^^^^^
torch._C._LinAlgError: linalg.svd: The algorithm failed to converge because the input matrix is ill-conditioned or has too many repeated singular values (error code: 511).
