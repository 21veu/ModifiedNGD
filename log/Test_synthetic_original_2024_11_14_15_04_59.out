/nishome/yui/ModifiedNGD/utils/readData.py:18: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  return torch.tensor(x, dtype=torch.float32), torch.tensor(y, dtype=torch.float32)
/nishome/yui/anaconda3/envs/ng/lib/python3.12/site-packages/torch/autograd/graph.py:744: UserWarning: Using backward() with create_graph=True will create a reference cycle between the parameter and its gradient which can cause a memory leak. We recommend using autograd.grad when creating the graph to avoid this. If you have to use this function, make sure to reset the .grad fields of your parameters to None after use to break the cycle and avoid the leak. (Triggered internally at /opt/conda/conda-bld/pytorch_1716905971214/work/torch/csrc/autograd/engine.cpp:1203.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
Train info: 
 train data shape: torch.Size([512, 1]), 
 train lable shape: torch.Size([512, 1]), 
 positive / negative: 0.021206805482506752 / 0.978793203830719, 
 discrepancy norm error: 5.045955617788422e-07
Test info: 
 test data shape: torch.Size([128, 1]), 
 test lable shape: torch.Size([128, 1]), , 
 positive / negative: -0.030759211629629135 / 1.0307592153549194, 
 discrepancy norm error: 2.750667249529215e-07
Valid info: 
 valid data shape: torch.Size([128, 1]), valid lable shape: torch.Size([128, 1]), 
 positive / negative: 0.015859205275774002 / 0.9841408133506775, 
 discrepancy norm error: 2.3576444618811365e-07
torch.Size([512, 1]) torch.Size([512])
seed is  2191
---------------------------------------- NGD ----------------------------------------
OUTPUT CHECK:  torch.Size([512]) tensor(0.0590, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2447, device='cuda:0', grad_fn=<MinBackward1>) 
TARGET:  torch.Size([512]) tensor(0.5000, device='cuda:0') tensor(-0.5000, device='cuda:0')
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch:   1
Test train Loss:  0.05464249104261398
Test train Acc:  0.0
Test Loss:  0.0616748183965683
Test Acc:  0.0
Valid Loss:  0.05691187083721161
Valid Acc:  0.0
max of grad d_p:  tensor(0.0106, device='cuda:0')
min of grad d_p:  tensor(-0.0819, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.0594, device='cuda:0') mean:  tensor(-0.0002, device='cuda:0') min:  tensor(-0.0396, device='cuda:0') norm:  tensor(1.2835, device='cuda:0') MSE:  tensor(2.4099e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(3.6665e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0061, device='cuda:0') MSE:  tensor(1.1442e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0094, device='cuda:0')
min of d_p_list:  tensor(-0.0047, device='cuda:0')
Epoch:  1  
Training Loss: 0.05427340940514114
Test Loss:  0.06112656742334366
Test Acc:  0.0
Valid Loss:  0.05640222877264023
Valid Acc:  0.0
local minima detector shape:  (0,)
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  0%|          | 1/1000 [00:02<46:30,  2.79s/it]Epoch:   2
max of grad d_p:  tensor(0.0105, device='cuda:0')
min of grad d_p:  tensor(-0.0851, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.0500, device='cuda:0') mean:  tensor(-0.0002, device='cuda:0') min:  tensor(-0.0375, device='cuda:0') norm:  tensor(1.4404, device='cuda:0') MSE:  tensor(2.7045e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(4.6048e-06, device='cuda:0') min:  tensor(1.9611e-12, device='cuda:0') norm:  tensor(0.0086, device='cuda:0') MSE:  tensor(1.6126e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0008, device='cuda:0')
min of d_p_list:  tensor(-0.0014, device='cuda:0')
Epoch:  2  
Training Loss: 0.05401075631380081
Test Loss:  0.060960929840803146
Test Acc:  0.0
Valid Loss:  0.0562443844974041
Valid Acc:  0.0
local minima detector shape:  (1,)
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  0%|          | 2/1000 [00:05<46:05,  2.77s/it]Epoch:   3
max of grad d_p:  tensor(0.0101, device='cuda:0')
min of grad d_p:  tensor(-0.0851, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.0451, device='cuda:0') mean:  tensor(-0.0002, device='cuda:0') min:  tensor(-0.0323, device='cuda:0') norm:  tensor(1.3003, device='cuda:0') MSE:  tensor(2.4414e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(8.8318e-06, device='cuda:0') min:  tensor(4.5475e-13, device='cuda:0') norm:  tensor(0.0148, device='cuda:0') MSE:  tensor(2.7775e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0003, device='cuda:0')
min of d_p_list:  tensor(-0.0005, device='cuda:0')
Epoch:  3  
Training Loss: 0.05391434207558632
Test Loss:  0.06086635962128639
Test Acc:  0.0
Valid Loss:  0.05614999681711197
Valid Acc:  0.0
local minima detector shape:  (2,)
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  0%|          | 3/1000 [00:08<48:40,  2.93s/it]Epoch:   4
max of grad d_p:  tensor(0.0100, device='cuda:0')
min of grad d_p:  tensor(-0.0849, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.0579, device='cuda:0') mean:  tensor(-0.0002, device='cuda:0') min:  tensor(-0.0410, device='cuda:0') norm:  tensor(1.6966, device='cuda:0') MSE:  tensor(3.1855e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0006, device='cuda:0') mean:  tensor(4.6024e-06, device='cuda:0') min:  tensor(2.2737e-13, device='cuda:0') norm:  tensor(0.0077, device='cuda:0') MSE:  tensor(1.4440e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0004, device='cuda:0')
min of d_p_list:  tensor(-0.0005, device='cuda:0')
Epoch:  4  
Training Loss: 0.05383675545454025
Test Loss:  0.06079769507050514
Test Acc:  0.0
Valid Loss:  0.05608096346259117
Valid Acc:  0.0
local minima detector shape:  (3,)
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  0%|          | 4/1000 [00:11<48:59,  2.95s/it]Epoch:   5
max of grad d_p:  tensor(0.0099, device='cuda:0')
min of grad d_p:  tensor(-0.0847, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.0509, device='cuda:0') mean:  tensor(-0.0002, device='cuda:0') min:  tensor(-0.0351, device='cuda:0') norm:  tensor(1.4681, device='cuda:0') MSE:  tensor(2.7564e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0008, device='cuda:0') mean:  tensor(1.1440e-05, device='cuda:0') min:  tensor(4.5475e-13, device='cuda:0') norm:  tensor(0.0217, device='cuda:0') MSE:  tensor(4.0659e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0005, device='cuda:0')
min of d_p_list:  tensor(-0.0009, device='cuda:0')
Epoch:  5  
Training Loss: 0.05372484773397446
Test Loss:  0.06068519502878189
Test Acc:  0.0
Valid Loss:  0.05597105622291565
Valid Acc:  0.0
local minima detector shape:  (4,)
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  0%|          | 5/1000 [00:14<47:29,  2.86s/it]Epoch:   6
max of grad d_p:  tensor(0.0098, device='cuda:0')
min of grad d_p:  tensor(-0.0845, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.0436, device='cuda:0') mean:  tensor(-0.0002, device='cuda:0') min:  tensor(-0.0292, device='cuda:0') norm:  tensor(1.2492, device='cuda:0') MSE:  tensor(2.3453e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(1.0927e-05, device='cuda:0') min:  tensor(1.3145e-12, device='cuda:0') norm:  tensor(0.0200, device='cuda:0') MSE:  tensor(3.7515e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0008, device='cuda:0')
min of d_p_list:  tensor(-0.0013, device='cuda:0')
Epoch:  6  
Training Loss: 0.05357956141233444
Test Loss:  0.06053043156862259
Test Acc:  0.0
Valid Loss:  0.05582188069820404
Valid Acc:  0.0
std:  0.00014980398842521077 
thres:  5.381325259804726e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  1%|          | 6/1000 [00:16<45:21,  2.74s/it]Epoch:   7
max of grad d_p:  tensor(0.0098, device='cuda:0')
min of grad d_p:  tensor(-0.0845, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.0531, device='cuda:0') mean:  tensor(-0.0002, device='cuda:0') min:  tensor(-0.0363, device='cuda:0') norm:  tensor(1.5800, device='cuda:0') MSE:  tensor(2.9665e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0006, device='cuda:0') mean:  tensor(6.2656e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0106, device='cuda:0') MSE:  tensor(1.9890e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0011, device='cuda:0')
min of d_p_list:  tensor(-0.0008, device='cuda:0')
Epoch:  7  
Training Loss: 0.0535307377576828
Test Loss:  0.060498666018247604
Test Acc:  0.0
Valid Loss:  0.05578380450606346
Valid Acc:  0.0
std:  0.0001462392075926783 
thres:  5.3717248886823654e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  1%|          | 7/1000 [00:19<43:41,  2.64s/it]Epoch:   8
max of grad d_p:  tensor(0.0101, device='cuda:0')
min of grad d_p:  tensor(-0.0847, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.0450, device='cuda:0') mean:  tensor(-0.0002, device='cuda:0') min:  tensor(-0.0349, device='cuda:0') norm:  tensor(1.4689, device='cuda:0') MSE:  tensor(2.7579e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0026, device='cuda:0') mean:  tensor(4.5298e-05, device='cuda:0') min:  tensor(9.0949e-12, device='cuda:0') norm:  tensor(0.0790, device='cuda:0') MSE:  tensor(1.4837e-07, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0005, device='cuda:0')
min of d_p_list:  tensor(-0.0008, device='cuda:0')
Epoch:  8  
Training Loss: 0.053412649780511856
Test Loss:  0.06037593632936478
Test Acc:  0.0
Valid Loss:  0.05566294491291046
Valid Acc:  0.0
std:  0.00014867776424776273 
thres:  5.361691042780877e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  1%|          | 8/1000 [00:21<43:39,  2.64s/it]Epoch:   9
max of grad d_p:  tensor(0.0100, device='cuda:0')
min of grad d_p:  tensor(-0.0846, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.0433, device='cuda:0') mean:  tensor(-0.0002, device='cuda:0') min:  tensor(-0.0343, device='cuda:0') norm:  tensor(1.4459, device='cuda:0') MSE:  tensor(2.7148e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(6.4874e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0107, device='cuda:0') MSE:  tensor(2.0146e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0007, device='cuda:0')
min of d_p_list:  tensor(-0.0013, device='cuda:0')
Epoch:  9  
Training Loss: 0.053281351923942566
Test Loss:  0.06023886799812317
Test Acc:  0.0
Valid Loss:  0.05553022027015686
Valid Acc:  0.0
std:  0.0001503984343581017 
thres:  5.3505829721689226e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  1%|          | 9/1000 [00:24<44:55,  2.72s/it]Epoch:   10
max of grad d_p:  tensor(0.0100, device='cuda:0')
min of grad d_p:  tensor(-0.0844, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.0438, device='cuda:0') mean:  tensor(-0.0002, device='cuda:0') min:  tensor(-0.0360, device='cuda:0') norm:  tensor(1.4768, device='cuda:0') MSE:  tensor(2.7727e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(6.6791e-06, device='cuda:0') min:  tensor(6.5370e-13, device='cuda:0') norm:  tensor(0.0120, device='cuda:0') MSE:  tensor(2.2531e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0016, device='cuda:0')
min of d_p_list:  tensor(-0.0021, device='cuda:0')
Epoch:  10  
Training Loss: 0.05305033549666405
Test Loss:  0.05999017134308815
Test Acc:  0.0
Valid Loss:  0.055283933877944946
Valid Acc:  0.0
std:  0.00019058394106348758 
thres:  5.337092727422714e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  1%|          | 10/1000 [00:27<47:07,  2.86s/it]Epoch:   11
max of grad d_p:  tensor(0.0101, device='cuda:0')
min of grad d_p:  tensor(-0.0839, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.0416, device='cuda:0') mean:  tensor(-0.0002, device='cuda:0') min:  tensor(-0.0393, device='cuda:0') norm:  tensor(1.5513, device='cuda:0') MSE:  tensor(2.9127e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(5.4835e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0107, device='cuda:0') MSE:  tensor(2.0008e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0008, device='cuda:0')
min of d_p_list:  tensor(-0.0011, device='cuda:0')
Epoch:  11  
Training Loss: 0.05294344946742058
Test Loss:  0.059883374720811844
Test Acc:  0.0
Valid Loss:  0.05518006533384323
Valid Acc:  0.0
std:  0.00021903998876570882 
thres:  5.324370488524437e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  1%|          | 11/1000 [00:30<47:05,  2.86s/it]Epoch:   12
max of grad d_p:  tensor(0.0101, device='cuda:0')
min of grad d_p:  tensor(-0.0837, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.0414, device='cuda:0') mean:  tensor(-0.0002, device='cuda:0') min:  tensor(-0.0397, device='cuda:0') norm:  tensor(1.5494, device='cuda:0') MSE:  tensor(2.9091e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(4.9482e-06, device='cuda:0') min:  tensor(1.7053e-13, device='cuda:0') norm:  tensor(0.0077, device='cuda:0') MSE:  tensor(1.4500e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0008, device='cuda:0')
min of d_p_list:  tensor(-0.0011, device='cuda:0')
Epoch:  12  
Training Loss: 0.05282802879810333
Test Loss:  0.0597660131752491
Test Acc:  0.0
Valid Loss:  0.055066727101802826
Valid Acc:  0.0
std:  0.0002151889154108009 
thres:  5.310316309332848e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  1%|          | 12/1000 [00:33<46:57,  2.85s/it]Epoch:   13
max of grad d_p:  tensor(0.0102, device='cuda:0')
min of grad d_p:  tensor(-0.0834, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.0473, device='cuda:0') mean:  tensor(-0.0002, device='cuda:0') min:  tensor(-0.0456, device='cuda:0') norm:  tensor(1.7651, device='cuda:0') MSE:  tensor(3.3140e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(8.1469e-06, device='cuda:0') min:  tensor(3.3538e-12, device='cuda:0') norm:  tensor(0.0165, device='cuda:0') MSE:  tensor(3.0972e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0009, device='cuda:0')
min of d_p_list:  tensor(-0.0014, device='cuda:0')
Epoch:  13  
Training Loss: 0.05269079655408859
Test Loss:  0.05962304025888443
Test Acc:  0.0
Valid Loss:  0.054928816854953766
Valid Acc:  0.0
std:  0.00020078898556434016 
thres:  5.295879244804382e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  1%|▏         | 13/1000 [00:36<48:00,  2.92s/it]Epoch:   14
max of grad d_p:  tensor(0.0103, device='cuda:0')
min of grad d_p:  tensor(-0.0832, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.0397, device='cuda:0') mean:  tensor(-0.0002, device='cuda:0') min:  tensor(-0.0386, device='cuda:0') norm:  tensor(1.4716, device='cuda:0') MSE:  tensor(2.7631e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0015, device='cuda:0') mean:  tensor(1.4694e-05, device='cuda:0') min:  tensor(7.9581e-13, device='cuda:0') norm:  tensor(0.0245, device='cuda:0') MSE:  tensor(4.5976e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0010, device='cuda:0')
min of d_p_list:  tensor(-0.0015, device='cuda:0')
Epoch:  14  
Training Loss: 0.0525384284555912
Test Loss:  0.05946234613656998
Test Acc:  0.0
Valid Loss:  0.05477382615208626
Valid Acc:  0.0
std:  0.0001810277869902717 
thres:  5.281020775437355e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  1%|▏         | 14/1000 [00:39<48:25,  2.95s/it]Epoch:   15
max of grad d_p:  tensor(0.0104, device='cuda:0')
min of grad d_p:  tensor(-0.0830, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.0484, device='cuda:0') mean:  tensor(-0.0002, device='cuda:0') min:  tensor(-0.0479, device='cuda:0') norm:  tensor(1.8033, device='cuda:0') MSE:  tensor(3.3858e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(9.7533e-06, device='cuda:0') min:  tensor(3.6380e-12, device='cuda:0') norm:  tensor(0.0182, device='cuda:0') MSE:  tensor(3.4265e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0006, device='cuda:0')
min of d_p_list:  tensor(-0.0013, device='cuda:0')
Epoch:  15  
Training Loss: 0.052412934601306915
Test Loss:  0.05933144688606262
Test Acc:  0.0
Valid Loss:  0.054647937417030334
Valid Acc:  0.0
std:  0.00019118783620436532 
thres:  5.2682727575302125e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  2%|▏         | 15/1000 [00:42<46:11,  2.81s/it]Epoch:   16
max of grad d_p:  tensor(0.0105, device='cuda:0')
min of grad d_p:  tensor(-0.0828, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.0367, device='cuda:0') mean:  tensor(-0.0002, device='cuda:0') min:  tensor(-0.0366, device='cuda:0') norm:  tensor(1.3715, device='cuda:0') MSE:  tensor(2.5752e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0038, device='cuda:0') mean:  tensor(3.0716e-05, device='cuda:0') min:  tensor(8.5123e-12, device='cuda:0') norm:  tensor(0.0477, device='cuda:0') MSE:  tensor(8.9467e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0017, device='cuda:0')
min of d_p_list:  tensor(-0.0021, device='cuda:0')
Epoch:  16  
Training Loss: 0.05231504887342453
Test Loss:  0.05924311280250549
Test Acc:  0.0
Valid Loss:  0.05457258224487305
Valid Acc:  0.0
std:  0.00018493144948341525 
thres:  5.255704745650292e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  2%|▏         | 16/1000 [00:44<45:03,  2.75s/it]Epoch:   17
max of grad d_p:  tensor(0.0114, device='cuda:0')
min of grad d_p:  tensor(-0.0836, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.0467, device='cuda:0') mean:  tensor(-0.0002, device='cuda:0') min:  tensor(-0.0443, device='cuda:0') norm:  tensor(1.5864, device='cuda:0') MSE:  tensor(2.9785e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0008, device='cuda:0') mean:  tensor(6.8866e-06, device='cuda:0') min:  tensor(6.8212e-13, device='cuda:0') norm:  tensor(0.0130, device='cuda:0') MSE:  tensor(2.4421e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0020, device='cuda:0')
min of d_p_list:  tensor(-0.0026, device='cuda:0')
Epoch:  17  
Training Loss: 0.05214603245258331
Test Loss:  0.05907109007239342
Test Acc:  0.0
Valid Loss:  0.05441068112850189
Valid Acc:  0.0
std:  0.00018626693100554374 
thres:  5.242064818739891e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  2%|▏         | 17/1000 [00:47<46:08,  2.82s/it]Epoch:   18
max of grad d_p:  tensor(0.0112, device='cuda:0')
min of grad d_p:  tensor(-0.0830, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.0485, device='cuda:0') mean:  tensor(-0.0002, device='cuda:0') min:  tensor(-0.0458, device='cuda:0') norm:  tensor(1.6131, device='cuda:0') MSE:  tensor(3.0286e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(7.4942e-06, device='cuda:0') min:  tensor(1.4779e-12, device='cuda:0') norm:  tensor(0.0136, device='cuda:0') MSE:  tensor(2.5563e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0012, device='cuda:0')
min of d_p_list:  tensor(-0.0010, device='cuda:0')
Epoch:  18  
Training Loss: 0.05207792669534683
Test Loss:  0.05898868292570114
Test Acc:  0.0
Valid Loss:  0.05432373285293579
Valid Acc:  0.0
std:  0.00016901647036285592 
thres:  5.229807421565056e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  2%|▏         | 18/1000 [00:50<46:25,  2.84s/it]Epoch:   19
max of grad d_p:  tensor(0.0111, device='cuda:0')
min of grad d_p:  tensor(-0.0823, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.0476, device='cuda:0') mean:  tensor(-0.0002, device='cuda:0') min:  tensor(-0.0460, device='cuda:0') norm:  tensor(1.6392, device='cuda:0') MSE:  tensor(3.0777e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0007, device='cuda:0') mean:  tensor(8.3998e-06, device='cuda:0') min:  tensor(9.0949e-13, device='cuda:0') norm:  tensor(0.0170, device='cuda:0') MSE:  tensor(3.1973e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0010, device='cuda:0')
min of d_p_list:  tensor(-0.0023, device='cuda:0')
Epoch:  19  
Training Loss: 0.051939643919467926
Test Loss:  0.058841075748205185
Test Acc:  0.0
Valid Loss:  0.05418439209461212
Valid Acc:  0.0
std:  0.00016841993272391647 
thres:  5.217831730842591e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  2%|▏         | 19/1000 [00:53<45:52,  2.81s/it]Epoch:   20
max of grad d_p:  tensor(0.0111, device='cuda:0')
min of grad d_p:  tensor(-0.0821, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.0495, device='cuda:0') mean:  tensor(-0.0002, device='cuda:0') min:  tensor(-0.0483, device='cuda:0') norm:  tensor(1.7221, device='cuda:0') MSE:  tensor(3.2333e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(7.5948e-06, device='cuda:0') min:  tensor(1.8190e-12, device='cuda:0') norm:  tensor(0.0153, device='cuda:0') MSE:  tensor(2.8634e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0012, device='cuda:0')
min of d_p_list:  tensor(-0.0027, device='cuda:0')
Epoch:  20  
Training Loss: 0.051800526678562164
Test Loss:  0.05868905410170555
Test Acc:  0.0
Valid Loss:  0.05404102802276611
Valid Acc:  0.0
std:  0.00017578291260504286 
thres:  5.205583572387695e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  2%|▏         | 20/1000 [00:56<45:57,  2.81s/it]Epoch:   21
max of grad d_p:  tensor(0.0110, device='cuda:0')
min of grad d_p:  tensor(-0.0819, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.0393, device='cuda:0') mean:  tensor(-0.0002, device='cuda:0') min:  tensor(-0.0390, device='cuda:0') norm:  tensor(1.3997, device='cuda:0') MSE:  tensor(2.6281e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0016, device='cuda:0') mean:  tensor(8.7666e-06, device='cuda:0') min:  tensor(1.5277e-13, device='cuda:0') norm:  tensor(0.0136, device='cuda:0') MSE:  tensor(2.5521e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0006, device='cuda:0')
min of d_p_list:  tensor(-0.0021, device='cuda:0')
Epoch:  21  
Training Loss: 0.05167807266116142
Test Loss:  0.05855525657534599
Test Acc:  0.0
Valid Loss:  0.053914498537778854
Valid Acc:  0.0
std:  0.00017254790492822158 
thres:  5.1928440481424334e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  2%|▏         | 21/1000 [00:58<45:15,  2.77s/it]Epoch:   22
max of grad d_p:  tensor(0.0110, device='cuda:0')
min of grad d_p:  tensor(-0.0817, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.0367, device='cuda:0') mean:  tensor(-0.0002, device='cuda:0') min:  tensor(-0.0370, device='cuda:0') norm:  tensor(1.3316, device='cuda:0') MSE:  tensor(2.5002e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(8.0168e-06, device='cuda:0') min:  tensor(7.9581e-13, device='cuda:0') norm:  tensor(0.0149, device='cuda:0') MSE:  tensor(2.7981e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0015, device='cuda:0')
min of d_p_list:  tensor(-0.0038, device='cuda:0')
Epoch:  22  
Training Loss: 0.05149638652801514
Test Loss:  0.05835732817649841
Test Acc:  0.0
Valid Loss:  0.053730517625808716
Valid Acc:  0.0
std:  0.0002018812942090716 
thres:  5.17985112965107e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  2%|▏         | 22/1000 [01:01<45:33,  2.79s/it]Epoch:   23
max of grad d_p:  tensor(0.0111, device='cuda:0')
min of grad d_p:  tensor(-0.0814, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.0414, device='cuda:0') mean:  tensor(-0.0002, device='cuda:0') min:  tensor(-0.0417, device='cuda:0') norm:  tensor(1.5016, device='cuda:0') MSE:  tensor(2.8193e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0014, device='cuda:0') mean:  tensor(5.5362e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0092, device='cuda:0') MSE:  tensor(1.7324e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0011, device='cuda:0')
min of d_p_list:  tensor(-0.0033, device='cuda:0')
Epoch:  23  
Training Loss: 0.05134352296590805
Test Loss:  0.058193862438201904
Test Acc:  0.0
Valid Loss:  0.053578294813632965
Valid Acc:  0.0
std:  0.00021206222344998465 
thres:  5.165163055062294e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  2%|▏         | 23/1000 [01:04<45:48,  2.81s/it]Epoch:   24
max of grad d_p:  tensor(0.0111, device='cuda:0')
min of grad d_p:  tensor(-0.0812, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.0496, device='cuda:0') mean:  tensor(-0.0002, device='cuda:0') min:  tensor(-0.0490, device='cuda:0') norm:  tensor(1.7585, device='cuda:0') MSE:  tensor(3.3016e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0023, device='cuda:0') mean:  tensor(1.7382e-05, device='cuda:0') min:  tensor(6.8212e-13, device='cuda:0') norm:  tensor(0.0287, device='cuda:0') MSE:  tensor(5.3936e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0009, device='cuda:0')
min of d_p_list:  tensor(-0.0033, device='cuda:0')
Epoch:  24  
Training Loss: 0.05119621008634567
Test Loss:  0.05803430452942848
Test Acc:  0.0
Valid Loss:  0.05343007296323776
Valid Acc:  0.0
std:  0.00021852654707182407 
thres:  5.1502943783998485e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  2%|▏         | 24/1000 [01:07<46:36,  2.87s/it]Epoch:   25
max of grad d_p:  tensor(0.0112, device='cuda:0')
min of grad d_p:  tensor(-0.0810, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.0482, device='cuda:0') mean:  tensor(-0.0002, device='cuda:0') min:  tensor(-0.0468, device='cuda:0') norm:  tensor(1.6679, device='cuda:0') MSE:  tensor(3.1316e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0011, device='cuda:0') mean:  tensor(1.8635e-05, device='cuda:0') min:  tensor(9.0949e-13, device='cuda:0') norm:  tensor(0.0327, device='cuda:0') MSE:  tensor(6.1331e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0014, device='cuda:0')
min of d_p_list:  tensor(-0.0037, device='cuda:0')
Epoch:  25  
Training Loss: 0.05104914307594299
Test Loss:  0.05787951499223709
Test Acc:  0.0
Valid Loss:  0.053286150097846985
Valid Acc:  0.0
std:  0.00022055987790777008 
thres:  5.1352667063474654e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  2%|▎         | 25/1000 [01:10<46:18,  2.85s/it]Epoch:   26
max of grad d_p:  tensor(0.0112, device='cuda:0')
min of grad d_p:  tensor(-0.0807, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.0496, device='cuda:0') mean:  tensor(-0.0002, device='cuda:0') min:  tensor(-0.0480, device='cuda:0') norm:  tensor(1.7097, device='cuda:0') MSE:  tensor(3.2100e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0046, device='cuda:0') mean:  tensor(3.0599e-05, device='cuda:0') min:  tensor(5.2296e-12, device='cuda:0') norm:  tensor(0.0506, device='cuda:0') MSE:  tensor(9.5071e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0027, device='cuda:0')
min of d_p_list:  tensor(-0.0046, device='cuda:0')
Epoch:  26  
Training Loss: 0.05088815093040466
Test Loss:  0.057712048292160034
Test Acc:  0.0
Valid Loss:  0.053129058331251144
Valid Acc:  0.0
std:  0.00021369345588740776 
thres:  5.1194682717323306e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  3%|▎         | 26/1000 [01:13<46:58,  2.89s/it]Epoch:   27
max of grad d_p:  tensor(0.0109, device='cuda:0')
min of grad d_p:  tensor(-0.0803, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.0460, device='cuda:0') mean:  tensor(-0.0002, device='cuda:0') min:  tensor(-0.0462, device='cuda:0') norm:  tensor(1.6610, device='cuda:0') MSE:  tensor(3.1186e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0028, device='cuda:0') mean:  tensor(3.3405e-05, device='cuda:0') min:  tensor(2.7285e-12, device='cuda:0') norm:  tensor(0.0716, device='cuda:0') MSE:  tensor(1.3448e-07, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0011, device='cuda:0')
min of d_p_list:  tensor(-0.0037, device='cuda:0')
Epoch:  27  
Training Loss: 0.050728633999824524
Test Loss:  0.05753663554787636
Test Acc:  0.0
Valid Loss:  0.05296587198972702
Valid Acc:  0.0
std:  0.00021753707464852292 
thres:  5.104113221168518e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  3%|▎         | 27/1000 [01:16<47:45,  2.94s/it]Epoch:   28
max of grad d_p:  tensor(0.0111, device='cuda:0')
min of grad d_p:  tensor(-0.0801, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.0458, device='cuda:0') mean:  tensor(-0.0002, device='cuda:0') min:  tensor(-0.0450, device='cuda:0') norm:  tensor(1.6022, device='cuda:0') MSE:  tensor(3.0082e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(4.0661e-06, device='cuda:0') min:  tensor(5.6843e-13, device='cuda:0') norm:  tensor(0.0076, device='cuda:0') MSE:  tensor(1.4192e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0014, device='cuda:0')
min of d_p_list:  tensor(-0.0041, device='cuda:0')
Epoch:  28  
Training Loss: 0.05057729035615921
Test Loss:  0.057376306504011154
Test Acc:  0.0
Valid Loss:  0.05281733721494675
Valid Acc:  0.0
std:  0.00022040803546285721 
thres:  5.0887885689735416e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  3%|▎         | 28/1000 [01:19<48:17,  2.98s/it]Epoch:   29
max of grad d_p:  tensor(0.0111, device='cuda:0')
min of grad d_p:  tensor(-0.0798, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.0536, device='cuda:0') mean:  tensor(-0.0003, device='cuda:0') min:  tensor(-0.0510, device='cuda:0') norm:  tensor(1.8178, device='cuda:0') MSE:  tensor(3.4131e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0008, device='cuda:0') mean:  tensor(5.4344e-06, device='cuda:0') min:  tensor(4.5475e-13, device='cuda:0') norm:  tensor(0.0099, device='cuda:0') MSE:  tensor(1.8514e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0014, device='cuda:0')
min of d_p_list:  tensor(-0.0038, device='cuda:0')
Epoch:  29  
Training Loss: 0.05043251812458038
Test Loss:  0.057223618030548096
Test Acc:  0.0
Valid Loss:  0.052675217390060425
Valid Acc:  0.0
std:  0.00021842578320341958 
thres:  5.0735147297382355e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  3%|▎         | 29/1000 [01:22<46:58,  2.90s/it]Epoch:   30
max of grad d_p:  tensor(0.0111, device='cuda:0')
min of grad d_p:  tensor(-0.0795, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.0544, device='cuda:0') mean:  tensor(-0.0003, device='cuda:0') min:  tensor(-0.0507, device='cuda:0') norm:  tensor(1.7950, device='cuda:0') MSE:  tensor(3.3703e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0012, device='cuda:0') mean:  tensor(1.2620e-05, device='cuda:0') min:  tensor(6.8212e-13, device='cuda:0') norm:  tensor(0.0257, device='cuda:0') MSE:  tensor(4.8212e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0018, device='cuda:0')
min of d_p_list:  tensor(-0.0045, device='cuda:0')
Epoch:  30  
Training Loss: 0.05028824135661125
Test Loss:  0.05707784369587898
Test Acc:  0.0
Valid Loss:  0.05253896862268448
Valid Acc:  0.0
std:  0.00021160642688082011 
thres:  5.058296695351601e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  3%|▎         | 30/1000 [01:25<46:37,  2.88s/it]Epoch:   31
max of grad d_p:  tensor(0.0111, device='cuda:0')
min of grad d_p:  tensor(-0.0791, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.0458, device='cuda:0') mean:  tensor(-0.0002, device='cuda:0') min:  tensor(-0.0411, device='cuda:0') norm:  tensor(1.4487, device='cuda:0') MSE:  tensor(2.7200e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(6.2638e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0123, device='cuda:0') MSE:  tensor(2.3062e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0009, device='cuda:0')
min of d_p_list:  tensor(-0.0035, device='cuda:0')
Epoch:  31  
Training Loss: 0.05015101283788681
Test Loss:  0.05693373829126358
Test Acc:  0.0
Valid Loss:  0.05240335687994957
Valid Acc:  0.0
std:  0.000204283618656804 
thres:  5.0435539335012436e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  3%|▎         | 31/1000 [01:27<45:03,  2.79s/it]Epoch:   32
max of grad d_p:  tensor(0.0112, device='cuda:0')
min of grad d_p:  tensor(-0.0789, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.0610, device='cuda:0') mean:  tensor(-0.0003, device='cuda:0') min:  tensor(-0.0516, device='cuda:0') norm:  tensor(1.8095, device='cuda:0') MSE:  tensor(3.3975e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0014, device='cuda:0') mean:  tensor(1.8500e-05, device='cuda:0') min:  tensor(5.4001e-13, device='cuda:0') norm:  tensor(0.0315, device='cuda:0') MSE:  tensor(5.9097e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0022, device='cuda:0')
min of d_p_list:  tensor(-0.0057, device='cuda:0')
Epoch:  32  
Training Loss: 0.05001841485500336
Test Loss:  0.05681281536817551
Test Acc:  0.0
Valid Loss:  0.05228649452328682
Valid Acc:  0.0
std:  0.00019792174554860055 
thres:  5.029349550604821e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  3%|▎         | 32/1000 [01:30<45:22,  2.81s/it]Epoch:   33
max of grad d_p:  tensor(0.0111, device='cuda:0')
min of grad d_p:  tensor(-0.0785, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.0581, device='cuda:0') mean:  tensor(-0.0002, device='cuda:0') min:  tensor(-0.0482, device='cuda:0') norm:  tensor(1.6892, device='cuda:0') MSE:  tensor(3.1715e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0008, device='cuda:0') mean:  tensor(7.0683e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0143, device='cuda:0') MSE:  tensor(2.6759e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0008, device='cuda:0')
min of d_p_list:  tensor(-0.0031, device='cuda:0')
Epoch:  33  
Training Loss: 0.04988366737961769
Test Loss:  0.05666957050561905
Test Acc:  0.0
Valid Loss:  0.05215179920196533
Valid Acc:  0.0
std:  0.00019342290265207763 
thres:  5.01547709107399e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  3%|▎         | 33/1000 [01:33<45:32,  2.83s/it]Epoch:   34
max of grad d_p:  tensor(0.0112, device='cuda:0')
min of grad d_p:  tensor(-0.0782, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.0569, device='cuda:0') mean:  tensor(-0.0002, device='cuda:0') min:  tensor(-0.0450, device='cuda:0') norm:  tensor(1.5733, device='cuda:0') MSE:  tensor(2.9540e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0006, device='cuda:0') mean:  tensor(6.6997e-06, device='cuda:0') min:  tensor(6.2528e-13, device='cuda:0') norm:  tensor(0.0124, device='cuda:0') MSE:  tensor(2.3365e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0016, device='cuda:0')
min of d_p_list:  tensor(-0.0067, device='cuda:0')
Epoch:  34  
Training Loss: 0.049720220267772675
Test Loss:  0.056505341082811356
Test Acc:  0.0
Valid Loss:  0.052001625299453735
Valid Acc:  0.0
std:  0.00019863493927115667 
thres:  5.001231133937836e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  3%|▎         | 34/1000 [01:36<46:21,  2.88s/it]Epoch:   35
max of grad d_p:  tensor(0.0114, device='cuda:0')
min of grad d_p:  tensor(-0.0780, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.0602, device='cuda:0') mean:  tensor(-0.0002, device='cuda:0') min:  tensor(-0.0462, device='cuda:0') norm:  tensor(1.5953, device='cuda:0') MSE:  tensor(2.9953e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0011, device='cuda:0') mean:  tensor(7.5566e-06, device='cuda:0') min:  tensor(9.0949e-13, device='cuda:0') norm:  tensor(0.0147, device='cuda:0') MSE:  tensor(2.7644e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0007, device='cuda:0')
min of d_p_list:  tensor(-0.0025, device='cuda:0')
Epoch:  35  
Training Loss: 0.04959295690059662
Test Loss:  0.0563703216612339
Test Acc:  0.0
Valid Loss:  0.05187344551086426
Valid Acc:  0.0
std:  0.00020015787341844368 
thres:  4.9873254448175436e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  4%|▎         | 35/1000 [01:39<46:53,  2.92s/it]Epoch:   36
max of grad d_p:  tensor(0.0114, device='cuda:0')
min of grad d_p:  tensor(-0.0778, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.0585, device='cuda:0') mean:  tensor(-0.0002, device='cuda:0') min:  tensor(-0.0445, device='cuda:0') norm:  tensor(1.5369, device='cuda:0') MSE:  tensor(2.8856e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0008, device='cuda:0') mean:  tensor(6.7816e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0128, device='cuda:0') MSE:  tensor(2.4026e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0007, device='cuda:0')
min of d_p_list:  tensor(-0.0019, device='cuda:0')
Epoch:  36  
Training Loss: 0.049543049186468124
Test Loss:  0.056319598108530045
Test Acc:  0.0
Valid Loss:  0.0518161840736866
Valid Acc:  0.0
std:  0.00017792003988973914 
thres:  4.9751661717891695e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  4%|▎         | 36/1000 [01:42<45:23,  2.82s/it]Epoch:   37
max of grad d_p:  tensor(0.0114, device='cuda:0')
min of grad d_p:  tensor(-0.0781, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.0725, device='cuda:0') mean:  tensor(-0.0003, device='cuda:0') min:  tensor(-0.0532, device='cuda:0') norm:  tensor(1.8837, device='cuda:0') MSE:  tensor(3.5368e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0013, device='cuda:0') mean:  tensor(9.4598e-06, device='cuda:0') min:  tensor(1.1369e-13, device='cuda:0') norm:  tensor(0.0184, device='cuda:0') MSE:  tensor(3.4541e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0013, device='cuda:0')
min of d_p_list:  tensor(-0.0022, device='cuda:0')
Epoch:  37  
Training Loss: 0.049418553709983826
Test Loss:  0.056190021336078644
Test Acc:  0.0
Valid Loss:  0.05169247090816498
Valid Acc:  0.0
std:  0.00015881733726796768 
thres:  4.9631689488887784e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  4%|▎         | 37/1000 [01:44<44:41,  2.78s/it]Epoch:   38
max of grad d_p:  tensor(0.0114, device='cuda:0')
min of grad d_p:  tensor(-0.0779, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.0773, device='cuda:0') mean:  tensor(-0.0003, device='cuda:0') min:  tensor(-0.0555, device='cuda:0') norm:  tensor(1.9698, device='cuda:0') MSE:  tensor(3.6984e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0008, device='cuda:0') mean:  tensor(7.8002e-06, device='cuda:0') min:  tensor(1.1369e-13, device='cuda:0') norm:  tensor(0.0146, device='cuda:0') MSE:  tensor(2.7400e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0013, device='cuda:0')
min of d_p_list:  tensor(-0.0011, device='cuda:0')
Epoch:  38  
Training Loss: 0.04928801208734512
Test Loss:  0.05603378266096115
Test Acc:  0.0
Valid Loss:  0.051541149616241455
Valid Acc:  0.0
std:  0.0001481721880491741 
thres:  4.951255843043327e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  4%|▍         | 38/1000 [01:47<43:30,  2.71s/it]Epoch:   39
max of grad d_p:  tensor(0.0115, device='cuda:0')
min of grad d_p:  tensor(-0.0777, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.0742, device='cuda:0') mean:  tensor(-0.0003, device='cuda:0') min:  tensor(-0.0511, device='cuda:0') norm:  tensor(1.8048, device='cuda:0') MSE:  tensor(3.3886e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0013, device='cuda:0') mean:  tensor(8.5952e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0173, device='cuda:0') MSE:  tensor(3.2498e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0005, device='cuda:0')
min of d_p_list:  tensor(-0.0016, device='cuda:0')
Epoch:  39  
Training Loss: 0.04915528744459152
Test Loss:  0.05588607117533684
Test Acc:  0.0
Valid Loss:  0.05140175670385361
Valid Acc:  0.0
std:  0.000161532836446386 
thres:  4.9399571865797046e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  4%|▍         | 39/1000 [01:49<42:56,  2.68s/it]Epoch:   40
max of grad d_p:  tensor(0.0116, device='cuda:0')
min of grad d_p:  tensor(-0.0775, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.0601, device='cuda:0') mean:  tensor(-0.0002, device='cuda:0') min:  tensor(-0.0409, device='cuda:0') norm:  tensor(1.4426, device='cuda:0') MSE:  tensor(2.7085e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(5.7851e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0108, device='cuda:0') MSE:  tensor(2.0273e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0012, device='cuda:0')
min of d_p_list:  tensor(-0.0034, device='cuda:0')
Epoch:  40  
Training Loss: 0.049020908772945404
Test Loss:  0.05574893206357956
Test Acc:  0.0
Valid Loss:  0.05127343535423279
Valid Acc:  0.0
std:  0.00018493482115910893 
thres:  4.92851622402668e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  4%|▍         | 40/1000 [01:52<44:45,  2.80s/it]Epoch:   41
max of grad d_p:  tensor(0.0116, device='cuda:0')
min of grad d_p:  tensor(-0.0773, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.0554, device='cuda:0') mean:  tensor(-0.0002, device='cuda:0') min:  tensor(-0.0373, device='cuda:0') norm:  tensor(1.3098, device='cuda:0') MSE:  tensor(2.4593e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0009, device='cuda:0') mean:  tensor(7.1166e-06, device='cuda:0') min:  tensor(2.2737e-12, device='cuda:0') norm:  tensor(0.0143, device='cuda:0') MSE:  tensor(2.6785e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0005, device='cuda:0')
min of d_p_list:  tensor(-0.0008, device='cuda:0')
Epoch:  41  
Training Loss: 0.04889503866434097
Test Loss:  0.0556037500500679
Test Acc:  0.0
Valid Loss:  0.05113540217280388
Valid Acc:  0.0
std:  0.00018585566469729513 
thres:  4.915556013584137e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  4%|▍         | 41/1000 [01:55<45:33,  2.85s/it]Epoch:   42
max of grad d_p:  tensor(0.0118, device='cuda:0')
min of grad d_p:  tensor(-0.0771, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.0750, device='cuda:0') mean:  tensor(-0.0002, device='cuda:0') min:  tensor(-0.0484, device='cuda:0') norm:  tensor(1.6977, device='cuda:0') MSE:  tensor(3.1875e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0009, device='cuda:0') mean:  tensor(7.2828e-06, device='cuda:0') min:  tensor(3.6380e-12, device='cuda:0') norm:  tensor(0.0141, device='cuda:0') MSE:  tensor(2.6398e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0019, device='cuda:0')
min of d_p_list:  tensor(-0.0033, device='cuda:0')
Epoch:  42  
Training Loss: 0.04878423362970352
Test Loss:  0.05549442768096924
Test Acc:  0.0
Valid Loss:  0.051030389964580536
Valid Acc:  0.0
std:  0.0001794196208731489 
thres:  4.902869611978531e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  4%|▍         | 42/1000 [01:58<45:33,  2.85s/it]Epoch:   43
max of grad d_p:  tensor(0.0116, device='cuda:0')
min of grad d_p:  tensor(-0.0771, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.0693, device='cuda:0') mean:  tensor(-0.0002, device='cuda:0') min:  tensor(-0.0446, device='cuda:0') norm:  tensor(1.5800, device='cuda:0') MSE:  tensor(2.9666e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0008, device='cuda:0') mean:  tensor(6.3636e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0120, device='cuda:0') MSE:  tensor(2.2521e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0004, device='cuda:0')
min of d_p_list:  tensor(-0.0012, device='cuda:0')
Epoch:  43  
Training Loss: 0.048648081719875336
Test Loss:  0.05533742904663086
Test Acc:  0.0
Valid Loss:  0.050882309675216675
Valid Acc:  0.0
std:  0.00017701829121119953 
thres:  4.890071004629135e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  4%|▍         | 43/1000 [02:01<45:31,  2.85s/it]Epoch:   44
max of grad d_p:  tensor(0.0118, device='cuda:0')
min of grad d_p:  tensor(-0.0769, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.0705, device='cuda:0') mean:  tensor(-0.0002, device='cuda:0') min:  tensor(-0.0429, device='cuda:0') norm:  tensor(1.5102, device='cuda:0') MSE:  tensor(2.8355e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0006, device='cuda:0') mean:  tensor(5.7305e-06, device='cuda:0') min:  tensor(2.2737e-13, device='cuda:0') norm:  tensor(0.0121, device='cuda:0') MSE:  tensor(2.2673e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0009, device='cuda:0')
min of d_p_list:  tensor(-0.0035, device='cuda:0')
Epoch:  44  
Training Loss: 0.048506155610084534
Test Loss:  0.05518888309597969
Test Acc:  0.0
Valid Loss:  0.050745636224746704
Valid Acc:  0.0
std:  0.00018070224171701875 
thres:  4.877088367938996e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  4%|▍         | 44/1000 [02:04<46:11,  2.90s/it]Epoch:   45
max of grad d_p:  tensor(0.0118, device='cuda:0')
min of grad d_p:  tensor(-0.0767, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.0832, device='cuda:0') mean:  tensor(-0.0003, device='cuda:0') min:  tensor(-0.0503, device='cuda:0') norm:  tensor(1.7697, device='cuda:0') MSE:  tensor(3.3227e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0007, device='cuda:0') mean:  tensor(6.3179e-06, device='cuda:0') min:  tensor(6.8212e-13, device='cuda:0') norm:  tensor(0.0116, device='cuda:0') MSE:  tensor(2.1729e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0005, device='cuda:0')
min of d_p_list:  tensor(-0.0008, device='cuda:0')
Epoch:  45  
Training Loss: 0.04837392270565033
Test Loss:  0.05503004044294357
Test Acc:  0.0
Valid Loss:  0.05059543251991272
Valid Acc:  0.0
std:  0.00018687630872739797 
thres:  4.864148646593094e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  4%|▍         | 45/1000 [02:07<46:34,  2.93s/it]Epoch:   46
max of grad d_p:  tensor(0.0119, device='cuda:0')
min of grad d_p:  tensor(-0.0765, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.0958, device='cuda:0') mean:  tensor(-0.0003, device='cuda:0') min:  tensor(-0.0548, device='cuda:0') norm:  tensor(1.9342, device='cuda:0') MSE:  tensor(3.6316e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0006, device='cuda:0') mean:  tensor(6.3387e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0111, device='cuda:0') MSE:  tensor(2.0929e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0010, device='cuda:0')
min of d_p_list:  tensor(-0.0032, device='cuda:0')
Epoch:  46  
Training Loss: 0.04822976142168045
Test Loss:  0.05487591028213501
Test Acc:  0.0
Valid Loss:  0.050453443080186844
Valid Acc:  0.0
std:  0.00019561380658941047 
thres:  4.850843101739884e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  5%|▍         | 46/1000 [02:10<46:44,  2.94s/it]Epoch:   47
max of grad d_p:  tensor(0.0119, device='cuda:0')
min of grad d_p:  tensor(-0.0763, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.0987, device='cuda:0') mean:  tensor(-0.0003, device='cuda:0') min:  tensor(-0.0555, device='cuda:0') norm:  tensor(1.9566, device='cuda:0') MSE:  tensor(3.6736e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0007, device='cuda:0') mean:  tensor(6.9350e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0128, device='cuda:0') MSE:  tensor(2.3991e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0022, device='cuda:0')
min of d_p_list:  tensor(-0.0056, device='cuda:0')
Epoch:  47  
Training Loss: 0.04806753247976303
Test Loss:  0.05471944436430931
Test Acc:  0.0
Valid Loss:  0.050309084355831146
Valid Acc:  0.0
std:  0.0002034286796457629 
thres:  4.836509078741073e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  5%|▍         | 47/1000 [02:13<46:43,  2.94s/it]Epoch:   48
max of grad d_p:  tensor(0.0118, device='cuda:0')
min of grad d_p:  tensor(-0.0760, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.0644, device='cuda:0') mean:  tensor(-0.0002, device='cuda:0') min:  tensor(-0.0363, device='cuda:0') norm:  tensor(1.2709, device='cuda:0') MSE:  tensor(2.3862e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0011, device='cuda:0') mean:  tensor(9.5545e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0199, device='cuda:0') MSE:  tensor(3.7327e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0025, device='cuda:0')
min of d_p_list:  tensor(-0.0047, device='cuda:0')
Epoch:  48  
Training Loss: 0.04792657122015953
Test Loss:  0.05457838624715805
Test Acc:  0.0
Valid Loss:  0.050177495926618576
Valid Acc:  0.0
std:  0.00020737222633567055 
thres:  4.822078868746758e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  5%|▍         | 48/1000 [02:16<46:49,  2.95s/it]Epoch:   49
max of grad d_p:  tensor(0.0117, device='cuda:0')
min of grad d_p:  tensor(-0.0758, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.0912, device='cuda:0') mean:  tensor(-0.0003, device='cuda:0') min:  tensor(-0.0511, device='cuda:0') norm:  tensor(1.8024, device='cuda:0') MSE:  tensor(3.3841e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0011, device='cuda:0') mean:  tensor(9.8063e-06, device='cuda:0') min:  tensor(1.2506e-12, device='cuda:0') norm:  tensor(0.0191, device='cuda:0') MSE:  tensor(3.5931e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0006, device='cuda:0')
min of d_p_list:  tensor(-0.0029, device='cuda:0')
Epoch:  49  
Training Loss: 0.0477755106985569
Test Loss:  0.054410338401794434
Test Acc:  0.0
Valid Loss:  0.05002393573522568
Valid Acc:  0.0
std:  0.00021217257636805005 
thres:  4.807465970516205e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  5%|▍         | 49/1000 [02:19<45:32,  2.87s/it]Epoch:   50
max of grad d_p:  tensor(0.0118, device='cuda:0')
min of grad d_p:  tensor(-0.0756, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.0827, device='cuda:0') mean:  tensor(-0.0002, device='cuda:0') min:  tensor(-0.0454, device='cuda:0') norm:  tensor(1.6028, device='cuda:0') MSE:  tensor(3.0094e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0035, device='cuda:0') mean:  tensor(2.8004e-05, device='cuda:0') min:  tensor(1.3642e-12, device='cuda:0') norm:  tensor(0.0526, device='cuda:0') MSE:  tensor(9.8827e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0007, device='cuda:0')
min of d_p_list:  tensor(-0.0028, device='cuda:0')
Epoch:  50  
Training Loss: 0.04763198643922806
Test Loss:  0.05425272881984711
Test Acc:  0.0
Valid Loss:  0.049879565834999084
Valid Acc:  0.0
std:  0.00021042499995873711 
thres:  4.7926272451877595e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  5%|▌         | 50/1000 [02:22<45:45,  2.89s/it]Epoch:   51
max of grad d_p:  tensor(0.0119, device='cuda:0')
min of grad d_p:  tensor(-0.0754, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.0935, device='cuda:0') mean:  tensor(-0.0003, device='cuda:0') min:  tensor(-0.0487, device='cuda:0') norm:  tensor(1.7071, device='cuda:0') MSE:  tensor(3.2052e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0016, device='cuda:0') mean:  tensor(1.7172e-05, device='cuda:0') min:  tensor(2.9559e-12, device='cuda:0') norm:  tensor(0.0340, device='cuda:0') MSE:  tensor(6.3765e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0011, device='cuda:0')
min of d_p_list:  tensor(-0.0029, device='cuda:0')
Epoch:  51  
Training Loss: 0.04749166592955589
Test Loss:  0.05410035699605942
Test Acc:  0.0
Valid Loss:  0.049739763140678406
Valid Acc:  0.0
std:  0.0002045549737316686 
thres:  4.777865335345268e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  5%|▌         | 51/1000 [02:24<43:38,  2.76s/it]Epoch:   52
max of grad d_p:  tensor(0.0119, device='cuda:0')
min of grad d_p:  tensor(-0.0752, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.0933, device='cuda:0') mean:  tensor(-0.0003, device='cuda:0') min:  tensor(-0.0486, device='cuda:0') norm:  tensor(1.7085, device='cuda:0') MSE:  tensor(3.2077e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0014, device='cuda:0') mean:  tensor(1.1136e-05, device='cuda:0') min:  tensor(2.2737e-12, device='cuda:0') norm:  tensor(0.0232, device='cuda:0') MSE:  tensor(4.3509e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0009, device='cuda:0')
min of d_p_list:  tensor(-0.0026, device='cuda:0')
Epoch:  52  
Training Loss: 0.047361720353364944
Test Loss:  0.05395878851413727
Test Acc:  0.0
Valid Loss:  0.04960935190320015
Valid Acc:  0.0
std:  0.00019998075496508754 
thres:  4.7637490928173064e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  5%|▌         | 52/1000 [02:27<43:23,  2.75s/it]Epoch:   53
max of grad d_p:  tensor(0.0119, device='cuda:0')
min of grad d_p:  tensor(-0.0750, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.1084, device='cuda:0') mean:  tensor(-0.0003, device='cuda:0') min:  tensor(-0.0551, device='cuda:0') norm:  tensor(1.9412, device='cuda:0') MSE:  tensor(3.6448e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0010, device='cuda:0') mean:  tensor(7.6098e-06, device='cuda:0') min:  tensor(2.1600e-12, device='cuda:0') norm:  tensor(0.0140, device='cuda:0') MSE:  tensor(2.6252e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0027, device='cuda:0')
min of d_p_list:  tensor(-0.0083, device='cuda:0')
Epoch:  53  
Training Loss: 0.04725334793329239
Test Loss:  0.05389465391635895
Test Acc:  0.0
Valid Loss:  0.04953501373529434
Valid Acc:  0.0
std:  0.0001861794931172107 
thres:  4.750284627079963e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  5%|▌         | 53/1000 [02:30<44:00,  2.79s/it]Epoch:   54
max of grad d_p:  tensor(0.0118, device='cuda:0')
min of grad d_p:  tensor(-0.0749, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.1224, device='cuda:0') mean:  tensor(-0.0003, device='cuda:0') min:  tensor(-0.0604, device='cuda:0') norm:  tensor(2.1385, device='cuda:0') MSE:  tensor(4.0151e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0009, device='cuda:0') mean:  tensor(8.3283e-06, device='cuda:0') min:  tensor(1.7053e-13, device='cuda:0') norm:  tensor(0.0154, device='cuda:0') MSE:  tensor(2.8931e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0006, device='cuda:0')
min of d_p_list:  tensor(-0.0027, device='cuda:0')
Epoch:  54  
Training Loss: 0.047100938856601715
Test Loss:  0.053725309669971466
Test Acc:  0.0
Valid Loss:  0.049381010234355927
Valid Acc:  0.0
std:  0.00018411315201158736 
thres:  4.73679319024086e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  5%|▌         | 54/1000 [02:33<45:18,  2.87s/it]Epoch:   55
max of grad d_p:  tensor(0.0119, device='cuda:0')
min of grad d_p:  tensor(-0.0747, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.1125, device='cuda:0') mean:  tensor(-0.0003, device='cuda:0') min:  tensor(-0.0545, device='cuda:0') norm:  tensor(1.9215, device='cuda:0') MSE:  tensor(3.6078e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0009, device='cuda:0') mean:  tensor(7.3882e-06, device='cuda:0') min:  tensor(6.3665e-12, device='cuda:0') norm:  tensor(0.0141, device='cuda:0') MSE:  tensor(2.6403e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0058, device='cuda:0')
min of d_p_list:  tensor(-0.0133, device='cuda:0')
Epoch:  55  
Training Loss: 0.047009315341711044
Test Loss:  0.0536118820309639
Test Acc:  0.0
Valid Loss:  0.04924783110618591
Valid Acc:  0.0
std:  0.00017368099710285287 
thres:  4.72433976829052e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  6%|▌         | 55/1000 [02:36<45:32,  2.89s/it]Epoch:   56
max of grad d_p:  tensor(0.0122, device='cuda:0')
min of grad d_p:  tensor(-0.0732, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.1064, device='cuda:0') mean:  tensor(-0.0002, device='cuda:0') min:  tensor(-0.0449, device='cuda:0') norm:  tensor(1.5709, device='cuda:0') MSE:  tensor(2.9494e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0011, device='cuda:0') mean:  tensor(9.0519e-06, device='cuda:0') min:  tensor(5.6843e-14, device='cuda:0') norm:  tensor(0.0179, device='cuda:0') MSE:  tensor(3.3602e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0027, device='cuda:0')
min of d_p_list:  tensor(-0.0058, device='cuda:0')
Epoch:  56  
Training Loss: 0.046910688281059265
Test Loss:  0.05352440103888512
Test Acc:  0.0
Valid Loss:  0.04916179180145264
Valid Acc:  0.0
std:  0.00016271254527192353 
thres:  4.7127202153205875e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  6%|▌         | 56/1000 [02:39<45:52,  2.92s/it]Epoch:   57
max of grad d_p:  tensor(0.0118, device='cuda:0')
min of grad d_p:  tensor(-0.0733, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.1236, device='cuda:0') mean:  tensor(-0.0003, device='cuda:0') min:  tensor(-0.0521, device='cuda:0') norm:  tensor(1.8427, device='cuda:0') MSE:  tensor(3.4597e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0013, device='cuda:0') mean:  tensor(9.6982e-06, device='cuda:0') min:  tensor(3.6380e-12, device='cuda:0') norm:  tensor(0.0188, device='cuda:0') MSE:  tensor(3.5373e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0017, device='cuda:0')
min of d_p_list:  tensor(-0.0017, device='cuda:0')
Epoch:  57  
Training Loss: 0.04679786413908005
Test Loss:  0.053394436836242676
Test Acc:  0.0
Valid Loss:  0.04904201626777649
Valid Acc:  0.0
std:  0.00015636805121845715 
thres:  4.701443091034889e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  6%|▌         | 57/1000 [02:41<44:06,  2.81s/it]Epoch:   58
max of grad d_p:  tensor(0.0116, device='cuda:0')
min of grad d_p:  tensor(-0.0732, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.1164, device='cuda:0') mean:  tensor(-0.0003, device='cuda:0') min:  tensor(-0.0480, device='cuda:0') norm:  tensor(1.7099, device='cuda:0') MSE:  tensor(3.2104e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0042, device='cuda:0') mean:  tensor(2.7707e-05, device='cuda:0') min:  tensor(5.4570e-12, device='cuda:0') norm:  tensor(0.0485, device='cuda:0') MSE:  tensor(9.1113e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0020, device='cuda:0')
min of d_p_list:  tensor(-0.0043, device='cuda:0')
Epoch:  58  
Training Loss: 0.046704333275556564
Test Loss:  0.05331159010529518
Test Acc:  0.0
Valid Loss:  0.04895889386534691
Valid Acc:  0.0
std:  0.0001421623139788783 
thres:  4.690462797880173e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  6%|▌         | 58/1000 [02:44<42:29,  2.71s/it]Epoch:   59
max of grad d_p:  tensor(0.0114, device='cuda:0')
min of grad d_p:  tensor(-0.0730, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.1295, device='cuda:0') mean:  tensor(-0.0003, device='cuda:0') min:  tensor(-0.0530, device='cuda:0') norm:  tensor(1.8987, device='cuda:0') MSE:  tensor(3.5648e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0020, device='cuda:0') mean:  tensor(1.5800e-05, device='cuda:0') min:  tensor(1.8190e-12, device='cuda:0') norm:  tensor(0.0280, device='cuda:0') MSE:  tensor(5.2580e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0005, device='cuda:0')
min of d_p_list:  tensor(-0.0016, device='cuda:0')
Epoch:  59  
Training Loss: 0.04655515402555466
Test Loss:  0.053138893097639084
Test Acc:  0.0
Valid Loss:  0.04880388826131821
Valid Acc:  0.0
std:  0.00015815719046218956 
thres:  4.6795471012592314e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  6%|▌         | 59/1000 [02:47<43:06,  2.75s/it]Epoch:   60
max of grad d_p:  tensor(0.0115, device='cuda:0')
min of grad d_p:  tensor(-0.0728, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.1305, device='cuda:0') mean:  tensor(-0.0003, device='cuda:0') min:  tensor(-0.0529, device='cuda:0') norm:  tensor(1.8867, device='cuda:0') MSE:  tensor(3.5424e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0012, device='cuda:0') mean:  tensor(9.2981e-06, device='cuda:0') min:  tensor(6.8212e-13, device='cuda:0') norm:  tensor(0.0173, device='cuda:0') MSE:  tensor(3.2531e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0009, device='cuda:0')
min of d_p_list:  tensor(-0.0027, device='cuda:0')
Epoch:  60  
Training Loss: 0.046416275203228
Test Loss:  0.05298544839024544
Test Acc:  0.0
Valid Loss:  0.0486641526222229
Valid Acc:  0.0
std:  0.0001748080250144654 
thres:  4.667686298489571e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  6%|▌         | 60/1000 [02:49<43:44,  2.79s/it]Epoch:   61
max of grad d_p:  tensor(0.0115, device='cuda:0')
min of grad d_p:  tensor(-0.0726, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.1345, device='cuda:0') mean:  tensor(-0.0003, device='cuda:0') min:  tensor(-0.0549, device='cuda:0') norm:  tensor(1.9671, device='cuda:0') MSE:  tensor(3.6933e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0018, device='cuda:0') mean:  tensor(1.2801e-05, device='cuda:0') min:  tensor(3.4106e-13, device='cuda:0') norm:  tensor(0.0230, device='cuda:0') MSE:  tensor(4.3221e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0012, device='cuda:0')
min of d_p_list:  tensor(-0.0027, device='cuda:0')
Epoch:  61  
Training Loss: 0.04631417989730835
Test Loss:  0.052875638008117676
Test Acc:  0.0
Valid Loss:  0.048560626804828644
Valid Acc:  0.0
std:  0.00017803905783068274 
thres:  4.655756130814552e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  6%|▌         | 61/1000 [02:53<45:00,  2.88s/it]Epoch:   62
max of grad d_p:  tensor(0.0114, device='cuda:0')
min of grad d_p:  tensor(-0.0725, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.1166, device='cuda:0') mean:  tensor(-0.0003, device='cuda:0') min:  tensor(-0.0469, device='cuda:0') norm:  tensor(1.6877, device='cuda:0') MSE:  tensor(3.1687e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0026, device='cuda:0') mean:  tensor(1.7142e-05, device='cuda:0') min:  tensor(7.2760e-12, device='cuda:0') norm:  tensor(0.0384, device='cuda:0') MSE:  tensor(7.2048e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0014, device='cuda:0')
min of d_p_list:  tensor(-0.0011, device='cuda:0')
Epoch:  62  
Training Loss: 0.04619230702519417
Test Loss:  0.05273487791419029
Test Acc:  0.0
Valid Loss:  0.0484299510717392
Valid Acc:  0.0
std:  0.00017934039566689294 
thres:  4.6436449885368346e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  6%|▌         | 62/1000 [02:55<42:54,  2.74s/it]Epoch:   63
max of grad d_p:  tensor(0.0113, device='cuda:0')
min of grad d_p:  tensor(-0.0722, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.1344, device='cuda:0') mean:  tensor(-0.0003, device='cuda:0') min:  tensor(-0.0531, device='cuda:0') norm:  tensor(1.9086, device='cuda:0') MSE:  tensor(3.5834e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0012, device='cuda:0') mean:  tensor(8.3690e-06, device='cuda:0') min:  tensor(1.3642e-12, device='cuda:0') norm:  tensor(0.0164, device='cuda:0') MSE:  tensor(3.0762e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0007, device='cuda:0')
min of d_p_list:  tensor(-0.0016, device='cuda:0')
Epoch:  63  
Training Loss: 0.04604150354862213
Test Loss:  0.05256174877285957
Test Acc:  0.0
Valid Loss:  0.04827342554926872
Valid Acc:  0.0
std:  0.00017729485969915555 
thres:  4.630388393998146e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  6%|▋         | 63/1000 [02:58<44:11,  2.83s/it]Epoch:   64
max of grad d_p:  tensor(0.0114, device='cuda:0')
min of grad d_p:  tensor(-0.0721, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.1317, device='cuda:0') mean:  tensor(-0.0003, device='cuda:0') min:  tensor(-0.0524, device='cuda:0') norm:  tensor(1.8807, device='cuda:0') MSE:  tensor(3.5311e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0006, device='cuda:0') mean:  tensor(6.8874e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0126, device='cuda:0') MSE:  tensor(2.3735e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0006, device='cuda:0')
min of d_p_list:  tensor(-0.0026, device='cuda:0')
Epoch:  64  
Training Loss: 0.04590020328760147
Test Loss:  0.052405036985874176
Test Acc:  0.0
Valid Loss:  0.0481315478682518
Valid Acc:  0.0
std:  0.00018503872878487045 
thres:  4.6172893792390825e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  6%|▋         | 64/1000 [03:01<44:52,  2.88s/it]Epoch:   65
max of grad d_p:  tensor(0.0115, device='cuda:0')
min of grad d_p:  tensor(-0.0719, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.1634, device='cuda:0') mean:  tensor(-0.0004, device='cuda:0') min:  tensor(-0.0631, device='cuda:0') norm:  tensor(2.2565, device='cuda:0') MSE:  tensor(4.2367e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0023, device='cuda:0') mean:  tensor(1.7543e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0338, device='cuda:0') MSE:  tensor(6.3504e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0008, device='cuda:0')
min of d_p_list:  tensor(-0.0020, device='cuda:0')
Epoch:  65  
Training Loss: 0.045779019594192505
Test Loss:  0.05227081850171089
Test Acc:  0.0
Valid Loss:  0.0480080284178257
Valid Acc:  0.0
std:  0.00019281083287379908 
thres:  4.6045442670583726e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  6%|▋         | 65/1000 [03:04<45:15,  2.90s/it]Epoch:   66
max of grad d_p:  tensor(0.0115, device='cuda:0')
min of grad d_p:  tensor(-0.0717, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.1443, device='cuda:0') mean:  tensor(-0.0003, device='cuda:0') min:  tensor(-0.0554, device='cuda:0') norm:  tensor(1.9829, device='cuda:0') MSE:  tensor(3.7229e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0016, device='cuda:0') mean:  tensor(1.2501e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0247, device='cuda:0') MSE:  tensor(4.6361e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0010, device='cuda:0')
min of d_p_list:  tensor(-0.0026, device='cuda:0')
Epoch:  66  
Training Loss: 0.04566523805260658
Test Loss:  0.05214317888021469
Test Acc:  0.0
Valid Loss:  0.04789058864116669
Valid Acc:  0.0
std:  0.0001865426692796886 
thres:  4.591565430164337e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  7%|▋         | 66/1000 [03:06<43:03,  2.77s/it]Epoch:   67
max of grad d_p:  tensor(0.0114, device='cuda:0')
min of grad d_p:  tensor(-0.0715, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.1527, device='cuda:0') mean:  tensor(-0.0003, device='cuda:0') min:  tensor(-0.0583, device='cuda:0') norm:  tensor(2.0996, device='cuda:0') MSE:  tensor(3.9421e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0010, device='cuda:0') mean:  tensor(1.0029e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0174, device='cuda:0') MSE:  tensor(3.2677e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0006, device='cuda:0')
min of d_p_list:  tensor(-0.0020, device='cuda:0')
Epoch:  67  
Training Loss: 0.04550328105688095
Test Loss:  0.051956698298454285
Test Acc:  0.0
Valid Loss:  0.04772220179438591
Valid Acc:  0.0
std:  0.00018577106548425506 
thres:  4.577784910798073e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  7%|▋         | 67/1000 [03:09<43:15,  2.78s/it]Epoch:   68
max of grad d_p:  tensor(0.0116, device='cuda:0')
min of grad d_p:  tensor(-0.0714, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.1330, device='cuda:0') mean:  tensor(-0.0003, device='cuda:0') min:  tensor(-0.0502, device='cuda:0') norm:  tensor(1.7973, device='cuda:0') MSE:  tensor(3.3746e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0007, device='cuda:0') mean:  tensor(6.3777e-06, device='cuda:0') min:  tensor(2.4869e-13, device='cuda:0') norm:  tensor(0.0122, device='cuda:0') MSE:  tensor(2.2958e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0007, device='cuda:0')
min of d_p_list:  tensor(-0.0029, device='cuda:0')
Epoch:  68  
Training Loss: 0.045353494584560394
Test Loss:  0.051785022020339966
Test Acc:  0.0
Valid Loss:  0.04756902903318405
Valid Acc:  0.0
std:  0.00019413720632958714 
thres:  4.564024731516838e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  7%|▋         | 68/1000 [03:12<42:24,  2.73s/it]Epoch:   69
max of grad d_p:  tensor(0.0117, device='cuda:0')
min of grad d_p:  tensor(-0.0712, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.1466, device='cuda:0') mean:  tensor(-0.0003, device='cuda:0') min:  tensor(-0.0541, device='cuda:0') norm:  tensor(1.9320, device='cuda:0') MSE:  tensor(3.6274e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0011, device='cuda:0') mean:  tensor(1.0987e-05, device='cuda:0') min:  tensor(6.2528e-13, device='cuda:0') norm:  tensor(0.0178, device='cuda:0') MSE:  tensor(3.3407e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0005, device='cuda:0')
min of d_p_list:  tensor(-0.0022, device='cuda:0')
Epoch:  69  
Training Loss: 0.04522629454731941
Test Loss:  0.05163813754916191
Test Acc:  0.0
Valid Loss:  0.047436706721782684
Valid Acc:  0.0
std:  0.00020069651853869396 
thres:  4.5505465567111974e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  7%|▋         | 69/1000 [03:15<43:30,  2.80s/it]Epoch:   70
max of grad d_p:  tensor(0.0116, device='cuda:0')
min of grad d_p:  tensor(-0.0710, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.1396, device='cuda:0') mean:  tensor(-0.0003, device='cuda:0') min:  tensor(-0.0507, device='cuda:0') norm:  tensor(1.8141, device='cuda:0') MSE:  tensor(3.4061e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0010, device='cuda:0') mean:  tensor(8.8154e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0159, device='cuda:0') MSE:  tensor(2.9919e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0007, device='cuda:0')
min of d_p_list:  tensor(-0.0023, device='cuda:0')
Epoch:  70  
Training Loss: 0.04510348290205002
Test Loss:  0.05150243639945984
Test Acc:  0.0
Valid Loss:  0.047312818467617035
Valid Acc:  0.0
std:  0.00019843576066824698 
thres:  4.537035822868347e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  7%|▋         | 70/1000 [03:18<43:04,  2.78s/it]Epoch:   71
max of grad d_p:  tensor(0.0116, device='cuda:0')
min of grad d_p:  tensor(-0.0709, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.1418, device='cuda:0') mean:  tensor(-0.0003, device='cuda:0') min:  tensor(-0.0520, device='cuda:0') norm:  tensor(1.8626, device='cuda:0') MSE:  tensor(3.4972e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0064, device='cuda:0') mean:  tensor(4.6361e-05, device='cuda:0') min:  tensor(1.8190e-12, device='cuda:0') norm:  tensor(0.0977, device='cuda:0') MSE:  tensor(1.8335e-07, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0022, device='cuda:0')
min of d_p_list:  tensor(-0.0020, device='cuda:0')
Epoch:  71  
Training Loss: 0.045015834271907806
Test Loss:  0.05141684412956238
Test Acc:  0.0
Valid Loss:  0.04722856730222702
Valid Acc:  0.0
std:  0.00017393782041505809 
thres:  4.5240477472543715e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  7%|▋         | 71/1000 [03:20<42:49,  2.77s/it]Epoch:   72
max of grad d_p:  tensor(0.0115, device='cuda:0')
min of grad d_p:  tensor(-0.0706, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.1397, device='cuda:0') mean:  tensor(-0.0003, device='cuda:0') min:  tensor(-0.0514, device='cuda:0') norm:  tensor(1.8386, device='cuda:0') MSE:  tensor(3.4521e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0032, device='cuda:0') mean:  tensor(1.5305e-05, device='cuda:0') min:  tensor(1.4779e-12, device='cuda:0') norm:  tensor(0.0346, device='cuda:0') MSE:  tensor(6.4881e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0091, device='cuda:0')
min of d_p_list:  tensor(-0.0109, device='cuda:0')
Epoch:  72  
Training Loss: 0.045417483896017075
Test Loss:  0.05206741765141487
Test Acc:  0.0
Valid Loss:  0.04770980775356293
Valid Acc:  0.0
std:  0.00014970981684684308 
thres:  4.522331804037094e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  7%|▋         | 72/1000 [03:23<41:15,  2.67s/it]Epoch:   73
max of grad d_p:  tensor(0.0148, device='cuda:0')
min of grad d_p:  tensor(-0.0760, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.1275, device='cuda:0') mean:  tensor(-0.0003, device='cuda:0') min:  tensor(-0.0522, device='cuda:0') norm:  tensor(2.0151, device='cuda:0') MSE:  tensor(3.7835e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0037, device='cuda:0') mean:  tensor(2.4730e-05, device='cuda:0') min:  tensor(5.8549e-12, device='cuda:0') norm:  tensor(0.0501, device='cuda:0') MSE:  tensor(9.4029e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0005, device='cuda:0')
min of d_p_list:  tensor(-0.0015, device='cuda:0')
Epoch:  73  
Training Loss: 0.04528374969959259
Test Loss:  0.05191218852996826
Test Acc:  0.0
Valid Loss:  0.04757152870297432
Valid Acc:  0.0
std:  0.0001398558753037676 
thres:  4.520936906337738e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  7%|▋         | 73/1000 [03:25<41:09,  2.66s/it]Epoch:   74
max of grad d_p:  tensor(0.0148, device='cuda:0')
min of grad d_p:  tensor(-0.0758, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.1279, device='cuda:0') mean:  tensor(-0.0003, device='cuda:0') min:  tensor(-0.0516, device='cuda:0') norm:  tensor(1.9957, device='cuda:0') MSE:  tensor(3.7470e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0007, device='cuda:0') mean:  tensor(5.8913e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0109, device='cuda:0') MSE:  tensor(2.0383e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0025, device='cuda:0')
min of d_p_list:  tensor(-0.0025, device='cuda:0')
Epoch:  74  
Training Loss: 0.04514449089765549
Test Loss:  0.05179364234209061
Test Acc:  0.0
Valid Loss:  0.04747065156698227
Valid Acc:  0.0
std:  0.00014169168376867625 
thres:  4.51930083334446e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  7%|▋         | 74/1000 [03:28<42:34,  2.76s/it]Epoch:   75
max of grad d_p:  tensor(0.0171, device='cuda:0')
min of grad d_p:  tensor(-0.0782, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.1237, device='cuda:0') mean:  tensor(-0.0003, device='cuda:0') min:  tensor(-0.0483, device='cuda:0') norm:  tensor(1.8181, device='cuda:0') MSE:  tensor(3.4136e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0007, device='cuda:0') mean:  tensor(7.7802e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0140, device='cuda:0') MSE:  tensor(2.6349e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0004, device='cuda:0')
min of d_p_list:  tensor(-0.0016, device='cuda:0')
Epoch:  75  
Training Loss: 0.045024409890174866
Test Loss:  0.05165672302246094
Test Acc:  0.0
Valid Loss:  0.04734640568494797
Valid Acc:  0.0
std:  0.00015462392454675458 
thres:  4.517719373106956e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  8%|▊         | 75/1000 [03:31<43:05,  2.80s/it]Epoch:   76
max of grad d_p:  tensor(0.0170, device='cuda:0')
min of grad d_p:  tensor(-0.0780, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.1585, device='cuda:0') mean:  tensor(-0.0004, device='cuda:0') min:  tensor(-0.0617, device='cuda:0') norm:  tensor(2.3185, device='cuda:0') MSE:  tensor(4.3531e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0009, device='cuda:0') mean:  tensor(8.5572e-06, device='cuda:0') min:  tensor(1.3642e-12, device='cuda:0') norm:  tensor(0.0150, device='cuda:0') MSE:  tensor(2.8168e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0005, device='cuda:0')
min of d_p_list:  tensor(-0.0017, device='cuda:0')
Epoch:  76  
Training Loss: 0.04489634186029434
Test Loss:  0.05150529369711876
Test Acc:  0.0
Valid Loss:  0.0472090020775795
Valid Acc:  0.0
std:  0.0001841347339214029 
thres:  4.515329524874687e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  8%|▊         | 76/1000 [03:34<44:23,  2.88s/it]Epoch:   77
max of grad d_p:  tensor(0.0170, device='cuda:0')
min of grad d_p:  tensor(-0.0778, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.1168, device='cuda:0') mean:  tensor(-0.0003, device='cuda:0') min:  tensor(-0.0459, device='cuda:0') norm:  tensor(1.7062, device='cuda:0') MSE:  tensor(3.2035e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0009, device='cuda:0') mean:  tensor(7.1153e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0130, device='cuda:0') MSE:  tensor(2.4370e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0015, device='cuda:0')
min of d_p_list:  tensor(-0.0022, device='cuda:0')
Epoch:  77  
Training Loss: 0.04485029727220535
Test Loss:  0.05146908760070801
Test Acc:  0.0
Valid Loss:  0.0471627451479435
Valid Acc:  0.0
std:  0.0001594992165354656 
thres:  4.503985792398453e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  8%|▊         | 77/1000 [03:37<43:47,  2.85s/it]Epoch:   78
max of grad d_p:  tensor(0.0168, device='cuda:0')
min of grad d_p:  tensor(-0.0778, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.1169, device='cuda:0') mean:  tensor(-0.0003, device='cuda:0') min:  tensor(-0.0487, device='cuda:0') norm:  tensor(1.7945, device='cuda:0') MSE:  tensor(3.3692e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0115, device='cuda:0') mean:  tensor(7.9428e-05, device='cuda:0') min:  tensor(3.5925e-11, device='cuda:0') norm:  tensor(0.1730, device='cuda:0') MSE:  tensor(3.2488e-07, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0069, device='cuda:0')
min of d_p_list:  tensor(-0.0051, device='cuda:0')
Epoch:  78  
Training Loss: 0.04489470273256302
Test Loss:  0.051599808037281036
Test Acc:  0.0
Valid Loss:  0.04723474383354187
Valid Acc:  0.0
std:  0.000108180703689259 
thres:  4.496204853057861e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  8%|▊         | 78/1000 [03:40<43:11,  2.81s/it]Epoch:   79
max of grad d_p:  tensor(0.0169, device='cuda:0')
min of grad d_p:  tensor(-0.0782, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.1376, device='cuda:0') mean:  tensor(-0.0004, device='cuda:0') min:  tensor(-0.0604, device='cuda:0') norm:  tensor(2.2582, device='cuda:0') MSE:  tensor(4.2399e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0009, device='cuda:0') mean:  tensor(7.6410e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0143, device='cuda:0') MSE:  tensor(2.6833e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0044, device='cuda:0')
min of d_p_list:  tensor(-0.0052, device='cuda:0')
Epoch:  79  
Training Loss: 0.04471860080957413
Test Loss:  0.05138566344976425
Test Acc:  0.0
Valid Loss:  0.04703745245933533
Valid Acc:  0.0
std:  9.820430274279424e-05 
thres:  4.487687051296234e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  8%|▊         | 79/1000 [03:43<43:44,  2.85s/it]Epoch:   80
max of grad d_p:  tensor(0.0169, device='cuda:0')
min of grad d_p:  tensor(-0.0778, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.1088, device='cuda:0') mean:  tensor(-0.0003, device='cuda:0') min:  tensor(-0.0461, device='cuda:0') norm:  tensor(1.7456, device='cuda:0') MSE:  tensor(3.2775e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0009, device='cuda:0') mean:  tensor(1.0503e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0198, device='cuda:0') MSE:  tensor(3.7116e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0007, device='cuda:0')
min of d_p_list:  tensor(-0.0029, device='cuda:0')
Epoch:  80  
Training Loss: 0.044572167098522186
Test Loss:  0.0512247234582901
Test Acc:  0.0
Valid Loss:  0.04689446836709976
Valid Acc:  0.0
std:  0.00012521343363142747 
thres:  4.4786421954631806e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  8%|▊         | 80/1000 [03:46<45:12,  2.95s/it]Epoch:   81
max of grad d_p:  tensor(0.0169, device='cuda:0')
min of grad d_p:  tensor(-0.0776, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.1322, device='cuda:0') mean:  tensor(-0.0003, device='cuda:0') min:  tensor(-0.0556, device='cuda:0') norm:  tensor(2.0964, device='cuda:0') MSE:  tensor(3.9361e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(6.7397e-06, device='cuda:0') min:  tensor(4.5475e-13, device='cuda:0') norm:  tensor(0.0128, device='cuda:0') MSE:  tensor(2.3966e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0008, device='cuda:0')
min of d_p_list:  tensor(-0.0026, device='cuda:0')
Epoch:  81  
Training Loss: 0.04445046931505203
Test Loss:  0.051090117543935776
Test Acc:  0.0
Valid Loss:  0.046772100031375885
Valid Acc:  0.0
std:  0.00016698104375553787 
thres:  4.469724744558335e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  8%|▊         | 81/1000 [03:49<45:19,  2.96s/it]Epoch:   82
max of grad d_p:  tensor(0.0169, device='cuda:0')
min of grad d_p:  tensor(-0.0774, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.1285, device='cuda:0') mean:  tensor(-0.0003, device='cuda:0') min:  tensor(-0.0534, device='cuda:0') norm:  tensor(2.0170, device='cuda:0') MSE:  tensor(3.7871e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0010, device='cuda:0') mean:  tensor(9.9214e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0185, device='cuda:0') MSE:  tensor(3.4695e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0004, device='cuda:0')
min of d_p_list:  tensor(-0.0019, device='cuda:0')
Epoch:  82  
Training Loss: 0.04432997480034828
Test Loss:  0.05095234885811806
Test Acc:  0.0
Valid Loss:  0.0466478131711483
Valid Acc:  0.0
std:  0.0001983588649057491 
thres:  4.459318295121193e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  8%|▊         | 82/1000 [03:52<45:00,  2.94s/it]Epoch:   83
max of grad d_p:  tensor(0.0168, device='cuda:0')
min of grad d_p:  tensor(-0.0772, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.1142, device='cuda:0') mean:  tensor(-0.0003, device='cuda:0') min:  tensor(-0.0479, device='cuda:0') norm:  tensor(1.7964, device='cuda:0') MSE:  tensor(3.3728e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0011, device='cuda:0') mean:  tensor(8.9767e-06, device='cuda:0') min:  tensor(5.6843e-13, device='cuda:0') norm:  tensor(0.0177, device='cuda:0') MSE:  tensor(3.3222e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0007, device='cuda:0')
min of d_p_list:  tensor(-0.0018, device='cuda:0')
Epoch:  83  
Training Loss: 0.04420855641365051
Test Loss:  0.05081365257501602
Test Acc:  0.0
Valid Loss:  0.046522364020347595
Valid Acc:  0.0
std:  0.00017865902557247124 
thres:  4.445595368742942e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  8%|▊         | 83/1000 [03:55<44:03,  2.88s/it]Epoch:   84
max of grad d_p:  tensor(0.0168, device='cuda:0')
min of grad d_p:  tensor(-0.0770, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.1203, device='cuda:0') mean:  tensor(-0.0003, device='cuda:0') min:  tensor(-0.0514, device='cuda:0') norm:  tensor(1.9188, device='cuda:0') MSE:  tensor(3.6027e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0485, device='cuda:0') mean:  tensor(0.0003, device='cuda:0') min:  tensor(1.3642e-12, device='cuda:0') norm:  tensor(0.5627, device='cuda:0') MSE:  tensor(1.0564e-06, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0020, device='cuda:0')
min of d_p_list:  tensor(-0.0021, device='cuda:0')
Epoch:  84  
Training Loss: 0.04414166510105133
Test Loss:  0.05075082555413246
Test Acc:  0.0
Valid Loss:  0.046456463634967804
Valid Acc:  0.0
std:  0.0001567278402170047 
thres:  4.434056654572487e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  8%|▊         | 84/1000 [03:58<44:34,  2.92s/it]Epoch:   85
max of grad d_p:  tensor(0.0167, device='cuda:0')
min of grad d_p:  tensor(-0.0769, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.1026, device='cuda:0') mean:  tensor(-0.0003, device='cuda:0') min:  tensor(-0.0442, device='cuda:0') norm:  tensor(1.6523, device='cuda:0') MSE:  tensor(3.1023e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0015, device='cuda:0') mean:  tensor(9.3537e-06, device='cuda:0') min:  tensor(3.4106e-13, device='cuda:0') norm:  tensor(0.0212, device='cuda:0') MSE:  tensor(3.9806e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0013, device='cuda:0')
min of d_p_list:  tensor(-0.0023, device='cuda:0')
Epoch:  85  
Training Loss: 0.04402139410376549
Test Loss:  0.05061766877770424
Test Acc:  0.0
Valid Loss:  0.04633554071187973
Valid Acc:  0.0
std:  0.00014858003418701568 
thres:  4.4230411946773536e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  8%|▊         | 85/1000 [04:00<44:19,  2.91s/it]Epoch:   86
max of grad d_p:  tensor(0.0167, device='cuda:0')
min of grad d_p:  tensor(-0.0767, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.1156, device='cuda:0') mean:  tensor(-0.0003, device='cuda:0') min:  tensor(-0.0486, device='cuda:0') norm:  tensor(1.8246, device='cuda:0') MSE:  tensor(3.4258e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0013, device='cuda:0') mean:  tensor(9.5526e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0173, device='cuda:0') MSE:  tensor(3.2409e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0007, device='cuda:0')
min of d_p_list:  tensor(-0.0016, device='cuda:0')
Epoch:  86  
Training Loss: 0.04386884719133377
Test Loss:  0.050440095365047455
Test Acc:  0.0
Valid Loss:  0.04617860168218613
Valid Acc:  0.0
std:  0.00015813102217965765 
thres:  4.411408752202988e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  9%|▊         | 86/1000 [04:03<44:13,  2.90s/it]Epoch:   87
max of grad d_p:  tensor(0.0167, device='cuda:0')
min of grad d_p:  tensor(-0.0766, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.1291, device='cuda:0') mean:  tensor(-0.0003, device='cuda:0') min:  tensor(-0.0536, device='cuda:0') norm:  tensor(2.0029, device='cuda:0') MSE:  tensor(3.7605e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0010, device='cuda:0') mean:  tensor(7.6083e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0137, device='cuda:0') MSE:  tensor(2.5648e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0003, device='cuda:0')
min of d_p_list:  tensor(-0.0013, device='cuda:0')
Epoch:  87  
Training Loss: 0.04374537616968155
Test Loss:  0.0502941720187664
Test Acc:  0.0
Valid Loss:  0.046048179268836975
Valid Acc:  0.0
std:  0.00017088986716200417 
thres:  4.3997167795896534e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  9%|▊         | 87/1000 [04:06<42:37,  2.80s/it]Epoch:   88
max of grad d_p:  tensor(0.0167, device='cuda:0')
min of grad d_p:  tensor(-0.0764, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.1352, device='cuda:0') mean:  tensor(-0.0003, device='cuda:0') min:  tensor(-0.0560, device='cuda:0') norm:  tensor(2.0834, device='cuda:0') MSE:  tensor(3.9116e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0016, device='cuda:0') mean:  tensor(1.4927e-05, device='cuda:0') min:  tensor(6.5370e-13, device='cuda:0') norm:  tensor(0.0270, device='cuda:0') MSE:  tensor(5.0782e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0007, device='cuda:0')
min of d_p_list:  tensor(-0.0016, device='cuda:0')
Epoch:  88  
Training Loss: 0.04362967982888222
Test Loss:  0.05016074329614639
Test Acc:  0.0
Valid Loss:  0.04592747986316681
Valid Acc:  0.0
std:  0.0001840431316833146 
thres:  4.388139247894287e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  9%|▉         | 88/1000 [04:09<43:06,  2.84s/it]Epoch:   89
max of grad d_p:  tensor(0.0167, device='cuda:0')
min of grad d_p:  tensor(-0.0762, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.1337, device='cuda:0') mean:  tensor(-0.0003, device='cuda:0') min:  tensor(-0.0552, device='cuda:0') norm:  tensor(2.0529, device='cuda:0') MSE:  tensor(3.8543e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0014, device='cuda:0') mean:  tensor(1.4922e-05, device='cuda:0') min:  tensor(1.9327e-12, device='cuda:0') norm:  tensor(0.0266, device='cuda:0') MSE:  tensor(4.9991e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0004, device='cuda:0')
min of d_p_list:  tensor(-0.0017, device='cuda:0')
Epoch:  89  
Training Loss: 0.04351208359003067
Test Loss:  0.050025343894958496
Test Acc:  0.0
Valid Loss:  0.045806460082530975
Valid Acc:  0.0
std:  0.00017817520220589014 
thres:  4.3755476176738736e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  9%|▉         | 89/1000 [04:11<41:37,  2.74s/it]Epoch:   90
max of grad d_p:  tensor(0.0166, device='cuda:0')
min of grad d_p:  tensor(-0.0760, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.1347, device='cuda:0') mean:  tensor(-0.0003, device='cuda:0') min:  tensor(-0.0559, device='cuda:0') norm:  tensor(2.0730, device='cuda:0') MSE:  tensor(3.8922e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0012, device='cuda:0') mean:  tensor(9.4494e-06, device='cuda:0') min:  tensor(1.5916e-12, device='cuda:0') norm:  tensor(0.0178, device='cuda:0') MSE:  tensor(3.3436e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0005, device='cuda:0')
min of d_p_list:  tensor(-0.0020, device='cuda:0')
Epoch:  90  
Training Loss: 0.04340541362762451
Test Loss:  0.04990362748503685
Test Acc:  0.0
Valid Loss:  0.045696113258600235
Valid Acc:  0.0
std:  0.00016412011966015873 
thres:  4.363228008151055e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  9%|▉         | 90/1000 [04:14<42:09,  2.78s/it]Epoch:   91
max of grad d_p:  tensor(0.0166, device='cuda:0')
min of grad d_p:  tensor(-0.0758, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.1265, device='cuda:0') mean:  tensor(-0.0003, device='cuda:0') min:  tensor(-0.0526, device='cuda:0') norm:  tensor(1.9485, device='cuda:0') MSE:  tensor(3.6584e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0044, device='cuda:0') mean:  tensor(2.4355e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0606, device='cuda:0') MSE:  tensor(1.1381e-07, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0005, device='cuda:0')
min of d_p_list:  tensor(-0.0016, device='cuda:0')
Epoch:  91  
Training Loss: 0.04329414665699005
Test Loss:  0.049771711230278015
Test Acc:  0.0
Valid Loss:  0.04557718336582184
Valid Acc:  0.0
std:  0.0001593682169563139 
thres:  4.35173399746418e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  9%|▉         | 91/1000 [04:17<42:37,  2.81s/it]Epoch:   92
max of grad d_p:  tensor(0.0165, device='cuda:0')
min of grad d_p:  tensor(-0.0757, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.1219, device='cuda:0') mean:  tensor(-0.0003, device='cuda:0') min:  tensor(-0.0495, device='cuda:0') norm:  tensor(1.8430, device='cuda:0') MSE:  tensor(3.4603e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0010, device='cuda:0') mean:  tensor(7.5944e-06, device='cuda:0') min:  tensor(5.0022e-12, device='cuda:0') norm:  tensor(0.0139, device='cuda:0') MSE:  tensor(2.6095e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0005, device='cuda:0')
min of d_p_list:  tensor(-0.0016, device='cuda:0')
Epoch:  92  
Training Loss: 0.04317522421479225
Test Loss:  0.049632832407951355
Test Acc:  0.0
Valid Loss:  0.045453399419784546
Valid Acc:  0.0
std:  0.00015938580829897217 
thres:  4.340330958366394e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  9%|▉         | 92/1000 [04:20<43:36,  2.88s/it]Epoch:   93
max of grad d_p:  tensor(0.0165, device='cuda:0')
min of grad d_p:  tensor(-0.0755, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.1268, device='cuda:0') mean:  tensor(-0.0003, device='cuda:0') min:  tensor(-0.0532, device='cuda:0') norm:  tensor(1.9738, device='cuda:0') MSE:  tensor(3.7059e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0031, device='cuda:0') mean:  tensor(1.9276e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0434, device='cuda:0') MSE:  tensor(8.1467e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0004, device='cuda:0')
min of d_p_list:  tensor(-0.0016, device='cuda:0')
Epoch:  93  
Training Loss: 0.043046608567237854
Test Loss:  0.049479927867650986
Test Acc:  0.0
Valid Loss:  0.04531850665807724
Valid Acc:  0.0
std:  0.00016432704427676772 
thres:  4.328669533133507e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  9%|▉         | 93/1000 [04:23<43:19,  2.87s/it]Epoch:   94
max of grad d_p:  tensor(0.0165, device='cuda:0')
min of grad d_p:  tensor(-0.0753, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.1324, device='cuda:0') mean:  tensor(-0.0003, device='cuda:0') min:  tensor(-0.0533, device='cuda:0') norm:  tensor(1.9822, device='cuda:0') MSE:  tensor(3.7216e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0019, device='cuda:0') mean:  tensor(1.5161e-05, device='cuda:0') min:  tensor(4.5475e-13, device='cuda:0') norm:  tensor(0.0338, device='cuda:0') MSE:  tensor(6.3426e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0007, device='cuda:0')
min of d_p_list:  tensor(-0.0017, device='cuda:0')
Epoch:  94  
Training Loss: 0.042921412736177444
Test Loss:  0.04933172091841698
Test Acc:  0.0
Valid Loss:  0.04518812894821167
Valid Acc:  0.0
std:  0.00017197091792079642 
thres:  4.3168561160564425e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
  9%|▉         | 94/1000 [04:26<44:06,  2.92s/it]Epoch:   95
max of grad d_p:  tensor(0.0164, device='cuda:0')
min of grad d_p:  tensor(-0.0751, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.1374, device='cuda:0') mean:  tensor(-0.0003, device='cuda:0') min:  tensor(-0.0549, device='cuda:0') norm:  tensor(2.0406, device='cuda:0') MSE:  tensor(3.8313e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0011, device='cuda:0') mean:  tensor(9.4037e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0165, device='cuda:0') MSE:  tensor(3.0900e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0007, device='cuda:0')
min of d_p_list:  tensor(-0.0024, device='cuda:0')
Epoch:  95  
Training Loss: 0.042767539620399475
Test Loss:  0.049153197556734085
Test Acc:  0.0
Valid Loss:  0.0450296625494957
Valid Acc:  0.0
std:  0.00018504730084913817 
thres:  4.304098635911942e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
 10%|▉         | 95/1000 [04:29<43:44,  2.90s/it]Epoch:   96
max of grad d_p:  tensor(0.0167, device='cuda:0')
min of grad d_p:  tensor(-0.0751, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.1256, device='cuda:0') mean:  tensor(-0.0003, device='cuda:0') min:  tensor(-0.0498, device='cuda:0') norm:  tensor(1.8280, device='cuda:0') MSE:  tensor(3.4323e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0012, device='cuda:0') mean:  tensor(1.0239e-05, device='cuda:0') min:  tensor(6.2528e-13, device='cuda:0') norm:  tensor(0.0178, device='cuda:0') MSE:  tensor(3.3431e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0008, device='cuda:0')
min of d_p_list:  tensor(-0.0019, device='cuda:0')
Epoch:  96  
Training Loss: 0.04263955354690552
Test Loss:  0.04900767654180527
Test Acc:  0.0
Valid Loss:  0.04489893466234207
Valid Acc:  0.0
std:  0.00019108754857799506 
thres:  4.291006773710251e-05
Preserved_eigens number check:  512
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0.0100, device='cuda:0')
eigenvalues preserved:  512
 10%|▉         | 96/1000 [04:31<41:56,  2.78s/it]