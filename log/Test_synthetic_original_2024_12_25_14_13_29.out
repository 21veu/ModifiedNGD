/nishome/yui/ModifiedNGD/utils/readData.py:18: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  return torch.tensor(x, dtype=torch.float32), torch.tensor(y, dtype=torch.float32)
Train info: 
 train data shape: torch.Size([512, 1]), 
 train lable shape: torch.Size([512, 1]), 
 positive / negative: 0.014509063214063644 / 0.9854909181594849, 
 discrepancy norm error: 8.21854019165039
Test info: 
 test data shape: torch.Size([256, 1]), 
 test lable shape: torch.Size([256, 1]), , 
 positive / negative: -0.04019593074917793 / 1.0401959419250488, 
 discrepancy norm error: 5.910345554351807
Valid info: 
 valid data shape: torch.Size([256, 1]), valid lable shape: torch.Size([256, 1]), 
 positive / negative: 0.04114104062318802 / 0.9588589668273926, 
 discrepancy norm error: 5.461434364318848
torch.Size([512, 1]) torch.Size([512])
seed is  2191
---------------------------------------- NGD ----------------------------------------
<bound method Module.modules of Sequential(
  (0): Linear(in_features=1, out_features=512, bias=True)
  (1): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (2): ReLU()
  (3): Linear(in_features=512, out_features=512, bias=True)
  (4): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (5): ReLU()
  (6): Linear(in_features=512, out_features=512, bias=True)
  (7): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (8): ReLU()
  (9): Linear(in_features=512, out_features=512, bias=True)
  (10): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (11): ReLU()
  (12): Linear(in_features=512, out_features=1, bias=True)
)>
Learning rate is:  0.5
  0%|          | 0/1000 [00:00<?, ?it/s]/nishome/yui/anaconda3/envs/ng/lib/python3.12/site-packages/torch/autograd/graph.py:744: UserWarning: Using backward() with create_graph=True will create a reference cycle between the parameter and its gradient which can cause a memory leak. We recommend using autograd.grad when creating the graph to avoid this. If you have to use this function, make sure to reset the .grad fields of your parameters to None after use to break the cycle and avoid the leak. (Triggered internally at /opt/conda/conda-bld/pytorch_1716905971214/work/torch/csrc/autograd/engine.cpp:1203.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
Epoch:   1
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.5201, device='cuda:0') 
Std:  tensor(37.1448, device='cuda:0') 
ABS Max:  tensor(570.4353, device='cuda:0') 
ABS Min:  tensor(0.0011, device='cuda:0')
Criterion check:  tensor([1.0012, 1.0003, 1.0000, 0.9985, 1.0004, 0.9998, 1.0016, 1.0089, 0.9992,
        0.9977], device='cuda:0') tensor(223, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0024, device='cuda:0')
eigenvalues preserved:  512
Test train Loss:  0.25982871651649475
Test train Acc:  0.0
Test Loss:  0.26468369364738464
Test Acc:  0.0
Valid Loss:  0.232069194316864
Valid Acc:  0.0
max of grad d_p:  tensor(4.7787, device='cuda:0')
min of grad d_p:  tensor(-0.3868, device='cuda:0')
max|min: (J_L, Jta/N)  (4.778709411621094, 4.7787394523620605, ratio: 1.0000063180923462)|(-0.3867913782596588, -0.3867897093296051)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.8030e-05, device='cuda:0') mean:  tensor(-2.4766e-09, device='cuda:0') min:  tensor(-3.0041e-05, device='cuda:0') norm:  tensor(0.0003, device='cuda:0') MSE:  tensor(3.8010e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0043, device='cuda:0') mean:  tensor(2.4455e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0493, device='cuda:0') MSE:  tensor(6.2138e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0067, device='cuda:0')
min of d_p_list:  tensor(-0.0192, device='cuda:0')
Epoch:  1  
Training Loss: 0.2624054591287859
Test Loss:  0.26566582918167114
Test Acc:  0.0
Valid Loss:  0.23512423038482666
Valid Acc:  0.0
local minima detector shape:  (0,)
Preserved_eigens number check:  512
  0%|          | 1/1000 [00:54<15:02:27, 54.20s/it]Epoch:   2
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(0.6509, device='cuda:0') 
Std:  tensor(11.5731, device='cuda:0') 
ABS Max:  tensor(149.6562, device='cuda:0') 
ABS Min:  tensor(0.0006, device='cuda:0')
Criterion check:  tensor([1.0000, 0.9999, 0.9995, 0.9998, 1.0001, 1.0001, 1.0000, 1.0004, 1.0009,
        1.0003], device='cuda:0') tensor(269, device='cuda:0')
max of Lambda2 tensor(471037.2188, device='cuda:0')
min of Lambda2 tensor(0.0003, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.5532, device='cuda:0')
min of grad d_p:  tensor(-0.2307, device='cuda:0')
max|min: (J_L, Jta/N)  (0.5532114505767822, 0.5532258749008179, ratio: 1.0000261068344116)|(-0.23071545362472534, -0.2307150959968567)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.7900e-06, device='cuda:0') mean:  tensor(3.0494e-10, device='cuda:0') min:  tensor(-1.4424e-05, device='cuda:0') norm:  tensor(3.5161e-05, device='cuda:0') MSE:  tensor(4.4305e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(1.2593e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0189, device='cuda:0') MSE:  tensor(2.3805e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0109, device='cuda:0')
min of d_p_list:  tensor(-0.0039, device='cuda:0')
Epoch:  2  
Training Loss: 0.2649890184402466
Test Loss:  0.26771509647369385
Test Acc:  0.0
Valid Loss:  0.2387404441833496
Valid Acc:  0.0
local minima detector shape:  (1,)
Preserved_eigens number check:  512
  0%|          | 2/1000 [01:32<12:27:15, 44.92s/it]Epoch:   3
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.5833, device='cuda:0') 
Std:  tensor(75.6989, device='cuda:0') 
ABS Max:  tensor(1423.1677, device='cuda:0') 
ABS Min:  tensor(0.0026, device='cuda:0')
Criterion check:  tensor([0.9994, 1.0033, 1.0117, 1.0008, 1.0046, 1.0007, 0.9914, 0.9975, 0.9978,
        0.9973], device='cuda:0') tensor(265, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0006, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2530, device='cuda:0')
min of grad d_p:  tensor(-0.2622, device='cuda:0')
max|min: (J_L, Jta/N)  (0.2529618442058563, 0.25295668840408325, ratio: 0.9999796152114868)|(-0.2622211277484894, -0.26221954822540283)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.3942e-06, device='cuda:0') mean:  tensor(4.7314e-10, device='cuda:0') min:  tensor(-2.3711e-06, device='cuda:0') norm:  tensor(9.7772e-05, device='cuda:0') MSE:  tensor(1.2320e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(8.5665e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0133, device='cuda:0') MSE:  tensor(1.6736e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0174, device='cuda:0')
min of d_p_list:  tensor(-0.0156, device='cuda:0')
Epoch:  3  
Training Loss: 0.2614731192588806
Test Loss:  0.26417237520217896
Test Acc:  0.0
Valid Loss:  0.23573437333106995
Valid Acc:  0.0
local minima detector shape:  (2,)
Preserved_eigens number check:  512
  0%|          | 3/1000 [01:52<9:13:39, 33.32s/it] Epoch:   4
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  509
Criterion check: 
Mean:  tensor(-18.2290, device='cuda:0') 
Std:  tensor(522.2902, device='cuda:0') 
ABS Max:  tensor(11328.6885, device='cuda:0') 
ABS Min:  tensor(0.0240, device='cuda:0')
Criterion check:  tensor([0.9996, 1.0001, 0.9990, 1.0016, 1.0013, 1.0008, 1.0016, 0.9980, 0.9998,
        1.0043], device='cuda:0') tensor(289, device='cuda:0')
max of Lambda2 tensor(284218.8438, device='cuda:0')
min of Lambda2 tensor(1.8048e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.4151, device='cuda:0')
min of grad d_p:  tensor(-0.2555, device='cuda:0')
max|min: (J_L, Jta/N)  (0.415114164352417, 0.41511407494544983, ratio: 0.9999997615814209)|(-0.2554926872253418, -0.2554924786090851)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.1548e-06, device='cuda:0') mean:  tensor(-1.4353e-10, device='cuda:0') min:  tensor(-3.2876e-06, device='cuda:0') norm:  tensor(2.1375e-05, device='cuda:0') MSE:  tensor(2.6935e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0039, device='cuda:0') mean:  tensor(0.0002, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.3059, device='cuda:0') MSE:  tensor(3.8544e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0062, device='cuda:0')
min of d_p_list:  tensor(-0.0066, device='cuda:0')
Epoch:  4  
Training Loss: 0.2571706771850586
Test Loss:  0.2566608190536499
Test Acc:  0.0
Valid Loss:  0.2361803650856018
Valid Acc:  0.0
local minima detector shape:  (3,)
Preserved_eigens number check:  512
  0%|          | 4/1000 [02:17<8:21:11, 30.19s/it]Epoch:   5
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(-2.2211, device='cuda:0') 
Std:  tensor(65.7512, device='cuda:0') 
ABS Max:  tensor(812.0654, device='cuda:0') 
ABS Min:  tensor(0.0204, device='cuda:0')
Criterion check:  tensor([1.0009, 0.9548, 1.0032, 0.9992, 1.0004, 1.0033, 0.9991, 0.9968, 0.9993,
        1.0026], device='cuda:0') tensor(249, device='cuda:0')
max of Lambda2 tensor(617276.3750, device='cuda:0')
min of Lambda2 tensor(2.7332e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2429, device='cuda:0')
min of grad d_p:  tensor(-0.1549, device='cuda:0')
max|min: (J_L, Jta/N)  (0.24288925528526306, 0.2428894340991974, ratio: 1.0000007152557373)|(-0.15494805574417114, -0.15494804084300995)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.7623e-06, device='cuda:0') mean:  tensor(1.5413e-11, device='cuda:0') min:  tensor(-5.1130e-07, device='cuda:0') norm:  tensor(8.5981e-06, device='cuda:0') MSE:  tensor(1.0834e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0008, device='cuda:0') mean:  tensor(3.3233e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0504, device='cuda:0') MSE:  tensor(6.3556e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0057, device='cuda:0')
min of d_p_list:  tensor(-0.0081, device='cuda:0')
Epoch:  5  
Training Loss: 0.2410172075033188
Test Loss:  0.23949895799160004
Test Acc:  0.0
Valid Loss:  0.22404496371746063
Valid Acc:  0.0
local minima detector shape:  (4,)
Preserved_eigens number check:  512
  0%|          | 5/1000 [02:37<7:17:27, 26.38s/it]Epoch:   6
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  509
Criterion check: 
Mean:  tensor(-0.1913, device='cuda:0') 
Std:  tensor(28.9030, device='cuda:0') 
ABS Max:  tensor(299.8524, device='cuda:0') 
ABS Min:  tensor(0.0005, device='cuda:0')
Criterion check:  tensor([1.0002, 0.9992, 1.0002, 1.0002, 1.0000, 0.9974, 1.0002, 1.0000, 0.9990,
        0.9998], device='cuda:0') tensor(279, device='cuda:0')
max of Lambda2 tensor(357438.0312, device='cuda:0')
min of Lambda2 tensor(4.4155e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3140, device='cuda:0')
min of grad d_p:  tensor(-0.1993, device='cuda:0')
max|min: (J_L, Jta/N)  (0.31395572423934937, 0.31395572423934937, ratio: 1.0)|(-0.19926366209983826, -0.19926370680332184)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.0460e-07, device='cuda:0') mean:  tensor(5.4999e-11, device='cuda:0') min:  tensor(-1.0527e-06, device='cuda:0') norm:  tensor(8.4384e-06, device='cuda:0') MSE:  tensor(1.0633e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(1.2392e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0178, device='cuda:0') MSE:  tensor(2.2373e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0039, device='cuda:0')
min of d_p_list:  tensor(-0.0026, device='cuda:0')
Epoch:  6  
Training Loss: 0.22110681235790253
Test Loss:  0.218664288520813
Test Acc:  0.0
Valid Loss:  0.20828834176063538
Valid Acc:  0.0
std:  0.016245785382721263 
thres:  0.0002491513669490814
Preserved_eigens number check:  512
  1%|          | 6/1000 [02:59<6:56:52, 25.16s/it]Epoch:   7
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(-0.0906, device='cuda:0') 
Std:  tensor(10.6846, device='cuda:0') 
ABS Max:  tensor(174.7159, device='cuda:0') 
ABS Min:  tensor(0.0018, device='cuda:0')
Criterion check:  tensor([0.9998, 1.0003, 1.0000, 1.0000, 1.0000, 0.9984, 1.0001, 0.9999, 1.0001,
        0.9999], device='cuda:0') tensor(236, device='cuda:0')
max of Lambda2 tensor(374907.0312, device='cuda:0')
min of Lambda2 tensor(1.1412e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1671, device='cuda:0')
min of grad d_p:  tensor(-0.1057, device='cuda:0')
max|min: (J_L, Jta/N)  (0.16705136001110077, 0.16705141961574554, ratio: 1.0000003576278687)|(-0.10569842159748077, -0.10569848865270615)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.2282e-07, device='cuda:0') mean:  tensor(-9.9459e-11, device='cuda:0') min:  tensor(-4.8988e-07, device='cuda:0') norm:  tensor(9.5102e-06, device='cuda:0') MSE:  tensor(1.1984e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(6.8408e-05, device='cuda:0') mean:  tensor(3.3324e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0048, device='cuda:0') MSE:  tensor(6.0146e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0071, device='cuda:0')
min of d_p_list:  tensor(-0.0042, device='cuda:0')
Epoch:  7  
Training Loss: 0.19569525122642517
Test Loss:  0.1914883702993393
Test Acc:  0.0
Valid Loss:  0.1873537003993988
Valid Acc:  0.0
std:  0.024355810731605528 
thres:  0.00023529261350631716
Preserved_eigens number check:  512
  1%|          | 7/1000 [03:19<6:26:02, 23.33s/it]Epoch:   8
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  510
Criterion check: 
Mean:  tensor(1.6018, device='cuda:0') 
Std:  tensor(302.1928, device='cuda:0') 
ABS Max:  tensor(5023.2822, device='cuda:0') 
ABS Min:  tensor(0.0008, device='cuda:0')
Criterion check:  tensor([1.0007, 1.0042, 0.9983, 1.0000, 0.9999, 1.0000, 0.9994, 0.9996, 0.9977,
        1.0006], device='cuda:0') tensor(249, device='cuda:0')
max of Lambda2 tensor(218549.7812, device='cuda:0')
min of Lambda2 tensor(7.0524e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1619, device='cuda:0')
min of grad d_p:  tensor(-0.1110, device='cuda:0')
max|min: (J_L, Jta/N)  (0.16187255084514618, 0.16187255084514618, ratio: 1.0)|(-0.11100440472364426, -0.11100439727306366)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.5123e-07, device='cuda:0') mean:  tensor(-7.1801e-11, device='cuda:0') min:  tensor(-1.5263e-07, device='cuda:0') norm:  tensor(3.6908e-06, device='cuda:0') MSE:  tensor(4.6507e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(8.8732e-05, device='cuda:0') mean:  tensor(4.8745e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0070, device='cuda:0') MSE:  tensor(8.8641e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0439, device='cuda:0')
min of d_p_list:  tensor(-0.0255, device='cuda:0')
Epoch:  8  
Training Loss: 0.22552096843719482
Test Loss:  0.2214638888835907
Test Acc:  0.0
Valid Loss:  0.21927711367607117
Valid Acc:  0.0
std:  0.02057951563144672 
thres:  0.00022810218334198
Preserved_eigens number check:  512
  1%|          | 8/1000 [03:41<6:17:04, 22.81s/it]Epoch:   9
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  507
Criterion check: 
Mean:  tensor(10.0476, device='cuda:0') 
Std:  tensor(257.4784, device='cuda:0') 
ABS Max:  tensor(5277.0376, device='cuda:0') 
ABS Min:  tensor(0.0005, device='cuda:0')
Criterion check:  tensor([0.9999, 0.9987, 1.0001, 1.0002, 0.9994, 0.9999, 1.0006, 1.0001, 1.0001,
        0.9997], device='cuda:0') tensor(246, device='cuda:0')
max of Lambda2 tensor(175140.5781, device='cuda:0')
min of Lambda2 tensor(1.1328e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2091, device='cuda:0')
min of grad d_p:  tensor(-0.3217, device='cuda:0')
max|min: (J_L, Jta/N)  (0.2090880274772644, 0.20908789336681366, ratio: 0.9999993443489075)|(-0.3216896653175354, -0.32168957591056824)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.8312e-07, device='cuda:0') mean:  tensor(1.9024e-11, device='cuda:0') min:  tensor(-8.4261e-07, device='cuda:0') norm:  tensor(4.9615e-06, device='cuda:0') MSE:  tensor(6.2519e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(1.1622e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0177, device='cuda:0') MSE:  tensor(2.2343e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0200, device='cuda:0')
min of d_p_list:  tensor(-0.0237, device='cuda:0')
Epoch:  9  
Training Loss: 0.15673638880252838
Test Loss:  0.1581304371356964
Test Acc:  0.0
Valid Loss:  0.1430157721042633
Valid Acc:  0.0
std:  0.029489904569143223 
thres:  0.00020801532566547392
Preserved_eigens number check:  512
  1%|          | 9/1000 [04:01<6:01:22, 21.88s/it]Epoch:   10
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  506
Criterion check: 
Mean:  tensor(-8.6860, device='cuda:0') 
Std:  tensor(113.1344, device='cuda:0') 
ABS Max:  tensor(2313.2654, device='cuda:0') 
ABS Min:  tensor(0.0019, device='cuda:0')
Criterion check:  tensor([0.9999, 0.9997, 1.0001, 1.0000, 1.0000, 0.9998, 1.0000, 0.9998, 1.0000,
        1.0001], device='cuda:0') tensor(246, device='cuda:0')
max of Lambda2 tensor(122930.0078, device='cuda:0')
min of Lambda2 tensor(3.4770e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2649, device='cuda:0')
min of grad d_p:  tensor(-0.3137, device='cuda:0')
max|min: (J_L, Jta/N)  (0.26492011547088623, 0.26492005586624146, ratio: 0.9999997615814209)|(-0.3137158453464508, -0.3137159049510956)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.4959e-07, device='cuda:0') mean:  tensor(-5.9347e-12, device='cuda:0') min:  tensor(-1.7881e-07, device='cuda:0') norm:  tensor(2.8580e-06, device='cuda:0') MSE:  tensor(3.6013e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(6.1530e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0093, device='cuda:0') MSE:  tensor(1.1738e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0266, device='cuda:0')
min of d_p_list:  tensor(-0.0164, device='cuda:0')
Epoch:  10  
Training Loss: 0.2206675112247467
Test Loss:  0.22773776948451996
Test Acc:  0.0
Valid Loss:  0.19898974895477295
Valid Acc:  0.0
std:  0.025831778585095694 
thres:  0.00020394538640975952
Preserved_eigens number check:  512
  1%|          | 10/1000 [04:21<5:52:34, 21.37s/it]Epoch:   11
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  508
Criterion check: 
Mean:  tensor(199.6722, device='cuda:0') 
Std:  tensor(4735.3672, device='cuda:0') 
ABS Max:  tensor(107088.2812, device='cuda:0') 
ABS Min:  tensor(0.0104, device='cuda:0')
Criterion check:  tensor([0.9998, 0.9998, 1.0015, 1.0000, 0.9978, 1.0000, 1.0001, 1.0003, 0.9964,
        0.9996], device='cuda:0') tensor(253, device='cuda:0')
max of Lambda2 tensor(127840.7422, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3311, device='cuda:0')
min of grad d_p:  tensor(-0.2224, device='cuda:0')
max|min: (J_L, Jta/N)  (0.33106905221939087, 0.33106911182403564, ratio: 1.000000238418579)|(-0.2224022001028061, -0.22240225970745087)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.2957e-07, device='cuda:0') mean:  tensor(-2.8500e-11, device='cuda:0') min:  tensor(-5.3563e-07, device='cuda:0') norm:  tensor(3.2966e-06, device='cuda:0') MSE:  tensor(4.1539e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0006, device='cuda:0') mean:  tensor(2.1217e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0308, device='cuda:0') MSE:  tensor(3.8783e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0060, device='cuda:0')
min of d_p_list:  tensor(-0.0068, device='cuda:0')
Epoch:  11  
Training Loss: 0.15385431051254272
Test Loss:  0.15373346209526062
Test Acc:  0.0
Valid Loss:  0.13632166385650635
Valid Acc:  0.0
std:  0.03048417775641047 
thres:  0.00019049488604068758
Preserved_eigens number check:  512
  1%|          | 11/1000 [04:44<6:00:12, 21.85s/it]Epoch:   12
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  506
Criterion check: 
Mean:  tensor(1.5748, device='cuda:0') 
Std:  tensor(26.8290, device='cuda:0') 
ABS Max:  tensor(413.3941, device='cuda:0') 
ABS Min:  tensor(0.0012, device='cuda:0')
Criterion check:  tensor([1.0000, 0.9999, 0.9987, 1.0000, 0.9999, 1.0000, 1.0001, 1.0000, 1.0008,
        1.0004], device='cuda:0') tensor(217, device='cuda:0')
max of Lambda2 tensor(124378.2031, device='cuda:0')
min of Lambda2 tensor(1.3332e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1904, device='cuda:0')
min of grad d_p:  tensor(-0.1490, device='cuda:0')
max|min: (J_L, Jta/N)  (0.19037571549415588, 0.1903756856918335, ratio: 0.9999998211860657)|(-0.14899323880672455, -0.14899322390556335)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.8879e-06, device='cuda:0') mean:  tensor(5.5128e-10, device='cuda:0') min:  tensor(-9.4797e-06, device='cuda:0') norm:  tensor(8.6056e-05, device='cuda:0') MSE:  tensor(1.0844e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(6.6996e-05, device='cuda:0') mean:  tensor(1.9634e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0030, device='cuda:0') MSE:  tensor(3.7333e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0203, device='cuda:0')
min of d_p_list:  tensor(-0.0178, device='cuda:0')
Epoch:  12  
Training Loss: 0.20093339681625366
Test Loss:  0.21783243119716644
Test Acc:  0.0
Valid Loss:  0.19073814153671265
Valid Acc:  0.0
std:  0.030733878839888356 
thres:  0.00019154251515865326
Preserved_eigens number check:  512
  1%|          | 12/1000 [05:06<6:02:50, 22.04s/it]Epoch:   13
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  505
Criterion check: 
Mean:  tensor(-1.5234, device='cuda:0') 
Std:  tensor(52.6631, device='cuda:0') 
ABS Max:  tensor(993.3846, device='cuda:0') 
ABS Min:  tensor(0.0010, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 0.9981, 1.0000, 0.9999, 1.0000, 1.0000, 1.0000, 1.0001,
        1.0000], device='cuda:0') tensor(239, device='cuda:0')
max of Lambda2 tensor(94104.2109, device='cuda:0')
min of Lambda2 tensor(1.0747e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1430, device='cuda:0')
min of grad d_p:  tensor(-0.2236, device='cuda:0')
max|min: (J_L, Jta/N)  (0.14302322268486023, 0.1430232971906662, ratio: 1.0000004768371582)|(-0.22361141443252563, -0.22361142933368683)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.3411e-07, device='cuda:0') mean:  tensor(9.2323e-12, device='cuda:0') min:  tensor(-1.6135e-07, device='cuda:0') norm:  tensor(1.8343e-06, device='cuda:0') MSE:  tensor(2.3114e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(4.1172e-05, device='cuda:0') mean:  tensor(1.8167e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0027, device='cuda:0') MSE:  tensor(3.3428e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0112, device='cuda:0')
min of d_p_list:  tensor(-0.0075, device='cuda:0')
Epoch:  13  
Training Loss: 0.13068822026252747
Test Loss:  0.1357485055923462
Test Acc:  0.0
Valid Loss:  0.11477752029895782
Valid Acc:  0.0
std:  0.033084487112709844 
thres:  0.0001725759655237198
Preserved_eigens number check:  512
  1%|▏         | 13/1000 [05:26<5:52:16, 21.41s/it]Epoch:   14
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  504
Criterion check: 
Mean:  tensor(-6.3302, device='cuda:0') 
Std:  tensor(256.8284, device='cuda:0') 
ABS Max:  tensor(5341.8975, device='cuda:0') 
ABS Min:  tensor(0.0010, device='cuda:0')
Criterion check:  tensor([1.0001, 1.0002, 1.0004, 1.0000, 1.0028, 0.9999, 0.9995, 1.0000, 0.9997,
        0.9988], device='cuda:0') tensor(243, device='cuda:0')
max of Lambda2 tensor(92190.2891, device='cuda:0')
min of Lambda2 tensor(9.8426e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1629, device='cuda:0')
min of grad d_p:  tensor(-0.1768, device='cuda:0')
max|min: (J_L, Jta/N)  (0.1629239022731781, 0.16292400658130646, ratio: 1.0000005960464478)|(-0.17675894498825073, -0.17675891518592834)

 check Jacobi res:  torch.Size([793601]) max:  tensor(9.9652e-08, device='cuda:0') mean:  tensor(-2.0521e-11, device='cuda:0') min:  tensor(-1.9034e-07, device='cuda:0') norm:  tensor(1.6168e-06, device='cuda:0') MSE:  tensor(2.0373e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(1.0060e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0146, device='cuda:0') MSE:  tensor(1.8372e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0098, device='cuda:0')
min of d_p_list:  tensor(-0.0095, device='cuda:0')
Epoch:  14  
Training Loss: 0.10852229595184326
Test Loss:  0.11614009737968445
Test Acc:  0.0
Valid Loss:  0.0927824005484581
Valid Acc:  0.0
std:  0.0420950759177105 
thres:  0.00016293314695358277
Preserved_eigens number check:  512
  1%|▏         | 14/1000 [05:50<6:01:54, 22.02s/it]Epoch:   15
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  504
Criterion check: 
Mean:  tensor(4.8966, device='cuda:0') 
Std:  tensor(45.2799, device='cuda:0') 
ABS Max:  tensor(516.0804, device='cuda:0') 
ABS Min:  tensor(0.0020, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0001, 1.0009, 1.0002, 0.9997, 1.0000, 1.0010, 0.9999, 1.0003,
        1.0000], device='cuda:0') tensor(232, device='cuda:0')
max of Lambda2 tensor(94568.6797, device='cuda:0')
min of Lambda2 tensor(1.5761e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1363, device='cuda:0')
min of grad d_p:  tensor(-0.1650, device='cuda:0')
max|min: (J_L, Jta/N)  (0.13625067472457886, 0.13625070452690125, ratio: 1.000000238418579)|(-0.16500528156757355, -0.16500528156757355)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.4697e-07, device='cuda:0') mean:  tensor(1.5690e-11, device='cuda:0') min:  tensor(-9.3132e-08, device='cuda:0') norm:  tensor(1.5079e-06, device='cuda:0') MSE:  tensor(1.9001e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(5.4176e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0079, device='cuda:0') MSE:  tensor(9.9410e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0209, device='cuda:0')
min of d_p_list:  tensor(-0.0254, device='cuda:0')
Epoch:  15  
Training Loss: 0.2333696335554123
Test Loss:  0.2500154972076416
Test Acc:  0.0
Valid Loss:  0.2200777232646942
Valid Acc:  0.0
std:  0.045729093862141364 
thres:  0.0001654735714197159
Preserved_eigens number check:  512
  2%|▏         | 15/1000 [06:07<5:40:00, 20.71s/it]Epoch:   16
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  503
Criterion check: 
Mean:  tensor(10.8410, device='cuda:0') 
Std:  tensor(116.0084, device='cuda:0') 
ABS Max:  tensor(2211.8376, device='cuda:0') 
ABS Min:  tensor(0.0063, device='cuda:0')
Criterion check:  tensor([1.0001, 0.9999, 1.0000, 1.0001, 0.9997, 1.0000, 1.0001, 0.9998, 1.0000,
        0.9985], device='cuda:0') tensor(247, device='cuda:0')
max of Lambda2 tensor(91653.5391, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3211, device='cuda:0')
min of grad d_p:  tensor(-0.2563, device='cuda:0')
max|min: (J_L, Jta/N)  (0.3211356997489929, 0.32113561034202576, ratio: 0.9999997019767761)|(-0.25629720091819763, -0.2562970817089081)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.7253e-07, device='cuda:0') mean:  tensor(-2.0661e-11, device='cuda:0') min:  tensor(-8.5402e-07, device='cuda:0') norm:  tensor(2.7751e-06, device='cuda:0') MSE:  tensor(3.4969e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(6.0058e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0091, device='cuda:0') MSE:  tensor(1.1417e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0417, device='cuda:0')
min of d_p_list:  tensor(-0.0307, device='cuda:0')
Epoch:  16  
Training Loss: 0.3996228575706482
Test Loss:  0.4527297616004944
Test Acc:  0.0
Valid Loss:  0.4119586646556854
Valid Acc:  0.0
std:  0.1030205759677303 
thres:  0.00021462728083133698
Preserved_eigens number check:  512
  2%|▏         | 16/1000 [06:24<5:22:22, 19.66s/it]Epoch:   17
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  505
Criterion check: 
Mean:  tensor(5.9139, device='cuda:0') 
Std:  tensor(107.4660, device='cuda:0') 
ABS Max:  tensor(2164.4521, device='cuda:0') 
ABS Min:  tensor(0.0026, device='cuda:0')
Criterion check:  tensor([1.0004, 0.9996, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0001,
        1.0006], device='cuda:0') tensor(250, device='cuda:0')
max of Lambda2 tensor(77890.3984, device='cuda:0')
min of Lambda2 tensor(2.1595e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1971, device='cuda:0')
min of grad d_p:  tensor(-0.2027, device='cuda:0')
max|min: (J_L, Jta/N)  (0.19711846113204956, 0.19711849093437195, ratio: 1.0000001192092896)|(-0.20266559720039368, -0.20266561210155487)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.2365e-07, device='cuda:0') mean:  tensor(-1.6207e-11, device='cuda:0') min:  tensor(-1.3411e-07, device='cuda:0') norm:  tensor(1.4086e-06, device='cuda:0') MSE:  tensor(1.7749e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(4.9461e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0074, device='cuda:0') MSE:  tensor(9.2672e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0254, device='cuda:0')
min of d_p_list:  tensor(-0.0285, device='cuda:0')
Epoch:  17  
Training Loss: 0.29573893547058105
Test Loss:  0.3243635296821594
Test Acc:  0.0
Valid Loss:  0.2739347219467163
Valid Acc:  0.0
std:  0.10738729477047503 
thres:  0.00023358838856220247
Preserved_eigens number check:  512
  2%|▏         | 17/1000 [06:42<5:13:22, 19.13s/it]Epoch:   18
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  504
Criterion check: 
Mean:  tensor(0.5494, device='cuda:0') 
Std:  tensor(104.8664, device='cuda:0') 
ABS Max:  tensor(2047.4675, device='cuda:0') 
ABS Min:  tensor(0.0022, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 0.9998, 1.0001, 0.9999, 1.0000, 1.0000, 1.0000, 1.0003,
        1.0000], device='cuda:0') tensor(231, device='cuda:0')
max of Lambda2 tensor(88135.8984, device='cuda:0')
min of Lambda2 tensor(1.3681e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2262, device='cuda:0')
min of grad d_p:  tensor(-0.2809, device='cuda:0')
max|min: (J_L, Jta/N)  (0.2261766940355301, 0.2261766493320465, ratio: 0.9999998211860657)|(-0.28086644411087036, -0.280866414308548)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.4273e-07, device='cuda:0') mean:  tensor(-1.1825e-11, device='cuda:0') min:  tensor(-3.0175e-07, device='cuda:0') norm:  tensor(1.8909e-06, device='cuda:0') MSE:  tensor(2.3826e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(9.3626e-05, device='cuda:0') mean:  tensor(3.3420e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0049, device='cuda:0') MSE:  tensor(6.1742e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0600, device='cuda:0')
min of d_p_list:  tensor(-0.0578, device='cuda:0')
Epoch:  18  
Training Loss: 1.1567156314849854
Test Loss:  1.2660675048828125
Test Acc:  0.0
Valid Loss:  1.0697656869888306
Valid Acc:  0.0
std:  0.37113048046872943 
thres:  0.00043879387080669404
Preserved_eigens number check:  512
  2%|▏         | 18/1000 [06:59<5:03:16, 18.53s/it]Epoch:   19
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  496
Criterion check: 
Mean:  tensor(7.3357, device='cuda:0') 
Std:  tensor(94.5937, device='cuda:0') 
ABS Max:  tensor(1748.5559, device='cuda:0') 
ABS Min:  tensor(0.0008, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0001, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 0.9980,
        0.9999], device='cuda:0') tensor(181, device='cuda:0')
max of Lambda2 tensor(64024.5586, device='cuda:0')
min of Lambda2 tensor(5.0864e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3339, device='cuda:0')
min of grad d_p:  tensor(-0.3578, device='cuda:0')
max|min: (J_L, Jta/N)  (0.3338620066642761, 0.3338621258735657, ratio: 1.0000003576278687)|(-0.3578312397003174, -0.3578312397003174)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.4529e-07, device='cuda:0') mean:  tensor(-1.2317e-11, device='cuda:0') min:  tensor(-3.3365e-07, device='cuda:0') norm:  tensor(2.2416e-06, device='cuda:0') MSE:  tensor(2.8246e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(5.5343e-05, device='cuda:0') mean:  tensor(2.0213e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0032, device='cuda:0') MSE:  tensor(4.0932e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0171, device='cuda:0')
min of d_p_list:  tensor(-0.0214, device='cuda:0')
Epoch:  19  
Training Loss: 0.37918055057525635
Test Loss:  0.41409677267074585
Test Acc:  0.0
Valid Loss:  0.3463144302368164
Valid Acc:  0.0
std:  0.3371979905923237 
thres:  0.0004929255217313767
Preserved_eigens number check:  512
  2%|▏         | 19/1000 [07:17<4:58:29, 18.26s/it]Epoch:   20
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  497
Criterion check: 
Mean:  tensor(-3.1202, device='cuda:0') 
Std:  tensor(155.6482, device='cuda:0') 
ABS Max:  tensor(1874.9075, device='cuda:0') 
ABS Min:  tensor(0.0014, device='cuda:0')
Criterion check:  tensor([0.9998, 1.0000, 0.9982, 1.0000, 1.0000, 0.9999, 0.9997, 1.0003, 0.9992,
        0.9994], device='cuda:0') tensor(246, device='cuda:0')
max of Lambda2 tensor(63772.7266, device='cuda:0')
min of Lambda2 tensor(7.4777e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1706, device='cuda:0')
min of grad d_p:  tensor(-0.2320, device='cuda:0')
max|min: (J_L, Jta/N)  (0.17062076926231384, 0.17062078416347504, ratio: 1.0000001192092896)|(-0.23197129368782043, -0.23197124898433685)

 check Jacobi res:  torch.Size([793601]) max:  tensor(7.4506e-08, device='cuda:0') mean:  tensor(-5.3247e-13, device='cuda:0') min:  tensor(-8.9407e-08, device='cuda:0') norm:  tensor(1.1089e-06, device='cuda:0') MSE:  tensor(1.3973e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0007, device='cuda:0') mean:  tensor(1.7203e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0276, device='cuda:0') MSE:  tensor(3.4728e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0216, device='cuda:0')
min of d_p_list:  tensor(-0.0243, device='cuda:0')
Epoch:  20  
Training Loss: 0.1697499006986618
Test Loss:  0.1797058880329132
Test Acc:  0.0
Valid Loss:  0.1530303955078125
Valid Acc:  0.0
std:  0.3477861852227079 
thres:  0.00048020157516002657
Preserved_eigens number check:  512
  2%|▏         | 20/1000 [07:35<4:54:37, 18.04s/it]Epoch:   21
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  496
Criterion check: 
Mean:  tensor(4.7169, device='cuda:0') 
Std:  tensor(102.5575, device='cuda:0') 
ABS Max:  tensor(2227.3542, device='cuda:0') 
ABS Min:  tensor(0.0009, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0011, 1.0000, 1.0000, 1.0001, 1.0001, 1.0003, 1.0009,
        1.0010], device='cuda:0') tensor(209, device='cuda:0')
max of Lambda2 tensor(63888.2461, device='cuda:0')
min of Lambda2 tensor(7.1015e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1612, device='cuda:0')
min of grad d_p:  tensor(-0.2136, device='cuda:0')
max|min: (J_L, Jta/N)  (0.16117355227470398, 0.16117355227470398, ratio: 1.0)|(-0.21359646320343018, -0.21359652280807495)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.0431e-07, device='cuda:0') mean:  tensor(-6.4791e-13, device='cuda:0') min:  tensor(-1.1921e-07, device='cuda:0') norm:  tensor(1.1225e-06, device='cuda:0') MSE:  tensor(1.4144e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(7.9967e-05, device='cuda:0') mean:  tensor(2.7348e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0041, device='cuda:0') MSE:  tensor(5.2132e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0116, device='cuda:0')
min of d_p_list:  tensor(-0.0137, device='cuda:0')
Epoch:  21  
Training Loss: 0.09546086192131042
Test Loss:  0.09444640576839447
Test Acc:  0.0
Valid Loss:  0.08871660381555557
Valid Acc:  0.0
std:  0.3815247661514068 
thres:  0.000419369176030159
Preserved_eigens number check:  512
  2%|▏         | 21/1000 [07:53<4:54:13, 18.03s/it]Epoch:   22
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  499
Criterion check: 
Mean:  tensor(8.3185, device='cuda:0') 
Std:  tensor(116.6539, device='cuda:0') 
ABS Max:  tensor(2262.9390, device='cuda:0') 
ABS Min:  tensor(0.0022, device='cuda:0')
Criterion check:  tensor([1.0001, 1.0001, 0.9993, 1.0000, 1.0000, 1.0000, 1.0000, 0.9999, 1.0005,
        0.9990], device='cuda:0') tensor(202, device='cuda:0')
max of Lambda2 tensor(65096.2422, device='cuda:0')
min of Lambda2 tensor(5.9305e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1166, device='cuda:0')
min of grad d_p:  tensor(-0.1141, device='cuda:0')
max|min: (J_L, Jta/N)  (0.11659218370914459, 0.11659218370914459, ratio: 1.0)|(-0.11410464346408844, -0.11410468071699142)

 check Jacobi res:  torch.Size([793601]) max:  tensor(7.4506e-08, device='cuda:0') mean:  tensor(1.6851e-12, device='cuda:0') min:  tensor(-7.4506e-08, device='cuda:0') norm:  tensor(7.0440e-07, device='cuda:0') MSE:  tensor(8.8760e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(3.6254e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0055, device='cuda:0') MSE:  tensor(6.8834e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0274, device='cuda:0')
min of d_p_list:  tensor(-0.0310, device='cuda:0')
Epoch:  22  
Training Loss: 0.09398050606250763
Test Loss:  0.09814906865358353
Test Acc:  0.0
Valid Loss:  0.09528064727783203
Valid Acc:  0.0
std:  0.40255628012229133 
thres:  0.0003790174901485443
Preserved_eigens number check:  512
  2%|▏         | 22/1000 [08:10<4:51:38, 17.89s/it]Epoch:   23
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  495
Criterion check: 
Mean:  tensor(-7.8636, device='cuda:0') 
Std:  tensor(197.4282, device='cuda:0') 
ABS Max:  tensor(4453.4526, device='cuda:0') 
ABS Min:  tensor(0.0001, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000,
        0.9999], device='cuda:0') tensor(163, device='cuda:0')
max of Lambda2 tensor(62240.3086, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1654, device='cuda:0')
min of grad d_p:  tensor(-0.1708, device='cuda:0')
max|min: (J_L, Jta/N)  (0.1654430329799652, 0.16544300317764282, ratio: 0.9999998211860657)|(-0.17080266773700714, -0.17080268263816833)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.7544e-08, device='cuda:0') mean:  tensor(-5.6507e-13, device='cuda:0') min:  tensor(-7.4506e-08, device='cuda:0') norm:  tensor(9.1760e-07, device='cuda:0') MSE:  tensor(1.1562e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(6.3777e-05, device='cuda:0') mean:  tensor(7.5246e-07, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0012, device='cuda:0') MSE:  tensor(1.4959e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0870, device='cuda:0')
min of d_p_list:  tensor(-0.1034, device='cuda:0')
Epoch:  23  
Training Loss: 1.9504694938659668
Test Loss:  2.103604316711426
Test Acc:  0.0
Valid Loss:  2.121016502380371
Valid Acc:  0.0
std:  0.7139882009487111 
thres:  0.0005377682626247406
Preserved_eigens number check:  512
  2%|▏         | 23/1000 [08:28<4:49:17, 17.77s/it]Epoch:   24
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  495
Criterion check: 
Mean:  tensor(4.2529, device='cuda:0') 
Std:  tensor(222.8860, device='cuda:0') 
ABS Max:  tensor(4687.2104, device='cuda:0') 
ABS Min:  tensor(0.0006, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0002, 1.0000, 1.0003, 1.0000, 0.9996, 1.0003, 1.0008,
        1.0033], device='cuda:0') tensor(226, device='cuda:0')
max of Lambda2 tensor(65467.5586, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.4727, device='cuda:0')
min of grad d_p:  tensor(-0.2230, device='cuda:0')
max|min: (J_L, Jta/N)  (0.4727283716201782, 0.47272831201553345, ratio: 0.9999998807907104)|(-0.22300419211387634, -0.22300416231155396)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.3842e-07, device='cuda:0') mean:  tensor(1.6178e-11, device='cuda:0') min:  tensor(-1.4901e-07, device='cuda:0') norm:  tensor(1.6596e-06, device='cuda:0') MSE:  tensor(2.0913e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(5.7353e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0087, device='cuda:0') MSE:  tensor(1.1012e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0294, device='cuda:0')
min of d_p_list:  tensor(-0.0285, device='cuda:0')
Epoch:  24  
Training Loss: 0.3473314046859741
Test Loss:  0.35864174365997314
Test Acc:  0.0
Valid Loss:  0.34873342514038086
Valid Acc:  0.0
std:  0.7155150615185693 
thres:  0.0005313984334468842
Preserved_eigens number check:  512
  2%|▏         | 24/1000 [08:45<4:47:39, 17.68s/it]Epoch:   25
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  491
Criterion check: 
Mean:  tensor(54.5200, device='cuda:0') 
Std:  tensor(940.6631, device='cuda:0') 
ABS Max:  tensor(20566.5762, device='cuda:0') 
ABS Min:  tensor(0.0006, device='cuda:0')
Criterion check:  tensor([0.9999, 0.9999, 1.0001, 1.0000, 1.0001, 1.0000, 0.9999, 1.0000, 1.0029,
        0.9999], device='cuda:0') tensor(190, device='cuda:0')
max of Lambda2 tensor(61477.8281, device='cuda:0')
min of Lambda2 tensor(3.6808e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2923, device='cuda:0')
min of grad d_p:  tensor(-0.1461, device='cuda:0')
max|min: (J_L, Jta/N)  (0.29231590032577515, 0.29231593012809753, ratio: 1.0000001192092896)|(-0.14606060087680817, -0.14606069028377533)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.6391e-07, device='cuda:0') mean:  tensor(-2.1001e-11, device='cuda:0') min:  tensor(-1.4901e-07, device='cuda:0') norm:  tensor(1.1919e-06, device='cuda:0') MSE:  tensor(1.5018e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(2.7641e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0046, device='cuda:0') MSE:  tensor(5.7473e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0149, device='cuda:0')
min of d_p_list:  tensor(-0.0156, device='cuda:0')
Epoch:  25  
Training Loss: 0.13659387826919556
Test Loss:  0.13551965355873108
Test Acc:  0.0
Valid Loss:  0.1327638328075409
Valid Acc:  0.0
std:  0.7189812414082932 
thres:  0.0005247672289609909
Preserved_eigens number check:  512
  2%|▎         | 25/1000 [09:03<4:48:10, 17.73s/it]Epoch:   26
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  495
Criterion check: 
Mean:  tensor(-0.0927, device='cuda:0') 
Std:  tensor(82.3698, device='cuda:0') 
ABS Max:  tensor(1283.3546, device='cuda:0') 
ABS Min:  tensor(0.0009, device='cuda:0')
Criterion check:  tensor([1.0000, 0.9989, 1.0003, 1.0000, 0.9947, 1.0000, 0.9993, 0.9999, 1.0003,
        0.9992], device='cuda:0') tensor(193, device='cuda:0')
max of Lambda2 tensor(64909.4219, device='cuda:0')
min of Lambda2 tensor(1.8914e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1882, device='cuda:0')
min of grad d_p:  tensor(-0.0907, device='cuda:0')
max|min: (J_L, Jta/N)  (0.18817764520645142, 0.18817758560180664, ratio: 0.9999997019767761)|(-0.09074969589710236, -0.09074972569942474)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.1921e-07, device='cuda:0') mean:  tensor(2.5862e-12, device='cuda:0') min:  tensor(-8.9407e-08, device='cuda:0') norm:  tensor(7.8913e-07, device='cuda:0') MSE:  tensor(9.9437e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(2.7751e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0047, device='cuda:0') MSE:  tensor(5.8658e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0111, device='cuda:0')
min of d_p_list:  tensor(-0.0097, device='cuda:0')
Epoch:  26  
Training Loss: 0.07076692581176758
Test Loss:  0.07125366479158401
Test Acc:  0.0
Valid Loss:  0.06978648900985718
Valid Acc:  0.0
std:  0.7219917572753464 
thres:  0.0005198284417390824
Preserved_eigens number check:  512
  3%|▎         | 26/1000 [09:20<4:45:23, 17.58s/it]Epoch:   27
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  498
Criterion check: 
Mean:  tensor(1.6153, device='cuda:0') 
Std:  tensor(83.7847, device='cuda:0') 
ABS Max:  tensor(1621.4020, device='cuda:0') 
ABS Min:  tensor(0.0005, device='cuda:0')
Criterion check:  tensor([1.0000, 0.9999, 1.0002, 1.0000, 0.9996, 1.0001, 0.9993, 1.0001, 1.0002,
        1.0005], device='cuda:0') tensor(179, device='cuda:0')
max of Lambda2 tensor(67726.6484, device='cuda:0')
min of Lambda2 tensor(7.2958e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1032, device='cuda:0')
min of grad d_p:  tensor(-0.0591, device='cuda:0')
max|min: (J_L, Jta/N)  (0.10316595435142517, 0.10316593199968338, ratio: 0.9999997615814209)|(-0.059140726923942566, -0.059140753000974655)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.2154e-08, device='cuda:0') mean:  tensor(-1.3471e-12, device='cuda:0') min:  tensor(-4.2841e-08, device='cuda:0') norm:  tensor(5.6548e-07, device='cuda:0') MSE:  tensor(7.1255e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(1.7418e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0028, device='cuda:0') MSE:  tensor(3.5484e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0095, device='cuda:0')
min of d_p_list:  tensor(-0.0097, device='cuda:0')
Epoch:  27  
Training Loss: 0.03806393966078758
Test Loss:  0.037825778126716614
Test Acc:  0.0
Valid Loss:  0.03676796332001686
Valid Acc:  0.0
std:  0.728901327551381 
thres:  0.0005086451284587384
Preserved_eigens number check:  512
  3%|▎         | 27/1000 [09:37<4:42:29, 17.42s/it]Epoch:   28
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  497
Criterion check: 
Mean:  tensor(1451.5732, device='cuda:0') 
Std:  tensor(32301.9980, device='cuda:0') 
ABS Max:  tensor(730742.5625, device='cuda:0') 
ABS Min:  tensor(0.0073, device='cuda:0')
Criterion check:  tensor([1.0000, 0.9981, 0.9997, 0.9996, 1.0002, 1.0005, 1.0021, 0.9996, 1.0253,
        1.0084], device='cuda:0') tensor(230, device='cuda:0')
max of Lambda2 tensor(78558.0234, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0527, device='cuda:0')
min of grad d_p:  tensor(-0.0453, device='cuda:0')
max|min: (J_L, Jta/N)  (0.052686989307403564, 0.052686985582113266, ratio: 0.9999999403953552)|(-0.0453052744269371, -0.045305270701646805)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.5879e-08, device='cuda:0') mean:  tensor(6.3323e-13, device='cuda:0') min:  tensor(-2.9802e-08, device='cuda:0') norm:  tensor(4.8345e-07, device='cuda:0') MSE:  tensor(6.0918e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(7.0485e-06, device='cuda:0') min:  tensor(5.4791e-15, device='cuda:0') norm:  tensor(0.0127, device='cuda:0') MSE:  tensor(1.5997e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0086, device='cuda:0')
min of d_p_list:  tensor(-0.0072, device='cuda:0')
Epoch:  28  
Training Loss: 0.028094762936234474
Test Loss:  0.027797136455774307
Test Acc:  0.0
Valid Loss:  0.02652064710855484
Valid Acc:  0.0
std:  0.11785750585283183 
thres:  0.00012417018227279186
Preserved_eigens number check:  512
  3%|▎         | 28/1000 [09:55<4:42:59, 17.47s/it]Epoch:   29
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  497
Criterion check: 
Mean:  tensor(0.7121, device='cuda:0') 
Std:  tensor(48.8451, device='cuda:0') 
ABS Max:  tensor(947.8206, device='cuda:0') 
ABS Min:  tensor(0.0004, device='cuda:0')
Criterion check:  tensor([1.0001, 0.9999, 1.0000, 1.0000, 0.9998, 0.9999, 0.9997, 0.9999, 1.0013,
        0.9995], device='cuda:0') tensor(190, device='cuda:0')
max of Lambda2 tensor(79302.0547, device='cuda:0')
min of Lambda2 tensor(1.5760e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0390, device='cuda:0')
min of grad d_p:  tensor(-0.0368, device='cuda:0')
max|min: (J_L, Jta/N)  (0.03900676220655441, 0.03900676220655441, ratio: 1.0)|(-0.036796022206544876, -0.03679603710770607)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.2352e-08, device='cuda:0') mean:  tensor(-3.3031e-12, device='cuda:0') min:  tensor(-2.0489e-08, device='cuda:0') norm:  tensor(2.8553e-07, device='cuda:0') MSE:  tensor(3.5979e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(3.8614e-05, device='cuda:0') mean:  tensor(6.8641e-07, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0012, device='cuda:0') MSE:  tensor(1.4664e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0064, device='cuda:0')
min of d_p_list:  tensor(-0.0104, device='cuda:0')
Epoch:  29  
Training Loss: 0.017012543976306915
Test Loss:  0.017044540494680405
Test Acc:  0.0
Valid Loss:  0.014255799353122711
Valid Acc:  0.0
std:  0.04315478359922447 
thres:  5.810641013085842e-05
Preserved_eigens number check:  512
  3%|▎         | 29/1000 [10:12<4:41:29, 17.39s/it]Epoch:   30
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  497
Criterion check: 
Mean:  tensor(10.5884, device='cuda:0') 
Std:  tensor(157.0320, device='cuda:0') 
ABS Max:  tensor(3065.8926, device='cuda:0') 
ABS Min:  tensor(0.0012, device='cuda:0')
Criterion check:  tensor([1.0000, 0.9998, 1.0000, 1.0000, 0.9997, 1.0001, 0.9998, 0.9997, 1.0002,
        1.0001], device='cuda:0') tensor(193, device='cuda:0')
max of Lambda2 tensor(77657.5781, device='cuda:0')
min of Lambda2 tensor(5.3802e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0638, device='cuda:0')
min of grad d_p:  tensor(-0.0518, device='cuda:0')
max|min: (J_L, Jta/N)  (0.06381654739379883, 0.06381654739379883, ratio: 1.0)|(-0.05175621435046196, -0.05175619572401047)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.8626e-08, device='cuda:0') mean:  tensor(-2.0177e-12, device='cuda:0') min:  tensor(-5.5879e-08, device='cuda:0') norm:  tensor(4.3847e-07, device='cuda:0') MSE:  tensor(5.5251e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(1.7325e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0031, device='cuda:0') MSE:  tensor(3.9159e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0048, device='cuda:0')
min of d_p_list:  tensor(-0.0082, device='cuda:0')
Epoch:  30  
Training Loss: 0.01862221583724022
Test Loss:  0.018164275214076042
Test Acc:  0.0
Valid Loss:  0.015989750623703003
Valid Acc:  0.0
std:  0.019631266155484363 
thres:  3.451207764446736e-05
Preserved_eigens number check:  512
  3%|▎         | 30/1000 [10:30<4:45:42, 17.67s/it]Epoch:   31
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  498
Criterion check: 
Mean:  tensor(-456.9385, device='cuda:0') 
Std:  tensor(6959.7559, device='cuda:0') 
ABS Max:  tensor(144429.1094, device='cuda:0') 
ABS Min:  tensor(0.0357, device='cuda:0')
Criterion check:  tensor([1.0057, 1.0321, 0.9984, 1.0058, 1.0063, 0.9953, 0.9739, 0.9975, 0.8694,
        0.9943], device='cuda:0') tensor(268, device='cuda:0')
max of Lambda2 tensor(74203.2656, device='cuda:0')
min of Lambda2 tensor(2.0512e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0386, device='cuda:0')
min of grad d_p:  tensor(-0.0505, device='cuda:0')
max|min: (J_L, Jta/N)  (0.0385608933866024, 0.038560908287763596, ratio: 1.0000003576278687)|(-0.05050705373287201, -0.050507012754678726)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.3039e-08, device='cuda:0') mean:  tensor(-1.2135e-11, device='cuda:0') min:  tensor(-4.8429e-08, device='cuda:0') norm:  tensor(5.1869e-07, device='cuda:0') MSE:  tensor(6.5359e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0028, device='cuda:0') mean:  tensor(5.3143e-05, device='cuda:0') min:  tensor(1.6364e-13, device='cuda:0') norm:  tensor(0.0894, device='cuda:0') MSE:  tensor(1.1265e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0392, device='cuda:0')
min of d_p_list:  tensor(-0.0266, device='cuda:0')
Epoch:  31  
Training Loss: 0.12282174825668335
Test Loss:  0.12310770153999329
Test Acc:  0.0
Valid Loss:  0.11047810316085815
Valid Acc:  0.0
std:  0.03967159198818994 
thres:  4.492304213345051e-05
Preserved_eigens number check:  512
  3%|▎         | 31/1000 [10:48<4:45:36, 17.68s/it]Epoch:   32
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  496
Criterion check: 
Mean:  tensor(-583.1360, device='cuda:0') 
Std:  tensor(13110.6553, device='cuda:0') 
ABS Max:  tensor(296472.5000, device='cuda:0') 
ABS Min:  tensor(0.0027, device='cuda:0')
Criterion check:  tensor([1.0014, 1.0021, 1.0017, 0.9998, 0.9992, 0.9998, 1.0234, 1.0031, 0.9919,
        1.0170], device='cuda:0') tensor(264, device='cuda:0')
max of Lambda2 tensor(71798.2656, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1610, device='cuda:0')
min of grad d_p:  tensor(-0.1284, device='cuda:0')
max|min: (J_L, Jta/N)  (0.16104799509048462, 0.1610480695962906, ratio: 1.0000004768371582)|(-0.12835583090782166, -0.12835584580898285)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.2154e-08, device='cuda:0') mean:  tensor(9.7736e-12, device='cuda:0') min:  tensor(-1.3007e-07, device='cuda:0') norm:  tensor(6.4165e-07, device='cuda:0') MSE:  tensor(8.0853e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0015, device='cuda:0') mean:  tensor(2.7625e-05, device='cuda:0') min:  tensor(1.1249e-13, device='cuda:0') norm:  tensor(0.0472, device='cuda:0') MSE:  tensor(5.9531e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0166, device='cuda:0')
min of d_p_list:  tensor(-0.0160, device='cuda:0')
Epoch:  32  
Training Loss: 0.10345877707004547
Test Loss:  0.10017356276512146
Test Acc:  0.0
Valid Loss:  0.09553493559360504
Valid Acc:  0.0
std:  0.04559224513065186 
thres:  5.800200961530209e-05
Preserved_eigens number check:  512
  3%|▎         | 32/1000 [11:06<4:48:22, 17.87s/it]Epoch:   33
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  491
Criterion check: 
Mean:  tensor(-9.9593, device='cuda:0') 
Std:  tensor(139.4673, device='cuda:0') 
ABS Max:  tensor(2360.5974, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([0.9984, 1.0003, 0.9995, 0.9998, 1.0006, 1.0002, 0.9998, 0.9995, 1.0007,
        1.0001], device='cuda:0') tensor(196, device='cuda:0')
max of Lambda2 tensor(66429.7188, device='cuda:0')
min of Lambda2 tensor(4.3381e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1542, device='cuda:0')
min of grad d_p:  tensor(-0.1359, device='cuda:0')
max|min: (J_L, Jta/N)  (0.15424728393554688, 0.15424737334251404, ratio: 1.0000005960464478)|(-0.13585501909255981, -0.135855033993721)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.0938e-08, device='cuda:0') mean:  tensor(-3.0974e-12, device='cuda:0') min:  tensor(-8.9407e-08, device='cuda:0') norm:  tensor(8.2641e-07, device='cuda:0') MSE:  tensor(1.0413e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(7.1321e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0122, device='cuda:0') MSE:  tensor(1.5317e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1123, device='cuda:0')
min of d_p_list:  tensor(-0.0918, device='cuda:0')
Epoch:  33  
Training Loss: 1.692036509513855
Test Loss:  1.8031222820281982
Test Acc:  0.0
Valid Loss:  1.6297602653503418
Valid Acc:  0.0
std:  0.6520471057115892 
thres:  0.0003907903589308262
Preserved_eigens number check:  512
  3%|▎         | 33/1000 [11:24<4:48:07, 17.88s/it]Epoch:   34
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  490
Criterion check: 
Mean:  tensor(50.4565, device='cuda:0') 
Std:  tensor(1142.3298, device='cuda:0') 
ABS Max:  tensor(20450.0820, device='cuda:0') 
ABS Min:  tensor(0.0033, device='cuda:0')
Criterion check:  tensor([0.9984, 1.0008, 1.0006, 1.0007, 1.0000, 0.9993, 0.9972, 0.9858, 0.9846,
        0.9945], device='cuda:0') tensor(246, device='cuda:0')
max of Lambda2 tensor(60640.4219, device='cuda:0')
min of Lambda2 tensor(3.5406e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2043, device='cuda:0')
min of grad d_p:  tensor(-0.3276, device='cuda:0')
max|min: (J_L, Jta/N)  (0.20425957441329956, 0.20425957441329956, ratio: 1.0)|(-0.327579140663147, -0.3275792896747589)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.4901e-07, device='cuda:0') mean:  tensor(-4.1683e-14, device='cuda:0') min:  tensor(-1.4901e-07, device='cuda:0') norm:  tensor(1.2923e-06, device='cuda:0') MSE:  tensor(1.6284e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0029, device='cuda:0') mean:  tensor(5.9711e-05, device='cuda:0') min:  tensor(3.2187e-14, device='cuda:0') norm:  tensor(0.0992, device='cuda:0') MSE:  tensor(1.2503e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0234, device='cuda:0')
min of d_p_list:  tensor(-0.0186, device='cuda:0')
Epoch:  34  
Training Loss: 0.21214982867240906
Test Loss:  0.2224208116531372
Test Acc:  0.0
Valid Loss:  0.1787831336259842
Valid Acc:  0.0
std:  0.6340999940793915 
thres:  0.00042981781587004663
Preserved_eigens number check:  512
  3%|▎         | 34/1000 [11:42<4:44:51, 17.69s/it]Epoch:   35
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  486
Criterion check: 
Mean:  tensor(-0.6128, device='cuda:0') 
Std:  tensor(32.6574, device='cuda:0') 
ABS Max:  tensor(356.9727, device='cuda:0') 
ABS Min:  tensor(0.0029, device='cuda:0')
Criterion check:  tensor([1.0000, 0.9999, 0.9999, 1.0000, 0.9999, 0.9999, 1.0003, 1.0000, 1.0016,
        1.0015], device='cuda:0') tensor(185, device='cuda:0')
max of Lambda2 tensor(59854.8477, device='cuda:0')
min of Lambda2 tensor(1.4736e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1518, device='cuda:0')
min of grad d_p:  tensor(-0.1778, device='cuda:0')
max|min: (J_L, Jta/N)  (0.15184766054153442, 0.1518477350473404, ratio: 1.0000004768371582)|(-0.1778215765953064, -0.17782153189182281)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.9407e-08, device='cuda:0') mean:  tensor(-1.2006e-12, device='cuda:0') min:  tensor(-8.9407e-08, device='cuda:0') norm:  tensor(7.5598e-07, device='cuda:0') MSE:  tensor(9.5260e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(3.0766e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0053, device='cuda:0') MSE:  tensor(6.6829e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0240, device='cuda:0')
min of d_p_list:  tensor(-0.0242, device='cuda:0')
Epoch:  35  
Training Loss: 0.14380767941474915
Test Loss:  0.15081728994846344
Test Acc:  0.0
Valid Loss:  0.12253224849700928
Valid Acc:  0.0
std:  0.6196772884442413 
thres:  0.0004548549085855484
Preserved_eigens number check:  512
  4%|▎         | 35/1000 [12:00<4:45:54, 17.78s/it]Epoch:   36
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  489
Criterion check: 
Mean:  tensor(-2215.5422, device='cuda:0') 
Std:  tensor(50187.2070, device='cuda:0') 
ABS Max:  tensor(1135604., device='cuda:0') 
ABS Min:  tensor(0.0008, device='cuda:0')
Criterion check:  tensor([0.9998, 1.0006, 1.0002, 1.0001, 1.0001, 1.0000, 0.9997, 1.0000, 0.9989,
        1.0000], device='cuda:0') tensor(182, device='cuda:0')
max of Lambda2 tensor(60626.4922, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1140, device='cuda:0')
min of grad d_p:  tensor(-0.1116, device='cuda:0')
max|min: (J_L, Jta/N)  (0.11398515105247498, 0.11398514360189438, ratio: 0.9999999403953552)|(-0.1115569993853569, -0.11155702918767929)

 check Jacobi res:  torch.Size([793601]) max:  tensor(6.7055e-08, device='cuda:0') mean:  tensor(7.6888e-12, device='cuda:0') min:  tensor(-3.9552e-08, device='cuda:0') norm:  tensor(5.3968e-07, device='cuda:0') MSE:  tensor(6.8004e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(2.2354e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0038, device='cuda:0') MSE:  tensor(4.7323e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0525, device='cuda:0')
min of d_p_list:  tensor(-0.0518, device='cuda:0')
Epoch:  36  
Training Loss: 0.12663057446479797
Test Loss:  0.13189992308616638
Test Acc:  0.0
Valid Loss:  0.11778347194194794
Valid Acc:  0.0
std:  0.6192708618347317 
thres:  0.0004556166738271713
Preserved_eigens number check:  512
  4%|▎         | 36/1000 [12:17<4:42:35, 17.59s/it]Epoch:   37
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  483
Criterion check: 
Mean:  tensor(1165.4534, device='cuda:0') 
Std:  tensor(75013.9453, device='cuda:0') 
ABS Max:  tensor(1072034.3750, device='cuda:0') 
ABS Min:  tensor(0.0555, device='cuda:0')
Criterion check:  tensor([ 1.7376,  0.8430,  0.9372,  0.9979,  2.3642,  0.9946, -2.1730,  1.5636,
         0.9414,  0.7171], device='cuda:0') tensor(270, device='cuda:0')
max of Lambda2 tensor(60571.7617, device='cuda:0')
min of Lambda2 tensor(3.3671e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2221, device='cuda:0')
min of grad d_p:  tensor(-0.1686, device='cuda:0')
max|min: (J_L, Jta/N)  (0.2221171259880066, 0.222117081284523, ratio: 0.9999998211860657)|(-0.16862669587135315, -0.16862666606903076)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.9407e-08, device='cuda:0') mean:  tensor(3.7293e-12, device='cuda:0') min:  tensor(-5.9605e-08, device='cuda:0') norm:  tensor(6.2706e-07, device='cuda:0') MSE:  tensor(7.9015e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.2391, device='cuda:0') mean:  tensor(0.0038, device='cuda:0') min:  tensor(3.0371e-13, device='cuda:0') norm:  tensor(6.4343, device='cuda:0') MSE:  tensor(8.1078e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0265, device='cuda:0')
min of d_p_list:  tensor(-0.0170, device='cuda:0')
Epoch:  37  
Training Loss: 0.05564653128385544
Test Loss:  0.057403869926929474
Test Acc:  0.0
Valid Loss:  0.05297860875725746
Valid Acc:  0.0
std:  0.6249777164181057 
thres:  0.00044605422466993336
Preserved_eigens number check:  512
  4%|▎         | 37/1000 [12:34<4:40:57, 17.51s/it]Epoch:   38
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  483
Criterion check: 
Mean:  tensor(-13.2255, device='cuda:0') 
Std:  tensor(304.0613, device='cuda:0') 
ABS Max:  tensor(6874.1895, device='cuda:0') 
ABS Min:  tensor(0.0012, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0002, 1.0013, 1.0000, 1.0003, 1.0000, 1.0436, 1.0003, 0.9921,
        1.0011], device='cuda:0') tensor(170, device='cuda:0')
max of Lambda2 tensor(62051.1172, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1230, device='cuda:0')
min of grad d_p:  tensor(-0.1103, device='cuda:0')
max|min: (J_L, Jta/N)  (0.12295214831829071, 0.12295211106538773, ratio: 0.9999997019767761)|(-0.11032097041606903, -0.11032098531723022)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.7253e-08, device='cuda:0') mean:  tensor(-3.5174e-13, device='cuda:0') min:  tensor(-4.4703e-08, device='cuda:0') norm:  tensor(3.8755e-07, device='cuda:0') MSE:  tensor(4.8835e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(9.0407e-05, device='cuda:0') mean:  tensor(2.1911e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0038, device='cuda:0') MSE:  tensor(4.8259e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0185, device='cuda:0')
min of d_p_list:  tensor(-0.0222, device='cuda:0')
Epoch:  38  
Training Loss: 0.038201622664928436
Test Loss:  0.039741113781929016
Test Acc:  0.0
Valid Loss:  0.035303279757499695
Valid Acc:  0.0
std:  0.06296610885484949 
thres:  0.00011528724730014802
Preserved_eigens number check:  512
  4%|▍         | 38/1000 [12:51<4:38:57, 17.40s/it]Epoch:   39
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  483
Criterion check: 
Mean:  tensor(0.4500, device='cuda:0') 
Std:  tensor(77.0679, device='cuda:0') 
ABS Max:  tensor(939.6743, device='cuda:0') 
ABS Min:  tensor(0.0011, device='cuda:0')
Criterion check:  tensor([0.9982, 1.0010, 0.9993, 1.0001, 1.0037, 1.0000, 0.9962, 1.0003, 1.0020,
        1.0013], device='cuda:0') tensor(191, device='cuda:0')
max of Lambda2 tensor(62151.2383, device='cuda:0')
min of Lambda2 tensor(2.4079e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0716, device='cuda:0')
min of grad d_p:  tensor(-0.0758, device='cuda:0')
max|min: (J_L, Jta/N)  (0.07163487374782562, 0.07163485884666443, ratio: 0.9999998211860657)|(-0.07576346397399902, -0.07576347142457962)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.7253e-08, device='cuda:0') mean:  tensor(-2.1331e-12, device='cuda:0') min:  tensor(-3.3528e-08, device='cuda:0') norm:  tensor(3.3254e-07, device='cuda:0') MSE:  tensor(4.1903e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(4.1387e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0067, device='cuda:0') MSE:  tensor(8.4169e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0312, device='cuda:0')
min of d_p_list:  tensor(-0.0320, device='cuda:0')
Epoch:  39  
Training Loss: 0.04440838098526001
Test Loss:  0.04790087789297104
Test Acc:  0.0
Valid Loss:  0.040228359401226044
Valid Acc:  0.0
std:  0.044356892783768205 
thres:  8.17389577627182e-05
Preserved_eigens number check:  512
  4%|▍         | 39/1000 [13:08<4:37:56, 17.35s/it]Epoch:   40
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  486
Criterion check: 
Mean:  tensor(-0.6123, device='cuda:0') 
Std:  tensor(87.0345, device='cuda:0') 
ABS Max:  tensor(1525.3312, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([1.0004, 1.0023, 1.0000, 1.0001, 1.0000, 0.9997, 1.0004, 1.0001, 1.0275,
        0.9996], device='cuda:0') tensor(187, device='cuda:0')
max of Lambda2 tensor(64586.1523, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0893, device='cuda:0')
min of grad d_p:  tensor(-0.1472, device='cuda:0')
max|min: (J_L, Jta/N)  (0.08928224444389343, 0.08928219974040985, ratio: 0.9999995231628418)|(-0.14720937609672546, -0.14720939099788666)

 check Jacobi res:  torch.Size([793601]) max:  tensor(6.7055e-08, device='cuda:0') mean:  tensor(7.4593e-12, device='cuda:0') min:  tensor(-5.2154e-08, device='cuda:0') norm:  tensor(4.5871e-07, device='cuda:0') MSE:  tensor(5.7802e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(4.1176e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0067, device='cuda:0') MSE:  tensor(8.4508e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0299, device='cuda:0')
min of d_p_list:  tensor(-0.0218, device='cuda:0')
Epoch:  40  
Training Loss: 0.06164209544658661
Test Loss:  0.06342436373233795
Test Acc:  0.0
Valid Loss:  0.051821377128362656
Valid Acc:  0.0
std:  0.031745206620288235 
thres:  6.53058409690857e-05
Preserved_eigens number check:  512
  4%|▍         | 40/1000 [13:26<4:37:32, 17.35s/it]Epoch:   41
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  483
Criterion check: 
Mean:  tensor(-30.0017, device='cuda:0') 
Std:  tensor(816.3011, device='cuda:0') 
ABS Max:  tensor(10203.8760, device='cuda:0') 
ABS Min:  tensor(0.0021, device='cuda:0')
Criterion check:  tensor([0.9909, 1.0239, 0.9871, 1.0023, 1.0011, 1.0084, 0.9572, 1.0447, 2.7901,
        1.0917], device='cuda:0') tensor(250, device='cuda:0')
max of Lambda2 tensor(65948.1875, device='cuda:0')
min of Lambda2 tensor(1.5947e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0844, device='cuda:0')
min of grad d_p:  tensor(-0.1000, device='cuda:0')
max|min: (J_L, Jta/N)  (0.08439739048480988, 0.08439738303422928, ratio: 0.9999999403953552)|(-0.0999731719493866, -0.09997319430112839)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.9605e-08, device='cuda:0') mean:  tensor(8.0554e-12, device='cuda:0') min:  tensor(-3.3528e-08, device='cuda:0') norm:  tensor(4.8949e-07, device='cuda:0') MSE:  tensor(6.1680e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0057, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(3.4198e-15, device='cuda:0') norm:  tensor(0.1904, device='cuda:0') MSE:  tensor(2.3991e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0330, device='cuda:0')
min of d_p_list:  tensor(-0.0289, device='cuda:0')
Epoch:  41  
Training Loss: 0.06934948265552521
Test Loss:  0.07127362489700317
Test Acc:  0.0
Valid Loss:  0.05897989869117737
Valid Acc:  0.0
std:  0.011297735355545097 
thres:  5.3849622607231144e-05
Preserved_eigens number check:  512
  4%|▍         | 41/1000 [13:43<4:37:25, 17.36s/it]Epoch:   42
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  486
Criterion check: 
Mean:  tensor(-0.3101, device='cuda:0') 
Std:  tensor(29.2844, device='cuda:0') 
ABS Max:  tensor(379.5471, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([1.0005, 1.0000, 0.9998, 1.0000, 1.0000, 0.9999, 1.0002, 0.9991, 1.0114,
        0.9969], device='cuda:0') tensor(163, device='cuda:0')
max of Lambda2 tensor(63988.8242, device='cuda:0')
min of Lambda2 tensor(1.2098e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0890, device='cuda:0')
min of grad d_p:  tensor(-0.1264, device='cuda:0')
max|min: (J_L, Jta/N)  (0.08898837864398956, 0.08898838609457016, ratio: 1.0000001192092896)|(-0.12642446160316467, -0.12642449140548706)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.9605e-08, device='cuda:0') mean:  tensor(5.2846e-12, device='cuda:0') min:  tensor(-5.2154e-08, device='cuda:0') norm:  tensor(5.5417e-07, device='cuda:0') MSE:  tensor(6.9829e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(5.7993e-05, device='cuda:0') mean:  tensor(1.4386e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0024, device='cuda:0') MSE:  tensor(3.0536e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0147, device='cuda:0')
min of d_p_list:  tensor(-0.0106, device='cuda:0')
Epoch:  42  
Training Loss: 0.03766277804970741
Test Loss:  0.03603656589984894
Test Acc:  0.0
Valid Loss:  0.03198900818824768
Valid Acc:  0.0
std:  0.012901907616159948 
thres:  5.025287196040153e-05
Preserved_eigens number check:  512
  4%|▍         | 42/1000 [14:00<4:35:56, 17.28s/it]Epoch:   43
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  488
Criterion check: 
Mean:  tensor(-0.7183, device='cuda:0') 
Std:  tensor(49.7612, device='cuda:0') 
ABS Max:  tensor(1039.3529, device='cuda:0') 
ABS Min:  tensor(0.0005, device='cuda:0')
Criterion check:  tensor([0.9998, 0.9998, 1.0010, 1.0000, 1.0000, 1.0001, 1.0001, 0.9989, 1.0033,
        1.0002], device='cuda:0') tensor(161, device='cuda:0')
max of Lambda2 tensor(64847.1562, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0619, device='cuda:0')
min of grad d_p:  tensor(-0.0678, device='cuda:0')
max|min: (J_L, Jta/N)  (0.061927348375320435, 0.06192735210061073, ratio: 1.0000001192092896)|(-0.06784388422966003, -0.06784391403198242)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.3528e-08, device='cuda:0') mean:  tensor(1.3430e-12, device='cuda:0') min:  tensor(-2.2352e-08, device='cuda:0') norm:  tensor(3.0977e-07, device='cuda:0') MSE:  tensor(3.9034e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(9.6750e-05, device='cuda:0') mean:  tensor(1.9712e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0034, device='cuda:0') MSE:  tensor(4.2471e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0109, device='cuda:0')
min of d_p_list:  tensor(-0.0163, device='cuda:0')
Epoch:  43  
Training Loss: 0.03954996168613434
Test Loss:  0.040386974811553955
Test Acc:  0.0
Valid Loss:  0.03537249192595482
Valid Acc:  0.0
std:  0.012659006089055983 
thres:  5.052253976464272e-05
Preserved_eigens number check:  512
  4%|▍         | 43/1000 [14:18<4:35:40, 17.28s/it]Epoch:   44
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  486
Criterion check: 
Mean:  tensor(30.8557, device='cuda:0') 
Std:  tensor(630.1500, device='cuda:0') 
ABS Max:  tensor(14217.6260, device='cuda:0') 
ABS Min:  tensor(0.0009, device='cuda:0')
Criterion check:  tensor([0.9998, 1.0003, 1.0007, 1.0000, 1.0002, 0.9999, 0.9993, 1.0018, 1.0128,
        0.9992], device='cuda:0') tensor(178, device='cuda:0')
max of Lambda2 tensor(64763.2617, device='cuda:0')
min of Lambda2 tensor(2.0114e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0503, device='cuda:0')
min of grad d_p:  tensor(-0.0546, device='cuda:0')
max|min: (J_L, Jta/N)  (0.050332874059677124, 0.05033288151025772, ratio: 1.0000001192092896)|(-0.05459599941968918, -0.05459602549672127)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.0978e-08, device='cuda:0') mean:  tensor(-2.0545e-12, device='cuda:0') min:  tensor(-3.1665e-08, device='cuda:0') norm:  tensor(4.2793e-07, device='cuda:0') MSE:  tensor(5.3923e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(9.9760e-05, device='cuda:0') mean:  tensor(2.4922e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0041, device='cuda:0') MSE:  tensor(5.1618e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0070, device='cuda:0')
min of d_p_list:  tensor(-0.0103, device='cuda:0')
Epoch:  44  
Training Loss: 0.02244890108704567
Test Loss:  0.02234461158514023
Test Acc:  0.0
Valid Loss:  0.019184885546565056
Valid Acc:  0.0
std:  0.017061973363913897 
thres:  4.613064378499985e-05
Preserved_eigens number check:  512
  4%|▍         | 44/1000 [14:35<4:36:06, 17.33s/it]Epoch:   45
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  491
Criterion check: 
Mean:  tensor(102.7328, device='cuda:0') 
Std:  tensor(2107.3213, device='cuda:0') 
ABS Max:  tensor(21729.7441, device='cuda:0') 
ABS Min:  tensor(0.0484, device='cuda:0')
Criterion check:  tensor([ 1.0315,  1.0254,  1.4750,  1.0107,  0.9951,  0.9821,  1.0206,  0.9173,
        -0.6926,  0.8604], device='cuda:0') tensor(269, device='cuda:0')
max of Lambda2 tensor(66702.7344, device='cuda:0')
min of Lambda2 tensor(8.4731e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0414, device='cuda:0')
min of grad d_p:  tensor(-0.0352, device='cuda:0')
max|min: (J_L, Jta/N)  (0.04139522835612297, 0.04139518737792969, ratio: 0.9999989867210388)|(-0.0352044440805912, -0.035204436630010605)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.4703e-08, device='cuda:0') mean:  tensor(9.8356e-12, device='cuda:0') min:  tensor(-1.6764e-08, device='cuda:0') norm:  tensor(3.9238e-07, device='cuda:0') MSE:  tensor(4.9443e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0051, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(2.3672e-14, device='cuda:0') norm:  tensor(0.2119, device='cuda:0') MSE:  tensor(2.6704e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0134, device='cuda:0')
min of d_p_list:  tensor(-0.0197, device='cuda:0')
Epoch:  45  
Training Loss: 0.022683490067720413
Test Loss:  0.02430597133934498
Test Acc:  0.0
Valid Loss:  0.019310493022203445
Valid Acc:  0.0
std:  0.01709481777342643 
thres:  3.833892270922661e-05
Preserved_eigens number check:  512
  4%|▍         | 45/1000 [14:53<4:36:51, 17.39s/it]Epoch:   46
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  490
Criterion check: 
Mean:  tensor(-1.3925, device='cuda:0') 
Std:  tensor(17.9289, device='cuda:0') 
ABS Max:  tensor(249.9823, device='cuda:0') 
ABS Min:  tensor(0.0005, device='cuda:0')
Criterion check:  tensor([1.0000, 0.9999, 0.9999, 0.9999, 1.0001, 1.0000, 0.9995, 1.0006, 1.0040,
        1.0012], device='cuda:0') tensor(148, device='cuda:0')
max of Lambda2 tensor(70479.3516, device='cuda:0')
min of Lambda2 tensor(4.0254e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0347, device='cuda:0')
min of grad d_p:  tensor(-0.0309, device='cuda:0')
max|min: (J_L, Jta/N)  (0.03468097746372223, 0.034680988639593124, ratio: 1.0000003576278687)|(-0.03087460994720459, -0.030874596908688545)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.2352e-08, device='cuda:0') mean:  tensor(2.3127e-12, device='cuda:0') min:  tensor(-2.7940e-08, device='cuda:0') norm:  tensor(2.2522e-07, device='cuda:0') MSE:  tensor(2.8379e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(4.7937e-05, device='cuda:0') mean:  tensor(1.0395e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0018, device='cuda:0') MSE:  tensor(2.2754e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0588, device='cuda:0')
min of d_p_list:  tensor(-0.0441, device='cuda:0')
Epoch:  46  
Training Loss: 0.2202339917421341
Test Loss:  0.23845215141773224
Test Acc:  0.0
Valid Loss:  0.1886478066444397
Valid Acc:  0.0
std:  0.07619986649250127 
thres:  6.851582452654839e-05
Preserved_eigens number check:  512
  5%|▍         | 46/1000 [15:10<4:37:39, 17.46s/it]Epoch:   47
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  488
Criterion check: 
Mean:  tensor(18.1485, device='cuda:0') 
Std:  tensor(524.6672, device='cuda:0') 
ABS Max:  tensor(7696.3135, device='cuda:0') 
ABS Min:  tensor(0.0043, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0011, 1.0037, 1.0002, 1.0003, 0.9993, 0.9752, 0.9994, 0.9961,
        1.0159], device='cuda:0') tensor(228, device='cuda:0')
max of Lambda2 tensor(68040.4141, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1566, device='cuda:0')
min of grad d_p:  tensor(-0.1536, device='cuda:0')
max|min: (J_L, Jta/N)  (0.15664978325366974, 0.15664981305599213, ratio: 1.000000238418579)|(-0.1536453515291214, -0.1536453366279602)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.8429e-08, device='cuda:0') mean:  tensor(-1.8695e-11, device='cuda:0') min:  tensor(-9.6858e-08, device='cuda:0') norm:  tensor(8.8479e-07, device='cuda:0') MSE:  tensor(1.1149e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0018, device='cuda:0') mean:  tensor(2.8256e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0482, device='cuda:0') MSE:  tensor(6.0712e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0178, device='cuda:0')
min of d_p_list:  tensor(-0.0274, device='cuda:0')
Epoch:  47  
Training Loss: 0.14259836077690125
Test Loss:  0.15463320910930634
Test Acc:  0.0
Valid Loss:  0.12371416389942169
Valid Acc:  0.0
std:  0.07920368004493059 
thres:  8.950294107198715e-05
Preserved_eigens number check:  512
  5%|▍         | 47/1000 [15:28<4:37:38, 17.48s/it]Epoch:   48
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  483
Criterion check: 
Mean:  tensor(32.6159, device='cuda:0') 
Std:  tensor(759.3640, device='cuda:0') 
ABS Max:  tensor(16288.9990, device='cuda:0') 
ABS Min:  tensor(0.0082, device='cuda:0')
Criterion check:  tensor([0.9998, 1.0004, 1.0002, 1.0000, 1.0005, 0.9996, 0.9925, 0.9963, 1.0089,
        0.9950], device='cuda:0') tensor(207, device='cuda:0')
max of Lambda2 tensor(69522.8984, device='cuda:0')
min of Lambda2 tensor(1.1851e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1372, device='cuda:0')
min of grad d_p:  tensor(-0.1122, device='cuda:0')
max|min: (J_L, Jta/N)  (0.13723909854888916, 0.13723911345005035, ratio: 1.0000001192092896)|(-0.11222797632217407, -0.11222802102565765)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.5879e-08, device='cuda:0') mean:  tensor(-2.6082e-12, device='cuda:0') min:  tensor(-5.9605e-08, device='cuda:0') norm:  tensor(6.1267e-07, device='cuda:0') MSE:  tensor(7.7202e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0009, device='cuda:0') mean:  tensor(1.0486e-05, device='cuda:0') min:  tensor(2.3349e-14, device='cuda:0') norm:  tensor(0.0196, device='cuda:0') MSE:  tensor(2.4640e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0197, device='cuda:0')
min of d_p_list:  tensor(-0.0170, device='cuda:0')
Epoch:  48  
Training Loss: 0.056639134883880615
Test Loss:  0.060482509434223175
Test Acc:  0.0
Valid Loss:  0.05006087198853493
Valid Acc:  0.0
std:  0.07732067809173451 
thres:  9.292077571153641e-05
Preserved_eigens number check:  512
  5%|▍         | 48/1000 [15:45<4:38:27, 17.55s/it]Epoch:   49
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  485
Criterion check: 
Mean:  tensor(23.5197, device='cuda:0') 
Std:  tensor(1418.8242, device='cuda:0') 
ABS Max:  tensor(16148.4102, device='cuda:0') 
ABS Min:  tensor(0.0213, device='cuda:0')
Criterion check:  tensor([1.0014, 1.0012, 1.0113, 0.9982, 0.9994, 1.0006, 1.0522, 1.0148, 1.0795,
        1.0203], device='cuda:0') tensor(246, device='cuda:0')
max of Lambda2 tensor(70212.6406, device='cuda:0')
min of Lambda2 tensor(1.0974e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1155, device='cuda:0')
min of grad d_p:  tensor(-0.0632, device='cuda:0')
max|min: (J_L, Jta/N)  (0.1155276969075203, 0.1155276745557785, ratio: 0.9999998211860657)|(-0.06318725645542145, -0.06318723410367966)

 check Jacobi res:  torch.Size([793601]) max:  tensor(9.6858e-08, device='cuda:0') mean:  tensor(3.0971e-12, device='cuda:0') min:  tensor(-4.8429e-08, device='cuda:0') norm:  tensor(8.2164e-07, device='cuda:0') MSE:  tensor(1.0353e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0024, device='cuda:0') mean:  tensor(5.0849e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0802, device='cuda:0') MSE:  tensor(1.0101e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0163, device='cuda:0')
min of d_p_list:  tensor(-0.0152, device='cuda:0')
Epoch:  49  
Training Loss: 0.04492254555225372
Test Loss:  0.0471072718501091
Test Acc:  0.0
Valid Loss:  0.03894004225730896
Valid Acc:  0.0
std:  0.0736599868979787 
thres:  9.741550460457801e-05
Preserved_eigens number check:  512
  5%|▍         | 49/1000 [16:03<4:37:32, 17.51s/it]Epoch:   50
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  486
Criterion check: 
Mean:  tensor(6.9206, device='cuda:0') 
Std:  tensor(102.1486, device='cuda:0') 
ABS Max:  tensor(2171.0103, device='cuda:0') 
ABS Min:  tensor(0.0001, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0004, 0.9999, 0.9999, 1.0001, 0.9951, 1.0001, 0.9834,
        0.9919], device='cuda:0') tensor(163, device='cuda:0')
max of Lambda2 tensor(71906.3359, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0938, device='cuda:0')
min of grad d_p:  tensor(-0.0684, device='cuda:0')
max|min: (J_L, Jta/N)  (0.09378555417060852, 0.09378555417060852, ratio: 1.0)|(-0.0684008002281189, -0.0684007853269577)

 check Jacobi res:  torch.Size([793601]) max:  tensor(6.7055e-08, device='cuda:0') mean:  tensor(6.0017e-12, device='cuda:0') min:  tensor(-5.2154e-08, device='cuda:0') norm:  tensor(5.0747e-07, device='cuda:0') MSE:  tensor(6.3945e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(6.0808e-05, device='cuda:0') mean:  tensor(1.7532e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0030, device='cuda:0') MSE:  tensor(3.7373e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0440, device='cuda:0')
min of d_p_list:  tensor(-0.0209, device='cuda:0')
Epoch:  50  
Training Loss: 0.03794040530920029
Test Loss:  0.04079939052462578
Test Acc:  0.0
Valid Loss:  0.03349422290921211
Valid Acc:  0.0
std:  0.0707599139286825 
thres:  0.000100466887652874
Preserved_eigens number check:  512
  5%|▌         | 50/1000 [16:20<4:35:16, 17.39s/it]Epoch:   51
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  485
Criterion check: 
Mean:  tensor(-42.8961, device='cuda:0') 
Std:  tensor(996.3638, device='cuda:0') 
ABS Max:  tensor(22316.1777, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([0.9990, 0.9987, 1.0002, 0.9999, 1.0002, 1.0000, 0.9998, 1.0018, 1.0082,
        1.0251], device='cuda:0') tensor(195, device='cuda:0')
max of Lambda2 tensor(71440.3516, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0601, device='cuda:0')
min of grad d_p:  tensor(-0.0597, device='cuda:0')
max|min: (J_L, Jta/N)  (0.06008255481719971, 0.06008255109190941, ratio: 0.9999999403953552)|(-0.05968048423528671, -0.05968047305941582)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.5299e-08, device='cuda:0') mean:  tensor(-5.4769e-12, device='cuda:0') min:  tensor(-3.7253e-08, device='cuda:0') norm:  tensor(3.6669e-07, device='cuda:0') MSE:  tensor(4.6206e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(8.6742e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0153, device='cuda:0') MSE:  tensor(1.9289e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0478, device='cuda:0')
min of d_p_list:  tensor(-0.0419, device='cuda:0')
Epoch:  51  
Training Loss: 0.14779572188854218
Test Loss:  0.16794630885124207
Test Acc:  0.0
Valid Loss:  0.13494354486465454
Valid Acc:  0.0
std:  0.04874674519652796 
thres:  8.597923368215561e-05
Preserved_eigens number check:  512
  5%|▌         | 51/1000 [16:37<4:35:36, 17.43s/it]Epoch:   52
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  485
Criterion check: 
Mean:  tensor(-5.2701, device='cuda:0') 
Std:  tensor(89.3615, device='cuda:0') 
ABS Max:  tensor(1922.7975, device='cuda:0') 
ABS Min:  tensor(0.0005, device='cuda:0')
Criterion check:  tensor([0.9998, 0.9999, 1.0025, 0.9999, 0.9998, 1.0001, 0.9975, 1.0009, 1.0002,
        0.9986], device='cuda:0') tensor(161, device='cuda:0')
max of Lambda2 tensor(73873.8281, device='cuda:0')
min of Lambda2 tensor(4.2368e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2775, device='cuda:0')
min of grad d_p:  tensor(-0.1421, device='cuda:0')
max|min: (J_L, Jta/N)  (0.27745717763900757, 0.2774571478366852, ratio: 0.9999998807907104)|(-0.14212638139724731, -0.1421263962984085)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.3411e-07, device='cuda:0') mean:  tensor(-2.2553e-12, device='cuda:0') min:  tensor(-1.1921e-07, device='cuda:0') norm:  tensor(9.8469e-07, device='cuda:0') MSE:  tensor(1.2408e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(1.8430e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0036, device='cuda:0') MSE:  tensor(4.4967e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0083, device='cuda:0')
min of d_p_list:  tensor(-0.0099, device='cuda:0')
Epoch:  52  
Training Loss: 0.05216861143708229
Test Loss:  0.058934926986694336
Test Acc:  0.0
Valid Loss:  0.04732007905840874
Valid Acc:  0.0
std:  0.040455285308032864 
thres:  6.789328381419183e-05
Preserved_eigens number check:  512
  5%|▌         | 52/1000 [16:55<4:36:05, 17.47s/it]Epoch:   53
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  487
Criterion check: 
Mean:  tensor(-0.3865, device='cuda:0') 
Std:  tensor(11.8820, device='cuda:0') 
ABS Max:  tensor(197.9496, device='cuda:0') 
ABS Min:  tensor(0., device='cuda:0')
Criterion check:  tensor([1.0000, 1.0001, 1.0087, 1.0001, 0.9998, 0.9998, 0.9967, 0.9996, 0.9982,
        0.9989], device='cuda:0') tensor(141, device='cuda:0')
max of Lambda2 tensor(74093.4922, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1502, device='cuda:0')
min of grad d_p:  tensor(-0.0793, device='cuda:0')
max|min: (J_L, Jta/N)  (0.15020465850830078, 0.15020470321178436, ratio: 1.000000238418579)|(-0.07928048074245453, -0.07928046584129333)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.4703e-08, device='cuda:0') mean:  tensor(-6.9155e-12, device='cuda:0') min:  tensor(-8.9407e-08, device='cuda:0') norm:  tensor(7.1225e-07, device='cuda:0') MSE:  tensor(8.9750e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(9.7678e-07, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0017, device='cuda:0') MSE:  tensor(2.1794e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0676, device='cuda:0')
min of d_p_list:  tensor(-0.0599, device='cuda:0')
Epoch:  53  
Training Loss: 0.21359536051750183
Test Loss:  0.23104292154312134
Test Acc:  0.0
Valid Loss:  0.19045545160770416
Valid Acc:  0.0
std:  0.06979761956005788 
thres:  9.928452894091607e-05
Preserved_eigens number check:  512
  5%|▌         | 53/1000 [17:13<4:36:36, 17.53s/it]Epoch:   54
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  488
Criterion check: 
Mean:  tensor(2.0121, device='cuda:0') 
Std:  tensor(49.2583, device='cuda:0') 
ABS Max:  tensor(1014.9791, device='cuda:0') 
ABS Min:  tensor(0.0008, device='cuda:0')
Criterion check:  tensor([1.0000, 0.9999, 1.0003, 1.0000, 0.9999, 1.0000, 1.0002, 0.9996, 0.9994,
        1.0060], device='cuda:0') tensor(165, device='cuda:0')
max of Lambda2 tensor(73261.6953, device='cuda:0')
min of Lambda2 tensor(3.4893e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2201, device='cuda:0')
min of grad d_p:  tensor(-0.1557, device='cuda:0')
max|min: (J_L, Jta/N)  (0.22008757293224335, 0.22008763253688812, ratio: 1.000000238418579)|(-0.1556643843650818, -0.1556643694639206)

 check Jacobi res:  torch.Size([793601]) max:  tensor(9.5355e-08, device='cuda:0') mean:  tensor(-5.3140e-12, device='cuda:0') min:  tensor(-1.4901e-07, device='cuda:0') norm:  tensor(8.8461e-07, device='cuda:0') MSE:  tensor(1.1147e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(1.7003e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0029, device='cuda:0') MSE:  tensor(3.6560e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1147, device='cuda:0')
min of d_p_list:  tensor(-0.1222, device='cuda:0')
Epoch:  54  
Training Loss: 0.23729640245437622
Test Loss:  0.2669309973716736
Test Acc:  0.0
Valid Loss:  0.23353977501392365
Valid Acc:  0.0
std:  0.08130073838547758 
thres:  0.00013775930032134057
Preserved_eigens number check:  512
  5%|▌         | 54/1000 [17:30<4:37:05, 17.57s/it]Epoch:   55
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  481
Criterion check: 
Mean:  tensor(-0.1838, device='cuda:0') 
Std:  tensor(22.5476, device='cuda:0') 
ABS Max:  tensor(334.6322, device='cuda:0') 
ABS Min:  tensor(0.0006, device='cuda:0')
Criterion check:  tensor([0.9998, 1.0000, 1.0001, 1.0000, 0.9998, 0.9997, 1.0016, 0.9989, 0.9957,
        0.9988], device='cuda:0') tensor(162, device='cuda:0')
max of Lambda2 tensor(73341.9922, device='cuda:0')
min of Lambda2 tensor(3.3773e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.4227, device='cuda:0')
min of grad d_p:  tensor(-0.2968, device='cuda:0')
max|min: (J_L, Jta/N)  (0.4226505756378174, 0.42265045642852783, ratio: 0.9999997019767761)|(-0.2968024015426636, -0.29680243134498596)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.3842e-07, device='cuda:0') mean:  tensor(1.1412e-11, device='cuda:0') min:  tensor(-1.7881e-07, device='cuda:0') norm:  tensor(1.3308e-06, device='cuda:0') MSE:  tensor(1.6769e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(1.5680e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0027, device='cuda:0') MSE:  tensor(3.4264e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0255, device='cuda:0')
min of d_p_list:  tensor(-0.0408, device='cuda:0')
Epoch:  55  
Training Loss: 0.08951609581708908
Test Loss:  0.09410366415977478
Test Acc:  0.0
Valid Loss:  0.08873207867145538
Valid Acc:  0.0
std:  0.07054166842262886 
thres:  0.00014807443842291832
Preserved_eigens number check:  512
  6%|▌         | 55/1000 [17:48<4:35:22, 17.48s/it]Epoch:   56
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  482
Criterion check: 
Mean:  tensor(-6.5066, device='cuda:0') 
Std:  tensor(127.5322, device='cuda:0') 
ABS Max:  tensor(2826.4131, device='cuda:0') 
ABS Min:  tensor(0.0004, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 0.9999, 1.0000, 1.0000, 0.9999, 1.0001, 1.0006, 0.9960,
        0.9996], device='cuda:0') tensor(160, device='cuda:0')
max of Lambda2 tensor(75144.3906, device='cuda:0')
min of Lambda2 tensor(1.3963e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2419, device='cuda:0')
min of grad d_p:  tensor(-0.1578, device='cuda:0')
max|min: (J_L, Jta/N)  (0.2419491708278656, 0.2419491410255432, ratio: 0.9999998807907104)|(-0.15782974660396576, -0.15782976150512695)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.0431e-07, device='cuda:0') mean:  tensor(1.0165e-11, device='cuda:0') min:  tensor(-7.4506e-08, device='cuda:0') norm:  tensor(7.1343e-07, device='cuda:0') MSE:  tensor(8.9897e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(2.3908e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0044, device='cuda:0') MSE:  tensor(5.4942e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0129, device='cuda:0')
min of d_p_list:  tensor(-0.0111, device='cuda:0')
Epoch:  56  
Training Loss: 0.04905978590250015
Test Loss:  0.04777568578720093
Test Acc:  0.0
Valid Loss:  0.0492415614426136
Valid Acc:  0.0
std:  0.08091316535529336 
thres:  0.00012832725122570993
Preserved_eigens number check:  512
  6%|▌         | 56/1000 [18:05<4:34:43, 17.46s/it]Epoch:   57
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  483
Criterion check: 
Mean:  tensor(-6.9660, device='cuda:0') 
Std:  tensor(135.2170, device='cuda:0') 
ABS Max:  tensor(2293.7412, device='cuda:0') 
ABS Min:  tensor(0.0015, device='cuda:0')
Criterion check:  tensor([1.0004, 0.9996, 0.9998, 1.0000, 0.9998, 0.9989, 1.0023, 0.9991, 1.0023,
        1.0737], device='cuda:0') tensor(179, device='cuda:0')
max of Lambda2 tensor(81315.6719, device='cuda:0')
min of Lambda2 tensor(1.6304e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1328, device='cuda:0')
min of grad d_p:  tensor(-0.1061, device='cuda:0')
max|min: (J_L, Jta/N)  (0.13284669816493988, 0.1328466385602951, ratio: 0.9999995231628418)|(-0.10606680810451508, -0.10606683045625687)

 check Jacobi res:  torch.Size([793601]) max:  tensor(6.7055e-08, device='cuda:0') mean:  tensor(1.4275e-11, device='cuda:0') min:  tensor(-6.7055e-08, device='cuda:0') norm:  tensor(7.7033e-07, device='cuda:0') MSE:  tensor(9.7068e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(7.2395e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0124, device='cuda:0') MSE:  tensor(1.5589e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1704, device='cuda:0')
min of d_p_list:  tensor(-0.1455, device='cuda:0')
Epoch:  57  
Training Loss: 1.1649813652038574
Test Loss:  1.2623249292373657
Test Acc:  0.0
Valid Loss:  1.0338761806488037
Valid Acc:  0.0
std:  0.4132592092774777 
thres:  0.0003508898019790649
Preserved_eigens number check:  512
  6%|▌         | 57/1000 [18:23<4:36:20, 17.58s/it]Epoch:   58
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  482
Criterion check: 
Mean:  tensor(-2.0087, device='cuda:0') 
Std:  tensor(50.4700, device='cuda:0') 
ABS Max:  tensor(1049.2954, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([0.9990, 0.9995, 0.9979, 1.0000, 0.9999, 0.9997, 1.0007, 0.9991, 0.9983,
        0.9968], device='cuda:0') tensor(173, device='cuda:0')
max of Lambda2 tensor(66159.5391, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2028, device='cuda:0')
min of grad d_p:  tensor(-0.2052, device='cuda:0')
max|min: (J_L, Jta/N)  (0.20284020900726318, 0.20284029841423035, ratio: 1.0000004768371582)|(-0.20520547032356262, -0.20520555973052979)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.9407e-08, device='cuda:0') mean:  tensor(-1.9255e-11, device='cuda:0') min:  tensor(-1.3411e-07, device='cuda:0') norm:  tensor(1.0681e-06, device='cuda:0') MSE:  tensor(1.3459e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(2.9483e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0052, device='cuda:0') MSE:  tensor(6.6051e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0361, device='cuda:0')
min of d_p_list:  tensor(-0.0676, device='cuda:0')
Epoch:  58  
Training Loss: 0.27342721819877625
Test Loss:  0.3008008599281311
Test Acc:  0.0
Valid Loss:  0.23743879795074463
Valid Acc:  0.0
std:  0.4099635564911076 
thres:  0.00036285617351531984
Preserved_eigens number check:  512
  6%|▌         | 58/1000 [18:40<4:34:41, 17.50s/it]Epoch:   59
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  479
Criterion check: 
Mean:  tensor(1.8604, device='cuda:0') 
Std:  tensor(64.3237, device='cuda:0') 
ABS Max:  tensor(849.8615, device='cuda:0') 
ABS Min:  tensor(0.0019, device='cuda:0')
Criterion check:  tensor([0.9997, 0.9863, 0.9992, 1.0001, 0.9996, 0.9968, 1.0023, 0.9919, 0.9142,
        0.9801], device='cuda:0') tensor(208, device='cuda:0')
max of Lambda2 tensor(65083.0898, device='cuda:0')
min of Lambda2 tensor(4.9717e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2143, device='cuda:0')
min of grad d_p:  tensor(-0.2038, device='cuda:0')
max|min: (J_L, Jta/N)  (0.21429631114006042, 0.2142963707447052, ratio: 1.000000238418579)|(-0.2038286030292511, -0.20382851362228394)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.9407e-08, device='cuda:0') mean:  tensor(7.6950e-12, device='cuda:0') min:  tensor(-8.9407e-08, device='cuda:0') norm:  tensor(6.3030e-07, device='cuda:0') MSE:  tensor(7.9423e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0010, device='cuda:0') mean:  tensor(1.5629e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0294, device='cuda:0') MSE:  tensor(3.7083e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0310, device='cuda:0')
min of d_p_list:  tensor(-0.0327, device='cuda:0')
Epoch:  59  
Training Loss: 0.15488071739673615
Test Loss:  0.16957733035087585
Test Acc:  0.0
Valid Loss:  0.13774752616882324
Valid Acc:  0.0
std:  0.416288518569595 
thres:  0.0003463730365037918
Preserved_eigens number check:  512
  6%|▌         | 59/1000 [18:57<4:32:57, 17.40s/it]Epoch:   60
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  480
Criterion check: 
Mean:  tensor(-6.1812, device='cuda:0') 
Std:  tensor(148.8759, device='cuda:0') 
ABS Max:  tensor(3159.6160, device='cuda:0') 
ABS Min:  tensor(0.0009, device='cuda:0')
Criterion check:  tensor([0.9992, 0.9984, 1.0003, 1.0000, 0.9999, 0.9995, 1.0008, 0.9997, 1.0078,
        1.0014], device='cuda:0') tensor(141, device='cuda:0')
max of Lambda2 tensor(65158.9375, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1711, device='cuda:0')
min of grad d_p:  tensor(-0.1154, device='cuda:0')
max|min: (J_L, Jta/N)  (0.17113222181797028, 0.17113220691680908, ratio: 0.9999999403953552)|(-0.11537983268499374, -0.11537982523441315)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.2154e-08, device='cuda:0') mean:  tensor(1.5480e-12, device='cuda:0') min:  tensor(-5.2154e-08, device='cuda:0') norm:  tensor(3.9434e-07, device='cuda:0') MSE:  tensor(4.9690e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(2.2536e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0037, device='cuda:0') MSE:  tensor(4.6119e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0397, device='cuda:0')
min of d_p_list:  tensor(-0.0280, device='cuda:0')
Epoch:  60  
Training Loss: 0.1090497225522995
Test Loss:  0.11849121749401093
Test Acc:  0.0
Valid Loss:  0.0968407392501831
Valid Acc:  0.0
std:  0.4139447326191361 
thres:  0.0003502797618508339
Preserved_eigens number check:  512
  6%|▌         | 60/1000 [19:15<4:32:35, 17.40s/it]Epoch:   61
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  482
Criterion check: 
Mean:  tensor(-4.5978, device='cuda:0') 
Std:  tensor(89.2185, device='cuda:0') 
ABS Max:  tensor(1929.7260, device='cuda:0') 
ABS Min:  tensor(0.0020, device='cuda:0')
Criterion check:  tensor([0.9994, 1.0003, 1.0012, 1.0001, 0.9999, 0.9986, 1.0007, 0.9958, 0.9698,
        0.9970], device='cuda:0') tensor(177, device='cuda:0')
max of Lambda2 tensor(65147.3828, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0944, device='cuda:0')
min of grad d_p:  tensor(-0.0804, device='cuda:0')
max|min: (J_L, Jta/N)  (0.09442503750324249, 0.09442505240440369, ratio: 1.0000001192092896)|(-0.08044452965259552, -0.08044452965259552)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.9517e-06, device='cuda:0') mean:  tensor(1.6860e-09, device='cuda:0') min:  tensor(-8.1805e-06, device='cuda:0') norm:  tensor(5.3303e-05, device='cuda:0') MSE:  tensor(6.7166e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(4.5006e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0074, device='cuda:0') MSE:  tensor(9.3307e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.2240, device='cuda:0')
min of d_p_list:  tensor(-0.2592, device='cuda:0')
Epoch:  61  
Training Loss: 0.6350077390670776
Test Loss:  0.7267746925354004
Test Acc:  0.0
Valid Loss:  0.6733369827270508
Valid Acc:  0.0
std:  0.39456830958692757 
thres:  0.00046746935248374936
Preserved_eigens number check:  512
  6%|▌         | 61/1000 [19:33<4:34:34, 17.54s/it]Epoch:   62
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  474
Criterion check: 
Mean:  tensor(-3.7548, device='cuda:0') 
Std:  tensor(86.6151, device='cuda:0') 
ABS Max:  tensor(1889.4430, device='cuda:0') 
ABS Min:  tensor(0.0005, device='cuda:0')
Criterion check:  tensor([0.9997, 1.0000, 0.9999, 1.0000, 1.0005, 0.9998, 0.9999, 1.0012, 0.9982,
        1.0046], device='cuda:0') tensor(145, device='cuda:0')
max of Lambda2 tensor(60309.8398, device='cuda:0')
min of Lambda2 tensor(2.8709e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3654, device='cuda:0')
min of grad d_p:  tensor(-0.2728, device='cuda:0')
max|min: (J_L, Jta/N)  (0.36543530225753784, 0.3654353618621826, ratio: 1.0000001192092896)|(-0.2727847993373871, -0.2727847695350647)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.3842e-07, device='cuda:0') mean:  tensor(-1.8630e-11, device='cuda:0') min:  tensor(-1.7881e-07, device='cuda:0') norm:  tensor(1.3764e-06, device='cuda:0') MSE:  tensor(1.7344e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(2.4798e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0044, device='cuda:0') MSE:  tensor(5.5989e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0509, device='cuda:0')
min of d_p_list:  tensor(-0.0457, device='cuda:0')
Epoch:  62  
Training Loss: 0.07395091652870178
Test Loss:  0.07839173823595047
Test Acc:  0.0
Valid Loss:  0.0847473293542862
Valid Acc:  0.0
std:  0.2042963622837256 
thres:  0.0002492632627487183
Preserved_eigens number check:  512
  6%|▌         | 62/1000 [19:50<4:32:29, 17.43s/it]Epoch:   63
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  476
Criterion check: 
Mean:  tensor(-3.0530, device='cuda:0') 
Std:  tensor(131.0434, device='cuda:0') 
ABS Max:  tensor(1989.7166, device='cuda:0') 
ABS Min:  tensor(0.0010, device='cuda:0')
Criterion check:  tensor([0.9979, 1.0000, 1.0006, 1.0000, 0.9991, 1.0005, 1.0006, 1.0015, 0.9586,
        1.0060], device='cuda:0') tensor(159, device='cuda:0')
max of Lambda2 tensor(59106.6250, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1705, device='cuda:0')
min of grad d_p:  tensor(-0.1167, device='cuda:0')
max|min: (J_L, Jta/N)  (0.17053759098052979, 0.17053760588169098, ratio: 1.0000001192092896)|(-0.11673668026924133, -0.11673665046691895)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.2154e-08, device='cuda:0') mean:  tensor(-1.9275e-11, device='cuda:0') min:  tensor(-9.6858e-08, device='cuda:0') norm:  tensor(8.9133e-07, device='cuda:0') MSE:  tensor(1.1231e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(5.1250e-06, device='cuda:0') min:  tensor(1.9075e-14, device='cuda:0') norm:  tensor(0.0089, device='cuda:0') MSE:  tensor(1.1161e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1039, device='cuda:0')
min of d_p_list:  tensor(-0.1201, device='cuda:0')
Epoch:  63  
Training Loss: 0.42068246006965637
Test Loss:  0.45009469985961914
Test Acc:  0.0
Valid Loss:  0.3752005696296692
Valid Acc:  0.0
std:  0.21593926990118698 
thres:  0.0002787143111228943
Preserved_eigens number check:  512
  6%|▋         | 63/1000 [20:07<4:32:51, 17.47s/it]Epoch:   64
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  478
Criterion check: 
Mean:  tensor(3.7469, device='cuda:0') 
Std:  tensor(99.1279, device='cuda:0') 
ABS Max:  tensor(2154.3911, device='cuda:0') 
ABS Min:  tensor(2.8038e-05, device='cuda:0')
Criterion check:  tensor([0.9946, 1.0001, 0.9996, 1.0000, 1.0000, 0.9999, 1.0022, 0.9995, 1.0856,
        1.0197], device='cuda:0') tensor(143, device='cuda:0')
max of Lambda2 tensor(58932.6133, device='cuda:0')
min of Lambda2 tensor(1.1590e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1810, device='cuda:0')
min of grad d_p:  tensor(-0.1104, device='cuda:0')
max|min: (J_L, Jta/N)  (0.18104064464569092, 0.1810407191514969, ratio: 1.0000003576278687)|(-0.11039399355649948, -0.11039398610591888)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.9605e-08, device='cuda:0') mean:  tensor(-3.2726e-12, device='cuda:0') min:  tensor(-7.4506e-08, device='cuda:0') norm:  tensor(5.7109e-07, device='cuda:0') MSE:  tensor(7.1962e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(3.2421e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0058, device='cuda:0') MSE:  tensor(7.3670e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0577, device='cuda:0')
min of d_p_list:  tensor(-0.0422, device='cuda:0')
Epoch:  64  
Training Loss: 0.23632775247097015
Test Loss:  0.24967744946479797
Test Acc:  0.0
Valid Loss:  0.20408287644386292
Valid Acc:  0.0
std:  0.2089420871638979 
thres:  0.00029500371813774107
Preserved_eigens number check:  512
  6%|▋         | 64/1000 [20:25<4:32:52, 17.49s/it]Epoch:   65
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  475
Criterion check: 
Mean:  tensor(-0.8081, device='cuda:0') 
Std:  tensor(15.3838, device='cuda:0') 
ABS Max:  tensor(191.0739, device='cuda:0') 
ABS Min:  tensor(0.0001, device='cuda:0')
Criterion check:  tensor([0.9982, 0.9997, 1.0022, 1.0000, 1.0018, 0.9992, 1.0037, 0.9974, 0.8513,
        0.9995], device='cuda:0') tensor(145, device='cuda:0')
max of Lambda2 tensor(58693.6680, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1598, device='cuda:0')
min of grad d_p:  tensor(-0.1606, device='cuda:0')
max|min: (J_L, Jta/N)  (0.1598426252603531, 0.1598426252603531, ratio: 1.0)|(-0.1605818122625351, -0.16058184206485748)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.9407e-08, device='cuda:0') mean:  tensor(9.8112e-12, device='cuda:0') min:  tensor(-8.9407e-08, device='cuda:0') norm:  tensor(8.2222e-07, device='cuda:0') MSE:  tensor(1.0361e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(3.2542e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0075, device='cuda:0') MSE:  tensor(9.4100e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0316, device='cuda:0')
min of d_p_list:  tensor(-0.0339, device='cuda:0')
Epoch:  65  
Training Loss: 0.106707364320755
Test Loss:  0.11413665115833282
Test Acc:  0.0
Valid Loss:  0.09035191684961319
Valid Acc:  0.0
std:  0.20936069831761342 
thres:  0.0002945352464914322
Preserved_eigens number check:  512
  6%|▋         | 65/1000 [20:43<4:33:54, 17.58s/it]Epoch:   66
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  477
Criterion check: 
Mean:  tensor(9.8229, device='cuda:0') 
Std:  tensor(312.7497, device='cuda:0') 
ABS Max:  tensor(6751.2671, device='cuda:0') 
ABS Min:  tensor(0.0070, device='cuda:0')
Criterion check:  tensor([0.9941, 0.9993, 1.0414, 0.9999, 0.9927, 0.9988, 1.0002, 1.0076, 1.0399,
        1.0195], device='cuda:0') tensor(175, device='cuda:0')
max of Lambda2 tensor(59881.2969, device='cuda:0')
min of Lambda2 tensor(1.3252e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0972, device='cuda:0')
min of grad d_p:  tensor(-0.0894, device='cuda:0')
max|min: (J_L, Jta/N)  (0.09723404049873352, 0.09723410755395889, ratio: 1.0000007152557373)|(-0.08939428627490997, -0.08939425647258759)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.2352e-08, device='cuda:0') mean:  tensor(-1.4733e-11, device='cuda:0') min:  tensor(-8.1956e-08, device='cuda:0') norm:  tensor(6.4248e-07, device='cuda:0') MSE:  tensor(8.0958e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0007, device='cuda:0') mean:  tensor(8.6912e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0164, device='cuda:0') MSE:  tensor(2.0713e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0435, device='cuda:0')
min of d_p_list:  tensor(-0.0367, device='cuda:0')
Epoch:  66  
Training Loss: 0.10172451287508011
Test Loss:  0.10942912101745605
Test Acc:  0.0
Valid Loss:  0.09006764739751816
Valid Acc:  0.0
std:  0.12925615724571698 
thres:  0.00018787860125303268
Preserved_eigens number check:  512
  7%|▋         | 66/1000 [21:00<4:32:26, 17.50s/it]Epoch:   67
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  473
Criterion check: 
Mean:  tensor(24.0963, device='cuda:0') 
Std:  tensor(730.0068, device='cuda:0') 
ABS Max:  tensor(14028.0840, device='cuda:0') 
ABS Min:  tensor(0.0018, device='cuda:0')
Criterion check:  tensor([1.0040, 0.9956, 0.9066, 0.9983, 0.9163, 0.9971, 1.0393, 1.0777, 1.1104,
        1.1766], device='cuda:0') tensor(227, device='cuda:0')
max of Lambda2 tensor(60185.2109, device='cuda:0')
min of Lambda2 tensor(3.2111e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0968, device='cuda:0')
min of grad d_p:  tensor(-0.0919, device='cuda:0')
max|min: (J_L, Jta/N)  (0.09682319313287735, 0.09682322293519974, ratio: 1.0000003576278687)|(-0.09191323816776276, -0.09191324561834335)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.9802e-08, device='cuda:0') mean:  tensor(-1.2016e-11, device='cuda:0') min:  tensor(-5.9605e-08, device='cuda:0') norm:  tensor(5.1283e-07, device='cuda:0') MSE:  tensor(6.4620e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0027, device='cuda:0') mean:  tensor(3.7550e-05, device='cuda:0') min:  tensor(6.7779e-14, device='cuda:0') norm:  tensor(0.0651, device='cuda:0') MSE:  tensor(8.2067e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1916, device='cuda:0')
min of d_p_list:  tensor(-0.1589, device='cuda:0')
Epoch:  67  
Training Loss: 0.6361350417137146
Test Loss:  0.6716030836105347
Test Acc:  0.0
Valid Loss:  0.5736064910888672
Valid Acc:  0.0
std:  0.2040979626921711 
thres:  0.0003003154262900353
Preserved_eigens number check:  512
  7%|▋         | 67/1000 [21:17<4:31:49, 17.48s/it]Epoch:   68
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  475
Criterion check: 
Mean:  tensor(33.7116, device='cuda:0') 
Std:  tensor(518.1770, device='cuda:0') 
ABS Max:  tensor(8901.5830, device='cuda:0') 
ABS Min:  tensor(0.0009, device='cuda:0')
Criterion check:  tensor([1.0000, 0.9998, 1.0001, 1.0000, 0.9998, 1.0001, 1.0021, 1.0006, 1.0038,
        0.9884], device='cuda:0') tensor(176, device='cuda:0')
max of Lambda2 tensor(62284.9453, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2305, device='cuda:0')
min of grad d_p:  tensor(-0.2670, device='cuda:0')
max|min: (J_L, Jta/N)  (0.23052620887756348, 0.23052619397640228, ratio: 0.9999999403953552)|(-0.266970157623291, -0.266970157623291)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.1921e-07, device='cuda:0') mean:  tensor(-1.9377e-13, device='cuda:0') min:  tensor(-1.1921e-07, device='cuda:0') norm:  tensor(8.8819e-07, device='cuda:0') MSE:  tensor(1.1192e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(3.7526e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0068, device='cuda:0') MSE:  tensor(8.5505e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0350, device='cuda:0')
min of d_p_list:  tensor(-0.0429, device='cuda:0')
Epoch:  68  
Training Loss: 0.2352028638124466
Test Loss:  0.24746456742286682
Test Acc:  0.0
Valid Loss:  0.20785605907440186
Valid Acc:  0.0
std:  0.19552533274305928 
thres:  0.0002632195070385933
Preserved_eigens number check:  512
  7%|▋         | 68/1000 [21:35<4:32:16, 17.53s/it]Epoch:   69
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  480
Criterion check: 
Mean:  tensor(-16.6058, device='cuda:0') 
Std:  tensor(237.1290, device='cuda:0') 
ABS Max:  tensor(4325.5977, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([0.9991, 1.0007, 0.9986, 1.0002, 1.0003, 0.9998, 0.9993, 0.9958, 1.0423,
        1.0305], device='cuda:0') tensor(206, device='cuda:0')
max of Lambda2 tensor(61175.1719, device='cuda:0')
min of Lambda2 tensor(5.1085e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1447, device='cuda:0')
min of grad d_p:  tensor(-0.1613, device='cuda:0')
max|min: (J_L, Jta/N)  (0.14472942054271698, 0.1447293907403946, ratio: 0.9999998211860657)|(-0.16133451461791992, -0.16133444011211395)

 check Jacobi res:  torch.Size([793601]) max:  tensor(6.7055e-08, device='cuda:0') mean:  tensor(-1.6659e-11, device='cuda:0') min:  tensor(-1.1921e-07, device='cuda:0') norm:  tensor(7.6422e-07, device='cuda:0') MSE:  tensor(9.6298e-13, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0009, device='cuda:0') mean:  tensor(1.5366e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0264, device='cuda:0') MSE:  tensor(3.3208e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(2.0096, device='cuda:0')
min of d_p_list:  tensor(-1.7290, device='cuda:0')
Epoch:  69  
Training Loss: 2042.0035400390625
Test Loss:  2093.0732421875
Test Acc:  0.0
Valid Loss:  2176.6103515625
Valid Acc:  0.0
std:  816.6934623321179 
thres:  0.4086166619643569
Preserved_eigens number check:  512
  7%|▋         | 69/1000 [21:52<4:29:51, 17.39s/it]Epoch:   70
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  506
Criterion check: 
Mean:  tensor(-4.6830, device='cuda:0') 
Std:  tensor(308.4175, device='cuda:0') 
ABS Max:  tensor(5054.8213, device='cuda:0') 
ABS Min:  tensor(0.0045, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0000, 1.0000, 0.9994, 1.0002, 0.9984, 0.9999, 1.0020,
        0.9977], device='cuda:0') tensor(227, device='cuda:0')
max of Lambda2 tensor(138075.6406, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(2.4380, device='cuda:0')
min of grad d_p:  tensor(-4.0801, device='cuda:0')
max|min: (J_L, Jta/N)  (2.43796968460083, 2.437969207763672, ratio: 0.9999998211860657)|(-4.080136299133301, -4.080134391784668)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.6689e-06, device='cuda:0') mean:  tensor(-1.8388e-10, device='cuda:0') min:  tensor(-1.9073e-06, device='cuda:0') norm:  tensor(2.1104e-05, device='cuda:0') MSE:  tensor(2.6593e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0022, device='cuda:0') mean:  tensor(2.7566e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0528, device='cuda:0') MSE:  tensor(6.6504e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0515, device='cuda:0')
min of d_p_list:  tensor(-0.0692, device='cuda:0')
Epoch:  70  
Training Loss: 19.63878631591797
Test Loss:  22.29245376586914
Test Acc:  0.0
Valid Loss:  21.353031158447266
Valid Acc:  0.0
std:  814.7745898584623 
thres:  0.4125230777546764
Preserved_eigens number check:  512
  7%|▋         | 70/1000 [22:09<4:29:19, 17.38s/it]Epoch:   71
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  505
Criterion check: 
Mean:  tensor(-5.2538, device='cuda:0') 
Std:  tensor(131.1436, device='cuda:0') 
ABS Max:  tensor(2944.1057, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0001, 1.0008, 0.9979,
        1.0000], device='cuda:0') tensor(184, device='cuda:0')
max of Lambda2 tensor(134518.1406, device='cuda:0')
min of Lambda2 tensor(1.3051e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.4035, device='cuda:0')
min of grad d_p:  tensor(-2.3591, device='cuda:0')
max|min: (J_L, Jta/N)  (1.4034935235977173, 1.4034934043884277, ratio: 0.9999999403953552)|(-2.3591036796569824, -2.3591039180755615)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.0729e-06, device='cuda:0') mean:  tensor(-2.3984e-11, device='cuda:0') min:  tensor(-1.0729e-06, device='cuda:0') norm:  tensor(1.1193e-05, device='cuda:0') MSE:  tensor(1.4104e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(4.3369e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0085, device='cuda:0') MSE:  tensor(1.0734e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0916, device='cuda:0')
min of d_p_list:  tensor(-0.1375, device='cuda:0')
Epoch:  71  
Training Loss: 3.1981325149536133
Test Loss:  3.563774585723877
Test Acc:  0.0
Valid Loss:  3.134596824645996
Valid Acc:  0.0
std:  814.4620042742727 
thres:  0.413142359355092
Preserved_eigens number check:  512
  7%|▋         | 71/1000 [22:27<4:30:29, 17.47s/it]Epoch:   72
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  505
Criterion check: 
Mean:  tensor(-14.7812, device='cuda:0') 
Std:  tensor(380.4603, device='cuda:0') 
ABS Max:  tensor(8575.0215, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0002, 1.0001, 1.0001, 1.0002, 0.9999,
        0.9996], device='cuda:0') tensor(189, device='cuda:0')
max of Lambda2 tensor(134420.0312, device='cuda:0')
min of Lambda2 tensor(1.5463e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.7681, device='cuda:0')
min of grad d_p:  tensor(-1.3220, device='cuda:0')
max|min: (J_L, Jta/N)  (0.7680741548538208, 0.768074095249176, ratio: 0.9999999403953552)|(-1.3220007419586182, -1.3220006227493286)

 check Jacobi res:  torch.Size([793601]) max:  tensor(7.1526e-07, device='cuda:0') mean:  tensor(1.7738e-11, device='cuda:0') min:  tensor(-4.7684e-07, device='cuda:0') norm:  tensor(6.4130e-06, device='cuda:0') MSE:  tensor(8.0809e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(5.7216e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0103, device='cuda:0') MSE:  tensor(1.2970e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0574, device='cuda:0')
min of d_p_list:  tensor(-0.0494, device='cuda:0')
Epoch:  72  
Training Loss: 1.1081187725067139
Test Loss:  1.131089687347412
Test Acc:  0.0
Valid Loss:  1.0584460496902466
Valid Acc:  0.0
std:  814.4142149783225 
thres:  0.41323675610125066
Preserved_eigens number check:  512
  7%|▋         | 72/1000 [22:45<4:29:32, 17.43s/it]Epoch:   73
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  507
Criterion check: 
Mean:  tensor(-23.2959, device='cuda:0') 
Std:  tensor(690.7928, device='cuda:0') 
ABS Max:  tensor(15166.8330, device='cuda:0') 
ABS Min:  tensor(0.0014, device='cuda:0')
Criterion check:  tensor([1.0001, 1.0000, 1.0008, 1.0003, 0.9990, 1.0001, 0.9985, 1.0038, 0.9983,
        0.9915], device='cuda:0') tensor(233, device='cuda:0')
max of Lambda2 tensor(128635.5703, device='cuda:0')
min of Lambda2 tensor(8.9499e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.4778, device='cuda:0')
min of grad d_p:  tensor(-0.7878, device='cuda:0')
max|min: (J_L, Jta/N)  (0.477803111076355, 0.4778028130531311, ratio: 0.9999994039535522)|(-0.78778076171875, -0.7877806425094604)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.3644e-07, device='cuda:0') mean:  tensor(-2.6172e-11, device='cuda:0') min:  tensor(-3.5763e-07, device='cuda:0') norm:  tensor(4.4170e-06, device='cuda:0') MSE:  tensor(5.5658e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0050, device='cuda:0') mean:  tensor(4.2821e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0789, device='cuda:0') MSE:  tensor(9.9448e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0276, device='cuda:0')
min of d_p_list:  tensor(-0.0184, device='cuda:0')
Epoch:  73  
Training Loss: 0.41011470556259155
Test Loss:  0.39985692501068115
Test Acc:  0.0
Valid Loss:  0.3969264030456543
Valid Acc:  0.0
std:  814.396477711497 
thres:  0.4132717384696007
Preserved_eigens number check:  512
  7%|▋         | 73/1000 [23:02<4:29:23, 17.44s/it]Epoch:   74
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  506
Criterion check: 
Mean:  tensor(-8.1173, device='cuda:0') 
Std:  tensor(129.4595, device='cuda:0') 
ABS Max:  tensor(2152.9932, device='cuda:0') 
ABS Min:  tensor(5.2380e-05, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0016, 1.0000, 0.9999, 1.0004, 1.0001,
        0.9975], device='cuda:0') tensor(175, device='cuda:0')
max of Lambda2 tensor(121302.2656, device='cuda:0')
min of Lambda2 tensor(7.0683e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2616, device='cuda:0')
min of grad d_p:  tensor(-0.4338, device='cuda:0')
max|min: (J_L, Jta/N)  (0.261597603559494, 0.26159754395484924, ratio: 0.9999997615814209)|(-0.4337964653968811, -0.4337965250015259)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.6391e-07, device='cuda:0') mean:  tensor(-1.0738e-11, device='cuda:0') min:  tensor(-3.2783e-07, device='cuda:0') norm:  tensor(3.2505e-06, device='cuda:0') MSE:  tensor(4.0958e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(2.8681e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0054, device='cuda:0') MSE:  tensor(6.8661e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0193, device='cuda:0')
min of d_p_list:  tensor(-0.0448, device='cuda:0')
Epoch:  74  
Training Loss: 0.18452098965644836
Test Loss:  0.15926408767700195
Test Acc:  0.0
Valid Loss:  0.1916525959968567
Valid Acc:  0.0
std:  7.441787899509586 
thres:  0.0049079346597194675
Preserved_eigens number check:  512
  7%|▋         | 74/1000 [23:20<4:29:33, 17.47s/it]Epoch:   75
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  507
Criterion check: 
Mean:  tensor(0.7685, device='cuda:0') 
Std:  tensor(342.5117, device='cuda:0') 
ABS Max:  tensor(3910.1567, device='cuda:0') 
ABS Min:  tensor(0.0012, device='cuda:0')
Criterion check:  tensor([1.0006, 0.9998, 1.0009, 1.0003, 1.2951, 1.0000, 1.0009, 0.9980, 0.9990,
        0.9933], device='cuda:0') tensor(234, device='cuda:0')
max of Lambda2 tensor(121518.6484, device='cuda:0')
min of Lambda2 tensor(1.0500e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1621, device='cuda:0')
min of grad d_p:  tensor(-0.2687, device='cuda:0')
max|min: (J_L, Jta/N)  (0.16205675899982452, 0.1620568186044693, ratio: 1.0000003576278687)|(-0.2686825394630432, -0.2686828076839447)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.8312e-07, device='cuda:0') mean:  tensor(6.3633e-11, device='cuda:0') min:  tensor(-1.4901e-07, device='cuda:0') norm:  tensor(2.7524e-06, device='cuda:0') MSE:  tensor(3.4682e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0016, device='cuda:0') mean:  tensor(2.9916e-05, device='cuda:0') min:  tensor(1.0100e-14, device='cuda:0') norm:  tensor(0.0562, device='cuda:0') MSE:  tensor(7.0759e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(3.5867, device='cuda:0')
min of d_p_list:  tensor(-2.5166, device='cuda:0')
Epoch:  75  
Training Loss: 16334.5205078125
Test Loss:  18601.8828125
Test Acc:  0.0
Valid Loss:  19189.724609375
Valid Acc:  0.0
std:  6533.3182009608245 
thres:  3.267884278959036
Preserved_eigens number check:  512
  8%|▊         | 75/1000 [23:37<4:31:32, 17.61s/it]Epoch:   76
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  505
Criterion check: 
Mean:  tensor(360.4343, device='cuda:0') 
Std:  tensor(8999.8301, device='cuda:0') 
ABS Max:  tensor(202718.1406, device='cuda:0') 
ABS Min:  tensor(0.0151, device='cuda:0')
Criterion check:  tensor([1.0001, 1.0000, 1.0002, 1.0000, 1.0000, 1.0001, 1.0001, 1.0000, 0.9942,
        1.0027], device='cuda:0') tensor(262, device='cuda:0')
max of Lambda2 tensor(130746.1719, device='cuda:0')
min of Lambda2 tensor(2.3911e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(4.4417, device='cuda:0')
min of grad d_p:  tensor(-8.1638, device='cuda:0')
max|min: (J_L, Jta/N)  (4.441701889038086, 4.441701889038086, ratio: 1.0)|(-8.163782119750977, -8.163782119750977)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.9073e-06, device='cuda:0') mean:  tensor(1.6284e-10, device='cuda:0') min:  tensor(-3.3379e-06, device='cuda:0') norm:  tensor(2.4540e-05, device='cuda:0') MSE:  tensor(3.0923e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0023, device='cuda:0') mean:  tensor(1.6878e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0317, device='cuda:0') MSE:  tensor(3.9970e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.2440, device='cuda:0')
min of d_p_list:  tensor(-0.1658, device='cuda:0')
Epoch:  76  
Training Loss: 17.13117218017578
Test Loss:  18.45842742919922
Test Acc:  0.0
Valid Loss:  17.16910171508789
Valid Acc:  0.0
std:  6531.927967691616 
thres:  3.2706708868920806
Preserved_eigens number check:  512
  8%|▊         | 76/1000 [23:55<4:31:06, 17.60s/it]Epoch:   77
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  498
Criterion check: 
Mean:  tensor(2.3229, device='cuda:0') 
Std:  tensor(38.5132, device='cuda:0') 
ABS Max:  tensor(512.5164, device='cuda:0') 
ABS Min:  tensor(0.0008, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 0.9997, 1.0008,
        0.9993], device='cuda:0') tensor(225, device='cuda:0')
max of Lambda2 tensor(96006.3906, device='cuda:0')
min of Lambda2 tensor(9.1219e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(2.3714, device='cuda:0')
min of grad d_p:  tensor(-4.2451, device='cuda:0')
max|min: (J_L, Jta/N)  (2.3713836669921875, 2.3713841438293457, ratio: 1.000000238418579)|(-4.245099067687988, -4.245098114013672)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.6689e-06, device='cuda:0') mean:  tensor(3.2010e-11, device='cuda:0') min:  tensor(-1.4305e-06, device='cuda:0') norm:  tensor(1.1429e-05, device='cuda:0') MSE:  tensor(1.4402e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0010, device='cuda:0') mean:  tensor(1.0902e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0211, device='cuda:0') MSE:  tensor(2.6553e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0935, device='cuda:0')
min of d_p_list:  tensor(-0.1362, device='cuda:0')
Epoch:  77  
Training Loss: 4.908019065856934
Test Loss:  5.427661895751953
Test Acc:  0.0
Valid Loss:  4.661507606506348
Valid Acc:  0.0
std:  6531.547724726659 
thres:  3.2714308669507504
Preserved_eigens number check:  512
  8%|▊         | 77/1000 [24:13<4:30:52, 17.61s/it]Epoch:   78
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  502
Criterion check: 
Mean:  tensor(-4.2270, device='cuda:0') 
Std:  tensor(191.3031, device='cuda:0') 
ABS Max:  tensor(3454.5063, device='cuda:0') 
ABS Min:  tensor(0.0023, device='cuda:0')
Criterion check:  tensor([1.0003, 1.0000, 1.0000, 1.0000, 1.0000, 1.0001, 1.0000, 0.9999, 1.0137,
        1.0024], device='cuda:0') tensor(182, device='cuda:0')
max of Lambda2 tensor(105557.2656, device='cuda:0')
min of Lambda2 tensor(2.1216e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.2737, device='cuda:0')
min of grad d_p:  tensor(-2.2951, device='cuda:0')
max|min: (J_L, Jta/N)  (1.2737162113189697, 1.273716688156128, ratio: 1.0000003576278687)|(-2.295098066329956, -2.2950985431671143)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.0729e-06, device='cuda:0') mean:  tensor(9.8816e-11, device='cuda:0') min:  tensor(-1.0729e-06, device='cuda:0') norm:  tensor(7.5022e-06, device='cuda:0') MSE:  tensor(9.4533e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0013, device='cuda:0') mean:  tensor(8.6416e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0175, device='cuda:0') MSE:  tensor(2.2057e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1118, device='cuda:0')
min of d_p_list:  tensor(-0.0824, device='cuda:0')
Epoch:  78  
Training Loss: 2.43674373626709
Test Loss:  2.7133076190948486
Test Acc:  0.0
Valid Loss:  2.411273956298828
Valid Acc:  0.0
std:  6531.344783372824 
thres:  3.2718361927568913
Preserved_eigens number check:  512
  8%|▊         | 78/1000 [24:30<4:28:28, 17.47s/it]Epoch:   79
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  500
Criterion check: 
Mean:  tensor(-2.2190, device='cuda:0') 
Std:  tensor(152.6833, device='cuda:0') 
ABS Max:  tensor(2854.0830, device='cuda:0') 
ABS Min:  tensor(0.0001, device='cuda:0')
Criterion check:  tensor([1.0001, 1.0000, 1.0000, 1.0000, 1.0001, 1.0000, 1.0000, 1.0001, 1.0007,
        0.9977], device='cuda:0') tensor(192, device='cuda:0')
max of Lambda2 tensor(99040.5000, device='cuda:0')
min of Lambda2 tensor(1.6793e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.6904, device='cuda:0')
min of grad d_p:  tensor(-1.2155, device='cuda:0')
max|min: (J_L, Jta/N)  (0.6903759241104126, 0.6903756260871887, ratio: 0.9999995827674866)|(-1.2154592275619507, -1.2154593467712402)

 check Jacobi res:  torch.Size([793601]) max:  tensor(6.5565e-07, device='cuda:0') mean:  tensor(1.9714e-11, device='cuda:0') min:  tensor(-4.7684e-07, device='cuda:0') norm:  tensor(4.7859e-06, device='cuda:0') MSE:  tensor(6.0307e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0011, device='cuda:0') mean:  tensor(5.6639e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0115, device='cuda:0') MSE:  tensor(1.4519e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0513, device='cuda:0')
min of d_p_list:  tensor(-0.0751, device='cuda:0')
Epoch:  79  
Training Loss: 1.4820666313171387
Test Loss:  1.6456992626190186
Test Acc:  0.0
Valid Loss:  1.4971141815185547
Valid Acc:  0.0
std:  6531.214810563519 
thres:  3.2720957018852235
Preserved_eigens number check:  512
  8%|▊         | 79/1000 [24:47<4:28:35, 17.50s/it]Epoch:   80
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  499
Criterion check: 
Mean:  tensor(-3.7874, device='cuda:0') 
Std:  tensor(79.4375, device='cuda:0') 
ABS Max:  tensor(1786.1160, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([1.0001, 0.9999, 1.0000, 1.0000, 1.0001, 1.0001, 1.0000, 0.9999, 0.9996,
        1.0003], device='cuda:0') tensor(174, device='cuda:0')
max of Lambda2 tensor(101295.4219, device='cuda:0')
min of Lambda2 tensor(9.1800e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3588, device='cuda:0')
min of grad d_p:  tensor(-0.6302, device='cuda:0')
max|min: (J_L, Jta/N)  (0.3588099479675293, 0.3588098883628845, ratio: 0.9999998211860657)|(-0.6302201747894287, -0.6302202939987183)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.9605e-07, device='cuda:0') mean:  tensor(4.9447e-12, device='cuda:0') min:  tensor(-2.3842e-07, device='cuda:0') norm:  tensor(2.9185e-06, device='cuda:0') MSE:  tensor(3.6776e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(3.8500e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0070, device='cuda:0') MSE:  tensor(8.8665e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0438, device='cuda:0')
min of d_p_list:  tensor(-0.0620, device='cuda:0')
Epoch:  80  
Training Loss: 0.6558433771133423
Test Loss:  0.7391170263290405
Test Acc:  0.0
Valid Loss:  0.6848520636558533
Valid Acc:  0.0
std:  6.074055226135568 
thres:  0.005322768998146057
Preserved_eigens number check:  512
  8%|▊         | 80/1000 [25:05<4:28:36, 17.52s/it]Epoch:   81
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  501
Criterion check: 
Mean:  tensor(-199.3184, device='cuda:0') 
Std:  tensor(3706.4910, device='cuda:0') 
ABS Max:  tensor(77942.6016, device='cuda:0') 
ABS Min:  tensor(0.0196, device='cuda:0')
Criterion check:  tensor([0.9990, 0.9990, 1.0013, 1.0025, 1.0028, 1.0009, 0.9969, 0.9919, 1.0030,
        1.1306], device='cuda:0') tensor(245, device='cuda:0')
max of Lambda2 tensor(106920.2734, device='cuda:0')
min of Lambda2 tensor(2.2945e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1909, device='cuda:0')
min of grad d_p:  tensor(-0.3315, device='cuda:0')
max|min: (J_L, Jta/N)  (0.19085516035556793, 0.19085535407066345, ratio: 1.000001072883606)|(-0.33153441548347473, -0.3315342664718628)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.9372e-07, device='cuda:0') mean:  tensor(-2.8708e-11, device='cuda:0') min:  tensor(-2.2352e-07, device='cuda:0') norm:  tensor(2.3962e-06, device='cuda:0') MSE:  tensor(3.0194e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0091, device='cuda:0') mean:  tensor(7.6910e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1438, device='cuda:0') MSE:  tensor(1.8115e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0441, device='cuda:0')
min of d_p_list:  tensor(-0.0751, device='cuda:0')
Epoch:  81  
Training Loss: 0.34340083599090576
Test Loss:  0.39991405606269836
Test Acc:  0.0
Valid Loss:  0.3935258090496063
Valid Acc:  0.0
std:  1.6407682770404624 
thres:  0.001965214729309082
Preserved_eigens number check:  512
  8%|▊         | 81/1000 [25:23<4:28:57, 17.56s/it]Epoch:   82
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  498
Criterion check: 
Mean:  tensor(-12.9292, device='cuda:0') 
Std:  tensor(256.7605, device='cuda:0') 
ABS Max:  tensor(5655.3501, device='cuda:0') 
ABS Min:  tensor(0.0004, device='cuda:0')
Criterion check:  tensor([0.9995, 1.0001, 0.9999, 1.0042, 1.0000, 1.0013, 0.9999, 1.0002, 1.0019,
        0.9983], device='cuda:0') tensor(174, device='cuda:0')
max of Lambda2 tensor(102058.3828, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0872, device='cuda:0')
min of grad d_p:  tensor(-0.1614, device='cuda:0')
max|min: (J_L, Jta/N)  (0.08720473945140839, 0.08720481395721436, ratio: 1.0000008344650269)|(-0.1613970398902893, -0.1613970845937729)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.4901e-07, device='cuda:0') mean:  tensor(-2.2412e-12, device='cuda:0') min:  tensor(-8.9407e-08, device='cuda:0') norm:  tensor(1.3935e-06, device='cuda:0') MSE:  tensor(1.7559e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0007, device='cuda:0') mean:  tensor(3.5101e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0068, device='cuda:0') MSE:  tensor(8.5732e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0181, device='cuda:0')
min of d_p_list:  tensor(-0.0249, device='cuda:0')
Epoch:  82  
Training Loss: 0.15885838866233826
Test Loss:  0.18689265847206116
Test Acc:  0.0
Valid Loss:  0.1795310080051422
Valid Acc:  0.0
std:  0.8429143649670716 
thres:  0.0010153825938701631
Preserved_eigens number check:  512
  8%|▊         | 82/1000 [25:40<4:26:47, 17.44s/it]Epoch:   83
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  497
Criterion check: 
Mean:  tensor(-0.7467, device='cuda:0') 
Std:  tensor(27.5460, device='cuda:0') 
ABS Max:  tensor(254.6730, device='cuda:0') 
ABS Min:  tensor(0.0012, device='cuda:0')
Criterion check:  tensor([1.0082, 1.0006, 0.9975, 1.0025, 0.9998, 1.0007, 1.0005, 1.0005, 1.0003,
        1.0068], device='cuda:0') tensor(194, device='cuda:0')
max of Lambda2 tensor(99217.2969, device='cuda:0')
min of Lambda2 tensor(8.3414e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0466, device='cuda:0')
min of grad d_p:  tensor(-0.0843, device='cuda:0')
max|min: (J_L, Jta/N)  (0.0465846061706543, 0.04658478498458862, ratio: 1.0000038146972656)|(-0.08430041372776031, -0.08430057764053345)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.8801e-07, device='cuda:0') mean:  tensor(2.3438e-11, device='cuda:0') min:  tensor(-2.3842e-07, device='cuda:0') norm:  tensor(4.4388e-06, device='cuda:0') MSE:  tensor(5.5932e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0007, device='cuda:0') mean:  tensor(5.5454e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0110, device='cuda:0') MSE:  tensor(1.3850e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0703, device='cuda:0')
min of d_p_list:  tensor(-0.0905, device='cuda:0')
Epoch:  83  
Training Loss: 0.28242695331573486
Test Loss:  0.31410282850265503
Test Acc:  0.0
Valid Loss:  0.30037635564804077
Valid Acc:  0.0
std:  0.4777579820333068 
thres:  0.000584519237279892
Preserved_eigens number check:  512
  8%|▊         | 83/1000 [25:57<4:26:44, 17.45s/it]Epoch:   84
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  500
Criterion check: 
Mean:  tensor(6.9428, device='cuda:0') 
Std:  tensor(182.0870, device='cuda:0') 
ABS Max:  tensor(3650.5605, device='cuda:0') 
ABS Min:  tensor(0.0055, device='cuda:0')
Criterion check:  tensor([1.0065, 1.0046, 1.0000, 1.0008, 1.0012, 1.0017, 0.9997, 1.0001, 0.9983,
        1.0010], device='cuda:0') tensor(193, device='cuda:0')
max of Lambda2 tensor(107597.7734, device='cuda:0')
min of Lambda2 tensor(1.9276e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0464, device='cuda:0')
min of grad d_p:  tensor(-0.0571, device='cuda:0')
max|min: (J_L, Jta/N)  (0.0463874414563179, 0.0463874526321888, ratio: 1.000000238418579)|(-0.057149630039930344, -0.05714971572160721)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.5274e-07, device='cuda:0') mean:  tensor(-9.1390e-12, device='cuda:0') min:  tensor(-9.4529e-08, device='cuda:0') norm:  tensor(1.8490e-06, device='cuda:0') MSE:  tensor(2.3299e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0036, device='cuda:0') mean:  tensor(2.0625e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0439, device='cuda:0') MSE:  tensor(5.5365e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1138, device='cuda:0')
min of d_p_list:  tensor(-0.0689, device='cuda:0')
Epoch:  84  
Training Loss: 0.1316363662481308
Test Loss:  0.14514347910881042
Test Acc:  0.0
Valid Loss:  0.12205834686756134
Valid Acc:  0.0
std:  0.1876393546944434 
thres:  0.0003144331842660904
Preserved_eigens number check:  512
  8%|▊         | 84/1000 [26:14<4:25:21, 17.38s/it]Epoch:   85
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  499
Criterion check: 
Mean:  tensor(-0.8188, device='cuda:0') 
Std:  tensor(13.0536, device='cuda:0') 
ABS Max:  tensor(173.3111, device='cuda:0') 
ABS Min:  tensor(1.1614e-05, device='cuda:0')
Criterion check:  tensor([0.9985, 1.0039, 0.9993, 1.0001, 0.9998, 0.9998, 1.0000, 1.0001, 1.0007,
        1.0003], device='cuda:0') tensor(158, device='cuda:0')
max of Lambda2 tensor(124007.0859, device='cuda:0')
min of Lambda2 tensor(3.7506e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0527, device='cuda:0')
min of grad d_p:  tensor(-0.0388, device='cuda:0')
max|min: (J_L, Jta/N)  (0.05271344631910324, 0.05271347984671593, ratio: 1.0000005960464478)|(-0.03883805871009827, -0.038837991654872894)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.6135e-07, device='cuda:0') mean:  tensor(6.3545e-11, device='cuda:0') min:  tensor(-2.5518e-07, device='cuda:0') norm:  tensor(5.3888e-06, device='cuda:0') MSE:  tensor(6.7904e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(2.5246e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0050, device='cuda:0') MSE:  tensor(6.2689e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0523, device='cuda:0')
min of d_p_list:  tensor(-0.0490, device='cuda:0')
Epoch:  85  
Training Loss: 0.0698433369398117
Test Loss:  0.07924944162368774
Test Acc:  0.0
Valid Loss:  0.06565985828638077
Valid Acc:  0.0
std:  0.10062474980754428 
thres:  0.00019723317623138428
Preserved_eigens number check:  512
  8%|▊         | 85/1000 [26:32<4:25:26, 17.41s/it]Epoch:   86
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  500
Criterion check: 
Mean:  tensor(0.8794, device='cuda:0') 
Std:  tensor(44.7425, device='cuda:0') 
ABS Max:  tensor(860.0849, device='cuda:0') 
ABS Min:  tensor(0.0008, device='cuda:0')
Criterion check:  tensor([1.0030, 1.0014, 0.9975, 1.0021, 1.0001, 1.0010, 0.9998, 1.0003, 1.0162,
        0.9982], device='cuda:0') tensor(191, device='cuda:0')
max of Lambda2 tensor(103876.1953, device='cuda:0')
min of Lambda2 tensor(1.5174e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0370, device='cuda:0')
min of grad d_p:  tensor(-0.0214, device='cuda:0')
max|min: (J_L, Jta/N)  (0.03702762350440025, 0.037027567625045776, ratio: 0.9999985098838806)|(-0.0214389655739069, -0.02143894135951996)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.3248e-07, device='cuda:0') mean:  tensor(-3.7366e-11, device='cuda:0') min:  tensor(-2.4680e-07, device='cuda:0') norm:  tensor(2.0287e-06, device='cuda:0') MSE:  tensor(2.5564e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0007, device='cuda:0') mean:  tensor(3.5184e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0071, device='cuda:0') MSE:  tensor(8.9194e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0452, device='cuda:0')
min of d_p_list:  tensor(-0.0359, device='cuda:0')
Epoch:  86  
Training Loss: 0.01852940022945404
Test Loss:  0.021043069660663605
Test Acc:  0.0
Valid Loss:  0.017344869673252106
Valid Acc:  0.0
std:  0.08954157270473401 
thres:  0.00013225888907909394
Preserved_eigens number check:  512
  9%|▊         | 86/1000 [26:49<4:25:01, 17.40s/it]Epoch:   87
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  499
Criterion check: 
Mean:  tensor(6.0180, device='cuda:0') 
Std:  tensor(114.6472, device='cuda:0') 
ABS Max:  tensor(2371.5767, device='cuda:0') 
ABS Min:  tensor(0.0008, device='cuda:0')
Criterion check:  tensor([0.9984, 1.0030, 0.9950, 0.9996, 1.0030, 0.9998, 0.9965, 1.0000, 1.0018,
        0.9929], device='cuda:0') tensor(183, device='cuda:0')
max of Lambda2 tensor(107530.3203, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0183, device='cuda:0')
min of grad d_p:  tensor(-0.0232, device='cuda:0')
max|min: (J_L, Jta/N)  (0.01832463964819908, 0.018324678763747215, ratio: 1.000002145767212)|(-0.023178791627287865, -0.023178838193416595)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.3597e-07, device='cuda:0') mean:  tensor(2.5951e-11, device='cuda:0') min:  tensor(-9.3132e-08, device='cuda:0') norm:  tensor(1.2271e-06, device='cuda:0') MSE:  tensor(1.5462e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0007, device='cuda:0') mean:  tensor(5.5633e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0116, device='cuda:0') MSE:  tensor(1.4618e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0284, device='cuda:0')
min of d_p_list:  tensor(-0.0203, device='cuda:0')
Epoch:  87  
Training Loss: 0.013155559077858925
Test Loss:  0.014628494158387184
Test Acc:  0.0
Valid Loss:  0.012362643145024776
Valid Acc:  0.0
std:  0.09931834990746184 
thres:  0.00010311832316219808
Preserved_eigens number check:  512
  9%|▊         | 87/1000 [27:07<4:24:16, 17.37s/it]Epoch:   88
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  498
Criterion check: 
Mean:  tensor(-0.3090, device='cuda:0') 
Std:  tensor(13.5165, device='cuda:0') 
ABS Max:  tensor(120.1240, device='cuda:0') 
ABS Min:  tensor(0.0010, device='cuda:0')
Criterion check:  tensor([0.9996, 0.9999, 1.0167, 1.0009, 1.0018, 1.0006, 0.9984, 0.9996, 0.9957,
        0.9947], device='cuda:0') tensor(181, device='cuda:0')
max of Lambda2 tensor(103120.6172, device='cuda:0')
min of Lambda2 tensor(3.4053e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0139, device='cuda:0')
min of grad d_p:  tensor(-0.0176, device='cuda:0')
max|min: (J_L, Jta/N)  (0.013928337953984737, 0.01392834261059761, ratio: 1.0000003576278687)|(-0.017596101388335228, -0.017596108838915825)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.2480e-07, device='cuda:0') mean:  tensor(1.7350e-11, device='cuda:0') min:  tensor(-7.7300e-08, device='cuda:0') norm:  tensor(1.6733e-06, device='cuda:0') MSE:  tensor(2.1084e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(1.9318e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0039, device='cuda:0') MSE:  tensor(4.9104e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0573, device='cuda:0')
min of d_p_list:  tensor(-0.0855, device='cuda:0')
Epoch:  88  
Training Loss: 0.011672772467136383
Test Loss:  0.011782294139266014
Test Acc:  0.0
Valid Loss:  0.011099234223365784
Valid Acc:  0.0
std:  0.04662576915546009 
thres:  4.896748699247837e-05
Preserved_eigens number check:  512
  9%|▉         | 88/1000 [27:25<4:27:16, 17.58s/it]Epoch:   89
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  496
Criterion check: 
Mean:  tensor(-1.4276, device='cuda:0') 
Std:  tensor(43.0447, device='cuda:0') 
ABS Max:  tensor(592.8735, device='cuda:0') 
ABS Min:  tensor(1.1854e-05, device='cuda:0')
Criterion check:  tensor([1.0052, 1.0033, 0.9943, 1.0003, 1.0014, 0.9917, 1.0125, 0.9973, 0.9640,
        1.0128], device='cuda:0') tensor(175, device='cuda:0')
max of Lambda2 tensor(115664.4609, device='cuda:0')
min of Lambda2 tensor(3.5233e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0307, device='cuda:0')
min of grad d_p:  tensor(-0.0273, device='cuda:0')
max|min: (J_L, Jta/N)  (0.03074823133647442, 0.030748263001441956, ratio: 1.000001072883606)|(-0.027281804010272026, -0.027281800284981728)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.0513e-08, device='cuda:0') mean:  tensor(-9.2608e-12, device='cuda:0') min:  tensor(-5.2154e-08, device='cuda:0') norm:  tensor(8.2209e-07, device='cuda:0') MSE:  tensor(1.0359e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0030, device='cuda:0') mean:  tensor(9.2315e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0208, device='cuda:0') MSE:  tensor(2.6237e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0471, device='cuda:0')
min of d_p_list:  tensor(-0.0357, device='cuda:0')
Epoch:  89  
Training Loss: 0.006154223345220089
Test Loss:  0.0061860159039497375
Test Acc:  0.0
Valid Loss:  0.006799818482249975
Valid Acc:  0.0
std:  0.023321621109751247 
thres:  2.387105841189623e-05
Preserved_eigens number check:  512
  9%|▉         | 89/1000 [27:42<4:24:36, 17.43s/it]Epoch:   90
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  499
Criterion check: 
Mean:  tensor(6.8222, device='cuda:0') 
Std:  tensor(92.9419, device='cuda:0') 
ABS Max:  tensor(1954.4287, device='cuda:0') 
ABS Min:  tensor(2.5193e-05, device='cuda:0')
Criterion check:  tensor([0.9996, 1.0163, 0.9999, 1.0002, 1.0011, 0.9927, 1.0118, 1.0017, 0.9970,
        0.9542], device='cuda:0') tensor(172, device='cuda:0')
max of Lambda2 tensor(124595.0078, device='cuda:0')
min of Lambda2 tensor(2.9785e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0789, device='cuda:0')
min of grad d_p:  tensor(-0.0639, device='cuda:0')
max|min: (J_L, Jta/N)  (0.07885648310184479, 0.07885640859603882, ratio: 0.9999990463256836)|(-0.06394100934267044, -0.06394091993570328)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.1921e-07, device='cuda:0') mean:  tensor(3.5788e-12, device='cuda:0') min:  tensor(-9.6858e-08, device='cuda:0') norm:  tensor(1.7023e-06, device='cuda:0') MSE:  tensor(2.1450e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0010, device='cuda:0') mean:  tensor(6.0082e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0117, device='cuda:0') MSE:  tensor(1.4741e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0467, device='cuda:0')
min of d_p_list:  tensor(-0.0378, device='cuda:0')
Epoch:  90  
Training Loss: 0.010955835692584515
Test Loss:  0.010711912997066975
Test Acc:  0.0
Valid Loss:  0.010645086877048016
Valid Acc:  0.0
std:  0.003982338010433697 
thres:  1.209355816245079e-05
Preserved_eigens number check:  512
  9%|▉         | 90/1000 [27:59<4:24:11, 17.42s/it]Epoch:   91
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  498
Criterion check: 
Mean:  tensor(-0.0323, device='cuda:0') 
Std:  tensor(43.4076, device='cuda:0') 
ABS Max:  tensor(587.7793, device='cuda:0') 
ABS Min:  tensor(0.0033, device='cuda:0')
Criterion check:  tensor([0.9962, 1.0009, 0.9990, 0.9998, 1.0004, 0.9476, 1.0005, 1.0034, 1.0031,
        0.9941], device='cuda:0') tensor(179, device='cuda:0')
max of Lambda2 tensor(117371., device='cuda:0')
min of Lambda2 tensor(2.4767e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0238, device='cuda:0')
min of grad d_p:  tensor(-0.0416, device='cuda:0')
max|min: (J_L, Jta/N)  (0.023785952478647232, 0.02378605306148529, ratio: 1.0000041723251343)|(-0.04164152592420578, -0.041641827672719955)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.4040e-07, device='cuda:0') mean:  tensor(9.4230e-11, device='cuda:0') min:  tensor(-2.0815e-07, device='cuda:0') norm:  tensor(4.0669e-06, device='cuda:0') MSE:  tensor(5.1247e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0008, device='cuda:0') mean:  tensor(5.4661e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0108, device='cuda:0') MSE:  tensor(1.3558e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1028, device='cuda:0')
min of d_p_list:  tensor(-0.1480, device='cuda:0')
Epoch:  91  
Training Loss: 0.01994391158223152
Test Loss:  0.024087807163596153
Test Acc:  0.0
Valid Loss:  0.0238352008163929
Valid Acc:  0.0
std:  0.0044520309382876525 
thres:  1.2376460433006287e-05
Preserved_eigens number check:  512
  9%|▉         | 91/1000 [28:17<4:25:31, 17.53s/it]Epoch:   92
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  500
Criterion check: 
Mean:  tensor(-10.0306, device='cuda:0') 
Std:  tensor(221.8005, device='cuda:0') 
ABS Max:  tensor(4798.6812, device='cuda:0') 
ABS Min:  tensor(0.0001, device='cuda:0')
Criterion check:  tensor([1.0051, 0.9730, 1.0018, 1.0051, 1.0039, 0.9999, 0.9836, 1.0017, 1.0010,
        1.0044], device='cuda:0') tensor(188, device='cuda:0')
max of Lambda2 tensor(127384.5234, device='cuda:0')
min of Lambda2 tensor(3.1476e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0434, device='cuda:0')
min of grad d_p:  tensor(-0.0501, device='cuda:0')
max|min: (J_L, Jta/N)  (0.04335114359855652, 0.043351251631975174, ratio: 1.0000025033950806)|(-0.050116777420043945, -0.050116971135139465)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.3842e-07, device='cuda:0') mean:  tensor(4.1125e-11, device='cuda:0') min:  tensor(-1.5274e-07, device='cuda:0') norm:  tensor(3.2724e-06, device='cuda:0') MSE:  tensor(4.1235e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0015, device='cuda:0') mean:  tensor(1.0608e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0210, device='cuda:0') MSE:  tensor(2.6438e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0201, device='cuda:0')
min of d_p_list:  tensor(-0.0170, device='cuda:0')
Epoch:  92  
Training Loss: 0.011739647015929222
Test Loss:  0.015100661665201187
Test Acc:  0.0
Valid Loss:  0.015529859811067581
Valid Acc:  0.0
std:  0.004438478852347653 
thres:  1.2093278020620346e-05
Preserved_eigens number check:  512
  9%|▉         | 92/1000 [28:35<4:25:37, 17.55s/it]Epoch:   93
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  499
Criterion check: 
Mean:  tensor(4.6420, device='cuda:0') 
Std:  tensor(97.4967, device='cuda:0') 
ABS Max:  tensor(1734.7429, device='cuda:0') 
ABS Min:  tensor(0.0011, device='cuda:0')
Criterion check:  tensor([0.9991, 0.9980, 1.0002, 1.0449, 0.9997, 1.0018, 0.9973, 0.9868, 1.0002,
        0.9975], device='cuda:0') tensor(175, device='cuda:0')
max of Lambda2 tensor(124301.6016, device='cuda:0')
min of Lambda2 tensor(3.0330e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0239, device='cuda:0')
min of grad d_p:  tensor(-0.0303, device='cuda:0')
max|min: (J_L, Jta/N)  (0.02394724078476429, 0.02394721657037735, ratio: 0.9999989867210388)|(-0.030263751745224, -0.03026372194290161)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.1688e-07, device='cuda:0') mean:  tensor(1.4477e-11, device='cuda:0') min:  tensor(-6.2166e-08, device='cuda:0') norm:  tensor(1.2937e-06, device='cuda:0') MSE:  tensor(1.6302e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0007, device='cuda:0') mean:  tensor(4.6206e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0090, device='cuda:0') MSE:  tensor(1.1333e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0202, device='cuda:0')
min of d_p_list:  tensor(-0.0155, device='cuda:0')
Epoch:  93  
Training Loss: 0.010000405833125114
Test Loss:  0.01285438984632492
Test Acc:  0.0
Valid Loss:  0.013821879401803017
Valid Acc:  0.0
std:  0.0045198318476389375 
thres:  1.1758804693818093e-05
Preserved_eigens number check:  512
  9%|▉         | 93/1000 [28:52<4:25:26, 17.56s/it]Epoch:   94
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  499
Criterion check: 
Mean:  tensor(2.3183, device='cuda:0') 
Std:  tensor(50.9843, device='cuda:0') 
ABS Max:  tensor(863.5202, device='cuda:0') 
ABS Min:  tensor(0.0016, device='cuda:0')
Criterion check:  tensor([0.9983, 0.9856, 0.9982, 0.9882, 0.9908, 1.0086, 1.0044, 0.9986, 1.0016,
        0.9552], device='cuda:0') tensor(171, device='cuda:0')
max of Lambda2 tensor(128062.3750, device='cuda:0')
min of Lambda2 tensor(5.0102e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0147, device='cuda:0')
min of grad d_p:  tensor(-0.0186, device='cuda:0')
max|min: (J_L, Jta/N)  (0.01473850104957819, 0.0147387171164155, ratio: 1.0000146627426147)|(-0.01860668882727623, -0.01860695518553257)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.6322e-07, device='cuda:0') mean:  tensor(8.1517e-11, device='cuda:0') min:  tensor(-2.1607e-07, device='cuda:0') norm:  tensor(4.2230e-06, device='cuda:0') MSE:  tensor(5.3213e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0007, device='cuda:0') mean:  tensor(6.0666e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0121, device='cuda:0') MSE:  tensor(1.5221e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0255, device='cuda:0')
min of d_p_list:  tensor(-0.0432, device='cuda:0')
Epoch:  94  
Training Loss: 0.005596821196377277
Test Loss:  0.006100551225244999
Test Acc:  0.0
Valid Loss:  0.007227261550724506
Valid Acc:  0.0
std:  0.00466135106494307 
thres:  1.164732426404953e-05
Preserved_eigens number check:  512
  9%|▉         | 94/1000 [29:10<4:25:28, 17.58s/it]Epoch:   95
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  499
Criterion check: 
Mean:  tensor(9.6329, device='cuda:0') 
Std:  tensor(269.8559, device='cuda:0') 
ABS Max:  tensor(6028.1733, device='cuda:0') 
ABS Min:  tensor(0.0020, device='cuda:0')
Criterion check:  tensor([0.9967, 0.7991, 0.9961, 1.0061, 1.0006, 0.9990, 0.9992, 0.9986, 0.9990,
        0.9865], device='cuda:0') tensor(155, device='cuda:0')
max of Lambda2 tensor(146421.4375, device='cuda:0')
min of Lambda2 tensor(7.8506e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0129, device='cuda:0')
min of grad d_p:  tensor(-0.0163, device='cuda:0')
max|min: (J_L, Jta/N)  (0.012865602970123291, 0.012865548953413963, ratio: 0.9999958276748657)|(-0.016334498301148415, -0.016334455460309982)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.2282e-07, device='cuda:0') mean:  tensor(4.9112e-11, device='cuda:0') min:  tensor(-2.5914e-07, device='cuda:0') norm:  tensor(4.1860e-06, device='cuda:0') MSE:  tensor(5.2746e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0006, device='cuda:0') mean:  tensor(3.2279e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0068, device='cuda:0') MSE:  tensor(8.5756e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0143, device='cuda:0')
min of d_p_list:  tensor(-0.0132, device='cuda:0')
Epoch:  95  
Training Loss: 0.00370227312669158
Test Loss:  0.003488534362986684
Test Acc:  0.0
Valid Loss:  0.004621509462594986
Valid Acc:  0.0
std:  0.005670340658276731 
thres:  1.0196611750870943e-05
Preserved_eigens number check:  512
 10%|▉         | 95/1000 [29:27<4:23:58, 17.50s/it]Epoch:   96
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  498
Criterion check: 
Mean:  tensor(-12.6757, device='cuda:0') 
Std:  tensor(292.8989, device='cuda:0') 
ABS Max:  tensor(6626.1016, device='cuda:0') 
ABS Min:  tensor(6.3362e-05, device='cuda:0')
Criterion check:  tensor([0.9990, 1.0254, 0.9988, 1.0055, 0.9982, 0.9991, 1.0007, 0.9999, 1.0004,
        0.9915], device='cuda:0') tensor(155, device='cuda:0')
max of Lambda2 tensor(138649.2969, device='cuda:0')
min of Lambda2 tensor(4.1691e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0082, device='cuda:0')
min of grad d_p:  tensor(-0.0103, device='cuda:0')
max|min: (J_L, Jta/N)  (0.008159139193594456, 0.008159203454852104, ratio: 1.0000078678131104)|(-0.0103414636105299, -0.01034151203930378)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.0710e-07, device='cuda:0') mean:  tensor(1.5713e-11, device='cuda:0') min:  tensor(-7.5903e-08, device='cuda:0') norm:  tensor(1.7352e-06, device='cuda:0') MSE:  tensor(2.1864e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(9.4050e-07, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0018, device='cuda:0') MSE:  tensor(2.2749e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0291, device='cuda:0')
min of d_p_list:  tensor(-0.0392, device='cuda:0')
Epoch:  96  
Training Loss: 0.00968664325773716
Test Loss:  0.011682648211717606
Test Acc:  0.0
Valid Loss:  0.014093929901719093
Valid Acc:  0.0
std:  0.0029990571541717265 
thres:  8.145158085972072e-06
Preserved_eigens number check:  512
 10%|▉         | 96/1000 [29:45<4:23:38, 17.50s/it]Epoch:   97
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  499
Criterion check: 
Mean:  tensor(2.1399, device='cuda:0') 
Std:  tensor(34.2151, device='cuda:0') 
ABS Max:  tensor(442.0185, device='cuda:0') 
ABS Min:  tensor(5.7403e-05, device='cuda:0')
Criterion check:  tensor([0.9996, 1.0049, 0.8804, 0.9963, 1.0461, 1.0015, 1.0109, 1.0005, 1.0164,
        0.9852], device='cuda:0') tensor(178, device='cuda:0')
max of Lambda2 tensor(132989.8906, device='cuda:0')
min of Lambda2 tensor(4.0724e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0101, device='cuda:0')
min of grad d_p:  tensor(-0.0095, device='cuda:0')
max|min: (J_L, Jta/N)  (0.010144807398319244, 0.010144826024770737, ratio: 1.0000017881393433)|(-0.009529485367238522, -0.009529503993690014)

 check Jacobi res:  torch.Size([793601]) max:  tensor(6.4727e-08, device='cuda:0') mean:  tensor(-1.9331e-11, device='cuda:0') min:  tensor(-1.0447e-07, device='cuda:0') norm:  tensor(1.0705e-06, device='cuda:0') MSE:  tensor(1.3490e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(4.7178e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0097, device='cuda:0') MSE:  tensor(1.2204e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0219, device='cuda:0')
min of d_p_list:  tensor(-0.0229, device='cuda:0')
Epoch:  97  
Training Loss: 0.006995322182774544
Test Loss:  0.00853192713111639
Test Acc:  0.0
Valid Loss:  0.010893980041146278
Valid Acc:  0.0
std:  0.0024029884470027317 
thres:  7.196293119341136e-06
Preserved_eigens number check:  512
 10%|▉         | 97/1000 [30:02<4:22:19, 17.43s/it]Epoch:   98
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  499
Criterion check: 
Mean:  tensor(36.9232, device='cuda:0') 
Std:  tensor(1030.4408, device='cuda:0') 
ABS Max:  tensor(22540.3379, device='cuda:0') 
ABS Min:  tensor(0.0006, device='cuda:0')
Criterion check:  tensor([0.9988, 1.0117, 1.0358, 1.0138, 1.0073, 0.9975, 0.9986, 0.9970, 1.0032,
        1.0217], device='cuda:0') tensor(176, device='cuda:0')
max of Lambda2 tensor(144621.1719, device='cuda:0')
min of Lambda2 tensor(7.1395e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0057, device='cuda:0')
min of grad d_p:  tensor(-0.0059, device='cuda:0')
max|min: (J_L, Jta/N)  (0.005716179497539997, 0.005715875420719385, ratio: 0.9999468326568604)|(-0.005935649387538433, -0.005935538560152054)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.2014e-07, device='cuda:0') mean:  tensor(3.3117e-11, device='cuda:0') min:  tensor(-1.8510e-07, device='cuda:0') norm:  tensor(3.3877e-06, device='cuda:0') MSE:  tensor(4.2687e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0017, device='cuda:0') mean:  tensor(5.4430e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0108, device='cuda:0') MSE:  tensor(1.3669e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0230, device='cuda:0')
min of d_p_list:  tensor(-0.0262, device='cuda:0')
Epoch:  98  
Training Loss: 0.007501004263758659
Test Loss:  0.00712659303098917
Test Acc:  0.0
Valid Loss:  0.00803854875266552
Valid Acc:  0.0
std:  0.0019925946156245625 
thres:  6.696412805467844e-06
Preserved_eigens number check:  512
 10%|▉         | 98/1000 [30:19<4:20:37, 17.34s/it]Epoch:   99
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  498
Criterion check: 
Mean:  tensor(0.9276, device='cuda:0') 
Std:  tensor(12.0791, device='cuda:0') 
ABS Max:  tensor(163.2915, device='cuda:0') 
ABS Min:  tensor(0.0008, device='cuda:0')
Criterion check:  tensor([1.0017, 0.9998, 0.8331, 0.9985, 0.9992, 1.0010, 1.0013, 1.0024, 1.0038,
        0.9909], device='cuda:0') tensor(153, device='cuda:0')
max of Lambda2 tensor(146521.3750, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0074, device='cuda:0')
min of grad d_p:  tensor(-0.0072, device='cuda:0')
max|min: (J_L, Jta/N)  (0.0073504094034433365, 0.007350359112024307, ratio: 0.9999931454658508)|(-0.007160554639995098, -0.0071604144759476185)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.2713e-07, device='cuda:0') mean:  tensor(-5.4861e-11, device='cuda:0') min:  tensor(-2.2887e-07, device='cuda:0') norm:  tensor(2.6227e-06, device='cuda:0') MSE:  tensor(3.3048e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(1.5450e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0030, device='cuda:0') MSE:  tensor(3.7879e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.2111, device='cuda:0')
min of d_p_list:  tensor(-0.2091, device='cuda:0')
Epoch:  99  
Training Loss: 0.23897747695446014
Test Loss:  0.22746364772319794
Test Acc:  0.0
Valid Loss:  0.21515193581581116
Valid Acc:  0.0
std:  0.092822227651116 
thres:  5.337254395708442e-05
Preserved_eigens number check:  512
 10%|▉         | 99/1000 [30:37<4:21:34, 17.42s/it]Epoch:   100
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  497
Criterion check: 
Mean:  tensor(0.2404, device='cuda:0') 
Std:  tensor(20.7445, device='cuda:0') 
ABS Max:  tensor(371.2966, device='cuda:0') 
ABS Min:  tensor(0.0012, device='cuda:0')
Criterion check:  tensor([1.0000, 0.9997, 1.0001, 0.9999, 0.9998, 1.0001, 1.0001, 1.0014, 1.0025,
        0.9997], device='cuda:0') tensor(162, device='cuda:0')
max of Lambda2 tensor(107863.4062, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3655, device='cuda:0')
min of grad d_p:  tensor(-0.5310, device='cuda:0')
max|min: (J_L, Jta/N)  (0.3655086159706116, 0.3655087649822235, ratio: 1.0000003576278687)|(-0.5309606790542603, -0.5309609770774841)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.9605e-07, device='cuda:0') mean:  tensor(1.2150e-10, device='cuda:0') min:  tensor(-2.3842e-07, device='cuda:0') norm:  tensor(4.6506e-06, device='cuda:0') MSE:  tensor(5.8602e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(3.8506e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0075, device='cuda:0') MSE:  tensor(9.4445e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0486, device='cuda:0')
min of d_p_list:  tensor(-0.0457, device='cuda:0')
Epoch:  100  
Training Loss: 0.08567161858081818
Test Loss:  0.08508765697479248
Test Acc:  0.0
Valid Loss:  0.07944181561470032
Valid Acc:  0.0
std:  0.08979101227731802 
thres:  6.976641304790973e-05
Preserved_eigens number check:  512
 10%|█         | 100/1000 [30:55<4:24:21, 17.62s/it]Epoch:   101
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  498
Criterion check: 
Mean:  tensor(0.4889, device='cuda:0') 
Std:  tensor(11.0987, device='cuda:0') 
ABS Max:  tensor(217.1774, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([1.0001, 1.0000, 1.0001, 1.0001, 1.0003, 1.0001, 1.0001, 1.0010, 1.0047,
        0.9994], device='cuda:0') tensor(151, device='cuda:0')
max of Lambda2 tensor(158996.2188, device='cuda:0')
min of Lambda2 tensor(3.9434e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2765, device='cuda:0')
min of grad d_p:  tensor(-0.3322, device='cuda:0')
max|min: (J_L, Jta/N)  (0.2764802575111389, 0.27648016810417175, ratio: 0.9999997019767761)|(-0.3321847915649414, -0.33218470215797424)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.7881e-07, device='cuda:0') mean:  tensor(-7.1596e-11, device='cuda:0') min:  tensor(-2.7195e-07, device='cuda:0') norm:  tensor(2.7330e-06, device='cuda:0') MSE:  tensor(3.4438e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(1.4012e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0027, device='cuda:0') MSE:  tensor(3.4170e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1817, device='cuda:0')
min of d_p_list:  tensor(-0.1733, device='cuda:0')
Epoch:  101  
Training Loss: 0.07384656369686127
Test Loss:  0.08883164077997208
Test Acc:  0.0
Valid Loss:  0.1097133457660675
Valid Acc:  0.0
std:  0.08473004100324093 
thres:  8.259839713573456e-05
Preserved_eigens number check:  512
 10%|█         | 101/1000 [31:12<4:21:17, 17.44s/it]Epoch:   102
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  500
Criterion check: 
Mean:  tensor(0.3745, device='cuda:0') 
Std:  tensor(443.3653, device='cuda:0') 
ABS Max:  tensor(8202.6260, device='cuda:0') 
ABS Min:  tensor(0.0012, device='cuda:0')
Criterion check:  tensor([0.9990, 1.0005, 1.0009, 1.0012, 0.9962, 0.9945, 1.0001, 1.0035, 1.0021,
        1.0312], device='cuda:0') tensor(194, device='cuda:0')
max of Lambda2 tensor(109356.4453, device='cuda:0')
min of Lambda2 tensor(1.6261e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2247, device='cuda:0')
min of grad d_p:  tensor(-0.3199, device='cuda:0')
max|min: (J_L, Jta/N)  (0.22466790676116943, 0.22466780245304108, ratio: 0.9999995231628418)|(-0.31986644864082336, -0.31986621022224426)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.9802e-07, device='cuda:0') mean:  tensor(-4.2942e-12, device='cuda:0') min:  tensor(-2.6822e-07, device='cuda:0') norm:  tensor(3.3858e-06, device='cuda:0') MSE:  tensor(4.2664e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0053, device='cuda:0') mean:  tensor(4.5566e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0825, device='cuda:0') MSE:  tensor(1.0395e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0365, device='cuda:0')
min of d_p_list:  tensor(-0.0497, device='cuda:0')
Epoch:  102  
Training Loss: 0.03826574608683586
Test Loss:  0.047148823738098145
Test Acc:  0.0
Valid Loss:  0.05829456448554993
Valid Acc:  0.0
std:  0.07993733841767191 
thres:  8.885248191654683e-05
Preserved_eigens number check:  512
 10%|█         | 102/1000 [31:29<4:21:56, 17.50s/it]Epoch:   103
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  499
Criterion check: 
Mean:  tensor(1.4781, device='cuda:0') 
Std:  tensor(24.8785, device='cuda:0') 
ABS Max:  tensor(522.5014, device='cuda:0') 
ABS Min:  tensor(0.0001, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0001, 1.0001, 1.0001, 0.9987, 1.0017, 1.0009, 0.9943,
        1.0018], device='cuda:0') tensor(153, device='cuda:0')
max of Lambda2 tensor(144924.7969, device='cuda:0')
min of Lambda2 tensor(2.3914e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1371, device='cuda:0')
min of grad d_p:  tensor(-0.1946, device='cuda:0')
max|min: (J_L, Jta/N)  (0.13711652159690857, 0.13711659610271454, ratio: 1.0000005960464478)|(-0.19458162784576416, -0.19458162784576416)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.3097e-07, device='cuda:0') mean:  tensor(3.2612e-11, device='cuda:0') min:  tensor(-1.4063e-07, device='cuda:0') norm:  tensor(2.5275e-06, device='cuda:0') MSE:  tensor(3.1848e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(1.8677e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0038, device='cuda:0') MSE:  tensor(4.8104e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0203, device='cuda:0')
min of d_p_list:  tensor(-0.0255, device='cuda:0')
Epoch:  103  
Training Loss: 0.013780685141682625
Test Loss:  0.01723291352391243
Test Acc:  0.0
Valid Loss:  0.020506806671619415
Valid Acc:  0.0
std:  0.07868890041528823 
thres:  9.010841809213162e-05
Preserved_eigens number check:  512
 10%|█         | 103/1000 [31:47<4:20:47, 17.44s/it]Epoch:   104
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  500
Criterion check: 
Mean:  tensor(-0.1667, device='cuda:0') 
Std:  tensor(24.2426, device='cuda:0') 
ABS Max:  tensor(338.8008, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([1.0000, 0.9997, 1.0000, 1.0004, 1.0088, 0.9981, 0.9991, 0.9913, 1.0077,
        0.9882], device='cuda:0') tensor(172, device='cuda:0')
max of Lambda2 tensor(128443.2188, device='cuda:0')
min of Lambda2 tensor(3.4070e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0762, device='cuda:0')
min of grad d_p:  tensor(-0.1082, device='cuda:0')
max|min: (J_L, Jta/N)  (0.0762476697564125, 0.07624740898609161, ratio: 0.9999966025352478)|(-0.10817115008831024, -0.10817070305347443)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.6077e-07, device='cuda:0') mean:  tensor(-8.5121e-11, device='cuda:0') min:  tensor(-4.4703e-07, device='cuda:0') norm:  tensor(5.5096e-06, device='cuda:0') MSE:  tensor(6.9425e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(4.2228e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0085, device='cuda:0') MSE:  tensor(1.0752e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1286, device='cuda:0')
min of d_p_list:  tensor(-0.1077, device='cuda:0')
Epoch:  104  
Training Loss: 0.04057636857032776
Test Loss:  0.03766606003046036
Test Acc:  0.0
Valid Loss:  0.0396895706653595
Valid Acc:  0.0
std:  0.025994393720570892 
thres:  5.042819641530514e-05
Preserved_eigens number check:  512
 10%|█         | 104/1000 [32:04<4:20:10, 17.42s/it]Epoch:   105
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  501
Criterion check: 
Mean:  tensor(-2.7541, device='cuda:0') 
Std:  tensor(68.2508, device='cuda:0') 
ABS Max:  tensor(1391.2405, device='cuda:0') 
ABS Min:  tensor(0.0010, device='cuda:0')
Criterion check:  tensor([1.0004, 0.9998, 1.0017, 1.0000, 1.0008, 1.0025, 1.0000, 1.0004, 0.9997,
        1.0166], device='cuda:0') tensor(176, device='cuda:0')
max of Lambda2 tensor(120982.7422, device='cuda:0')
min of Lambda2 tensor(1.0659e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1436, device='cuda:0')
min of grad d_p:  tensor(-0.1724, device='cuda:0')
max|min: (J_L, Jta/N)  (0.14357861876487732, 0.14357852935791016, ratio: 0.9999994039535522)|(-0.17240217328071594, -0.1724020391702652)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.4214e-07, device='cuda:0') mean:  tensor(1.2477e-11, device='cuda:0') min:  tensor(-1.3411e-07, device='cuda:0') norm:  tensor(2.5918e-06, device='cuda:0') MSE:  tensor(3.2658e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0011, device='cuda:0') mean:  tensor(3.4890e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0073, device='cuda:0') MSE:  tensor(9.2035e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1309, device='cuda:0')
min of d_p_list:  tensor(-0.0950, device='cuda:0')
Epoch:  105  
Training Loss: 0.036655083298683167
Test Loss:  0.039226382970809937
Test Acc:  0.0
Valid Loss:  0.036799848079681396
Valid Acc:  0.0
std:  0.019212590753326368 
thres:  4.062488935887814e-05
Preserved_eigens number check:  512
 10%|█         | 105/1000 [32:22<4:20:38, 17.47s/it]Epoch:   106
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  495
Criterion check: 
Mean:  tensor(-2.5033, device='cuda:0') 
Std:  tensor(49.0721, device='cuda:0') 
ABS Max:  tensor(881.5128, device='cuda:0') 
ABS Min:  tensor(0.0018, device='cuda:0')
Criterion check:  tensor([1.0004, 1.0005, 1.0982, 0.9999, 1.0006, 0.9996, 1.0030, 0.9982, 1.0005,
        0.9910], device='cuda:0') tensor(176, device='cuda:0')
max of Lambda2 tensor(100573.7344, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1142, device='cuda:0')
min of grad d_p:  tensor(-0.1329, device='cuda:0')
max|min: (J_L, Jta/N)  (0.11418215185403824, 0.11418206989765167, ratio: 0.9999992847442627)|(-0.1329253911972046, -0.13292521238327026)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.7136e-07, device='cuda:0') mean:  tensor(-4.4900e-11, device='cuda:0') min:  tensor(-2.9802e-07, device='cuda:0') norm:  tensor(3.6233e-06, device='cuda:0') MSE:  tensor(4.5657e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0013, device='cuda:0') mean:  tensor(4.3146e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0106, device='cuda:0') MSE:  tensor(1.3408e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0216, device='cuda:0')
min of d_p_list:  tensor(-0.0258, device='cuda:0')
Epoch:  106  
Training Loss: 0.020077573135495186
Test Loss:  0.02216070517897606
Test Acc:  0.0
Valid Loss:  0.02420128509402275
Valid Acc:  0.0
std:  0.010825062644077798 
thres:  2.987109124660492e-05
Preserved_eigens number check:  512
 11%|█         | 106/1000 [32:39<4:19:03, 17.39s/it]Epoch:   107
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  497
Criterion check: 
Mean:  tensor(-0.6620, device='cuda:0') 
Std:  tensor(29.4895, device='cuda:0') 
ABS Max:  tensor(449.1509, device='cuda:0') 
ABS Min:  tensor(0.0012, device='cuda:0')
Criterion check:  tensor([0.9987, 0.9989, 0.9820, 0.9992, 0.9955, 0.9991, 1.0031, 0.9990, 0.9982,
        1.3393], device='cuda:0') tensor(172, device='cuda:0')
max of Lambda2 tensor(100299.2109, device='cuda:0')
min of Lambda2 tensor(1.8982e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0614, device='cuda:0')
min of grad d_p:  tensor(-0.0731, device='cuda:0')
max|min: (J_L, Jta/N)  (0.061444077640771866, 0.0614440031349659, ratio: 0.9999988079071045)|(-0.07312612235546112, -0.07312609255313873)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.1537e-07, device='cuda:0') mean:  tensor(4.8307e-11, device='cuda:0') min:  tensor(-2.3842e-07, device='cuda:0') norm:  tensor(3.0006e-06, device='cuda:0') MSE:  tensor(3.7809e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0008, device='cuda:0') mean:  tensor(5.4137e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0114, device='cuda:0') MSE:  tensor(1.4328e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0431, device='cuda:0')
min of d_p_list:  tensor(-0.0814, device='cuda:0')
Epoch:  107  
Training Loss: 0.028987038880586624
Test Loss:  0.03224056959152222
Test Acc:  0.0
Valid Loss:  0.03818216919898987
Valid Acc:  0.0
std:  0.0099900184530003 
thres:  2.8015349805355074e-05
Preserved_eigens number check:  512
 11%|█         | 107/1000 [32:56<4:19:57, 17.47s/it]Epoch:   108
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  497
Criterion check: 
Mean:  tensor(-0.0155, device='cuda:0') 
Std:  tensor(49.5271, device='cuda:0') 
ABS Max:  tensor(856.5766, device='cuda:0') 
ABS Min:  tensor(7.8901e-05, device='cuda:0')
Criterion check:  tensor([0.9997, 0.9992, 1.0037, 0.9997, 0.9998, 0.9998, 1.0009, 1.0010, 1.0003,
        1.0162], device='cuda:0') tensor(151, device='cuda:0')
max of Lambda2 tensor(99492.1406, device='cuda:0')
min of Lambda2 tensor(1.8662e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0172, device='cuda:0')
min of grad d_p:  tensor(-0.0198, device='cuda:0')
max|min: (J_L, Jta/N)  (0.017219342291355133, 0.017219452187418938, ratio: 1.0000064373016357)|(-0.019803060218691826, -0.019803233444690704)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.8871e-07, device='cuda:0') mean:  tensor(7.3165e-11, device='cuda:0') min:  tensor(-1.5274e-07, device='cuda:0') norm:  tensor(3.0289e-06, device='cuda:0') MSE:  tensor(3.8167e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(2.2340e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0043, device='cuda:0') MSE:  tensor(5.3956e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0292, device='cuda:0')
min of d_p_list:  tensor(-0.0185, device='cuda:0')
Epoch:  108  
Training Loss: 0.020788688212633133
Test Loss:  0.024042664095759392
Test Acc:  0.0
Valid Loss:  0.02747352235019207
Valid Acc:  0.0
std:  0.008231389697207386 
thres:  2.9416950419545173e-05
Preserved_eigens number check:  512
 11%|█         | 108/1000 [33:14<4:20:56, 17.55s/it]Epoch:   109
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  497
Criterion check: 
Mean:  tensor(5.3293, device='cuda:0') 
Std:  tensor(115.1385, device='cuda:0') 
ABS Max:  tensor(2586.6213, device='cuda:0') 
ABS Min:  tensor(0.0007, device='cuda:0')
Criterion check:  tensor([1.0006, 0.9922, 0.9985, 0.9996, 0.9989, 0.9995, 0.9861, 0.9988, 0.9973,
        0.9966], device='cuda:0') tensor(167, device='cuda:0')
max of Lambda2 tensor(101835.8906, device='cuda:0')
min of Lambda2 tensor(6.0704e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0118, device='cuda:0')
min of grad d_p:  tensor(-0.0133, device='cuda:0')
max|min: (J_L, Jta/N)  (0.011808308772742748, 0.011808396317064762, ratio: 1.0000073909759521)|(-0.013335760682821274, -0.013335837982594967)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.1441e-07, device='cuda:0') mean:  tensor(-1.6669e-11, device='cuda:0') min:  tensor(-2.0163e-07, device='cuda:0') norm:  tensor(1.9873e-06, device='cuda:0') MSE:  tensor(2.5041e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(2.5390e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0054, device='cuda:0') MSE:  tensor(6.7672e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0221, device='cuda:0')
min of d_p_list:  tensor(-0.0187, device='cuda:0')
Epoch:  109  
Training Loss: 0.017983511090278625
Test Loss:  0.022767942398786545
Test Acc:  0.0
Valid Loss:  0.02221716195344925
Valid Acc:  0.0
std:  0.006969682365010624 
thres:  2.489837892353535e-05
Preserved_eigens number check:  512
 11%|█         | 109/1000 [33:31<4:19:01, 17.44s/it]Epoch:   110
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  496
Criterion check: 
Mean:  tensor(0.6799, device='cuda:0') 
Std:  tensor(33.6251, device='cuda:0') 
ABS Max:  tensor(445.0837, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([0.9997, 0.9967, 0.9984, 0.9981, 1.0042, 1.0027, 1.0221, 1.0018, 1.0054,
        0.9898], device='cuda:0') tensor(172, device='cuda:0')
max of Lambda2 tensor(105563.2891, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0071, device='cuda:0')
min of grad d_p:  tensor(-0.0090, device='cuda:0')
max|min: (J_L, Jta/N)  (0.007133018225431442, 0.007132957223802805, ratio: 0.9999914765357971)|(-0.009042833000421524, -0.009042720310389996)

 check Jacobi res:  torch.Size([793601]) max:  tensor(7.2643e-08, device='cuda:0') mean:  tensor(-2.0936e-11, device='cuda:0') min:  tensor(-1.5151e-07, device='cuda:0') norm:  tensor(1.8260e-06, device='cuda:0') MSE:  tensor(2.3010e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(3.4371e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0066, device='cuda:0') MSE:  tensor(8.3630e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0463, device='cuda:0')
min of d_p_list:  tensor(-0.0365, device='cuda:0')
Epoch:  110  
Training Loss: 0.008246513083577156
Test Loss:  0.010253343731164932
Test Acc:  0.0
Valid Loss:  0.009115414693951607
Valid Acc:  0.0
std:  0.006641348164337198 
thres:  1.9216664880514147e-05
Preserved_eigens number check:  512
 11%|█         | 110/1000 [33:49<4:19:22, 17.49s/it]Epoch:   111
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  497
Criterion check: 
Mean:  tensor(-1.9935, device='cuda:0') 
Std:  tensor(27.7626, device='cuda:0') 
ABS Max:  tensor(502.6712, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([0.9995, 1.0028, 0.9995, 1.0002, 0.9957, 0.9999, 0.9991, 1.0012, 1.0062,
        1.0080], device='cuda:0') tensor(128, device='cuda:0')
max of Lambda2 tensor(107939.0703, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0111, device='cuda:0')
min of grad d_p:  tensor(-0.0096, device='cuda:0')
max|min: (J_L, Jta/N)  (0.011084777303040028, 0.011084831319749355, ratio: 1.0000048875808716)|(-0.00962810218334198, -0.009628253988921642)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.9185e-07, device='cuda:0') mean:  tensor(3.3929e-11, device='cuda:0') min:  tensor(-1.1828e-07, device='cuda:0') norm:  tensor(2.1395e-06, device='cuda:0') MSE:  tensor(2.6959e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(1.3104e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0027, device='cuda:0') MSE:  tensor(3.3506e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0252, device='cuda:0')
min of d_p_list:  tensor(-0.0231, device='cuda:0')
Epoch:  111  
Training Loss: 0.004070870578289032
Test Loss:  0.004235059022903442
Test Acc:  0.0
Valid Loss:  0.004352345131337643
Valid Acc:  0.0
std:  0.00892130644996092 
thres:  1.6015324369072917e-05
Preserved_eigens number check:  512
 11%|█         | 111/1000 [34:06<4:18:09, 17.42s/it]Epoch:   112
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  492
Criterion check: 
Mean:  tensor(0.0034, device='cuda:0') 
Std:  tensor(14.2048, device='cuda:0') 
ABS Max:  tensor(233.5936, device='cuda:0') 
ABS Min:  tensor(2.0334e-05, device='cuda:0')
Criterion check:  tensor([0.9988, 0.9931, 0.9999, 0.9994, 1.0371, 1.0010, 0.9870, 1.0009, 1.0056,
        1.0054], device='cuda:0') tensor(150, device='cuda:0')
max of Lambda2 tensor(106830.8906, device='cuda:0')
min of Lambda2 tensor(1.0844e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0059, device='cuda:0')
min of grad d_p:  tensor(-0.0056, device='cuda:0')
max|min: (J_L, Jta/N)  (0.005896779242902994, 0.005896848160773516, ratio: 1.000011682510376)|(-0.0056428755633533, -0.005642973817884922)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.0524e-07, device='cuda:0') mean:  tensor(3.3016e-11, device='cuda:0') min:  tensor(-7.7765e-08, device='cuda:0') norm:  tensor(1.6977e-06, device='cuda:0') MSE:  tensor(2.1393e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(1.9731e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0043, device='cuda:0') MSE:  tensor(5.3762e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0551, device='cuda:0')
min of d_p_list:  tensor(-0.0662, device='cuda:0')
Epoch:  112  
Training Loss: 0.008545923978090286
Test Loss:  0.010380169376730919
Test Acc:  0.0
Valid Loss:  0.009313331916928291
Valid Acc:  0.0
std:  0.006354640399137563 
thres:  1.1927101388573646e-05
Preserved_eigens number check:  512
 11%|█         | 112/1000 [34:23<4:17:07, 17.37s/it]Epoch:   113
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  495
Criterion check: 
Mean:  tensor(0.4765, device='cuda:0') 
Std:  tensor(29.5134, device='cuda:0') 
ABS Max:  tensor(433.6669, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([0.9973, 1.0103, 0.9805, 0.9991, 1.0035, 0.9976, 1.0016, 0.9998, 1.1552,
        1.0038], device='cuda:0') tensor(170, device='cuda:0')
max of Lambda2 tensor(111536.7969, device='cuda:0')
min of Lambda2 tensor(7.2268e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0155, device='cuda:0')
min of grad d_p:  tensor(-0.0117, device='cuda:0')
max|min: (J_L, Jta/N)  (0.015520215965807438, 0.01552015170454979, ratio: 0.9999958872795105)|(-0.01165580004453659, -0.011655837297439575)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.8720e-07, device='cuda:0') mean:  tensor(2.3775e-11, device='cuda:0') min:  tensor(-7.7474e-08, device='cuda:0') norm:  tensor(1.9289e-06, device='cuda:0') MSE:  tensor(2.4306e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(2.1508e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0040, device='cuda:0') MSE:  tensor(5.0526e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.2211, device='cuda:0')
min of d_p_list:  tensor(-0.2018, device='cuda:0')
Epoch:  113  
Training Loss: 0.20559687912464142
Test Loss:  0.2443094253540039
Test Acc:  0.0
Valid Loss:  0.21237239241600037
Valid Acc:  0.0
std:  0.07848636680937071 
thres:  4.8888739570975306e-05
Preserved_eigens number check:  512
 11%|█▏        | 113/1000 [34:41<4:19:35, 17.56s/it]Epoch:   114
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  495
Criterion check: 
Mean:  tensor(-0.9790, device='cuda:0') 
Std:  tensor(224.4085, device='cuda:0') 
ABS Max:  tensor(4377.8452, device='cuda:0') 
ABS Min:  tensor(0.0049, device='cuda:0')
Criterion check:  tensor([1.0039, 1.0141, 1.0239, 1.0003, 1.0008, 1.0010, 1.0061, 0.9987, 0.9867,
        1.0045], device='cuda:0') tensor(212, device='cuda:0')
max of Lambda2 tensor(175828.5312, device='cuda:0')
min of Lambda2 tensor(7.6301e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1243, device='cuda:0')
min of grad d_p:  tensor(-0.0780, device='cuda:0')
max|min: (J_L, Jta/N)  (0.1242523193359375, 0.12425227463245392, ratio: 0.9999996423721313)|(-0.07795967906713486, -0.07795954495668411)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.6450e-07, device='cuda:0') mean:  tensor(2.0630e-11, device='cuda:0') min:  tensor(-1.4016e-07, device='cuda:0') norm:  tensor(2.7772e-06, device='cuda:0') MSE:  tensor(3.4995e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0065, device='cuda:0') mean:  tensor(2.6818e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0535, device='cuda:0') MSE:  tensor(6.7459e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0503, device='cuda:0')
min of d_p_list:  tensor(-0.0826, device='cuda:0')
Epoch:  114  
Training Loss: 0.08662509173154831
Test Loss:  0.09569764882326126
Test Acc:  0.0
Valid Loss:  0.082713782787323
Valid Acc:  0.0
std:  0.07788082521780541 
thres:  6.261705569922923e-05
Preserved_eigens number check:  512
 11%|█▏        | 114/1000 [34:59<4:19:44, 17.59s/it]Epoch:   115
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  498
Criterion check: 
Mean:  tensor(-14.0028, device='cuda:0') 
Std:  tensor(346.8044, device='cuda:0') 
ABS Max:  tensor(7819.7939, device='cuda:0') 
ABS Min:  tensor(4.3915e-05, device='cuda:0')
Criterion check:  tensor([1.0003, 1.0020, 0.9526, 1.0002, 0.9977, 0.9981, 1.0013, 1.0075, 1.0040,
        0.9986], device='cuda:0') tensor(178, device='cuda:0')
max of Lambda2 tensor(201553.9531, device='cuda:0')
min of Lambda2 tensor(5.7604e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1423, device='cuda:0')
min of grad d_p:  tensor(-0.0868, device='cuda:0')
max|min: (J_L, Jta/N)  (0.14232094585895538, 0.14232094585895538, ratio: 1.0)|(-0.08682024478912354, -0.08682038635015488)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.1525e-07, device='cuda:0') mean:  tensor(-4.1653e-11, device='cuda:0') min:  tensor(-3.9150e-07, device='cuda:0') norm:  tensor(3.6083e-06, device='cuda:0') MSE:  tensor(4.5468e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0010, device='cuda:0') mean:  tensor(6.0062e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0122, device='cuda:0') MSE:  tensor(1.5407e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1561, device='cuda:0')
min of d_p_list:  tensor(-0.1844, device='cuda:0')
Epoch:  115  
Training Loss: 0.06784138083457947
Test Loss:  0.0818457379937172
Test Acc:  0.0
Valid Loss:  0.08075016736984253
Valid Acc:  0.0
std:  0.07305880193293522 
thres:  7.453602924942971e-05
Preserved_eigens number check:  512
 12%|█▏        | 115/1000 [35:17<4:19:50, 17.62s/it]Epoch:   116
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  502
Criterion check: 
Mean:  tensor(2.4459, device='cuda:0') 
Std:  tensor(82.7446, device='cuda:0') 
ABS Max:  tensor(1803.7292, device='cuda:0') 
ABS Min:  tensor(0.0022, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0004, 1.0005, 0.9999, 0.9996, 1.0002, 1.0008, 1.0008, 0.9810,
        0.9747], device='cuda:0') tensor(170, device='cuda:0')
max of Lambda2 tensor(219009.4219, device='cuda:0')
min of Lambda2 tensor(1.3752e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2695, device='cuda:0')
min of grad d_p:  tensor(-0.1692, device='cuda:0')
max|min: (J_L, Jta/N)  (0.2694683372974396, 0.2694685459136963, ratio: 1.0000007152557373)|(-0.16916558146476746, -0.16916579008102417)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.1164e-07, device='cuda:0') mean:  tensor(-1.2022e-10, device='cuda:0') min:  tensor(-6.6217e-07, device='cuda:0') norm:  tensor(6.6035e-06, device='cuda:0') MSE:  tensor(8.3210e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0011, device='cuda:0') mean:  tensor(4.0854e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0086, device='cuda:0') MSE:  tensor(1.0806e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.2260, device='cuda:0')
min of d_p_list:  tensor(-0.2097, device='cuda:0')
Epoch:  116  
Training Loss: 0.11175282299518585
Test Loss:  0.15101316571235657
Test Acc:  0.0
Valid Loss:  0.17802712321281433
Valid Acc:  0.0
std:  0.06448040520077623 
thres:  9.607241973280907e-05
Preserved_eigens number check:  512
 12%|█▏        | 116/1000 [35:34<4:19:33, 17.62s/it]Epoch:   117
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  499
Criterion check: 
Mean:  tensor(1.8982, device='cuda:0') 
Std:  tensor(36.1231, device='cuda:0') 
ABS Max:  tensor(512.6080, device='cuda:0') 
ABS Min:  tensor(0.0038, device='cuda:0')
Criterion check:  tensor([1.0020, 1.0010, 1.0000, 1.0000, 1.0484, 0.9986, 0.9998, 1.0038, 1.0021,
        1.3723], device='cuda:0') tensor(190, device='cuda:0')
max of Lambda2 tensor(265915.9375, device='cuda:0')
min of Lambda2 tensor(2.7367e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2187, device='cuda:0')
min of grad d_p:  tensor(-0.1848, device='cuda:0')
max|min: (J_L, Jta/N)  (0.21868763864040375, 0.21868762373924255, ratio: 0.9999999403953552)|(-0.18482330441474915, -0.18482346832752228)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.0862e-07, device='cuda:0') mean:  tensor(1.6203e-11, device='cuda:0') min:  tensor(-1.2293e-07, device='cuda:0') norm:  tensor(2.0315e-06, device='cuda:0') MSE:  tensor(2.5598e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0024, device='cuda:0') mean:  tensor(1.2608e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0276, device='cuda:0') MSE:  tensor(3.4753e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0492, device='cuda:0')
min of d_p_list:  tensor(-0.0679, device='cuda:0')
Epoch:  117  
Training Loss: 0.092311330139637
Test Loss:  0.1231166422367096
Test Acc:  0.0
Valid Loss:  0.14679978787899017
Valid Acc:  0.0
std:  0.04845315873341332 
thres:  0.00011282550096511842
Preserved_eigens number check:  512
 12%|█▏        | 117/1000 [35:52<4:19:59, 17.67s/it]Epoch:   118
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  499
Criterion check: 
Mean:  tensor(0.1237, device='cuda:0') 
Std:  tensor(12.4612, device='cuda:0') 
ABS Max:  tensor(188.3832, device='cuda:0') 
ABS Min:  tensor(0.0007, device='cuda:0')
Criterion check:  tensor([1.0005, 1.0007, 0.9999, 1.0002, 1.0031, 0.9992, 1.0002, 0.9909, 1.0022,
        1.0014], device='cuda:0') tensor(153, device='cuda:0')
max of Lambda2 tensor(252101.1250, device='cuda:0')
min of Lambda2 tensor(3.0233e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1428, device='cuda:0')
min of grad d_p:  tensor(-0.1142, device='cuda:0')
max|min: (J_L, Jta/N)  (0.14283011853694916, 0.14282964169979095, ratio: 0.9999966621398926)|(-0.1141657754778862, -0.11416550725698471)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.9174e-07, device='cuda:0') mean:  tensor(-7.2133e-11, device='cuda:0') min:  tensor(-3.4273e-07, device='cuda:0') norm:  tensor(6.7289e-06, device='cuda:0') MSE:  tensor(8.4789e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(2.1274e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0041, device='cuda:0') MSE:  tensor(5.1457e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0623, device='cuda:0')
min of d_p_list:  tensor(-0.0649, device='cuda:0')
Epoch:  118  
Training Loss: 0.03128613531589508
Test Loss:  0.04225791245698929
Test Acc:  0.0
Valid Loss:  0.048963624984025955
Valid Acc:  0.0
std:  0.027217036648597794 
thres:  7.796335220336914e-05
Preserved_eigens number check:  512
 12%|█▏        | 118/1000 [36:10<4:18:15, 17.57s/it]Epoch:   119
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  497
Criterion check: 
Mean:  tensor(5.6194, device='cuda:0') 
Std:  tensor(100.7179, device='cuda:0') 
ABS Max:  tensor(2191.4500, device='cuda:0') 
ABS Min:  tensor(3.3873e-05, device='cuda:0')
Criterion check:  tensor([0.9978, 0.9979, 0.9990, 0.9985, 1.0075, 1.0046, 0.9975, 0.9126, 0.9642,
        1.0486], device='cuda:0') tensor(161, device='cuda:0')
max of Lambda2 tensor(244081.8125, device='cuda:0')
min of Lambda2 tensor(3.0555e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0871, device='cuda:0')
min of grad d_p:  tensor(-0.0640, device='cuda:0')
max|min: (J_L, Jta/N)  (0.0870557576417923, 0.08705585449934006, ratio: 1.000001072883606)|(-0.0640488937497139, -0.06404902040958405)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.4959e-07, device='cuda:0') mean:  tensor(4.5109e-11, device='cuda:0') min:  tensor(-1.7509e-07, device='cuda:0') norm:  tensor(2.3862e-06, device='cuda:0') MSE:  tensor(3.0068e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0018, device='cuda:0') mean:  tensor(6.5156e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0146, device='cuda:0') MSE:  tensor(1.8402e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.2507, device='cuda:0')
min of d_p_list:  tensor(-0.1921, device='cuda:0')
Epoch:  119  
Training Loss: 0.021195437759160995
Test Loss:  0.022525135427713394
Test Acc:  0.0
Valid Loss:  0.02533872239291668
Valid Acc:  0.0
std:  0.03462715083444557 
thres:  6.487742140889168e-05
Preserved_eigens number check:  512
 12%|█▏        | 119/1000 [36:27<4:18:58, 17.64s/it]Epoch:   120
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  501
Criterion check: 
Mean:  tensor(1.7868, device='cuda:0') 
Std:  tensor(46.8492, device='cuda:0') 
ABS Max:  tensor(866.7578, device='cuda:0') 
ABS Min:  tensor(6.5013e-05, device='cuda:0')
Criterion check:  tensor([1.0007, 1.0000, 0.9995, 1.0002, 0.9991, 0.9995, 0.9682, 1.0008, 1.0010,
        0.9983], device='cuda:0') tensor(164, device='cuda:0')
max of Lambda2 tensor(284762.8125, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1279, device='cuda:0')
min of grad d_p:  tensor(-0.1331, device='cuda:0')
max|min: (J_L, Jta/N)  (0.1278889775276184, 0.12788917124271393, ratio: 1.0000015497207642)|(-0.13309378921985626, -0.13309389352798462)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.3469e-07, device='cuda:0') mean:  tensor(-8.0793e-11, device='cuda:0') min:  tensor(-4.9174e-07, device='cuda:0') norm:  tensor(4.1940e-06, device='cuda:0') MSE:  tensor(5.2848e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0006, device='cuda:0') mean:  tensor(5.1324e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0107, device='cuda:0') MSE:  tensor(1.3455e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1579, device='cuda:0')
min of d_p_list:  tensor(-0.1367, device='cuda:0')
Epoch:  120  
Training Loss: 0.024360772222280502
Test Loss:  0.027442239224910736
Test Acc:  0.0
Valid Loss:  0.030814049765467644
Valid Acc:  0.0
std:  0.03807860032966505 
thres:  5.618129968643189e-05
Preserved_eigens number check:  512
 12%|█▏        | 120/1000 [36:45<4:18:00, 17.59s/it]Epoch:   121
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  497
Criterion check: 
Mean:  tensor(23.2530, device='cuda:0') 
Std:  tensor(538.0811, device='cuda:0') 
ABS Max:  tensor(12141.1299, device='cuda:0') 
ABS Min:  tensor(0.0005, device='cuda:0')
Criterion check:  tensor([0.9982, 0.9979, 0.9999, 0.9996, 0.9993, 1.0009, 0.9997, 0.9982, 1.0098,
        1.0139], device='cuda:0') tensor(193, device='cuda:0')
max of Lambda2 tensor(221603.4531, device='cuda:0')
min of Lambda2 tensor(1.5959e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0506, device='cuda:0')
min of grad d_p:  tensor(-0.0614, device='cuda:0')
max|min: (J_L, Jta/N)  (0.050600506365299225, 0.050600286573171616, ratio: 0.9999956488609314)|(-0.061410076916217804, -0.0614105723798275)

 check Jacobi res:  torch.Size([793601]) max:  tensor(6.4075e-07, device='cuda:0') mean:  tensor(8.0479e-11, device='cuda:0') min:  tensor(-3.7253e-07, device='cuda:0') norm:  tensor(5.2543e-06, device='cuda:0') MSE:  tensor(6.6209e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0012, device='cuda:0') mean:  tensor(6.2992e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0132, device='cuda:0') MSE:  tensor(1.6584e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0388, device='cuda:0')
min of d_p_list:  tensor(-0.0412, device='cuda:0')
Epoch:  121  
Training Loss: 0.01453999150544405
Test Loss:  0.014082074165344238
Test Acc:  0.0
Valid Loss:  0.018009208142757416
Valid Acc:  0.0
std:  0.028304192050824788 
thres:  3.673873338848353e-05
Preserved_eigens number check:  512
 12%|█▏        | 121/1000 [37:02<4:17:08, 17.55s/it]Epoch:   122
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  498
Criterion check: 
Mean:  tensor(-0.1632, device='cuda:0') 
Std:  tensor(247.8635, device='cuda:0') 
ABS Max:  tensor(4723.6802, device='cuda:0') 
ABS Min:  tensor(0.0012, device='cuda:0')
Criterion check:  tensor([1.0041, 0.9979, 1.0005, 1.0001, 0.9992, 0.9997, 0.9999, 1.0156, 0.9972,
        1.0000], device='cuda:0') tensor(186, device='cuda:0')
max of Lambda2 tensor(199242.3906, device='cuda:0')
min of Lambda2 tensor(1.1241e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0319, device='cuda:0')
min of grad d_p:  tensor(-0.0343, device='cuda:0')
max|min: (J_L, Jta/N)  (0.031944639980793, 0.03194476291537285, ratio: 1.0000038146972656)|(-0.03429058566689491, -0.03429046645760536)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.2873e-07, device='cuda:0') mean:  tensor(7.9203e-12, device='cuda:0') min:  tensor(-1.4156e-07, device='cuda:0') norm:  tensor(2.6277e-06, device='cuda:0') MSE:  tensor(3.3112e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0009, device='cuda:0') mean:  tensor(4.3158e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0087, device='cuda:0') MSE:  tensor(1.0984e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0280, device='cuda:0')
min of d_p_list:  tensor(-0.0348, device='cuda:0')
Epoch:  122  
Training Loss: 0.01038376148790121
Test Loss:  0.010255840606987476
Test Acc:  0.0
Valid Loss:  0.011359104886651039
Valid Acc:  0.0
std:  0.007341419092070149 
thres:  2.035321965813637e-05
Preserved_eigens number check:  512
 12%|█▏        | 122/1000 [37:19<4:15:16, 17.44s/it]Epoch:   123
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  494
Criterion check: 
Mean:  tensor(-0.6396, device='cuda:0') 
Std:  tensor(11.7648, device='cuda:0') 
ABS Max:  tensor(203.8045, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([1.0015, 1.0059, 1.0106, 0.9993, 1.0298, 0.9961, 1.0004, 1.0056, 1.0718,
        0.9762], device='cuda:0') tensor(135, device='cuda:0')
max of Lambda2 tensor(209651.1406, device='cuda:0')
min of Lambda2 tensor(1.1924e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0188, device='cuda:0')
min of grad d_p:  tensor(-0.0153, device='cuda:0')
max|min: (J_L, Jta/N)  (0.01877428963780403, 0.018774718046188354, ratio: 1.0000227689743042)|(-0.01530324388295412, -0.015303326770663261)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.4808e-07, device='cuda:0') mean:  tensor(5.9306e-11, device='cuda:0') min:  tensor(-4.9733e-07, device='cuda:0') norm:  tensor(7.9361e-06, device='cuda:0') MSE:  tensor(1.0000e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(1.9135e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0041, device='cuda:0') MSE:  tensor(5.1311e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0647, device='cuda:0')
min of d_p_list:  tensor(-0.0793, device='cuda:0')
Epoch:  123  
Training Loss: 0.022641867399215698
Test Loss:  0.02290504053235054
Test Acc:  0.0
Valid Loss:  0.023811189457774162
Valid Acc:  0.0
std:  0.005296163924333835 
thres:  1.862436607480049e-05
Preserved_eigens number check:  512
 12%|█▏        | 123/1000 [37:37<4:17:02, 17.59s/it]Epoch:   124
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  498
Criterion check: 
Mean:  tensor(-8.5393, device='cuda:0') 
Std:  tensor(167.6827, device='cuda:0') 
ABS Max:  tensor(3765.5374, device='cuda:0') 
ABS Min:  tensor(0.0006, device='cuda:0')
Criterion check:  tensor([1.0137, 1.0001, 0.9993, 1.0001, 1.0006, 1.0000, 0.9990, 0.9962, 1.0014,
        0.9995], device='cuda:0') tensor(140, device='cuda:0')
max of Lambda2 tensor(268154.1875, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0329, device='cuda:0')
min of grad d_p:  tensor(-0.0469, device='cuda:0')
max|min: (J_L, Jta/N)  (0.032889965921640396, 0.03288980573415756, ratio: 0.9999951124191284)|(-0.04692712426185608, -0.04692719131708145)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.6880e-07, device='cuda:0') mean:  tensor(6.6800e-11, device='cuda:0') min:  tensor(-3.3155e-07, device='cuda:0') norm:  tensor(4.7115e-06, device='cuda:0') MSE:  tensor(5.9368e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0006, device='cuda:0') mean:  tensor(3.0968e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0062, device='cuda:0') MSE:  tensor(7.8129e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0674, device='cuda:0')
min of d_p_list:  tensor(-0.0558, device='cuda:0')
Epoch:  124  
Training Loss: 0.011306686326861382
Test Loss:  0.010546322911977768
Test Acc:  0.0
Valid Loss:  0.012023195624351501
Valid Acc:  0.0
std:  0.005790117578709298 
thres:  1.664661578834057e-05
Preserved_eigens number check:  512
 12%|█▏        | 124/1000 [37:55<4:14:58, 17.46s/it]Epoch:   125
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  501
Criterion check: 
Mean:  tensor(2.6333, device='cuda:0') 
Std:  tensor(93.0451, device='cuda:0') 
ABS Max:  tensor(1267.9088, device='cuda:0') 
ABS Min:  tensor(0.0050, device='cuda:0')
Criterion check:  tensor([0.9820, 0.9811, 0.9741, 1.0365, 1.0037, 1.0106, 0.9671, 0.8199, 1.0535,
        1.0062], device='cuda:0') tensor(232, device='cuda:0')
max of Lambda2 tensor(253512.1250, device='cuda:0')
min of Lambda2 tensor(1.7970e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0161, device='cuda:0')
min of grad d_p:  tensor(-0.0280, device='cuda:0')
max|min: (J_L, Jta/N)  (0.016068678349256516, 0.016068480908870697, ratio: 0.9999877214431763)|(-0.027995020151138306, -0.027994658797979355)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.9150e-07, device='cuda:0') mean:  tensor(-2.7931e-11, device='cuda:0') min:  tensor(-3.6508e-07, device='cuda:0') norm:  tensor(5.3730e-06, device='cuda:0') MSE:  tensor(6.7704e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0027, device='cuda:0') mean:  tensor(1.4710e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0304, device='cuda:0') MSE:  tensor(3.8253e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0194, device='cuda:0')
min of d_p_list:  tensor(-0.0271, device='cuda:0')
Epoch:  125  
Training Loss: 0.007545383647084236
Test Loss:  0.008096783421933651
Test Acc:  0.0
Valid Loss:  0.00957941822707653
Valid Acc:  0.0
std:  0.005184593837344722 
thres:  1.3283538073301316e-05
Preserved_eigens number check:  512
 12%|█▎        | 125/1000 [38:12<4:15:21, 17.51s/it]Epoch:   126
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  497
Criterion check: 
Mean:  tensor(0.5040, device='cuda:0') 
Std:  tensor(14.9883, device='cuda:0') 
ABS Max:  tensor(208.8068, device='cuda:0') 
ABS Min:  tensor(0.0006, device='cuda:0')
Criterion check:  tensor([1.0015, 0.9972, 1.0020, 1.0186, 0.9943, 1.0004, 1.0135, 0.9520, 0.9901,
        1.0009], device='cuda:0') tensor(139, device='cuda:0')
max of Lambda2 tensor(250706.0781, device='cuda:0')
min of Lambda2 tensor(1.1399e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0084, device='cuda:0')
min of grad d_p:  tensor(-0.0167, device='cuda:0')
max|min: (J_L, Jta/N)  (0.008397392928600311, 0.008397387340664864, ratio: 0.9999993443489075)|(-0.016677798703312874, -0.016677698120474815)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.1281e-07, device='cuda:0') mean:  tensor(1.8927e-11, device='cuda:0') min:  tensor(-1.4249e-07, device='cuda:0') norm:  tensor(2.8166e-06, device='cuda:0') MSE:  tensor(3.5491e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(2.9280e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0057, device='cuda:0') MSE:  tensor(7.1556e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1718, device='cuda:0')
min of d_p_list:  tensor(-0.0839, device='cuda:0')
Epoch:  126  
Training Loss: 0.030477724969387054
Test Loss:  0.0308041013777256
Test Acc:  0.0
Valid Loss:  0.03179967775940895
Valid Acc:  0.0
std:  0.00869090541299363 
thres:  1.6471084766089918e-05
Preserved_eigens number check:  512
 13%|█▎        | 126/1000 [38:30<4:17:31, 17.68s/it]Epoch:   127
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  501
Criterion check: 
Mean:  tensor(-2.9117, device='cuda:0') 
Std:  tensor(199.5764, device='cuda:0') 
ABS Max:  tensor(3083.8125, device='cuda:0') 
ABS Min:  tensor(0.0096, device='cuda:0')
Criterion check:  tensor([1.0037, 0.9928, 0.9818, 0.9995, 0.9991, 1.0019, 0.9978, 1.2784, 0.9868,
        1.2129], device='cuda:0') tensor(231, device='cuda:0')
max of Lambda2 tensor(212298.3750, device='cuda:0')
min of Lambda2 tensor(9.9198e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0718, device='cuda:0')
min of grad d_p:  tensor(-0.0703, device='cuda:0')
max|min: (J_L, Jta/N)  (0.07180222868919373, 0.07180205732584, ratio: 0.999997615814209)|(-0.07033011317253113, -0.07032975554466248)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.6694e-07, device='cuda:0') mean:  tensor(-1.3024e-10, device='cuda:0') min:  tensor(-6.2259e-07, device='cuda:0') norm:  tensor(6.5362e-06, device='cuda:0') MSE:  tensor(8.2361e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0042, device='cuda:0') mean:  tensor(3.1624e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0673, device='cuda:0') MSE:  tensor(8.4844e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1249, device='cuda:0')
min of d_p_list:  tensor(-0.0600, device='cuda:0')
Epoch:  127  
Training Loss: 0.03651832044124603
Test Loss:  0.04187513515353203
Test Acc:  0.0
Valid Loss:  0.042445968836545944
Valid Acc:  0.0
std:  0.011008108862769416 
thres:  2.169799655675888e-05
Preserved_eigens number check:  512
 13%|█▎        | 127/1000 [38:48<4:16:53, 17.66s/it]Epoch:   128
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  502
Criterion check: 
Mean:  tensor(6.3710, device='cuda:0') 
Std:  tensor(314.3492, device='cuda:0') 
ABS Max:  tensor(5999.2832, device='cuda:0') 
ABS Min:  tensor(0.0030, device='cuda:0')
Criterion check:  tensor([0.9963, 1.0017, 1.0002, 0.9986, 0.9994, 1.0002, 0.9997, 1.0111, 0.9893,
        0.9929], device='cuda:0') tensor(192, device='cuda:0')
max of Lambda2 tensor(231764.4688, device='cuda:0')
min of Lambda2 tensor(8.9817e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1133, device='cuda:0')
min of grad d_p:  tensor(-0.0788, device='cuda:0')
max|min: (J_L, Jta/N)  (0.11328652501106262, 0.1132863312959671, ratio: 0.9999982714653015)|(-0.0787741169333458, -0.078774094581604)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.0885e-07, device='cuda:0') mean:  tensor(3.8083e-11, device='cuda:0') min:  tensor(-2.5146e-07, device='cuda:0') norm:  tensor(4.0676e-06, device='cuda:0') MSE:  tensor(5.1255e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0021, device='cuda:0') mean:  tensor(1.4468e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0297, device='cuda:0') MSE:  tensor(3.7484e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0400, device='cuda:0')
min of d_p_list:  tensor(-0.0402, device='cuda:0')
Epoch:  128  
Training Loss: 0.016074078157544136
Test Loss:  0.018633050844073296
Test Acc:  0.0
Valid Loss:  0.019797448068857193
Valid Acc:  0.0
std:  0.011207164659824496 
thres:  2.038443870842457e-05
Preserved_eigens number check:  512
 13%|█▎        | 128/1000 [39:05<4:13:52, 17.47s/it]Epoch:   129
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  500
Criterion check: 
Mean:  tensor(0.1340, device='cuda:0') 
Std:  tensor(26.1448, device='cuda:0') 
ABS Max:  tensor(436.2250, device='cuda:0') 
ABS Min:  tensor(0.0010, device='cuda:0')
Criterion check:  tensor([1.0011, 0.9999, 1.0018, 1.0002, 0.9999, 1.0005, 0.9991, 1.0012, 1.0343,
        1.0006], device='cuda:0') tensor(162, device='cuda:0')
max of Lambda2 tensor(248979., device='cuda:0')
min of Lambda2 tensor(3.6934e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0716, device='cuda:0')
min of grad d_p:  tensor(-0.0527, device='cuda:0')
max|min: (J_L, Jta/N)  (0.07161317765712738, 0.07161315530538559, ratio: 0.9999997019767761)|(-0.05267256125807762, -0.05267234146595001)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.1444e-07, device='cuda:0') mean:  tensor(-3.7145e-11, device='cuda:0') min:  tensor(-3.6508e-07, device='cuda:0') norm:  tensor(4.5254e-06, device='cuda:0') MSE:  tensor(5.7023e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0011, device='cuda:0') mean:  tensor(3.9518e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0081, device='cuda:0') MSE:  tensor(1.0158e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.2079, device='cuda:0')
min of d_p_list:  tensor(-0.2667, device='cuda:0')
Epoch:  129  
Training Loss: 0.04543462023139
Test Loss:  0.04392941668629646
Test Acc:  0.0
Valid Loss:  0.04681002348661423
Valid Acc:  0.0
std:  0.01371251639981709 
thres:  2.721002548933029e-05
Preserved_eigens number check:  512
 13%|█▎        | 129/1000 [39:22<4:13:26, 17.46s/it]Epoch:   130
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  500
Criterion check: 
Mean:  tensor(-44.5992, device='cuda:0') 
Std:  tensor(627.7539, device='cuda:0') 
ABS Max:  tensor(13169.3125, device='cuda:0') 
ABS Min:  tensor(0.0017, device='cuda:0')
Criterion check:  tensor([0.9996, 1.0029, 0.9980, 1.0025, 1.0013, 1.0006, 0.9821, 1.0358, 0.9993,
        0.8984], device='cuda:0') tensor(196, device='cuda:0')
max of Lambda2 tensor(197114.8281, device='cuda:0')
min of Lambda2 tensor(4.2974e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0963, device='cuda:0')
min of grad d_p:  tensor(-0.1423, device='cuda:0')
max|min: (J_L, Jta/N)  (0.09625598043203354, 0.09625589102506638, ratio: 0.9999990463256836)|(-0.14231868088245392, -0.14231854677200317)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.3411e-07, device='cuda:0') mean:  tensor(-1.8675e-11, device='cuda:0') min:  tensor(-2.0862e-07, device='cuda:0') norm:  tensor(2.5573e-06, device='cuda:0') MSE:  tensor(3.2224e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0036, device='cuda:0') mean:  tensor(2.0801e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0489, device='cuda:0') MSE:  tensor(6.1677e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1281, device='cuda:0')
min of d_p_list:  tensor(-0.1149, device='cuda:0')
Epoch:  130  
Training Loss: 0.07264111936092377
Test Loss:  0.08622905611991882
Test Acc:  0.0
Valid Loss:  0.09443897753953934
Valid Acc:  0.0
std:  0.01881467895041942 
thres:  4.02291726320982e-05
Preserved_eigens number check:  512
 13%|█▎        | 130/1000 [39:40<4:13:25, 17.48s/it]Epoch:   131
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  501
Criterion check: 
Mean:  tensor(5.2495, device='cuda:0') 
Std:  tensor(60.1552, device='cuda:0') 
ABS Max:  tensor(866.1318, device='cuda:0') 
ABS Min:  tensor(0.0031, device='cuda:0')
Criterion check:  tensor([0.9999, 0.9994, 0.9999, 0.9740, 0.9992, 1.0004, 1.0007, 1.0072, 0.9963,
        1.0027], device='cuda:0') tensor(176, device='cuda:0')
max of Lambda2 tensor(231889.8594, device='cuda:0')
min of Lambda2 tensor(3.3900e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1693, device='cuda:0')
min of grad d_p:  tensor(-0.1646, device='cuda:0')
max|min: (J_L, Jta/N)  (0.1693262904882431, 0.1693265438079834, ratio: 1.0000015497207642)|(-0.16461993753910065, -0.16462008655071259)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.0233e-07, device='cuda:0') mean:  tensor(8.5948e-11, device='cuda:0') min:  tensor(-3.4273e-07, device='cuda:0') norm:  tensor(4.9943e-06, device='cuda:0') MSE:  tensor(6.2932e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0015, device='cuda:0') mean:  tensor(6.4737e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0145, device='cuda:0') MSE:  tensor(1.8308e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0517, device='cuda:0')
min of d_p_list:  tensor(-0.0797, device='cuda:0')
Epoch:  131  
Training Loss: 0.03690513223409653
Test Loss:  0.04601779952645302
Test Acc:  0.0
Valid Loss:  0.0504126101732254
Valid Acc:  0.0
std:  0.018317515771831307 
thres:  4.1514654085040094e-05
Preserved_eigens number check:  512
 13%|█▎        | 131/1000 [39:57<4:13:37, 17.51s/it]Epoch:   132
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  499
Criterion check: 
Mean:  tensor(1.8056, device='cuda:0') 
Std:  tensor(24.0515, device='cuda:0') 
ABS Max:  tensor(277.5095, device='cuda:0') 
ABS Min:  tensor(0.0012, device='cuda:0')
Criterion check:  tensor([0.9995, 0.9997, 0.9992, 1.0057, 0.9994, 1.0002, 0.9964, 0.9951, 0.9949,
        0.9807], device='cuda:0') tensor(176, device='cuda:0')
max of Lambda2 tensor(221444.1562, device='cuda:0')
min of Lambda2 tensor(5.8026e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0981, device='cuda:0')
min of grad d_p:  tensor(-0.0881, device='cuda:0')
max|min: (J_L, Jta/N)  (0.09806521236896515, 0.0980650782585144, ratio: 0.9999986290931702)|(-0.08814562857151031, -0.08814547210931778)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.7881e-07, device='cuda:0') mean:  tensor(6.5405e-12, device='cuda:0') min:  tensor(-1.8626e-07, device='cuda:0') norm:  tensor(2.6450e-06, device='cuda:0') MSE:  tensor(3.3329e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(4.7760e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0097, device='cuda:0') MSE:  tensor(1.2170e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1291, device='cuda:0')
min of d_p_list:  tensor(-0.1985, device='cuda:0')
Epoch:  132  
Training Loss: 0.04587846249341965
Test Loss:  0.05357930436730385
Test Acc:  0.0
Valid Loss:  0.06056351214647293
Valid Acc:  0.0
std:  0.018189084321944327 
thres:  4.3386682495474816e-05
Preserved_eigens number check:  512
 13%|█▎        | 132/1000 [40:15<4:12:02, 17.42s/it]Epoch:   133
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  499
Criterion check: 
Mean:  tensor(-26.3315, device='cuda:0') 
Std:  tensor(600.2843, device='cuda:0') 
ABS Max:  tensor(13579.0713, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([1.0008, 1.0002, 1.0004, 1.0003, 1.0016, 0.9990, 0.9994, 1.0000, 1.0000,
        0.5869], device='cuda:0') tensor(154, device='cuda:0')
max of Lambda2 tensor(261222.4219, device='cuda:0')
min of Lambda2 tensor(9.6643e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1311, device='cuda:0')
min of grad d_p:  tensor(-0.1693, device='cuda:0')
max|min: (J_L, Jta/N)  (0.13110987842082977, 0.1311100423336029, ratio: 1.0000011920928955)|(-0.16930972039699554, -0.16931025683879852)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.9977e-07, device='cuda:0') mean:  tensor(-1.3467e-10, device='cuda:0') min:  tensor(-9.0152e-07, device='cuda:0') norm:  tensor(9.6607e-06, device='cuda:0') MSE:  tensor(1.2173e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(3.1112e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0061, device='cuda:0') MSE:  tensor(7.7342e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1297, device='cuda:0')
min of d_p_list:  tensor(-0.1426, device='cuda:0')
Epoch:  133  
Training Loss: 0.16204380989074707
Test Loss:  0.17027176916599274
Test Acc:  0.0
Valid Loss:  0.1714731603860855
Valid Acc:  0.0
std:  0.04631698814016058 
thres:  7.25806288421154e-05
Preserved_eigens number check:  512
 13%|█▎        | 133/1000 [40:32<4:12:35, 17.48s/it]Epoch:   134
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  502
Criterion check: 
Mean:  tensor(6.3334, device='cuda:0') 
Std:  tensor(111.6560, device='cuda:0') 
ABS Max:  tensor(2211.2808, device='cuda:0') 
ABS Min:  tensor(0.0015, device='cuda:0')
Criterion check:  tensor([1.0009, 0.9995, 0.9988, 1.0006, 1.0026, 1.0015, 1.0119, 1.0041, 1.0011,
        0.9717], device='cuda:0') tensor(184, device='cuda:0')
max of Lambda2 tensor(210603.5938, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1169, device='cuda:0')
min of grad d_p:  tensor(-0.1946, device='cuda:0')
max|min: (J_L, Jta/N)  (0.11690591275691986, 0.11690609902143478, ratio: 1.0000015497207642)|(-0.19455838203430176, -0.19455872476100922)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.1723e-07, device='cuda:0') mean:  tensor(9.4583e-11, device='cuda:0') min:  tensor(-2.2119e-07, device='cuda:0') norm:  tensor(5.2205e-06, device='cuda:0') MSE:  tensor(6.5783e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0013, device='cuda:0') mean:  tensor(9.8987e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0212, device='cuda:0') MSE:  tensor(2.6734e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.4472, device='cuda:0')
min of d_p_list:  tensor(-0.3266, device='cuda:0')
Epoch:  134  
Training Loss: 0.42162615060806274
Test Loss:  0.4291933476924896
Test Acc:  0.0
Valid Loss:  0.42674580216407776
Valid Acc:  0.0
std:  0.1438875768979512 
thres:  0.00014781893491744996
Preserved_eigens number check:  512
 13%|█▎        | 134/1000 [40:50<4:14:35, 17.64s/it]Epoch:   135
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  497
Criterion check: 
Mean:  tensor(1.8412, device='cuda:0') 
Std:  tensor(35.2946, device='cuda:0') 
ABS Max:  tensor(760.5908, device='cuda:0') 
ABS Min:  tensor(1.9326e-05, device='cuda:0')
Criterion check:  tensor([0.9991, 1.0001, 1.0002, 0.9996, 1.0000, 1.0009, 0.9997, 1.0009, 0.9993,
        0.9996], device='cuda:0') tensor(166, device='cuda:0')
max of Lambda2 tensor(78668.5938, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2903, device='cuda:0')
min of grad d_p:  tensor(-0.2026, device='cuda:0')
max|min: (J_L, Jta/N)  (0.290347695350647, 0.2903478145599365, ratio: 1.0000003576278687)|(-0.20263338088989258, -0.20263369381427765)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.1292e-07, device='cuda:0') mean:  tensor(5.6342e-11, device='cuda:0') min:  tensor(-2.2352e-07, device='cuda:0') norm:  tensor(2.9453e-06, device='cuda:0') MSE:  tensor(3.7112e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0006, device='cuda:0') mean:  tensor(3.0196e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0062, device='cuda:0') MSE:  tensor(7.7960e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.7985, device='cuda:0')
min of d_p_list:  tensor(-0.6653, device='cuda:0')
Epoch:  135  
Training Loss: 1.055267095565796
Test Loss:  1.1301767826080322
Test Acc:  0.0
Valid Loss:  0.9955995082855225
Valid Acc:  0.0
std:  0.3816327743833118 
thres:  0.00034434413015842436
Preserved_eigens number check:  512
 14%|█▎        | 135/1000 [41:08<4:13:54, 17.61s/it]Epoch:   136
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  495
Criterion check: 
Mean:  tensor(-0.6156, device='cuda:0') 
Std:  tensor(20.9776, device='cuda:0') 
ABS Max:  tensor(313.7559, device='cuda:0') 
ABS Min:  tensor(0.0019, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0003, 1.0000, 1.0000, 0.9999, 0.9998, 1.0008, 0.9984,
        0.9999], device='cuda:0') tensor(171, device='cuda:0')
max of Lambda2 tensor(79857.6562, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.9803, device='cuda:0')
min of grad d_p:  tensor(-0.5062, device='cuda:0')
max|min: (J_L, Jta/N)  (0.9802887439727783, 0.980289101600647, ratio: 1.0000003576278687)|(-0.5062174797058105, -0.5062174797058105)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.5763e-07, device='cuda:0') mean:  tensor(-5.6981e-12, device='cuda:0') min:  tensor(-4.1723e-07, device='cuda:0') norm:  tensor(3.2105e-06, device='cuda:0') MSE:  tensor(4.0454e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0011, device='cuda:0') mean:  tensor(6.1907e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0115, device='cuda:0') MSE:  tensor(1.4497e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(11.9678, device='cuda:0')
min of d_p_list:  tensor(-10.6004, device='cuda:0')
Epoch:  136  
Training Loss: 21375.767578125
Test Loss:  22705.6171875
Test Acc:  0.0
Valid Loss:  20252.404296875
Valid Acc:  0.0
std:  8550.138556833343 
thres:  4.275490478728711
Preserved_eigens number check:  512
 14%|█▎        | 136/1000 [41:25<4:11:40, 17.48s/it]Epoch:   137
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  509
Criterion check: 
Mean:  tensor(5.8783, device='cuda:0') 
Std:  tensor(81.8969, device='cuda:0') 
ABS Max:  tensor(1570.5425, device='cuda:0') 
ABS Min:  tensor(0.0015, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0008, 1.0002, 1.0000, 0.9999, 0.9998, 0.9997, 1.0012,
        0.9930], device='cuda:0') tensor(182, device='cuda:0')
max of Lambda2 tensor(216668.8906, device='cuda:0')
min of Lambda2 tensor(3.4929e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(12.6344, device='cuda:0')
min of grad d_p:  tensor(-49.8902, device='cuda:0')
max|min: (J_L, Jta/N)  (12.634424209594727, 12.634410858154297, ratio: 0.999998927116394)|(-49.890167236328125, -49.89019775390625)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.0518e-05, device='cuda:0') mean:  tensor(1.5196e-11, device='cuda:0') min:  tensor(-1.9073e-05, device='cuda:0') norm:  tensor(7.6047e-05, device='cuda:0') MSE:  tensor(9.5825e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0072, device='cuda:0') mean:  tensor(3.1975e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0683, device='cuda:0') MSE:  tensor(8.6061e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.2705, device='cuda:0')
min of d_p_list:  tensor(-0.2566, device='cuda:0')
Epoch:  137  
Training Loss: 365.6869812011719
Test Loss:  395.67926025390625
Test Acc:  0.0
Valid Loss:  333.5455322265625
Valid Acc:  0.0
std:  8514.748908586458 
thres:  4.348618699276447
Preserved_eigens number check:  512
 14%|█▎        | 137/1000 [41:43<4:13:15, 17.61s/it]Epoch:   138
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  505
Criterion check: 
Mean:  tensor(-2.5409, device='cuda:0') 
Std:  tensor(69.7569, device='cuda:0') 
ABS Max:  tensor(1475.9635, device='cuda:0') 
ABS Min:  tensor(0.0008, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0000, 1.0000, 0.9999, 0.9988, 1.0001, 1.0001, 1.0003,
        0.9997], device='cuda:0') tensor(186, device='cuda:0')
max of Lambda2 tensor(217359.0781, device='cuda:0')
min of Lambda2 tensor(2.7432e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(6.9362, device='cuda:0')
min of grad d_p:  tensor(-27.5757, device='cuda:0')
max|min: (J_L, Jta/N)  (6.936226844787598, 6.936226844787598, ratio: 1.0)|(-27.575748443603516, -27.575733184814453)

 check Jacobi res:  torch.Size([793601]) max:  tensor(9.5367e-06, device='cuda:0') mean:  tensor(3.2701e-10, device='cuda:0') min:  tensor(-1.5259e-05, device='cuda:0') norm:  tensor(4.2859e-05, device='cuda:0') MSE:  tensor(5.4006e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0043, device='cuda:0') mean:  tensor(2.3276e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0481, device='cuda:0') MSE:  tensor(6.0557e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0730, device='cuda:0')
min of d_p_list:  tensor(-0.0874, device='cuda:0')
Epoch:  138  
Training Loss: 86.44731903076172
Test Loss:  94.80119323730469
Test Acc:  0.0
Valid Loss:  77.90605163574219
Valid Acc:  0.0
std:  8506.001239615964 
thres:  4.365875754320621
Preserved_eigens number check:  512
 14%|█▍        | 138/1000 [42:00<4:10:53, 17.46s/it]Epoch:   139
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  506
Criterion check: 
Mean:  tensor(-7.3363, device='cuda:0') 
Std:  tensor(224.1439, device='cuda:0') 
ABS Max:  tensor(3214.5391, device='cuda:0') 
ABS Min:  tensor(0.0032, device='cuda:0')
Criterion check:  tensor([0.9999, 1.0001, 0.9997, 0.9962, 1.0007, 1.0008, 0.9987, 0.9970, 1.0161,
        0.9820], device='cuda:0') tensor(206, device='cuda:0')
max of Lambda2 tensor(216603.0938, device='cuda:0')
min of Lambda2 tensor(7.7042e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(3.7802, device='cuda:0')
min of grad d_p:  tensor(-15.0100, device='cuda:0')
max|min: (J_L, Jta/N)  (3.7801589965820312, 3.780160665512085, ratio: 1.0000004768371582)|(-15.009992599487305, -15.00999641418457)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.7684e-06, device='cuda:0') mean:  tensor(1.4815e-10, device='cuda:0') min:  tensor(-3.3379e-06, device='cuda:0') norm:  tensor(2.1535e-05, device='cuda:0') MSE:  tensor(2.7136e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0528, device='cuda:0') mean:  tensor(0.0002, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.4486, device='cuda:0') MSE:  tensor(5.6529e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.2303, device='cuda:0')
min of d_p_list:  tensor(-0.1777, device='cuda:0')
Epoch:  139  
Training Loss: 26.11279296875
Test Loss:  29.203977584838867
Test Acc:  0.0
Valid Loss:  23.588783264160156
Valid Acc:  0.0
std:  8503.369993715385 
thres:  4.3710139876842495
Preserved_eigens number check:  512
 14%|█▍        | 139/1000 [42:18<4:10:40, 17.47s/it]Epoch:   140
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  503
Criterion check: 
Mean:  tensor(-7.3383, device='cuda:0') 
Std:  tensor(123.7727, device='cuda:0') 
ABS Max:  tensor(1572.9565, device='cuda:0') 
ABS Min:  tensor(0.0026, device='cuda:0')
Criterion check:  tensor([0.9997, 1.0003, 0.9995, 1.0002, 1.0024, 1.0008, 0.9990, 0.9963, 0.9995,
        1.0206], device='cuda:0') tensor(205, device='cuda:0')
max of Lambda2 tensor(216625.2500, device='cuda:0')
min of Lambda2 tensor(4.5512e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(2.0998, device='cuda:0')
min of grad d_p:  tensor(-8.3040, device='cuda:0')
max|min: (J_L, Jta/N)  (2.0997977256774902, 2.0997979640960693, ratio: 1.0000001192092896)|(-8.30398178100586, -8.303982734680176)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.3842e-06, device='cuda:0') mean:  tensor(-4.3018e-11, device='cuda:0') min:  tensor(-4.7684e-06, device='cuda:0') norm:  tensor(1.7004e-05, device='cuda:0') MSE:  tensor(2.1426e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0060, device='cuda:0') mean:  tensor(4.3348e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0883, device='cuda:0') MSE:  tensor(1.1127e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0440, device='cuda:0')
min of d_p_list:  tensor(-0.0400, device='cuda:0')
Epoch:  140  
Training Loss: 10.170747756958008
Test Loss:  11.324140548706055
Test Acc:  0.0
Valid Loss:  9.29637336730957
Valid Acc:  0.0
std:  8502.43381832836 
thres:  4.3728370838165285
Preserved_eigens number check:  512
 14%|█▍        | 140/1000 [42:35<4:12:16, 17.60s/it]Epoch:   141
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  503
Criterion check: 
Mean:  tensor(-19.6634, device='cuda:0') 
Std:  tensor(475.4588, device='cuda:0') 
ABS Max:  tensor(10732.0518, device='cuda:0') 
ABS Min:  tensor(0.0007, device='cuda:0')
Criterion check:  tensor([0.9999, 1.0000, 0.9987, 1.0001, 1.0003, 0.9999, 1.0001, 0.9980, 0.9947,
        1.0022], device='cuda:0') tensor(166, device='cuda:0')
max of Lambda2 tensor(216220.2031, device='cuda:0')
min of Lambda2 tensor(7.1466e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.1332, device='cuda:0')
min of grad d_p:  tensor(-4.4778, device='cuda:0')
max|min: (J_L, Jta/N)  (1.1331753730773926, 1.1331759691238403, ratio: 1.0000004768371582)|(-4.477755546569824, -4.477758884429932)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.5300e-06, device='cuda:0') mean:  tensor(3.0012e-10, device='cuda:0') min:  tensor(-1.1921e-06, device='cuda:0') norm:  tensor(1.7345e-05, device='cuda:0') MSE:  tensor(2.1856e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0033, device='cuda:0') mean:  tensor(1.4878e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0300, device='cuda:0') MSE:  tensor(3.7743e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1457, device='cuda:0')
min of d_p_list:  tensor(-0.2156, device='cuda:0')
Epoch:  141  
Training Loss: 4.152994155883789
Test Loss:  4.650537014007568
Test Acc:  0.0
Valid Loss:  3.9869136810302734
Valid Acc:  0.0
std:  136.7314675513787 
thres:  0.09851416702270509
Preserved_eigens number check:  512
 14%|█▍        | 141/1000 [42:52<4:09:33, 17.43s/it]Epoch:   142
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  505
Criterion check: 
Mean:  tensor(1.9592, device='cuda:0') 
Std:  tensor(31.8096, device='cuda:0') 
ABS Max:  tensor(468.7247, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([0.9999, 0.9999, 0.9991, 1.0001, 0.9971, 1.0311, 1.0027, 1.0003, 1.0127,
        1.0330], device='cuda:0') tensor(187, device='cuda:0')
max of Lambda2 tensor(216281.3438, device='cuda:0')
min of Lambda2 tensor(4.7104e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.6614, device='cuda:0')
min of grad d_p:  tensor(-3.0633, device='cuda:0')
max|min: (J_L, Jta/N)  (0.6613694429397583, 0.6613684296607971, ratio: 0.9999984502792358)|(-3.06327486038208, -3.0632712841033936)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.0133e-06, device='cuda:0') mean:  tensor(-1.7862e-10, device='cuda:0') min:  tensor(-3.5763e-06, device='cuda:0') norm:  tensor(1.7773e-05, device='cuda:0') MSE:  tensor(2.2395e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0048, device='cuda:0') mean:  tensor(2.8290e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0582, device='cuda:0') MSE:  tensor(7.3337e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0698, device='cuda:0')
min of d_p_list:  tensor(-0.1100, device='cuda:0')
Epoch:  142  
Training Loss: 1.9278080463409424
Test Loss:  2.133342742919922
Test Acc:  0.0
Valid Loss:  1.9077019691467285
Valid Acc:  0.0
std:  31.499003118133466 
thres:  0.02576233239173889
Preserved_eigens number check:  512
 14%|█▍        | 142/1000 [43:10<4:08:14, 17.36s/it]Epoch:   143
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  503
Criterion check: 
Mean:  tensor(15.8136, device='cuda:0') 
Std:  tensor(552.1768, device='cuda:0') 
ABS Max:  tensor(8054.0405, device='cuda:0') 
ABS Min:  tensor(0.0039, device='cuda:0')
Criterion check:  tensor([ 0.9943,  1.0017,  1.0067,  0.9979,  1.0082, -2.2081,  1.0146,  1.0088,
         0.9864,  1.2054], device='cuda:0') tensor(232, device='cuda:0')
max of Lambda2 tensor(216604.3750, device='cuda:0')
min of Lambda2 tensor(1.3842e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.4380, device='cuda:0')
min of grad d_p:  tensor(-1.9468, device='cuda:0')
max|min: (J_L, Jta/N)  (0.4380081295967102, 0.4380078613758087, ratio: 0.9999994039535522)|(-1.9467742443084717, -1.9467717409133911)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.0133e-06, device='cuda:0') mean:  tensor(-1.9595e-10, device='cuda:0') min:  tensor(-3.0994e-06, device='cuda:0') norm:  tensor(1.4282e-05, device='cuda:0') MSE:  tensor(1.7996e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0474, device='cuda:0') mean:  tensor(0.0002, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.4738, device='cuda:0') MSE:  tensor(5.9705e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0371, device='cuda:0')
min of d_p_list:  tensor(-0.0517, device='cuda:0')
Epoch:  143  
Training Loss: 0.8863216638565063
Test Loss:  0.9663335680961609
Test Acc:  0.0
Valid Loss:  0.9057138562202454
Valid Acc:  0.0
std:  9.305347274039145 
thres:  0.00865013291835785
Preserved_eigens number check:  512
 14%|█▍        | 143/1000 [43:28<4:10:18, 17.52s/it]Epoch:   144
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  504
Criterion check: 
Mean:  tensor(-0.8248, device='cuda:0') 
Std:  tensor(51.2652, device='cuda:0') 
ABS Max:  tensor(1021.7897, device='cuda:0') 
ABS Min:  tensor(0.0005, device='cuda:0')
Criterion check:  tensor([1.0006, 1.0001, 0.9997, 0.9998, 1.0010, 1.0014, 1.0002, 1.0000, 1.0003,
        1.0282], device='cuda:0') tensor(180, device='cuda:0')
max of Lambda2 tensor(216008.4219, device='cuda:0')
min of Lambda2 tensor(4.0398e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2483, device='cuda:0')
min of grad d_p:  tensor(-1.1445, device='cuda:0')
max|min: (J_L, Jta/N)  (0.24831825494766235, 0.24831831455230713, ratio: 1.000000238418579)|(-1.1444741487503052, -1.1444735527038574)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.4885e-06, device='cuda:0') mean:  tensor(7.4090e-11, device='cuda:0') min:  tensor(-5.9605e-07, device='cuda:0') norm:  tensor(7.9652e-06, device='cuda:0') MSE:  tensor(1.0037e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0019, device='cuda:0') mean:  tensor(1.0520e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0220, device='cuda:0') MSE:  tensor(2.7662e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0680, device='cuda:0')
min of d_p_list:  tensor(-0.0794, device='cuda:0')
Epoch:  144  
Training Loss: 0.5079116821289062
Test Loss:  0.5582878589630127
Test Acc:  0.0
Valid Loss:  0.5393635630607605
Valid Acc:  0.0
std:  3.554622931791284 
thres:  0.0035291566610336305
Preserved_eigens number check:  512
 14%|█▍        | 144/1000 [43:45<4:09:26, 17.48s/it]Epoch:   145
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  504
Criterion check: 
Mean:  tensor(-25.3718, device='cuda:0') 
Std:  tensor(520.5425, device='cuda:0') 
ABS Max:  tensor(11627.0400, device='cuda:0') 
ABS Min:  tensor(0.0007, device='cuda:0')
Criterion check:  tensor([1.0004, 1.0004, 1.0007, 1.0000, 1.0005, 0.9991, 0.9970, 0.9971, 1.0088,
        1.0354], device='cuda:0') tensor(174, device='cuda:0')
max of Lambda2 tensor(216276.3594, device='cuda:0')
min of Lambda2 tensor(2.6404e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1854, device='cuda:0')
min of grad d_p:  tensor(-1.1789, device='cuda:0')
max|min: (J_L, Jta/N)  (0.1853983998298645, 0.1853983998298645, ratio: 1.0)|(-1.178884506225586, -1.1788835525512695)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.6391e-07, device='cuda:0') mean:  tensor(5.0008e-12, device='cuda:0') min:  tensor(-9.5367e-07, device='cuda:0') norm:  tensor(4.3410e-06, device='cuda:0') MSE:  tensor(5.4700e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0040, device='cuda:0') mean:  tensor(2.2235e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0497, device='cuda:0') MSE:  tensor(6.2572e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0288, device='cuda:0')
min of d_p_list:  tensor(-0.0239, device='cuda:0')
Epoch:  145  
Training Loss: 0.22695212066173553
Test Loss:  0.2440134584903717
Test Acc:  0.0
Valid Loss:  0.24273182451725006
Valid Acc:  0.0
std:  1.4279166044127456 
thres:  0.0015403975337743758
Preserved_eigens number check:  512
 14%|█▍        | 145/1000 [44:02<4:07:30, 17.37s/it]Epoch:   146
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  503
Criterion check: 
Mean:  tensor(-201.5794, device='cuda:0') 
Std:  tensor(2793.3875, device='cuda:0') 
ABS Max:  tensor(34682.0742, device='cuda:0') 
ABS Min:  tensor(0.0140, device='cuda:0')
Criterion check:  tensor([  1.5041,   0.9388,   0.9286,   0.8919,   0.9416,   1.2862,   1.5621,
          3.4634,   0.8326, -57.2894], device='cuda:0') tensor(260, device='cuda:0')
max of Lambda2 tensor(216276.9531, device='cuda:0')
min of Lambda2 tensor(3.4316e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0915, device='cuda:0')
min of grad d_p:  tensor(-0.5762, device='cuda:0')
max|min: (J_L, Jta/N)  (0.09146290272474289, 0.09146280586719513, ratio: 0.999998927116394)|(-0.5762496590614319, -0.576248288154602)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.5705e-07, device='cuda:0') mean:  tensor(-9.3782e-11, device='cuda:0') min:  tensor(-1.3709e-06, device='cuda:0') norm:  tensor(5.3262e-06, device='cuda:0') MSE:  tensor(6.7114e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.2654, device='cuda:0') mean:  tensor(0.0014, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(2.7849, device='cuda:0') MSE:  tensor(3.5092e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0485, device='cuda:0')
min of d_p_list:  tensor(-0.0411, device='cuda:0')
Epoch:  146  
Training Loss: 0.20206792652606964
Test Loss:  0.21986211836338043
Test Acc:  0.0
Valid Loss:  0.2136523425579071
Valid Acc:  0.0
std:  0.6384717001720056 
thres:  0.000750212287902832
Preserved_eigens number check:  512
 15%|█▍        | 146/1000 [44:20<4:08:21, 17.45s/it]Epoch:   147
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  503
Criterion check: 
Mean:  tensor(2.1604, device='cuda:0') 
Std:  tensor(326.0641, device='cuda:0') 
ABS Max:  tensor(4523.0977, device='cuda:0') 
ABS Min:  tensor(0.0012, device='cuda:0')
Criterion check:  tensor([ 1.0277,  1.0006,  1.0001,  1.0014,  1.0170,  0.9962,  1.0154,  1.2351,
         0.9494, -0.0179], device='cuda:0') tensor(207, device='cuda:0')
max of Lambda2 tensor(216203.7969, device='cuda:0')
min of Lambda2 tensor(1.0858e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1860, device='cuda:0')
min of grad d_p:  tensor(-0.4538, device='cuda:0')
max|min: (J_L, Jta/N)  (0.18596678972244263, 0.1859716922044754, ratio: 1.0000263452529907)|(-0.45377227663993835, -0.45377057790756226)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.1055e-06, device='cuda:0') mean:  tensor(-2.0130e-10, device='cuda:0') min:  tensor(-4.9025e-06, device='cuda:0') norm:  tensor(1.8348e-05, device='cuda:0') MSE:  tensor(2.3120e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0109, device='cuda:0') mean:  tensor(8.1541e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1699, device='cuda:0') MSE:  tensor(2.1404e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0523, device='cuda:0')
min of d_p_list:  tensor(-0.0673, device='cuda:0')
Epoch:  147  
Training Loss: 0.13884693384170532
Test Loss:  0.14186373353004456
Test Acc:  0.0
Valid Loss:  0.15399855375289917
Valid Acc:  0.0
std:  0.27755720601368444 
thres:  0.00039242006540298466
Preserved_eigens number check:  512
 15%|█▍        | 147/1000 [44:37<4:07:52, 17.44s/it]Epoch:   148
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  505
Criterion check: 
Mean:  tensor(-0.6455, device='cuda:0') 
Std:  tensor(88.0164, device='cuda:0') 
ABS Max:  tensor(1341.9342, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([ 0.9996,  1.0002,  1.0011,  1.0002,  0.9978,  1.0923,  0.9953, -0.6462,
         0.9960,  1.0227], device='cuda:0') tensor(163, device='cuda:0')
max of Lambda2 tensor(215734.5000, device='cuda:0')
min of Lambda2 tensor(2.5988e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1861, device='cuda:0')
min of grad d_p:  tensor(-0.2652, device='cuda:0')
max|min: (J_L, Jta/N)  (0.1861443817615509, 0.18614596128463745, ratio: 1.000008463859558)|(-0.26515093445777893, -0.2651505768299103)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.9116e-07, device='cuda:0') mean:  tensor(-1.1890e-10, device='cuda:0') min:  tensor(-1.5795e-06, device='cuda:0') norm:  tensor(6.2821e-06, device='cuda:0') MSE:  tensor(7.9160e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0020, device='cuda:0') mean:  tensor(1.5011e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0292, device='cuda:0') MSE:  tensor(3.6831e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0666, device='cuda:0')
min of d_p_list:  tensor(-0.0810, device='cuda:0')
Epoch:  148  
Training Loss: 0.1467016488313675
Test Loss:  0.15750432014465332
Test Acc:  0.0
Valid Loss:  0.1555059552192688
Valid Acc:  0.0
std:  0.13580958067307022 
thres:  0.00024449606239795684
Preserved_eigens number check:  512
 15%|█▍        | 148/1000 [44:55<4:08:08, 17.47s/it]Epoch:   149
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  502
Criterion check: 
Mean:  tensor(-3.1154, device='cuda:0') 
Std:  tensor(130.1524, device='cuda:0') 
ABS Max:  tensor(2745.5383, device='cuda:0') 
ABS Min:  tensor(0.0034, device='cuda:0')
Criterion check:  tensor([0.9933, 0.9990, 0.9974, 0.9687, 0.9959, 1.0017, 1.0435, 0.9619, 0.8925,
        1.0045], device='cuda:0') tensor(180, device='cuda:0')
max of Lambda2 tensor(215802.8906, device='cuda:0')
min of Lambda2 tensor(3.1834e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3400, device='cuda:0')
min of grad d_p:  tensor(-0.2628, device='cuda:0')
max|min: (J_L, Jta/N)  (0.33995139598846436, 0.33995184302330017, ratio: 1.000001311302185)|(-0.26278188824653625, -0.26278021931648254)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.5763e-07, device='cuda:0') mean:  tensor(-1.3028e-10, device='cuda:0') min:  tensor(-1.6689e-06, device='cuda:0') norm:  tensor(7.0529e-06, device='cuda:0') MSE:  tensor(8.8872e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0092, device='cuda:0') mean:  tensor(4.5176e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0943, device='cuda:0') MSE:  tensor(1.1877e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0393, device='cuda:0')
min of d_p_list:  tensor(-0.0748, device='cuda:0')
Epoch:  149  
Training Loss: 0.05030890554189682
Test Loss:  0.05317729711532593
Test Acc:  0.0
Valid Loss:  0.051122501492500305
Valid Acc:  0.0
std:  0.061093394003849055 
thres:  0.00015297550708055497
Preserved_eigens number check:  512
 15%|█▍        | 149/1000 [45:12<4:07:27, 17.45s/it]Epoch:   150
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  505
Criterion check: 
Mean:  tensor(0.4164, device='cuda:0') 
Std:  tensor(86.5157, device='cuda:0') 
ABS Max:  tensor(1526.9225, device='cuda:0') 
ABS Min:  tensor(0.0008, device='cuda:0')
Criterion check:  tensor([0.9944, 1.0032, 1.0008, 1.0035, 0.9971, 0.9988, 1.0025, 0.9838, 1.0115,
        0.9927], device='cuda:0') tensor(187, device='cuda:0')
max of Lambda2 tensor(215818.7656, device='cuda:0')
min of Lambda2 tensor(9.0193e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2045, device='cuda:0')
min of grad d_p:  tensor(-0.1819, device='cuda:0')
max|min: (J_L, Jta/N)  (0.2044941931962967, 0.20449711382389069, ratio: 1.000014305114746)|(-0.18190783262252808, -0.18190449476242065)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.0319e-06, device='cuda:0') mean:  tensor(-2.5223e-10, device='cuda:0') min:  tensor(-4.0159e-06, device='cuda:0') norm:  tensor(1.6774e-05, device='cuda:0') MSE:  tensor(2.1137e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0025, device='cuda:0') mean:  tensor(1.9365e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0400, device='cuda:0') MSE:  tensor(5.0458e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0426, device='cuda:0')
min of d_p_list:  tensor(-0.0181, device='cuda:0')
Epoch:  150  
Training Loss: 0.02185654640197754
Test Loss:  0.023422017693519592
Test Acc:  0.0
Valid Loss:  0.02191026322543621
Valid Acc:  0.0
std:  0.06628546979670694 
thres:  0.00011195639222860337
Preserved_eigens number check:  512
 15%|█▌        | 150/1000 [45:30<4:09:00, 17.58s/it]Epoch:   151
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  502
Criterion check: 
Mean:  tensor(1.9057, device='cuda:0') 
Std:  tensor(29.9726, device='cuda:0') 
ABS Max:  tensor(662.4077, device='cuda:0') 
ABS Min:  tensor(1.2294e-05, device='cuda:0')
Criterion check:  tensor([0.9980, 1.0004, 0.9997, 1.0017, 0.9959, 0.9939, 1.0025, 0.9898, 1.0161,
        1.0121], device='cuda:0') tensor(149, device='cuda:0')
max of Lambda2 tensor(215753.1562, device='cuda:0')
min of Lambda2 tensor(2.5681e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1123, device='cuda:0')
min of grad d_p:  tensor(-0.1113, device='cuda:0')
max|min: (J_L, Jta/N)  (0.11231175065040588, 0.11231368035078049, ratio: 1.0000171661376953)|(-0.11125575006008148, -0.11125444620847702)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.6054e-07, device='cuda:0') mean:  tensor(-7.0009e-11, device='cuda:0') min:  tensor(-1.9297e-06, device='cuda:0') norm:  tensor(1.2522e-05, device='cuda:0') MSE:  tensor(1.5779e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0010, device='cuda:0') mean:  tensor(7.1609e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0151, device='cuda:0') MSE:  tensor(1.9037e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0401, device='cuda:0')
min of d_p_list:  tensor(-0.0331, device='cuda:0')
Epoch:  151  
Training Loss: 0.013277298770844936
Test Loss:  0.014542165212333202
Test Acc:  0.0
Valid Loss:  0.013784386217594147
Valid Acc:  0.0
std:  0.05737231418970295 
thres:  7.419826667755842e-05
Preserved_eigens number check:  512
 15%|█▌        | 151/1000 [45:47<4:07:15, 17.47s/it]Epoch:   152
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  501
Criterion check: 
Mean:  tensor(-3.7020, device='cuda:0') 
Std:  tensor(60.2267, device='cuda:0') 
ABS Max:  tensor(1250.1509, device='cuda:0') 
ABS Min:  tensor(0.0001, device='cuda:0')
Criterion check:  tensor([1.0053, 1.0017, 1.0032, 0.9965, 0.9984, 1.0174, 1.0089, 0.9248, 0.9106,
        1.2685], device='cuda:0') tensor(161, device='cuda:0')
max of Lambda2 tensor(215674.0625, device='cuda:0')
min of Lambda2 tensor(3.0166e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0885, device='cuda:0')
min of grad d_p:  tensor(-0.0901, device='cuda:0')
max|min: (J_L, Jta/N)  (0.0885014683008194, 0.08850304782390594, ratio: 1.0000178813934326)|(-0.09005957096815109, -0.09005983918905258)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.4086e-07, device='cuda:0') mean:  tensor(-8.3810e-11, device='cuda:0') min:  tensor(-1.5795e-06, device='cuda:0') norm:  tensor(5.6457e-06, device='cuda:0') MSE:  tensor(7.1141e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0033, device='cuda:0') mean:  tensor(1.9709e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0411, device='cuda:0') MSE:  tensor(5.1779e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0841, device='cuda:0')
min of d_p_list:  tensor(-0.0586, device='cuda:0')
Epoch:  152  
Training Loss: 0.057154178619384766
Test Loss:  0.06728140264749527
Test Acc:  0.0
Valid Loss:  0.05373747646808624
Valid Acc:  0.0
std:  0.0474008896496285 
thres:  5.785971563309431e-05
Preserved_eigens number check:  512
 15%|█▌        | 152/1000 [46:04<4:06:14, 17.42s/it]Epoch:   153
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  504
Criterion check: 
Mean:  tensor(0.1700, device='cuda:0') 
Std:  tensor(680.5898, device='cuda:0') 
ABS Max:  tensor(13337.9297, device='cuda:0') 
ABS Min:  tensor(0.0007, device='cuda:0')
Criterion check:  tensor([ 0.9899,  1.0207,  1.0016,  1.0007,  1.0053,  0.9976,  0.6101,  0.9912,
         0.9871, -3.5920], device='cuda:0') tensor(186, device='cuda:0')
max of Lambda2 tensor(215963.1094, device='cuda:0')
min of Lambda2 tensor(1.2359e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1467, device='cuda:0')
min of grad d_p:  tensor(-0.3872, device='cuda:0')
max|min: (J_L, Jta/N)  (0.1467473804950714, 0.1467486172914505, ratio: 1.000008463859558)|(-0.3872455954551697, -0.3872497081756592)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.1127e-06, device='cuda:0') mean:  tensor(8.1482e-11, device='cuda:0') min:  tensor(-1.2368e-06, device='cuda:0') norm:  tensor(1.5528e-05, device='cuda:0') MSE:  tensor(1.9566e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0078, device='cuda:0') mean:  tensor(6.2489e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1293, device='cuda:0') MSE:  tensor(1.6294e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1340, device='cuda:0')
min of d_p_list:  tensor(-0.0959, device='cuda:0')
Epoch:  153  
Training Loss: 0.2204444855451584
Test Loss:  0.24071696400642395
Test Acc:  0.0
Valid Loss:  0.2132185995578766
Valid Acc:  0.0
std:  0.07574633828445348 
thres:  7.260828297585249e-05
Preserved_eigens number check:  512
 15%|█▌        | 153/1000 [46:21<4:04:17, 17.31s/it]Epoch:   154
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  501
Criterion check: 
Mean:  tensor(-6.9115, device='cuda:0') 
Std:  tensor(144.4600, device='cuda:0') 
ABS Max:  tensor(3242.5249, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([0.9943, 1.0003, 1.0001, 0.9989, 1.0063, 1.0000, 1.0017, 0.9940, 1.0128,
        1.0079], device='cuda:0') tensor(158, device='cuda:0')
max of Lambda2 tensor(215738.3438, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2123, device='cuda:0')
min of grad d_p:  tensor(-0.1793, device='cuda:0')
max|min: (J_L, Jta/N)  (0.21225333213806152, 0.21225151419639587, ratio: 0.9999914169311523)|(-0.17932552099227905, -0.17932862043380737)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.8056e-06, device='cuda:0') mean:  tensor(3.2044e-10, device='cuda:0') min:  tensor(-1.2126e-06, device='cuda:0') norm:  tensor(1.9828e-05, device='cuda:0') MSE:  tensor(2.4985e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0027, device='cuda:0') mean:  tensor(1.9288e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0405, device='cuda:0') MSE:  tensor(5.1031e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0743, device='cuda:0')
min of d_p_list:  tensor(-0.0689, device='cuda:0')
Epoch:  154  
Training Loss: 0.09336908161640167
Test Loss:  0.09918111562728882
Test Acc:  0.0
Valid Loss:  0.09004601091146469
Valid Acc:  0.0
std:  0.07516708267726271 
thres:  8.122031819075346e-05
Preserved_eigens number check:  512
 15%|█▌        | 154/1000 [46:39<4:05:22, 17.40s/it]Epoch:   155
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  503
Criterion check: 
Mean:  tensor(5.0916, device='cuda:0') 
Std:  tensor(68.2714, device='cuda:0') 
ABS Max:  tensor(1308.6984, device='cuda:0') 
ABS Min:  tensor(0.0005, device='cuda:0')
Criterion check:  tensor([1.0071, 1.0000, 0.9996, 0.9995, 1.0019, 0.9992, 0.9952, 0.9927, 1.0104,
        1.0521], device='cuda:0') tensor(166, device='cuda:0')
max of Lambda2 tensor(215740.4375, device='cuda:0')
min of Lambda2 tensor(1.7670e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1452, device='cuda:0')
min of grad d_p:  tensor(-0.1529, device='cuda:0')
max|min: (J_L, Jta/N)  (0.14519840478897095, 0.14519767463207245, ratio: 0.9999949932098389)|(-0.15290960669517517, -0.1529114544391632)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.2133e-06, device='cuda:0') mean:  tensor(1.6105e-10, device='cuda:0') min:  tensor(-1.9670e-06, device='cuda:0') norm:  tensor(1.5736e-05, device='cuda:0') MSE:  tensor(1.9829e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0012, device='cuda:0') mean:  tensor(8.2453e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0167, device='cuda:0') MSE:  tensor(2.1011e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0739, device='cuda:0')
min of d_p_list:  tensor(-0.0708, device='cuda:0')
Epoch:  155  
Training Loss: 0.028971444815397263
Test Loss:  0.03519605100154877
Test Acc:  0.0
Valid Loss:  0.03274492174386978
Valid Acc:  0.0
std:  0.07408942516063913 
thres:  8.264329787343741e-05
Preserved_eigens number check:  512
 16%|█▌        | 155/1000 [46:57<4:06:20, 17.49s/it]Epoch:   156
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  504
Criterion check: 
Mean:  tensor(2.0602, device='cuda:0') 
Std:  tensor(26.5031, device='cuda:0') 
ABS Max:  tensor(345.1453, device='cuda:0') 
ABS Min:  tensor(1.5706e-06, device='cuda:0')
Criterion check:  tensor([0.9993, 0.9894, 1.0007, 1.0001, 0.9996, 1.0002, 1.0008, 1.0007, 0.9988,
        1.0045], device='cuda:0') tensor(162, device='cuda:0')
max of Lambda2 tensor(215798.1875, device='cuda:0')
min of Lambda2 tensor(3.6873e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1427, device='cuda:0')
min of grad d_p:  tensor(-0.1706, device='cuda:0')
max|min: (J_L, Jta/N)  (0.14272792637348175, 0.14272454380989075, ratio: 0.9999762773513794)|(-0.17055770754814148, -0.17055949568748474)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.4608e-06, device='cuda:0') mean:  tensor(1.9111e-10, device='cuda:0') min:  tensor(-8.7172e-07, device='cuda:0') norm:  tensor(1.3968e-05, device='cuda:0') MSE:  tensor(1.7601e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0009, device='cuda:0') mean:  tensor(4.4351e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0093, device='cuda:0') MSE:  tensor(1.1666e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1064, device='cuda:0')
min of d_p_list:  tensor(-0.0608, device='cuda:0')
Epoch:  156  
Training Loss: 0.01945868879556656
Test Loss:  0.024097688496112823
Test Acc:  0.0
Valid Loss:  0.025833725929260254
Valid Acc:  0.0
std:  0.07296468416907549 
thres:  8.387957587838173e-05
Preserved_eigens number check:  512
 16%|█▌        | 156/1000 [47:15<4:06:59, 17.56s/it]Epoch:   157
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  505
Criterion check: 
Mean:  tensor(-0.1299, device='cuda:0') 
Std:  tensor(11.9940, device='cuda:0') 
ABS Max:  tensor(195.6596, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([1.0007, 0.9993, 1.0005, 0.9996, 1.0019, 0.9999, 0.9979, 1.0030, 1.0033,
        0.9687], device='cuda:0') tensor(169, device='cuda:0')
max of Lambda2 tensor(215701.6250, device='cuda:0')
min of Lambda2 tensor(6.3276e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.0905, device='cuda:0')
min of grad d_p:  tensor(-0.1373, device='cuda:0')
max|min: (J_L, Jta/N)  (0.09051161259412766, 0.09051182121038437, ratio: 1.0000022649765015)|(-0.13728398084640503, -0.13728809356689453)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.1127e-06, device='cuda:0') mean:  tensor(1.7059e-10, device='cuda:0') min:  tensor(-5.6624e-07, device='cuda:0') norm:  tensor(1.2021e-05, device='cuda:0') MSE:  tensor(1.5147e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0013, device='cuda:0') mean:  tensor(9.9118e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0198, device='cuda:0') MSE:  tensor(2.4939e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1853, device='cuda:0')
min of d_p_list:  tensor(-0.1178, device='cuda:0')
Epoch:  157  
Training Loss: 0.07618913054466248
Test Loss:  0.06471753865480423
Test Acc:  0.0
Valid Loss:  0.0841846838593483
Valid Acc:  0.0
std:  0.07196062241432447 
thres:  8.768656626343726e-05
Preserved_eigens number check:  512
 16%|█▌        | 157/1000 [47:32<4:04:52, 17.43s/it]Epoch:   158
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  505
Criterion check: 
Mean:  tensor(0.5899, device='cuda:0') 
Std:  tensor(55.4935, device='cuda:0') 
ABS Max:  tensor(750.9022, device='cuda:0') 
ABS Min:  tensor(0.0004, device='cuda:0')
Criterion check:  tensor([0.9956, 0.9993, 1.0003, 0.9996, 1.0001, 0.9977, 0.9800, 1.0056, 0.9914,
        1.0035], device='cuda:0') tensor(182, device='cuda:0')
max of Lambda2 tensor(215714.7188, device='cuda:0')
min of Lambda2 tensor(1.2164e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.6153, device='cuda:0')
min of grad d_p:  tensor(-1.0965, device='cuda:0')
max|min: (J_L, Jta/N)  (0.6153067946434021, 0.6153029203414917, ratio: 0.9999936819076538)|(-1.0964889526367188, -1.0964901447296143)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.8743e-06, device='cuda:0') mean:  tensor(1.8359e-10, device='cuda:0') min:  tensor(-8.4774e-07, device='cuda:0') norm:  tensor(1.4446e-05, device='cuda:0') MSE:  tensor(1.8203e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0090, device='cuda:0') mean:  tensor(3.6726e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0737, device='cuda:0') MSE:  tensor(9.2818e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0802, device='cuda:0')
min of d_p_list:  tensor(-0.1137, device='cuda:0')
Epoch:  158  
Training Loss: 0.11495546996593475
Test Loss:  0.10040219128131866
Test Acc:  0.0
Valid Loss:  0.12911808490753174
Valid Acc:  0.0
std:  0.03683747381901817 
thres:  6.658876314759254e-05
Preserved_eigens number check:  512
 16%|█▌        | 158/1000 [47:49<4:04:53, 17.45s/it]Epoch:   159
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  503
Criterion check: 
Mean:  tensor(0.7080, device='cuda:0') 
Std:  tensor(36.3129, device='cuda:0') 
ABS Max:  tensor(530.9115, device='cuda:0') 
ABS Min:  tensor(0.0008, device='cuda:0')
Criterion check:  tensor([0.9717, 0.9984, 0.9991, 0.9992, 0.9990, 1.0026, 0.9956, 0.9943, 0.9978,
        1.0098], device='cuda:0') tensor(190, device='cuda:0')
max of Lambda2 tensor(215483.5469, device='cuda:0')
min of Lambda2 tensor(6.5845e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3873, device='cuda:0')
min of grad d_p:  tensor(-0.8694, device='cuda:0')
max|min: (J_L, Jta/N)  (0.3873424530029297, 0.3873375952243805, ratio: 0.9999874830245972)|(-0.8693557977676392, -0.8693559765815735)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.8578e-06, device='cuda:0') mean:  tensor(1.6104e-10, device='cuda:0') min:  tensor(-9.6671e-07, device='cuda:0') norm:  tensor(1.6492e-05, device='cuda:0') MSE:  tensor(2.0781e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0032, device='cuda:0') mean:  tensor(2.4365e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0549, device='cuda:0') MSE:  tensor(6.9172e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.3372, device='cuda:0')
min of d_p_list:  tensor(-0.3593, device='cuda:0')
Epoch:  159  
Training Loss: 0.16072222590446472
Test Loss:  0.13902902603149414
Test Acc:  0.0
Valid Loss:  0.14464589953422546
Valid Acc:  0.0
std:  0.05295589019371711 
thres:  8.005939200520515e-05
Preserved_eigens number check:  512
 16%|█▌        | 159/1000 [48:06<4:03:54, 17.40s/it]Epoch:   160
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  504
Criterion check: 
Mean:  tensor(0.8940, device='cuda:0') 
Std:  tensor(13.2296, device='cuda:0') 
ABS Max:  tensor(169.7596, device='cuda:0') 
ABS Min:  tensor(0.0001, device='cuda:0')
Criterion check:  tensor([0.9993, 1.0000, 1.0007, 0.9999, 1.0012, 1.0002, 0.9987, 1.0006, 1.0024,
        0.6657], device='cuda:0') tensor(171, device='cuda:0')
max of Lambda2 tensor(215374.6719, device='cuda:0')
min of Lambda2 tensor(7.5797e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.2236, device='cuda:0')
min of grad d_p:  tensor(-0.6106, device='cuda:0')
max|min: (J_L, Jta/N)  (1.223564624786377, 1.2235620021820068, ratio: 0.9999978542327881)|(-0.6105859279632568, -0.6105878949165344)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.6492e-06, device='cuda:0') mean:  tensor(2.8615e-10, device='cuda:0') min:  tensor(-1.1809e-06, device='cuda:0') norm:  tensor(1.9128e-05, device='cuda:0') MSE:  tensor(2.4102e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0020, device='cuda:0') mean:  tensor(1.1719e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0240, device='cuda:0') MSE:  tensor(3.0271e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1284, device='cuda:0')
min of d_p_list:  tensor(-0.0790, device='cuda:0')
Epoch:  160  
Training Loss: 0.1293281465768814
Test Loss:  0.10766185820102692
Test Acc:  0.0
Valid Loss:  0.11704517900943756
Valid Acc:  0.0
std:  0.04863079238986733 
thres:  0.00010013073235750199
Preserved_eigens number check:  512
 16%|█▌        | 160/1000 [48:24<4:04:10, 17.44s/it]Epoch:   161
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  504
Criterion check: 
Mean:  tensor(-1.0723, device='cuda:0') 
Std:  tensor(28.1669, device='cuda:0') 
ABS Max:  tensor(387.2904, device='cuda:0') 
ABS Min:  tensor(0.0004, device='cuda:0')
Criterion check:  tensor([1.0002, 0.9999, 1.0000, 1.0000, 0.9997, 0.9999, 1.0042, 0.9971, 1.0171,
        0.9882], device='cuda:0') tensor(147, device='cuda:0')
max of Lambda2 tensor(215400.8906, device='cuda:0')
min of Lambda2 tensor(5.5881e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.7836, device='cuda:0')
min of grad d_p:  tensor(-0.3924, device='cuda:0')
max|min: (J_L, Jta/N)  (0.7836147546768188, 0.783612847328186, ratio: 0.9999975562095642)|(-0.3924012780189514, -0.3924027383327484)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.1963e-06, device='cuda:0') mean:  tensor(1.7149e-10, device='cuda:0') min:  tensor(-7.8604e-07, device='cuda:0') norm:  tensor(1.2949e-05, device='cuda:0') MSE:  tensor(1.6317e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0015, device='cuda:0') mean:  tensor(9.6479e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0202, device='cuda:0') MSE:  tensor(2.5442e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1940, device='cuda:0')
min of d_p_list:  tensor(-0.3435, device='cuda:0')
Epoch:  161  
Training Loss: 0.2947674095630646
Test Loss:  0.36470142006874084
Test Acc:  0.0
Valid Loss:  0.29023757576942444
Valid Acc:  0.0
std:  0.07488824874086485 
thres:  0.0001551924765110016
Preserved_eigens number check:  512
 16%|█▌        | 161/1000 [48:42<4:04:54, 17.51s/it]Epoch:   162
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  502
Criterion check: 
Mean:  tensor(2.1114, device='cuda:0') 
Std:  tensor(52.0961, device='cuda:0') 
ABS Max:  tensor(1139.2346, device='cuda:0') 
ABS Min:  tensor(8.4568e-05, device='cuda:0')
Criterion check:  tensor([0.9997, 1.0009, 1.0011, 0.9997, 0.9997, 0.9997, 0.9944, 1.0015, 1.0066,
        0.9924], device='cuda:0') tensor(169, device='cuda:0')
max of Lambda2 tensor(215570.1250, device='cuda:0')
min of Lambda2 tensor(7.1437e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2745, device='cuda:0')
min of grad d_p:  tensor(-0.1331, device='cuda:0')
max|min: (J_L, Jta/N)  (0.27447250485420227, 0.27447307109832764, ratio: 1.0000020265579224)|(-0.13310158252716064, -0.13310135900974274)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.4028e-07, device='cuda:0') mean:  tensor(-8.8704e-11, device='cuda:0') min:  tensor(-1.0729e-06, device='cuda:0') norm:  tensor(4.4390e-06, device='cuda:0') MSE:  tensor(5.5935e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0022, device='cuda:0') mean:  tensor(1.5514e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0325, device='cuda:0') MSE:  tensor(4.0960e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1111, device='cuda:0')
min of d_p_list:  tensor(-0.1015, device='cuda:0')
Epoch:  162  
Training Loss: 0.15355731546878815
Test Loss:  0.182979017496109
Test Acc:  0.0
Valid Loss:  0.15303686261177063
Valid Acc:  0.0
std:  0.06419536878534833 
thres:  0.00017066611349582673
Preserved_eigens number check:  512
 16%|█▌        | 162/1000 [48:59<4:03:41, 17.45s/it]Epoch:   163
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  503
Criterion check: 
Mean:  tensor(-2.2506, device='cuda:0') 
Std:  tensor(30.6131, device='cuda:0') 
ABS Max:  tensor(509.1015, device='cuda:0') 
ABS Min:  tensor(0.0019, device='cuda:0')
Criterion check:  tensor([1.0134, 1.0011, 1.0007, 0.9990, 1.0014, 0.9998, 1.0046, 1.0033, 0.9939,
        1.0107], device='cuda:0') tensor(168, device='cuda:0')
max of Lambda2 tensor(216065.9688, device='cuda:0')
min of Lambda2 tensor(2.7736e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1496, device='cuda:0')
min of grad d_p:  tensor(-0.1075, device='cuda:0')
max|min: (J_L, Jta/N)  (0.14961257576942444, 0.14961323142051697, ratio: 1.0000044107437134)|(-0.1074940636754036, -0.10749492794275284)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.6427e-07, device='cuda:0') mean:  tensor(5.6275e-11, device='cuda:0') min:  tensor(-6.5565e-07, device='cuda:0') norm:  tensor(3.2912e-06, device='cuda:0') MSE:  tensor(4.1471e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0025, device='cuda:0') mean:  tensor(2.0131e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0411, device='cuda:0') MSE:  tensor(5.1754e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1226, device='cuda:0')
min of d_p_list:  tensor(-0.0724, device='cuda:0')
Epoch:  163  
Training Loss: 0.04716067016124725
Test Loss:  0.052289366722106934
Test Acc:  0.0
Valid Loss:  0.05266683176159859
Valid Acc:  0.0
std:  0.07979463468439363 
thres:  0.00015710715353488923
Preserved_eigens number check:  512
 16%|█▋        | 163/1000 [49:16<4:02:40, 17.40s/it]Epoch:   164
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  503
Criterion check: 
Mean:  tensor(-0.4347, device='cuda:0') 
Std:  tensor(13.1525, device='cuda:0') 
ABS Max:  tensor(189.3620, device='cuda:0') 
ABS Min:  tensor(0.0008, device='cuda:0')
Criterion check:  tensor([1.0354, 0.9924, 0.9988, 1.0009, 1.0018, 0.9992, 0.9910, 0.9983, 1.0377,
        1.0582], device='cuda:0') tensor(160, device='cuda:0')
max of Lambda2 tensor(216385.7969, device='cuda:0')
min of Lambda2 tensor(5.2961e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1952, device='cuda:0')
min of grad d_p:  tensor(-0.2515, device='cuda:0')
max|min: (J_L, Jta/N)  (0.1951727271080017, 0.19517146050930023, ratio: 0.9999935030937195)|(-0.251531720161438, -0.25153592228889465)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.2021e-06, device='cuda:0') mean:  tensor(3.3157e-10, device='cuda:0') min:  tensor(-8.0094e-07, device='cuda:0') norm:  tensor(1.4541e-05, device='cuda:0') MSE:  tensor(1.8323e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0026, device='cuda:0') mean:  tensor(1.3628e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0294, device='cuda:0') MSE:  tensor(3.7043e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.6622, device='cuda:0')
min of d_p_list:  tensor(-0.3530, device='cuda:0')
Epoch:  164  
Training Loss: 1.275917649269104
Test Loss:  1.4787002801895142
Test Acc:  0.0
Valid Loss:  1.4220092296600342
Valid Acc:  0.0
std:  0.454934634597146 
thres:  0.00038014623820781707
Preserved_eigens number check:  512
 16%|█▋        | 164/1000 [49:34<4:05:15, 17.60s/it]Epoch:   165
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  502
Criterion check: 
Mean:  tensor(-1.3598, device='cuda:0') 
Std:  tensor(18.7929, device='cuda:0') 
ABS Max:  tensor(341.5188, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([1.0001, 1.0000, 1.0000, 1.0000, 1.0000, 1.0032, 0.9998, 0.9991, 0.9986,
        0.9984], device='cuda:0') tensor(140, device='cuda:0')
max of Lambda2 tensor(215721.5000, device='cuda:0')
min of Lambda2 tensor(7.2051e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.9687, device='cuda:0')
min of grad d_p:  tensor(-2.7829, device='cuda:0')
max|min: (J_L, Jta/N)  (0.9687219262123108, 0.9687228202819824, ratio: 1.0000009536743164)|(-2.7829365730285645, -2.782932758331299)

 check Jacobi res:  torch.Size([793601]) max:  tensor(9.8348e-07, device='cuda:0') mean:  tensor(-3.0214e-10, device='cuda:0') min:  tensor(-3.8147e-06, device='cuda:0') norm:  tensor(1.6840e-05, device='cuda:0') MSE:  tensor(2.1219e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0010, device='cuda:0') mean:  tensor(6.7645e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0133, device='cuda:0') MSE:  tensor(1.6755e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(12.1309, device='cuda:0')
min of d_p_list:  tensor(-7.0169, device='cuda:0')
Epoch:  165  
Training Loss: 38576.6484375
Test Loss:  40569.0390625
Test Acc:  0.0
Valid Loss:  39574.1484375
Valid Acc:  0.0
std:  15430.482240892316 
thres:  7.715683968108892
Preserved_eigens number check:  512
 16%|█▋        | 165/1000 [49:52<4:03:13, 17.48s/it]Epoch:   166
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  507
Criterion check: 
Mean:  tensor(-0.0212, device='cuda:0') 
Std:  tensor(6.0643, device='cuda:0') 
ABS Max:  tensor(95.1850, device='cuda:0') 
ABS Min:  tensor(0.0001, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0000, 1.0000, 0.9957, 1.0000, 0.9996, 1.0000, 1.0002,
        1.0009], device='cuda:0') tensor(136, device='cuda:0')
max of Lambda2 tensor(343335.9062, device='cuda:0')
min of Lambda2 tensor(9.8496e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(12.8318, device='cuda:0')
min of grad d_p:  tensor(-11.0836, device='cuda:0')
max|min: (J_L, Jta/N)  (12.831802368164062, 12.831806182861328, ratio: 1.000000238418579)|(-11.083600997924805, -11.083596229553223)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.2452e-06, device='cuda:0') mean:  tensor(4.5198e-10, device='cuda:0') min:  tensor(-5.7220e-06, device='cuda:0') norm:  tensor(4.6247e-05, device='cuda:0') MSE:  tensor(5.8274e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0040, device='cuda:0') mean:  tensor(1.7704e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0447, device='cuda:0') MSE:  tensor(5.6314e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.3431, device='cuda:0')
min of d_p_list:  tensor(-0.2559, device='cuda:0')
Epoch:  166  
Training Loss: 193.3624267578125
Test Loss:  214.40846252441406
Test Acc:  0.0
Valid Loss:  210.59689331054688
Valid Acc:  0.0
std:  15411.356505911186 
thres:  7.754297499978542
Preserved_eigens number check:  512
 17%|█▋        | 166/1000 [50:09<4:02:24, 17.44s/it]Epoch:   167
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  509
Criterion check: 
Mean:  tensor(-1.7204, device='cuda:0') 
Std:  tensor(50.6430, device='cuda:0') 
ABS Max:  tensor(1078.4474, device='cuda:0') 
ABS Min:  tensor(5.0132e-05, device='cuda:0')
Criterion check:  tensor([1.0002, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0002,
        1.0000], device='cuda:0') tensor(143, device='cuda:0')
max of Lambda2 tensor(343015.6250, device='cuda:0')
min of Lambda2 tensor(3.1141e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(7.5716, device='cuda:0')
min of grad d_p:  tensor(-9.8912, device='cuda:0')
max|min: (J_L, Jta/N)  (7.5716094970703125, 7.571609973907471, ratio: 1.0000001192092896)|(-9.891231536865234, -9.891233444213867)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.2452e-06, device='cuda:0') mean:  tensor(2.5778e-10, device='cuda:0') min:  tensor(-2.3842e-06, device='cuda:0') norm:  tensor(3.6782e-05, device='cuda:0') MSE:  tensor(4.6348e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0036, device='cuda:0') mean:  tensor(1.2410e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0312, device='cuda:0') MSE:  tensor(3.9296e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(1.3517, device='cuda:0')
min of d_p_list:  tensor(-1.4957, device='cuda:0')
Epoch:  167  
Training Loss: 104.86492919921875
Test Loss:  114.71241760253906
Test Acc:  0.0
Valid Loss:  110.12865447998047
Valid Acc:  0.0
std:  15400.87285992931 
thres:  7.775239774355292
Preserved_eigens number check:  512
 17%|█▋        | 167/1000 [50:26<4:00:41, 17.34s/it]Epoch:   168
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  505
Criterion check: 
Mean:  tensor(0.4304, device='cuda:0') 
Std:  tensor(17.1976, device='cuda:0') 
ABS Max:  tensor(282.3850, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([0.9999, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 0.9998, 0.9996, 1.0395,
        0.9995], device='cuda:0') tensor(150, device='cuda:0')
max of Lambda2 tensor(344332.1250, device='cuda:0')
min of Lambda2 tensor(1.1396e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(8.3033, device='cuda:0')
min of grad d_p:  tensor(-11.2197, device='cuda:0')
max|min: (J_L, Jta/N)  (8.303337097167969, 8.303336143493652, ratio: 0.9999998807907104)|(-11.219715118408203, -11.219710350036621)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.8147e-06, device='cuda:0') mean:  tensor(4.3889e-11, device='cuda:0') min:  tensor(-6.1989e-06, device='cuda:0') norm:  tensor(3.8199e-05, device='cuda:0') MSE:  tensor(4.8134e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0064, device='cuda:0') mean:  tensor(2.5193e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0643, device='cuda:0') MSE:  tensor(8.1006e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.4063, device='cuda:0')
min of d_p_list:  tensor(-0.5077, device='cuda:0')
Epoch:  168  
Training Loss: 27.69769287109375
Test Loss:  30.171871185302734
Test Acc:  0.0
Valid Loss:  27.542797088623047
Valid Acc:  0.0
std:  15398.084682535125 
thres:  7.780769880795479
Preserved_eigens number check:  512
 17%|█▋        | 168/1000 [50:43<4:00:41, 17.36s/it]Epoch:   169
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  507
Criterion check: 
Mean:  tensor(0.0525, device='cuda:0') 
Std:  tensor(8.4997, device='cuda:0') 
ABS Max:  tensor(129.5739, device='cuda:0') 
ABS Min:  tensor(0.0004, device='cuda:0')
Criterion check:  tensor([1.0000, 0.9999, 1.0000, 1.0001, 0.9999, 1.0000, 1.0014, 1.0001, 0.9963,
        1.0018], device='cuda:0') tensor(124, device='cuda:0')
max of Lambda2 tensor(343788.4062, device='cuda:0')
min of Lambda2 tensor(4.9518e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(2.5810, device='cuda:0')
min of grad d_p:  tensor(-4.5604, device='cuda:0')
max|min: (J_L, Jta/N)  (2.580997943878174, 2.580998420715332, ratio: 1.000000238418579)|(-4.560417175292969, -4.560420989990234)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.3590e-05, device='cuda:0') mean:  tensor(1.3912e-09, device='cuda:0') min:  tensor(-3.9935e-06, device='cuda:0') norm:  tensor(6.8061e-05, device='cuda:0') MSE:  tensor(8.5763e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0033, device='cuda:0') mean:  tensor(1.4749e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0355, device='cuda:0') MSE:  tensor(4.4776e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(37.2736, device='cuda:0')
min of d_p_list:  tensor(-31.1417, device='cuda:0')
Epoch:  169  
Training Loss: 23204032.0
Test Loss:  26035244.0
Test Acc:  0.0
Valid Loss:  21711808.0
Valid Acc:  0.0
std:  9277734.505217405 
thres:  4648.5869146972655
Preserved_eigens number check:  512
 17%|█▋        | 169/1000 [51:01<4:00:16, 17.35s/it]Epoch:   170
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-68.8735, device='cuda:0') 
Std:  tensor(1585.9901, device='cuda:0') 
ABS Max:  tensor(35883.4883, device='cuda:0') 
ABS Min:  tensor(0.0005, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0003, 0.9999, 1.0001, 1.0000, 1.0000, 1.0001, 0.9998, 1.0000,
        1.0012], device='cuda:0') tensor(221, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0002, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(530.3721, device='cuda:0')
min of grad d_p:  tensor(-2163.1587, device='cuda:0')
max|min: (J_L, Jta/N)  (530.3720703125, 530.3721313476562, ratio: 1.0000001192092896)|(-2163.15869140625, -2163.159423828125)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0014, device='cuda:0') mean:  tensor(6.3836e-08, device='cuda:0') min:  tensor(-0.0005, device='cuda:0') norm:  tensor(0.0076, device='cuda:0') MSE:  tensor(9.6306e-09, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.5090, device='cuda:0') mean:  tensor(0.0015, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(4.7548, device='cuda:0') MSE:  tensor(5.9915e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1858, device='cuda:0')
min of d_p_list:  tensor(-0.6134, device='cuda:0')
Epoch:  170  
Training Loss: 9097.71875
Test Loss:  8814.3408203125
Test Acc:  0.0
Valid Loss:  9333.458984375
Valid Acc:  0.0
std:  9280671.08876659 
thres:  4642.691128759766
Preserved_eigens number check:  512
 17%|█▋        | 170/1000 [51:18<3:59:34, 17.32s/it]Epoch:   171
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-6.5482, device='cuda:0') 
Std:  tensor(175.3997, device='cuda:0') 
ABS Max:  tensor(3876.0564, device='cuda:0') 
ABS Min:  tensor(0.0010, device='cuda:0')
Criterion check:  tensor([0.9999, 1.0001, 0.9954, 1.0000, 1.0000, 1.0000, 1.0000, 1.0004, 0.9999,
        1.0019], device='cuda:0') tensor(186, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0010, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(286.5353, device='cuda:0')
min of grad d_p:  tensor(-1175.0629, device='cuda:0')
max|min: (J_L, Jta/N)  (286.5352783203125, 286.53515625, ratio: 0.9999995827674866)|(-1175.0628662109375, -1175.0633544921875)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(3.1708e-08, device='cuda:0') min:  tensor(-0.0003, device='cuda:0') norm:  tensor(0.0027, device='cuda:0') MSE:  tensor(3.3896e-09, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.3029, device='cuda:0') mean:  tensor(0.0009, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(3.0208, device='cuda:0') MSE:  tensor(3.8064e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1707, device='cuda:0')
min of d_p_list:  tensor(-0.3542, device='cuda:0')
Epoch:  171  
Training Loss: 3383.66796875
Test Loss:  3601.155029296875
Test Acc:  0.0
Valid Loss:  3678.43359375
Valid Acc:  0.0
std:  9280351.991805855 
thres:  4643.329189868165
Preserved_eigens number check:  512
 17%|█▋        | 171/1000 [51:35<3:59:59, 17.37s/it]Epoch:   172
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.6270, device='cuda:0') 
Std:  tensor(39.9602, device='cuda:0') 
ABS Max:  tensor(864.7901, device='cuda:0') 
ABS Min:  tensor(0., device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0001, 1.0000, 0.9999, 1.0000, 1.0000, 1.0000, 1.0003,
        1.0006], device='cuda:0') tensor(176, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0004, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(157.3904, device='cuda:0')
min of grad d_p:  tensor(-641.3694, device='cuda:0')
max|min: (J_L, Jta/N)  (157.39039611816406, 157.39041137695312, ratio: 1.0000001192092896)|(-641.369384765625, -641.3690795898438)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(-1.7631e-08, device='cuda:0') min:  tensor(-0.0003, device='cuda:0') norm:  tensor(0.0014, device='cuda:0') MSE:  tensor(1.7388e-09, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0936, device='cuda:0') mean:  tensor(0.0003, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.8729, device='cuda:0') MSE:  tensor(1.1000e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(6.7690, device='cuda:0')
min of d_p_list:  tensor(-8.2943, device='cuda:0')
Epoch:  172  
Training Loss: 32816.15625
Test Loss:  32635.421875
Test Acc:  0.0
Valid Loss:  32104.84375
Valid Acc:  0.0
std:  9277087.363551304 
thres:  4649.871448132324
Preserved_eigens number check:  512
 17%|█▋        | 172/1000 [51:53<4:00:58, 17.46s/it]Epoch:   173
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(268.1336, device='cuda:0') 
Std:  tensor(6987.9263, device='cuda:0') 
ABS Max:  tensor(155461.6250, device='cuda:0') 
ABS Min:  tensor(0.0030, device='cuda:0')
Criterion check:  tensor([1.0001, 0.9957, 0.9990, 0.9994, 0.9971, 1.0012, 0.9940, 0.7893, 1.0223,
        0.7032], device='cuda:0') tensor(250, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(5.2016e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(690.3688, device='cuda:0')
min of grad d_p:  tensor(-805.3036, device='cuda:0')
max|min: (J_L, Jta/N)  (690.3687744140625, 690.3687744140625, ratio: 1.0)|(-805.3035888671875, -805.3045654296875)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0010, device='cuda:0') mean:  tensor(6.6880e-08, device='cuda:0') min:  tensor(-0.0002, device='cuda:0') norm:  tensor(0.0028, device='cuda:0') MSE:  tensor(3.5175e-09, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(22.3816, device='cuda:0') mean:  tensor(0.0281, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(104.7164, device='cuda:0') MSE:  tensor(0.0001, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.8949, device='cuda:0')
min of d_p_list:  tensor(-1.2600, device='cuda:0')
Epoch:  173  
Training Loss: 4062.59619140625
Test Loss:  4357.3349609375
Test Acc:  0.0
Valid Loss:  3578.88623046875
Valid Acc:  0.0
std:  9276683.02233085 
thres:  4650.678427832032
Preserved_eigens number check:  512
 17%|█▋        | 173/1000 [52:10<3:59:26, 17.37s/it]Epoch:   174
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  510
Criterion check: 
Mean:  tensor(-0.5147, device='cuda:0') 
Std:  tensor(10.1659, device='cuda:0') 
ABS Max:  tensor(156.8868, device='cuda:0') 
ABS Min:  tensor(0.0009, device='cuda:0')
Criterion check:  tensor([1.0000, 0.9999, 1.0000, 1.0000, 1.0000, 1.0000, 1.0005, 1.0001, 0.9997,
        0.9998], device='cuda:0') tensor(160, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(1.9759e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(465.9478, device='cuda:0')
min of grad d_p:  tensor(-299.1408, device='cuda:0')
max|min: (J_L, Jta/N)  (465.94775390625, 465.9473876953125, ratio: 0.9999992251396179)|(-299.1407775878906, -299.1407470703125)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(8.4486e-09, device='cuda:0') min:  tensor(-0.0001, device='cuda:0') norm:  tensor(0.0016, device='cuda:0') MSE:  tensor(1.9945e-09, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0901, device='cuda:0') mean:  tensor(0.0003, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.9503, device='cuda:0') MSE:  tensor(1.1974e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.6065, device='cuda:0')
min of d_p_list:  tensor(-0.3353, device='cuda:0')
Epoch:  174  
Training Loss: 767.1822509765625
Test Loss:  824.8362426757812
Test Acc:  0.0
Valid Loss:  718.09375
Valid Acc:  0.0
std:  11710.349204450733 
thres:  10.025464282226563
Preserved_eigens number check:  512
 17%|█▋        | 174/1000 [52:28<3:59:01, 17.36s/it]Epoch:   175
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(10.1347, device='cuda:0') 
Std:  tensor(189.3480, device='cuda:0') 
ABS Max:  tensor(4070.3669, device='cuda:0') 
ABS Min:  tensor(0.0001, device='cuda:0')
Criterion check:  tensor([0.9999, 1.0070, 1.0001, 1.0000, 0.9924, 1.0002, 0.9998, 0.9995, 0.9997,
        1.0002], device='cuda:0') tensor(161, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(1.7409e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(293.0861, device='cuda:0')
min of grad d_p:  tensor(-165.2242, device='cuda:0')
max|min: (J_L, Jta/N)  (293.0860900878906, 293.0860290527344, ratio: 0.9999998211860657)|(-165.22418212890625, -165.22422790527344)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(-1.0192e-08, device='cuda:0') min:  tensor(-9.1553e-05, device='cuda:0') norm:  tensor(0.0009, device='cuda:0') MSE:  tensor(1.0742e-09, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.1862, device='cuda:0') mean:  tensor(0.0005, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(1.7848, device='cuda:0') MSE:  tensor(2.2490e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(2.0282, device='cuda:0')
min of d_p_list:  tensor(-1.7647, device='cuda:0')
Epoch:  175  
Training Loss: 1079.920166015625
Test Loss:  1076.593994140625
Test Acc:  0.0
Valid Loss:  1058.304443359375
Valid Acc:  0.0
std:  12263.493966947111 
thres:  8.421904565429688
Preserved_eigens number check:  512
 18%|█▊        | 175/1000 [52:45<4:00:46, 17.51s/it]Epoch:   176
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.0903, device='cuda:0') 
Std:  tensor(9.6515, device='cuda:0') 
ABS Max:  tensor(134.0009, device='cuda:0') 
ABS Min:  tensor(2.9074e-05, device='cuda:0')
Criterion check:  tensor([0.9999, 1.0000, 1.0005, 1.0000, 1.0001, 0.9999, 0.9999, 1.0001, 1.0011,
        1.0076], device='cuda:0') tensor(146, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0003, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(322.4529, device='cuda:0')
min of grad d_p:  tensor(-322.4196, device='cuda:0')
max|min: (J_L, Jta/N)  (322.4528503417969, 322.45281982421875, ratio: 0.9999998807907104)|(-322.4195861816406, -322.4195861816406)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(2.1355e-08, device='cuda:0') min:  tensor(-0.0002, device='cuda:0') norm:  tensor(0.0017, device='cuda:0') MSE:  tensor(2.1567e-09, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.5119, device='cuda:0') mean:  tensor(0.0005, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(1.9491, device='cuda:0') MSE:  tensor(2.4560e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.2668, device='cuda:0')
min of d_p_list:  tensor(-0.3099, device='cuda:0')
Epoch:  176  
Training Loss: 526.4733276367188
Test Loss:  556.5945434570312
Test Acc:  0.0
Valid Loss:  546.9287109375
Valid Acc:  0.0
std:  12548.208761172998 
thres:  7.850465637207032
Preserved_eigens number check:  512
 18%|█▊        | 176/1000 [53:04<4:02:39, 17.67s/it]Epoch:   177
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(0.7693, device='cuda:0') 
Std:  tensor(7.4373, device='cuda:0') 
ABS Max:  tensor(107.2581, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 0.9998, 0.9999, 1.0000, 1.0001, 1.0001, 0.9996, 0.9997,
        0.9992], device='cuda:0') tensor(149, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0001, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(173.9721, device='cuda:0')
min of grad d_p:  tensor(-198.9964, device='cuda:0')
max|min: (J_L, Jta/N)  (173.97210693359375, 173.97207641601562, ratio: 0.9999998211860657)|(-198.99636840820312, -198.9965362548828)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0038, device='cuda:0') mean:  tensor(-2.1472e-08, device='cuda:0') min:  tensor(-0.0043, device='cuda:0') norm:  tensor(0.0131, device='cuda:0') MSE:  tensor(1.6514e-08, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.1116, device='cuda:0') mean:  tensor(0.0002, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.8842, device='cuda:0') MSE:  tensor(1.1142e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.3662, device='cuda:0')
min of d_p_list:  tensor(-0.4303, device='cuda:0')
Epoch:  177  
Training Loss: 280.44244384765625
Test Loss:  323.7593994140625
Test Acc:  0.0
Valid Loss:  341.1171875
Valid Acc:  0.0
std:  1385.1154730941141 
thres:  1.3433228759765625
Preserved_eigens number check:  512
 18%|█▊        | 177/1000 [53:21<4:03:02, 17.72s/it]Epoch:   178
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(0.4577, device='cuda:0') 
Std:  tensor(4.9079, device='cuda:0') 
ABS Max:  tensor(91.7877, device='cuda:0') 
ABS Min:  tensor(0.0001, device='cuda:0')
Criterion check:  tensor([0.9999, 0.9999, 0.9999, 1.0000, 1.0000, 0.9968, 0.9998, 0.9996, 1.0001,
        1.0051], device='cuda:0') tensor(129, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0002, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(81.3110, device='cuda:0')
min of grad d_p:  tensor(-109.2006, device='cuda:0')
max|min: (J_L, Jta/N)  (81.31098937988281, 81.31107330322266, ratio: 1.000001072883606)|(-109.20064544677734, -109.20068359375)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(3.0475e-09, device='cuda:0') min:  tensor(-0.0001, device='cuda:0') norm:  tensor(0.0007, device='cuda:0') MSE:  tensor(9.1842e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0642, device='cuda:0') mean:  tensor(0.0002, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.6977, device='cuda:0') MSE:  tensor(8.7916e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.2581, device='cuda:0')
min of d_p_list:  tensor(-0.2142, device='cuda:0')
Epoch:  178  
Training Loss: 109.89522552490234
Test Loss:  125.5844955444336
Test Acc:  0.0
Valid Loss:  133.35653686523438
Valid Acc:  0.0
std:  344.92079925064786 
thres:  0.552782682800293
Preserved_eigens number check:  512
 18%|█▊        | 178/1000 [53:38<4:00:19, 17.54s/it]Epoch:   179
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.0711, device='cuda:0') 
Std:  tensor(107.5823, device='cuda:0') 
ABS Max:  tensor(2106.6624, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([1.0005, 1.0005, 1.0006, 0.9975, 0.9998, 1.0155, 1.0009, 0.9988, 0.9681,
        1.0653], device='cuda:0') tensor(183, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0003, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(50.2670, device='cuda:0')
min of grad d_p:  tensor(-68.4731, device='cuda:0')
max|min: (J_L, Jta/N)  (50.267005920410156, 50.267051696777344, ratio: 1.0000009536743164)|(-68.47306823730469, -68.47315216064453)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(-6.3857e-09, device='cuda:0') min:  tensor(-0.0001, device='cuda:0') norm:  tensor(0.0006, device='cuda:0') MSE:  tensor(7.5970e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.4689, device='cuda:0') mean:  tensor(0.0012, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(4.3953, device='cuda:0') MSE:  tensor(5.5384e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(8.0387, device='cuda:0')
min of d_p_list:  tensor(-9.6027, device='cuda:0')
Epoch:  179  
Training Loss: 31548.224609375
Test Loss:  36963.0390625
Test Acc:  0.0
Valid Loss:  38462.6171875
Valid Acc:  0.0
std:  12423.942941785475 
thres:  6.708991154479981
Preserved_eigens number check:  512
 18%|█▊        | 179/1000 [53:56<4:00:07, 17.55s/it]Epoch:   180
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(-0.8848, device='cuda:0') 
Std:  tensor(43.1743, device='cuda:0') 
ABS Max:  tensor(772.2271, device='cuda:0') 
ABS Min:  tensor(0.0007, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000,
        1.0002], device='cuda:0') tensor(176, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(2.3349e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(698.4951, device='cuda:0')
min of grad d_p:  tensor(-805.1177, device='cuda:0')
max|min: (J_L, Jta/N)  (698.4950561523438, 698.4945678710938, ratio: 0.9999992847442627)|(-805.11767578125, -805.11767578125)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.3693, device='cuda:0') mean:  tensor(2.1620e-06, device='cuda:0') min:  tensor(-0.5408, device='cuda:0') norm:  tensor(1.4761, device='cuda:0') MSE:  tensor(1.8600e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.3170, device='cuda:0') mean:  tensor(0.0007, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(2.6893, device='cuda:0') MSE:  tensor(3.3887e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(4.7785, device='cuda:0')
min of d_p_list:  tensor(-8.2230, device='cuda:0')
Epoch:  180  
Training Loss: 11790.630859375
Test Loss:  13919.982421875
Test Acc:  0.0
Valid Loss:  16318.2724609375
Valid Acc:  0.0
std:  12189.869140310997 
thres:  8.851133293151856
Preserved_eigens number check:  512
 18%|█▊        | 180/1000 [54:13<3:58:43, 17.47s/it]Epoch:   181
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.1056, device='cuda:0') 
Std:  tensor(8.9272, device='cuda:0') 
ABS Max:  tensor(119.2222, device='cuda:0') 
ABS Min:  tensor(0.0019, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0001, 1.0006, 1.0000, 1.0004, 0.9988,
        0.9946], device='cuda:0') tensor(187, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0003, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(404.7440, device='cuda:0')
min of grad d_p:  tensor(-634.4087, device='cuda:0')
max|min: (J_L, Jta/N)  (404.7440185546875, 404.7439270019531, ratio: 0.9999997615814209)|(-634.40869140625, -634.408935546875)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(-2.3638e-08, device='cuda:0') min:  tensor(-0.0003, device='cuda:0') norm:  tensor(0.0022, device='cuda:0') MSE:  tensor(2.7615e-09, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.1653, device='cuda:0') mean:  tensor(0.0003, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(1.1006, device='cuda:0') MSE:  tensor(1.3869e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(1.1208, device='cuda:0')
min of d_p_list:  tensor(-1.3303, device='cuda:0')
Epoch:  181  
Training Loss: 1623.72265625
Test Loss:  1790.2435302734375
Test Acc:  0.0
Valid Loss:  2189.517333984375
Valid Acc:  0.0
std:  12047.068174827058 
thres:  9.070583158874511
Preserved_eigens number check:  512
 18%|█▊        | 181/1000 [54:31<3:58:45, 17.49s/it]Epoch:   182
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(0.0281, device='cuda:0') 
Std:  tensor(5.5616, device='cuda:0') 
ABS Max:  tensor(58.2195, device='cuda:0') 
ABS Min:  tensor(0.0004, device='cuda:0')
Criterion check:  tensor([0.9999, 1.0002, 1.0000, 1.0001, 1.0002, 1.0000, 1.0000, 1.0001, 0.9990,
        0.9972], device='cuda:0') tensor(149, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(2.9787e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(386.0895, device='cuda:0')
min of grad d_p:  tensor(-267.0450, device='cuda:0')
max|min: (J_L, Jta/N)  (386.08953857421875, 386.089111328125, ratio: 0.9999988675117493)|(-267.04498291015625, -267.044921875)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(-8.9940e-10, device='cuda:0') min:  tensor(-0.0001, device='cuda:0') norm:  tensor(0.0013, device='cuda:0') MSE:  tensor(1.6368e-09, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0875, device='cuda:0') mean:  tensor(0.0002, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.6860, device='cuda:0') MSE:  tensor(8.6447e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.4526, device='cuda:0')
min of d_p_list:  tensor(-0.6161, device='cuda:0')
Epoch:  182  
Training Loss: 834.337890625
Test Loss:  912.8074951171875
Test Acc:  0.0
Valid Loss:  1066.3692626953125
Valid Acc:  0.0
std:  11968.016212725082 
thres:  9.18136224822998
Preserved_eigens number check:  512
 18%|█▊        | 182/1000 [54:48<3:57:43, 17.44s/it]Epoch:   183
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(1.6712, device='cuda:0') 
Std:  tensor(43.7914, device='cuda:0') 
ABS Max:  tensor(621.3576, device='cuda:0') 
ABS Min:  tensor(0.0008, device='cuda:0')
Criterion check:  tensor([1.0008, 1.0000, 1.0000, 0.9997, 0.9989, 1.0001, 0.9998, 0.9996, 1.0001,
        0.9995], device='cuda:0') tensor(198, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0001, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(225.8547, device='cuda:0')
min of grad d_p:  tensor(-144.5762, device='cuda:0')
max|min: (J_L, Jta/N)  (225.854736328125, 225.85498046875, ratio: 1.000001072883606)|(-144.576171875, -144.57615661621094)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.5313e-05, device='cuda:0') mean:  tensor(-3.9871e-09, device='cuda:0') min:  tensor(-0.0002, device='cuda:0') norm:  tensor(0.0007, device='cuda:0') MSE:  tensor(8.9660e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.6942, device='cuda:0') mean:  tensor(0.0007, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(2.8537, device='cuda:0') MSE:  tensor(3.5959e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.9934, device='cuda:0')
min of d_p_list:  tensor(-0.8881, device='cuda:0')
Epoch:  183  
Training Loss: 290.36944580078125
Test Loss:  332.7795104980469
Test Acc:  0.0
Valid Loss:  385.8059387207031
Valid Acc:  0.0
std:  11940.844067487336 
thres:  9.217457092285157
Preserved_eigens number check:  512
 18%|█▊        | 183/1000 [55:06<3:58:11, 17.49s/it]Epoch:   184
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(2.7538, device='cuda:0') 
Std:  tensor(133.0470, device='cuda:0') 
ABS Max:  tensor(2739.2571, device='cuda:0') 
ABS Min:  tensor(0.0039, device='cuda:0')
Criterion check:  tensor([1.0055, 0.9978, 0.9999, 0.9994, 1.0007, 0.9996, 0.9994, 1.0075, 0.9932,
        1.0798], device='cuda:0') tensor(184, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(2.8183e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(154.0474, device='cuda:0')
min of grad d_p:  tensor(-118.7998, device='cuda:0')
max|min: (J_L, Jta/N)  (154.04736328125, 154.0474853515625, ratio: 1.0000008344650269)|(-118.79983520507812, -118.7998275756836)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.3406e-05, device='cuda:0') mean:  tensor(-9.2448e-09, device='cuda:0') min:  tensor(-0.0001, device='cuda:0') norm:  tensor(0.0005, device='cuda:0') MSE:  tensor(6.9034e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.3357, device='cuda:0') mean:  tensor(0.0008, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(3.0029, device='cuda:0') MSE:  tensor(3.7838e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.2421, device='cuda:0')
min of d_p_list:  tensor(-0.2955, device='cuda:0')
Epoch:  184  
Training Loss: 155.15863037109375
Test Loss:  179.60557556152344
Test Acc:  0.0
Valid Loss:  207.63385009765625
Valid Acc:  0.0
std:  4455.916121704136 
thres:  2.938843896484375
Preserved_eigens number check:  512
 18%|█▊        | 184/1000 [55:23<3:58:28, 17.54s/it]Epoch:   185
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(0.3508, device='cuda:0') 
Std:  tensor(11.9907, device='cuda:0') 
ABS Max:  tensor(197.6261, device='cuda:0') 
ABS Min:  tensor(0.0004, device='cuda:0')
Criterion check:  tensor([1.0009, 0.9995, 1.0000, 0.9998, 0.9997, 0.9998, 1.0002, 0.9999, 0.9873,
        1.0198], device='cuda:0') tensor(120, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0001, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(85.4301, device='cuda:0')
min of grad d_p:  tensor(-64.0501, device='cuda:0')
max|min: (J_L, Jta/N)  (85.43009948730469, 85.43012237548828, ratio: 1.000000238418579)|(-64.05014038085938, -64.05013275146484)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.8532e-05, device='cuda:0') mean:  tensor(-4.4546e-09, device='cuda:0') min:  tensor(-7.3433e-05, device='cuda:0') norm:  tensor(0.0004, device='cuda:0') MSE:  tensor(5.6618e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0788, device='cuda:0') mean:  tensor(0.0002, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.6476, device='cuda:0') MSE:  tensor(8.1605e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1917, device='cuda:0')
min of d_p_list:  tensor(-0.2138, device='cuda:0')
Epoch:  185  
Training Loss: 91.73846435546875
Test Loss:  104.97276306152344
Test Acc:  0.0
Valid Loss:  117.98477172851562
Valid Acc:  0.0
std:  575.3264585472277 
thres:  0.5990654174804688
Preserved_eigens number check:  512
 18%|█▊        | 185/1000 [55:41<3:58:42, 17.57s/it]Epoch:   186
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(1.0499, device='cuda:0') 
Std:  tensor(39.2813, device='cuda:0') 
ABS Max:  tensor(698.0278, device='cuda:0') 
ABS Min:  tensor(0.0010, device='cuda:0')
Criterion check:  tensor([1.0014, 1.0015, 1.0001, 0.9995, 1.0005, 0.9991, 0.9993, 0.9998, 1.0050,
        1.0652], device='cuda:0') tensor(133, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0002, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(49.8380, device='cuda:0')
min of grad d_p:  tensor(-34.7316, device='cuda:0')
max|min: (J_L, Jta/N)  (49.837989807128906, 49.837982177734375, ratio: 0.9999998211860657)|(-34.731571197509766, -34.73152160644531)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.0054e-05, device='cuda:0') mean:  tensor(-3.4973e-09, device='cuda:0') min:  tensor(-4.9591e-05, device='cuda:0') norm:  tensor(0.0004, device='cuda:0') MSE:  tensor(4.4391e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.1166, device='cuda:0') mean:  tensor(0.0003, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(1.0959, device='cuda:0') MSE:  tensor(1.3809e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1650, device='cuda:0')
min of d_p_list:  tensor(-0.1473, device='cuda:0')
Epoch:  186  
Training Loss: 48.3583984375
Test Loss:  56.73161315917969
Test Acc:  0.0
Valid Loss:  63.01533508300781
Valid Acc:  0.0
std:  287.0553690228565 
thres:  0.2839925659179688
Preserved_eigens number check:  512
 19%|█▊        | 186/1000 [55:58<3:57:05, 17.48s/it]Epoch:   187
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  510
Criterion check: 
Mean:  tensor(2.4466, device='cuda:0') 
Std:  tensor(45.3251, device='cuda:0') 
ABS Max:  tensor(901.3806, device='cuda:0') 
ABS Min:  tensor(0., device='cuda:0')
Criterion check:  tensor([1.0013, 0.9986, 1.0000, 1.0007, 1.0014, 1.0005, 0.9996, 1.0071, 0.9965,
        1.0710], device='cuda:0') tensor(161, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(3.3525e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(29.9627, device='cuda:0')
min of grad d_p:  tensor(-19.0728, device='cuda:0')
max|min: (J_L, Jta/N)  (29.962661743164062, 29.962688446044922, ratio: 1.0000008344650269)|(-19.072795867919922, -19.07280921936035)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.8133e-05, device='cuda:0') mean:  tensor(1.0189e-09, device='cuda:0') min:  tensor(-3.1471e-05, device='cuda:0') norm:  tensor(0.0002, device='cuda:0') MSE:  tensor(2.5013e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0996, device='cuda:0') mean:  tensor(0.0002, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.8545, device='cuda:0') MSE:  tensor(1.0767e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.2075, device='cuda:0')
min of d_p_list:  tensor(-0.1283, device='cuda:0')
Epoch:  187  
Training Loss: 12.427196502685547
Test Loss:  14.320344924926758
Test Acc:  0.0
Valid Loss:  15.187685012817383
Valid Acc:  0.0
std:  97.73869248203405 
thres:  0.11961042709350586
Preserved_eigens number check:  512
 19%|█▊        | 187/1000 [56:16<3:58:53, 17.63s/it]Epoch:   188
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  510
Criterion check: 
Mean:  tensor(2.2083, device='cuda:0') 
Std:  tensor(146.4595, device='cuda:0') 
ABS Max:  tensor(1987.7306, device='cuda:0') 
ABS Min:  tensor(0.0037, device='cuda:0')
Criterion check:  tensor([1.0065, 0.9755, 0.9979, 0.9922, 1.0010, 0.8484, 1.0052, 1.0039, 1.0941,
        1.2355], device='cuda:0') tensor(182, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(4.6309e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(20.4440, device='cuda:0')
min of grad d_p:  tensor(-10.6220, device='cuda:0')
max|min: (J_L, Jta/N)  (20.444034576416016, 20.444290161132812, ratio: 1.0000125169754028)|(-10.621973037719727, -10.621922492980957)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.9128e-05, device='cuda:0') mean:  tensor(-9.2454e-09, device='cuda:0') min:  tensor(-0.0003, device='cuda:0') norm:  tensor(0.0006, device='cuda:0') MSE:  tensor(8.0171e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.3219, device='cuda:0') mean:  tensor(0.0008, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(2.7282, device='cuda:0') MSE:  tensor(3.4377e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.3676, device='cuda:0')
min of d_p_list:  tensor(-0.3366, device='cuda:0')
Epoch:  188  
Training Loss: 16.183958053588867
Test Loss:  17.374977111816406
Test Acc:  0.0
Valid Loss:  18.923219680786133
Valid Acc:  0.0
std:  53.41744233946105 
thres:  0.06477332954406738
Preserved_eigens number check:  512
 19%|█▉        | 188/1000 [56:34<3:56:53, 17.50s/it]Epoch:   189
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(1.2319, device='cuda:0') 
Std:  tensor(16.7247, device='cuda:0') 
ABS Max:  tensor(309.4230, device='cuda:0') 
ABS Min:  tensor(9.5340e-05, device='cuda:0')
Criterion check:  tensor([1.0109, 0.9996, 0.9998, 1.0000, 1.0006, 0.9986, 0.9997, 0.9993, 1.0110,
        1.0006], device='cuda:0') tensor(124, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0002, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(10.0958, device='cuda:0')
min of grad d_p:  tensor(-7.0070, device='cuda:0')
max|min: (J_L, Jta/N)  (10.09581184387207, 10.095819473266602, ratio: 1.0000007152557373)|(-7.006972312927246, -7.006989479064941)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.7166e-05, device='cuda:0') mean:  tensor(5.6050e-10, device='cuda:0') min:  tensor(-1.3351e-05, device='cuda:0') norm:  tensor(0.0001, device='cuda:0') MSE:  tensor(1.4011e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0226, device='cuda:0') mean:  tensor(6.6839e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.2470, device='cuda:0') MSE:  tensor(3.1129e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.2600, device='cuda:0')
min of d_p_list:  tensor(-0.2194, device='cuda:0')
Epoch:  189  
Training Loss: 8.34455680847168
Test Loss:  9.838821411132812
Test Acc:  0.0
Valid Loss:  10.876919746398926
Valid Acc:  0.0
std:  31.530763004061555 
thres:  0.03541051483154297
Preserved_eigens number check:  512
 19%|█▉        | 189/1000 [56:51<3:56:38, 17.51s/it]Epoch:   190
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(-3.3737, device='cuda:0') 
Std:  tensor(69.6494, device='cuda:0') 
ABS Max:  tensor(1464.5018, device='cuda:0') 
ABS Min:  tensor(0.0006, device='cuda:0')
Criterion check:  tensor([0.9993, 1.2774, 1.0005, 1.0159, 0.9988, 1.0035, 0.9928, 1.0497, 1.0745,
        1.0114], device='cuda:0') tensor(177, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(2.9053e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(9.8376, device='cuda:0')
min of grad d_p:  tensor(-4.1789, device='cuda:0')
max|min: (J_L, Jta/N)  (9.837628364562988, 9.837444305419922, ratio: 0.9999812841415405)|(-4.178945064544678, -4.178951263427734)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(5.2833e-09, device='cuda:0') min:  tensor(-4.1962e-05, device='cuda:0') norm:  tensor(0.0004, device='cuda:0') MSE:  tensor(5.5222e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.1857, device='cuda:0') mean:  tensor(0.0004, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(1.4799, device='cuda:0') MSE:  tensor(1.8648e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0910, device='cuda:0')
min of d_p_list:  tensor(-0.1295, device='cuda:0')
Epoch:  190  
Training Loss: 1.0678138732910156
Test Loss:  1.2106603384017944
Test Acc:  0.0
Valid Loss:  1.3831377029418945
Valid Acc:  0.0
std:  16.32969637107332 
thres:  0.01727638473510742
Preserved_eigens number check:  512
 19%|█▉        | 190/1000 [57:09<3:57:12, 17.57s/it]Epoch:   191
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(-36.4010, device='cuda:0') 
Std:  tensor(579.8535, device='cuda:0') 
ABS Max:  tensor(12571.6299, device='cuda:0') 
ABS Min:  tensor(0.0036, device='cuda:0')
Criterion check:  tensor([0.9703, 0.6192, 0.9774, 0.3024, 1.1255, 1.0078, 0.8198, 0.7973, 1.4874,
        1.4519], device='cuda:0') tensor(210, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(8.5076e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(5.1187, device='cuda:0')
min of grad d_p:  tensor(-2.5848, device='cuda:0')
max|min: (J_L, Jta/N)  (5.118699073791504, 5.118619441986084, ratio: 0.9999844431877136)|(-2.584794044494629, -2.584855318069458)

 check Jacobi res:  torch.Size([793601]) max:  tensor(7.9632e-05, device='cuda:0') mean:  tensor(4.7019e-09, device='cuda:0') min:  tensor(-2.3991e-05, device='cuda:0') norm:  tensor(0.0003, device='cuda:0') MSE:  tensor(3.3032e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(1.1364, device='cuda:0') mean:  tensor(0.0023, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(8.6671, device='cuda:0') MSE:  tensor(1.0921e-05, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1406, device='cuda:0')
min of d_p_list:  tensor(-0.1510, device='cuda:0')
Epoch:  191  
Training Loss: 1.389765977859497
Test Loss:  1.3028591871261597
Test Acc:  0.0
Valid Loss:  1.5461369752883911
Valid Acc:  0.0
std:  5.972897296520156 
thres:  0.007882658243179321
Preserved_eigens number check:  512
 19%|█▉        | 191/1000 [57:26<3:57:29, 17.61s/it]Epoch:   192
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  509
Criterion check: 
Mean:  tensor(0.3648, device='cuda:0') 
Std:  tensor(163.4964, device='cuda:0') 
ABS Max:  tensor(2546.2839, device='cuda:0') 
ABS Min:  tensor(0.0011, device='cuda:0')
Criterion check:  tensor([0.8837, 1.0314, 1.0056, 0.9846, 1.0182, 1.0112, 0.9643, 0.9875, 0.9204,
        1.0022], device='cuda:0') tensor(166, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(3.4987e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(3.4212, device='cuda:0')
min of grad d_p:  tensor(-1.6879, device='cuda:0')
max|min: (J_L, Jta/N)  (3.421203851699829, 3.421304941177368, ratio: 1.0000295639038086)|(-1.6878703832626343, -1.687818169593811)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.0905e-05, device='cuda:0') mean:  tensor(-5.4303e-09, device='cuda:0') min:  tensor(-0.0001, device='cuda:0') norm:  tensor(0.0003, device='cuda:0') MSE:  tensor(3.9221e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.1524, device='cuda:0') mean:  tensor(0.0003, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(1.3048, device='cuda:0') MSE:  tensor(1.6442e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.3279, device='cuda:0')
min of d_p_list:  tensor(-0.3592, device='cuda:0')
Epoch:  192  
Training Loss: 13.726678848266602
Test Loss:  16.3043212890625
Test Acc:  0.0
Valid Loss:  17.943527221679688
Valid Acc:  0.0
std:  6.189338067049858 
thres:  0.008142554712295531
Preserved_eigens number check:  512
 19%|█▉        | 192/1000 [57:44<3:55:03, 17.46s/it]Epoch:   193
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(2.2482, device='cuda:0') 
Std:  tensor(42.5265, device='cuda:0') 
ABS Max:  tensor(568.8258, device='cuda:0') 
ABS Min:  tensor(0.0039, device='cuda:0')
Criterion check:  tensor([1.0057, 1.0015, 1.0037, 1.0609, 0.9959, 1.0022, 0.9946, 1.0091, 1.0252,
        1.0100], device='cuda:0') tensor(186, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0002, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(4.1952, device='cuda:0')
min of grad d_p:  tensor(-2.8724, device='cuda:0')
max|min: (J_L, Jta/N)  (4.195220947265625, 4.194926738739014, ratio: 0.9999298453330994)|(-2.8723702430725098, -2.8724288940429688)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(1.1493e-08, device='cuda:0') min:  tensor(-7.3791e-05, device='cuda:0') norm:  tensor(0.0008, device='cuda:0') MSE:  tensor(9.8680e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.2001, device='cuda:0') mean:  tensor(0.0005, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(2.1582, device='cuda:0') MSE:  tensor(2.7195e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.5154, device='cuda:0')
min of d_p_list:  tensor(-0.3722, device='cuda:0')
Epoch:  193  
Training Loss: 11.908761024475098
Test Loss:  14.140207290649414
Test Acc:  0.0
Valid Loss:  16.642202377319336
Valid Acc:  0.0
std:  5.242217258034072 
thres:  0.007287515306472779
Preserved_eigens number check:  512
 19%|█▉        | 193/1000 [58:01<3:54:47, 17.46s/it]Epoch:   194
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(0.6727, device='cuda:0') 
Std:  tensor(20.6102, device='cuda:0') 
ABS Max:  tensor(284.0327, device='cuda:0') 
ABS Min:  tensor(0.0016, device='cuda:0')
Criterion check:  tensor([1.0023, 0.9978, 1.0073, 0.9999, 0.9969, 0.9984, 0.9960, 1.0024, 1.0013,
        0.9889], device='cuda:0') tensor(156, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0002, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(2.6651, device='cuda:0')
min of grad d_p:  tensor(-4.0838, device='cuda:0')
max|min: (J_L, Jta/N)  (2.665144443511963, 2.6651053428649902, ratio: 0.9999853372573853)|(-4.083832263946533, -4.083847999572754)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(7.2202e-09, device='cuda:0') min:  tensor(-3.9071e-05, device='cuda:0') norm:  tensor(0.0004, device='cuda:0') MSE:  tensor(5.6114e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0776, device='cuda:0') mean:  tensor(0.0002, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.8695, device='cuda:0') MSE:  tensor(1.0957e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.7999, device='cuda:0')
min of d_p_list:  tensor(-0.7971, device='cuda:0')
Epoch:  194  
Training Loss: 30.726879119873047
Test Loss:  36.300209045410156
Test Acc:  0.0
Valid Loss:  34.595306396484375
Valid Acc:  0.0
std:  10.821247411752953 
thres:  0.011763979768753052
Preserved_eigens number check:  512
 19%|█▉        | 194/1000 [58:19<3:55:47, 17.55s/it]Epoch:   195
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(-0.3284, device='cuda:0') 
Std:  tensor(16.3991, device='cuda:0') 
ABS Max:  tensor(246.5394, device='cuda:0') 
ABS Min:  tensor(7.4564e-06, device='cuda:0')
Criterion check:  tensor([0.9985, 0.9995, 1.0005, 0.9995, 1.0003, 0.9998, 0.9994, 1.0035, 1.0012,
        1.0020], device='cuda:0') tensor(130, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(3.2121e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(3.9161, device='cuda:0')
min of grad d_p:  tensor(-16.1677, device='cuda:0')
max|min: (J_L, Jta/N)  (3.916105031967163, 3.9160985946655273, ratio: 0.9999983310699463)|(-16.16767692565918, -16.167720794677734)

 check Jacobi res:  torch.Size([793601]) max:  tensor(6.2704e-05, device='cuda:0') mean:  tensor(3.3169e-09, device='cuda:0') min:  tensor(-2.1219e-05, device='cuda:0') norm:  tensor(0.0002, device='cuda:0') MSE:  tensor(2.8913e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0520, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.5562, device='cuda:0') MSE:  tensor(7.0089e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(2.4879, device='cuda:0')
min of d_p_list:  tensor(-3.2582, device='cuda:0')
Epoch:  195  
Training Loss: 650.3613891601562
Test Loss:  651.6696166992188
Test Acc:  0.0
Valid Loss:  623.2093505859375
Valid Acc:  0.0
std:  254.54324226446082 
thres:  0.1416226948261261
Preserved_eigens number check:  512
 20%|█▉        | 195/1000 [58:36<3:54:04, 17.45s/it]Epoch:   196
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  510
Criterion check: 
Mean:  tensor(1.7459, device='cuda:0') 
Std:  tensor(44.9407, device='cuda:0') 
ABS Max:  tensor(963.1207, device='cuda:0') 
ABS Min:  tensor(0.0037, device='cuda:0')
Criterion check:  tensor([0.9999, 1.0003, 0.9929, 1.0015, 0.9996, 1.0000, 1.0002, 0.9975, 0.9998,
        1.0006], device='cuda:0') tensor(135, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(6.5319e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(263.2036, device='cuda:0')
min of grad d_p:  tensor(-128.4377, device='cuda:0')
max|min: (J_L, Jta/N)  (263.2035827636719, 263.2033996582031, ratio: 0.9999992847442627)|(-128.43771362304688, -128.43777465820312)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(2.1102e-09, device='cuda:0') min:  tensor(-7.6294e-05, device='cuda:0') norm:  tensor(0.0007, device='cuda:0') MSE:  tensor(8.3912e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.1670, device='cuda:0') mean:  tensor(0.0003, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(1.0273, device='cuda:0') MSE:  tensor(1.2944e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.2979, device='cuda:0')
min of d_p_list:  tensor(-0.3039, device='cuda:0')
Epoch:  196  
Training Loss: 264.9018249511719
Test Loss:  272.38494873046875
Test Acc:  0.0
Valid Loss:  252.62367248535156
Valid Acc:  0.0
std:  247.2270452271248 
thres:  0.19432510662078858
Preserved_eigens number check:  512
 20%|█▉        | 196/1000 [58:54<3:54:50, 17.53s/it]Epoch:   197
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(-2.0613, device='cuda:0') 
Std:  tensor(50.5185, device='cuda:0') 
ABS Max:  tensor(1099.0460, device='cuda:0') 
ABS Min:  tensor(0.0007, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0002, 1.0000, 1.0000, 0.9999, 1.0001, 1.0003, 1.0004, 1.0002,
        0.9986], device='cuda:0') tensor(122, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(8.7522e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(140.1513, device='cuda:0')
min of grad d_p:  tensor(-77.2563, device='cuda:0')
max|min: (J_L, Jta/N)  (140.15130615234375, 140.1511688232422, ratio: 0.9999990463256836)|(-77.25625610351562, -77.25623321533203)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(5.0326e-09, device='cuda:0') min:  tensor(-3.0518e-05, device='cuda:0') norm:  tensor(0.0005, device='cuda:0') MSE:  tensor(5.8806e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0538, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.4389, device='cuda:0') MSE:  tensor(5.5307e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.9951, device='cuda:0')
min of d_p_list:  tensor(-0.8589, device='cuda:0')
Epoch:  197  
Training Loss: 60.17853546142578
Test Loss:  64.0960922241211
Test Acc:  0.0
Valid Loss:  58.03362274169922
Valid Acc:  0.0
std:  241.06182397966683 
thres:  0.20361547794342041
Preserved_eigens number check:  512
 20%|█▉        | 197/1000 [59:11<3:53:39, 17.46s/it]Epoch:   198
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  510
Criterion check: 
Mean:  tensor(-1.3302, device='cuda:0') 
Std:  tensor(190.3781, device='cuda:0') 
ABS Max:  tensor(3054.2390, device='cuda:0') 
ABS Min:  tensor(0.0013, device='cuda:0')
Criterion check:  tensor([0.9998, 0.9988, 1.0049, 1.0002, 1.0003, 1.0030, 0.8175, 1.2092, 0.9973,
        1.0939], device='cuda:0') tensor(172, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(3.2951e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(105.4358, device='cuda:0')
min of grad d_p:  tensor(-40.5524, device='cuda:0')
max|min: (J_L, Jta/N)  (105.43577575683594, 105.43598175048828, ratio: 1.0000019073486328)|(-40.55243682861328, -40.552425384521484)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.9128e-05, device='cuda:0') mean:  tensor(-7.2452e-09, device='cuda:0') min:  tensor(-0.0002, device='cuda:0') norm:  tensor(0.0006, device='cuda:0') MSE:  tensor(8.0438e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.4075, device='cuda:0') mean:  tensor(0.0008, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(2.9142, device='cuda:0') MSE:  tensor(3.6721e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.2775, device='cuda:0')
min of d_p_list:  tensor(-0.3938, device='cuda:0')
Epoch:  198  
Training Loss: 74.26297760009766
Test Loss:  79.55414581298828
Test Acc:  0.0
Valid Loss:  66.350830078125
Valid Acc:  0.0
std:  232.2744106742265 
thres:  0.21608632125854493
Preserved_eigens number check:  512
 20%|█▉        | 198/1000 [59:29<3:54:35, 17.55s/it]Epoch:   199
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(0.7945, device='cuda:0') 
Std:  tensor(10.0494, device='cuda:0') 
ABS Max:  tensor(113.3700, device='cuda:0') 
ABS Min:  tensor(0.0008, device='cuda:0')
Criterion check:  tensor([0.9998, 0.9996, 0.9980, 1.0000, 0.9988, 0.9976, 0.9983, 1.0017, 0.9990,
        0.9799], device='cuda:0') tensor(132, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(8.8483e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(60.5203, device='cuda:0')
min of grad d_p:  tensor(-18.4074, device='cuda:0')
max|min: (J_L, Jta/N)  (60.52027130126953, 60.52015686035156, ratio: 0.9999980926513672)|(-18.40735626220703, -18.407358169555664)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(3.5236e-09, device='cuda:0') min:  tensor(-2.1935e-05, device='cuda:0') norm:  tensor(0.0003, device='cuda:0') MSE:  tensor(3.6258e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0971, device='cuda:0') mean:  tensor(0.0002, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.9136, device='cuda:0') MSE:  tensor(1.1512e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(3.7756, device='cuda:0')
min of d_p_list:  tensor(-3.0836, device='cuda:0')
Epoch:  199  
Training Loss: 287.9785461425781
Test Loss:  330.0414123535156
Test Acc:  0.0
Valid Loss:  332.9341125488281
Valid Acc:  0.0
std:  213.22837261580395 
thres:  0.2675366546630859
Preserved_eigens number check:  512
 20%|█▉        | 199/1000 [59:55<4:30:07, 20.23s/it]Epoch:   200
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  509
Criterion check: 
Mean:  tensor(-0.2215, device='cuda:0') 
Std:  tensor(14.5953, device='cuda:0') 
ABS Max:  tensor(159.8248, device='cuda:0') 
ABS Min:  tensor(0.0005, device='cuda:0')
Criterion check:  tensor([0.9999, 1.0001, 1.0002, 0.9999, 0.9999, 0.9999, 1.0003, 0.9844, 1.0067,
        0.9970], device='cuda:0') tensor(151, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(4.7810e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(88.1808, device='cuda:0')
min of grad d_p:  tensor(-189.6713, device='cuda:0')
max|min: (J_L, Jta/N)  (88.18075561523438, 88.18077087402344, ratio: 1.0000001192092896)|(-189.6712646484375, -189.67141723632812)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(2.6566e-09, device='cuda:0') min:  tensor(-3.4332e-05, device='cuda:0') norm:  tensor(0.0004, device='cuda:0') MSE:  tensor(4.9180e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.1949, device='cuda:0') mean:  tensor(0.0003, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(1.3034, device='cuda:0') MSE:  tensor(1.6424e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.3561, device='cuda:0')
min of d_p_list:  tensor(-0.3134, device='cuda:0')
Epoch:  200  
Training Loss: 105.79019165039062
Test Loss:  117.5693130493164
Test Acc:  0.0
Valid Loss:  117.50099182128906
Valid Acc:  0.0
std:  97.59844011544598 
thres:  0.15862241516113282
Preserved_eigens number check:  512
 20%|██        | 200/1000 [1:00:13<4:18:52, 19.42s/it]Epoch:   201
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.0169, device='cuda:0') 
Std:  tensor(5.2477, device='cuda:0') 
ABS Max:  tensor(66.3351, device='cuda:0') 
ABS Min:  tensor(5.6475e-05, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 0.9998, 1.0001, 0.9999, 1.0000, 1.0000, 1.0384, 1.0013,
        0.9998], device='cuda:0') tensor(110, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0001, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(57.5223, device='cuda:0')
min of grad d_p:  tensor(-106.1104, device='cuda:0')
max|min: (J_L, Jta/N)  (57.522300720214844, 57.52228546142578, ratio: 0.9999997615814209)|(-106.11039733886719, -106.11055755615234)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(5.4532e-09, device='cuda:0') min:  tensor(-3.6240e-05, device='cuda:0') norm:  tensor(0.0004, device='cuda:0') MSE:  tensor(5.1942e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0597, device='cuda:0') mean:  tensor(8.1057e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.3393, device='cuda:0') MSE:  tensor(4.2750e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.5156, device='cuda:0')
min of d_p_list:  tensor(-0.6975, device='cuda:0')
Epoch:  201  
Training Loss: 38.39082336425781
Test Loss:  38.45555877685547
Test Acc:  0.0
Valid Loss:  46.092140197753906
Valid Acc:  0.0
std:  90.02905477405771 
thres:  0.11332021484375
Preserved_eigens number check:  512
 20%|██        | 201/1000 [1:00:30<4:09:02, 18.70s/it]Epoch:   202
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(-0.2335, device='cuda:0') 
Std:  tensor(16.7650, device='cuda:0') 
ABS Max:  tensor(319.8985, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([1.0001, 1.0001, 0.9999, 1.0000, 1.0000, 1.0001, 1.0001, 0.9984, 0.9985,
        1.0011], device='cuda:0') tensor(111, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(1.0710e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(36.8939, device='cuda:0')
min of grad d_p:  tensor(-76.0658, device='cuda:0')
max|min: (J_L, Jta/N)  (36.89387130737305, 36.89390182495117, ratio: 1.0000008344650269)|(-76.06584167480469, -76.06595611572266)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(3.8664e-09, device='cuda:0') min:  tensor(-3.6240e-05, device='cuda:0') norm:  tensor(0.0004, device='cuda:0') MSE:  tensor(4.6796e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0386, device='cuda:0') mean:  tensor(6.2739e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.2472, device='cuda:0') MSE:  tensor(3.1152e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1551, device='cuda:0')
min of d_p_list:  tensor(-0.1823, device='cuda:0')
Epoch:  202  
Training Loss: 26.155271530151367
Test Loss:  23.35602569580078
Test Acc:  0.0
Valid Loss:  30.194059371948242
Valid Acc:  0.0
std:  94.94032470466182 
thres:  0.10651556205749511
Preserved_eigens number check:  512
 20%|██        | 202/1000 [1:00:47<4:04:12, 18.36s/it]Epoch:   203
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  510
Criterion check: 
Mean:  tensor(0.1571, device='cuda:0') 
Std:  tensor(5.5243, device='cuda:0') 
ABS Max:  tensor(66.4671, device='cuda:0') 
ABS Min:  tensor(7.5134e-06, device='cuda:0')
Criterion check:  tensor([1.0002, 1.0001, 0.9998, 1.0002, 1.0002, 1.0000, 0.9999, 0.9998, 0.9955,
        1.0042], device='cuda:0') tensor(117, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(7.3840e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(21.4847, device='cuda:0')
min of grad d_p:  tensor(-43.3164, device='cuda:0')
max|min: (J_L, Jta/N)  (21.484664916992188, 21.4846134185791, ratio: 0.999997615814209)|(-43.31639099121094, -43.316322326660156)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.2452e-05, device='cuda:0') mean:  tensor(4.7463e-10, device='cuda:0') min:  tensor(-6.8665e-05, device='cuda:0') norm:  tensor(0.0003, device='cuda:0') MSE:  tensor(4.1691e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0403, device='cuda:0') mean:  tensor(5.7505e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.2263, device='cuda:0') MSE:  tensor(2.8521e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.2562, device='cuda:0')
min of d_p_list:  tensor(-0.1812, device='cuda:0')
Epoch:  203  
Training Loss: 16.271575927734375
Test Loss:  15.404129028320312
Test Acc:  0.0
Valid Loss:  20.239166259765625
Valid Acc:  0.0
std:  101.48839694266032 
thres:  0.09491728172302245
Preserved_eigens number check:  512
 20%|██        | 203/1000 [1:01:05<4:01:25, 18.18s/it]Epoch:   204
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(0.6012, device='cuda:0') 
Std:  tensor(9.9049, device='cuda:0') 
ABS Max:  tensor(201.5870, device='cuda:0') 
ABS Min:  tensor(0.0001, device='cuda:0')
Criterion check:  tensor([0.9998, 0.9999, 1.0006, 0.9998, 1.0001, 1.0001, 1.0007, 0.9985, 1.1182,
        1.0007], device='cuda:0') tensor(122, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(8.1876e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(9.6703, device='cuda:0')
min of grad d_p:  tensor(-23.2842, device='cuda:0')
max|min: (J_L, Jta/N)  (9.670306205749512, 9.670318603515625, ratio: 1.000001311302185)|(-23.284181594848633, -23.28421974182129)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.8147e-05, device='cuda:0') mean:  tensor(9.8821e-10, device='cuda:0') min:  tensor(-1.2398e-05, device='cuda:0') norm:  tensor(0.0001, device='cuda:0') MSE:  tensor(1.2892e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0565, device='cuda:0') mean:  tensor(6.6574e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.2965, device='cuda:0') MSE:  tensor(3.7360e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.3469, device='cuda:0')
min of d_p_list:  tensor(-0.2900, device='cuda:0')
Epoch:  204  
Training Loss: 6.744509696960449
Test Loss:  7.536427974700928
Test Acc:  0.0
Valid Loss:  9.047059059143066
Valid Acc:  0.0
std:  35.164592493979605 
thres:  0.03867047443389893
Preserved_eigens number check:  512
 20%|██        | 204/1000 [1:01:23<4:00:10, 18.10s/it]Epoch:   205
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  510
Criterion check: 
Mean:  tensor(0.3310, device='cuda:0') 
Std:  tensor(8.1392, device='cuda:0') 
ABS Max:  tensor(111.5911, device='cuda:0') 
ABS Min:  tensor(5.2977e-05, device='cuda:0')
Criterion check:  tensor([1.0000, 0.9995, 0.9990, 1.0200, 1.0000, 0.9982, 1.0001, 0.8760, 0.9994,
        0.9834], device='cuda:0') tensor(116, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(1.4834e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(3.6551, device='cuda:0')
min of grad d_p:  tensor(-14.3691, device='cuda:0')
max|min: (J_L, Jta/N)  (3.655127763748169, 3.6551544666290283, ratio: 1.0000072717666626)|(-14.36909008026123, -14.369224548339844)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(3.8153e-09, device='cuda:0') min:  tensor(-2.6703e-05, device='cuda:0') norm:  tensor(0.0003, device='cuda:0') MSE:  tensor(4.0071e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0299, device='cuda:0') mean:  tensor(6.1514e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.2440, device='cuda:0') MSE:  tensor(3.0748e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.4195, device='cuda:0')
min of d_p_list:  tensor(-0.5509, device='cuda:0')
Epoch:  205  
Training Loss: 6.914950370788574
Test Loss:  7.458034515380859
Test Acc:  0.0
Valid Loss:  6.132556438446045
Valid Acc:  0.0
std:  12.089971282176801 
thres:  0.018895426177978514
Preserved_eigens number check:  512
 20%|██        | 205/1000 [1:01:41<3:59:09, 18.05s/it]