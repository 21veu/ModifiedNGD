/nishome/yui/ModifiedNGD/utils/readData.py:18: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  return torch.tensor(x, dtype=torch.float32), torch.tensor(y, dtype=torch.float32)
Train info: 
 train data shape: torch.Size([512, 1]), 
 train lable shape: torch.Size([512, 1]), 
 positive / negative: 0.014509063214063644 / 0.9854909181594849, 
 discrepancy norm error: 8.21854019165039
Test info: 
 test data shape: torch.Size([256, 1]), 
 test lable shape: torch.Size([256, 1]), , 
 positive / negative: -0.04019593074917793 / 1.0401959419250488, 
 discrepancy norm error: 5.910345554351807
Valid info: 
 valid data shape: torch.Size([256, 1]), valid lable shape: torch.Size([256, 1]), 
 positive / negative: 0.04114104062318802 / 0.9588589668273926, 
 discrepancy norm error: 5.461434364318848
torch.Size([512, 1]) torch.Size([512])
seed is  2191
---------------------------------------- NGD ----------------------------------------
<bound method Module.modules of Sequential(
  (0): Linear(in_features=1, out_features=512, bias=True)
  (1): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (2): ReLU()
  (3): Linear(in_features=512, out_features=512, bias=True)
  (4): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (5): ReLU()
  (6): Linear(in_features=512, out_features=512, bias=True)
  (7): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (8): ReLU()
  (9): Linear(in_features=512, out_features=512, bias=True)
  (10): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (11): ReLU()
  (12): Linear(in_features=512, out_features=1, bias=True)
)>
Learning rate is:  0.05
  0%|          | 0/1000 [00:00<?, ?it/s]/nishome/yui/anaconda3/envs/ng/lib/python3.12/site-packages/torch/autograd/graph.py:744: UserWarning: Using backward() with create_graph=True will create a reference cycle between the parameter and its gradient which can cause a memory leak. We recommend using autograd.grad when creating the graph to avoid this. If you have to use this function, make sure to reset the .grad fields of your parameters to None after use to break the cycle and avoid the leak. (Triggered internally at /opt/conda/conda-bld/pytorch_1716905971214/work/torch/csrc/autograd/engine.cpp:1203.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
Epoch:   1
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.5201, device='cuda:0') 
Std:  tensor(37.1448, device='cuda:0') 
ABS Max:  tensor(570.4353, device='cuda:0') 
ABS Min:  tensor(0.0011, device='cuda:0')
Criterion check:  tensor([1.0012, 1.0003, 1.0000, 0.9985, 1.0004, 0.9998, 1.0016, 1.0089, 0.9992,
        0.9977], device='cuda:0') tensor(223, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0024, device='cuda:0')
eigenvalues preserved:  512
Test train Loss:  0.25982871651649475
Test train Acc:  0.0
Test Loss:  0.26468369364738464
Test Acc:  0.0
Valid Loss:  0.232069194316864
Valid Acc:  0.0
max of grad d_p:  tensor(4.7787, device='cuda:0')
min of grad d_p:  tensor(-0.3868, device='cuda:0')
max|min: (J_L, Jta/N)  (4.778709411621094, 4.7787394523620605, ratio: 1.0000063180923462)|(-0.3867913782596588, -0.3867897093296051)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.8030e-05, device='cuda:0') mean:  tensor(-2.4766e-09, device='cuda:0') min:  tensor(-3.0041e-05, device='cuda:0') norm:  tensor(0.0003, device='cuda:0') MSE:  tensor(3.8010e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0043, device='cuda:0') mean:  tensor(2.4455e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0493, device='cuda:0') MSE:  tensor(6.2138e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0067, device='cuda:0')
min of d_p_list:  tensor(-0.0192, device='cuda:0')
Epoch:  1  
Training Loss: 0.2621028463472612
Test Loss:  0.26633477210998535
Test Acc:  0.0
Valid Loss:  0.23425701260566711
Valid Acc:  0.0
local minima detector shape:  (0,)
Preserved_eigens number check:  512
  0%|          | 1/1000 [00:14<3:57:35, 14.27s/it]Epoch:   2
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.1139, device='cuda:0') 
Std:  tensor(14.6869, device='cuda:0') 
ABS Max:  tensor(209.3008, device='cuda:0') 
ABS Min:  tensor(0.0032, device='cuda:0')
Criterion check:  tensor([0.9987, 1.0003, 0.9996, 0.9999, 1.0017, 1.0003, 0.9998, 0.9989, 0.9997,
        1.0020], device='cuda:0') tensor(241, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0014, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.5223, device='cuda:0')
min of grad d_p:  tensor(-0.4440, device='cuda:0')
max|min: (J_L, Jta/N)  (1.522270679473877, 1.522843599319458, ratio: 1.0003763437271118)|(-0.44395169615745544, -0.4439818561077118)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(-3.8510e-08, device='cuda:0') min:  tensor(-0.0006, device='cuda:0') norm:  tensor(0.0088, device='cuda:0') MSE:  tensor(1.1142e-08, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0081, device='cuda:0') mean:  tensor(5.5673e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1493, device='cuda:0') MSE:  tensor(1.8815e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0053, device='cuda:0')
min of d_p_list:  tensor(-0.0077, device='cuda:0')
Epoch:  2  
Training Loss: 0.2634811997413635
Test Loss:  0.2676789164543152
Test Acc:  0.0
Valid Loss:  0.23643338680267334
Valid Acc:  0.0
local minima detector shape:  (1,)
Preserved_eigens number check:  512
  0%|          | 2/1000 [00:28<3:54:45, 14.11s/it]Epoch:   3
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(12.7001, device='cuda:0') 
Std:  tensor(214.4993, device='cuda:0') 
ABS Max:  tensor(2556.7493, device='cuda:0') 
ABS Min:  tensor(0.0130, device='cuda:0')
Criterion check:  tensor([1.0047, 1.0036, 0.9958, 0.9991, 1.0088, 1.0000, 1.0135, 1.0015, 1.0079,
        0.9878], device='cuda:0') tensor(266, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0008, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(2.1121, device='cuda:0')
min of grad d_p:  tensor(-0.3920, device='cuda:0')
max|min: (J_L, Jta/N)  (2.1121137142181396, 2.1121110916137695, ratio: 0.9999987483024597)|(-0.3919551968574524, -0.3919401168823242)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.1815e-05, device='cuda:0') mean:  tensor(-2.2468e-09, device='cuda:0') min:  tensor(-1.5587e-05, device='cuda:0') norm:  tensor(0.0003, device='cuda:0') MSE:  tensor(3.7289e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0031, device='cuda:0') mean:  tensor(5.3626e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1158, device='cuda:0') MSE:  tensor(1.4588e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0089, device='cuda:0')
min of d_p_list:  tensor(-0.0145, device='cuda:0')
Epoch:  3  
Training Loss: 0.26192590594291687
Test Loss:  0.2652747929096222
Test Acc:  0.0
Valid Loss:  0.23564501106739044
Valid Acc:  0.0
local minima detector shape:  (2,)
Preserved_eigens number check:  512
  0%|          | 3/1000 [00:42<3:58:49, 14.37s/it]Epoch:   4
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-3.3400, device='cuda:0') 
Std:  tensor(74.2372, device='cuda:0') 
ABS Max:  tensor(789.1142, device='cuda:0') 
ABS Min:  tensor(0.0083, device='cuda:0')
Criterion check:  tensor([0.9956, 1.0023, 1.0115, 0.9993, 1.0032, 1.0011, 1.0027, 1.0014, 0.9997,
        0.9994], device='cuda:0') tensor(267, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0009, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.8143, device='cuda:0')
min of grad d_p:  tensor(-0.3090, device='cuda:0')
max|min: (J_L, Jta/N)  (0.8143042922019958, 0.8143180012702942, ratio: 1.0000168085098267)|(-0.30896806716918945, -0.3089727461338043)

 check Jacobi res:  torch.Size([793601]) max:  tensor(7.3016e-06, device='cuda:0') mean:  tensor(-1.5446e-09, device='cuda:0') min:  tensor(-1.3709e-05, device='cuda:0') norm:  tensor(0.0001, device='cuda:0') MSE:  tensor(1.4353e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0043, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.2234, device='cuda:0') MSE:  tensor(2.8156e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0015, device='cuda:0')
min of d_p_list:  tensor(-0.0025, device='cuda:0')
Epoch:  4  
Training Loss: 0.26009809970855713
Test Loss:  0.263214647769928
Test Acc:  0.0
Valid Loss:  0.23458491265773773
Valid Acc:  0.0
local minima detector shape:  (3,)
Preserved_eigens number check:  512
  0%|          | 4/1000 [00:57<4:00:17, 14.48s/it]Epoch:   5
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(1.7486, device='cuda:0') 
Std:  tensor(80.4688, device='cuda:0') 
ABS Max:  tensor(1728.2209, device='cuda:0') 
ABS Min:  tensor(0.0070, device='cuda:0')
Criterion check:  tensor([1.0016, 1.0003, 0.9933, 0.9994, 1.0000, 1.0004, 0.9797, 0.9998, 1.0047,
        0.9996], device='cuda:0') tensor(253, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0009, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.7674, device='cuda:0')
min of grad d_p:  tensor(-0.3349, device='cuda:0')
max|min: (J_L, Jta/N)  (0.7673976421356201, 0.7674019932746887, ratio: 1.0000057220458984)|(-0.33493322134017944, -0.3349466323852539)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.7613e-05, device='cuda:0') mean:  tensor(9.1444e-10, device='cuda:0') min:  tensor(-1.3232e-05, device='cuda:0') norm:  tensor(0.0002, device='cuda:0') MSE:  tensor(3.0627e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0042, device='cuda:0') mean:  tensor(3.9241e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0932, device='cuda:0') MSE:  tensor(1.1750e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0036, device='cuda:0')
min of d_p_list:  tensor(-0.0032, device='cuda:0')
Epoch:  5  
Training Loss: 0.25917989015579224
Test Loss:  0.2619324326515198
Test Acc:  0.0
Valid Loss:  0.23381608724594116
Valid Acc:  0.0
local minima detector shape:  (4,)
Preserved_eigens number check:  512
  0%|          | 5/1000 [01:12<4:01:34, 14.57s/it]Epoch:   6
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(4.6512, device='cuda:0') 
Std:  tensor(66.3277, device='cuda:0') 
ABS Max:  tensor(1106.6138, device='cuda:0') 
ABS Min:  tensor(0.0113, device='cuda:0')
Criterion check:  tensor([1.0000, 0.9963, 1.0031, 0.9985, 1.0003, 1.0023, 1.0007, 1.0002, 0.9964,
        0.9947], device='cuda:0') tensor(243, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0036, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.4087, device='cuda:0')
min of grad d_p:  tensor(-0.5822, device='cuda:0')
max|min: (J_L, Jta/N)  (1.4087215662002563, 1.408832311630249, ratio: 1.000078558921814)|(-0.5821653604507446, -0.5822587609291077)

 check Jacobi res:  torch.Size([793601]) max:  tensor(9.5844e-05, device='cuda:0') mean:  tensor(-3.0080e-09, device='cuda:0') min:  tensor(-0.0001, device='cuda:0') norm:  tensor(0.0029, device='cuda:0') MSE:  tensor(3.6972e-09, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0136, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.2180, device='cuda:0') MSE:  tensor(2.7466e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0033, device='cuda:0')
min of d_p_list:  tensor(-0.0016, device='cuda:0')
Epoch:  6  
Training Loss: 0.25793391466140747
Test Loss:  0.26023411750793457
Test Acc:  0.0
Valid Loss:  0.2322586178779602
Valid Acc:  0.0
std:  0.0019701235890120508 
thres:  0.00026052380204200743
Preserved_eigens number check:  512
  1%|          | 6/1000 [01:27<4:02:38, 14.65s/it]Epoch:   7
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-157.0584, device='cuda:0') 
Std:  tensor(4831.9634, device='cuda:0') 
ABS Max:  tensor(95216.8750, device='cuda:0') 
ABS Min:  tensor(0.6533, device='cuda:0')
Criterion check:  tensor([1.0341, 0.6991, 0.6533, 1.3287, 0.8292, 0.9775, 0.8973, 1.1342, 1.4005,
        0.8854], device='cuda:0') tensor(265, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0053, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.0500, device='cuda:0')
min of grad d_p:  tensor(-0.4072, device='cuda:0')
max|min: (J_L, Jta/N)  (1.049957275390625, 1.0499391555786133, ratio: 0.9999827146530151)|(-0.4072178304195404, -0.40729233622550964)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(6.8316e-08, device='cuda:0') min:  tensor(-0.0008, device='cuda:0') norm:  tensor(0.0200, device='cuda:0') MSE:  tensor(2.5192e-08, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.4073, device='cuda:0') mean:  tensor(0.0046, device='cuda:0') min:  tensor(4.5925e-13, device='cuda:0') norm:  tensor(7.6723, device='cuda:0') MSE:  tensor(9.6677e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0061, device='cuda:0')
min of d_p_list:  tensor(-0.0032, device='cuda:0')
Epoch:  7  
Training Loss: 0.25636959075927734
Test Loss:  0.259007066488266
Test Acc:  0.0
Valid Loss:  0.22940072417259216
Valid Acc:  0.0
std:  0.0018869662713729839 
thres:  0.00025910148024559023
Preserved_eigens number check:  512
  1%|          | 7/1000 [01:41<4:02:56, 14.68s/it]Epoch:   8
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.4957, device='cuda:0') 
Std:  tensor(21.2683, device='cuda:0') 
ABS Max:  tensor(332.0777, device='cuda:0') 
ABS Min:  tensor(0.0027, device='cuda:0')
Criterion check:  tensor([1.0065, 0.9895, 0.9980, 0.9989, 1.0001, 0.9988, 1.0175, 1.0043, 1.0003,
        0.9916], device='cuda:0') tensor(203, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0070, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.8273, device='cuda:0')
min of grad d_p:  tensor(-0.3223, device='cuda:0')
max|min: (J_L, Jta/N)  (1.8272647857666016, 1.8272690773010254, ratio: 1.000002384185791)|(-0.32226037979125977, -0.32223793864250183)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.8179e-05, device='cuda:0') mean:  tensor(-5.5922e-09, device='cuda:0') min:  tensor(-2.4140e-05, device='cuda:0') norm:  tensor(0.0004, device='cuda:0') MSE:  tensor(4.8672e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0195, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.3726, device='cuda:0') MSE:  tensor(4.6952e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0029, device='cuda:0')
min of d_p_list:  tensor(-0.0072, device='cuda:0')
Epoch:  8  
Training Loss: 0.2478947788476944
Test Loss:  0.24928808212280273
Test Acc:  0.0
Valid Loss:  0.219361811876297
Valid Acc:  0.0
std:  0.004382726976117035 
thres:  0.0002562952548265457
Preserved_eigens number check:  512
  1%|          | 8/1000 [01:56<4:02:37, 14.68s/it]Epoch:   9
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(0.4373, device='cuda:0') 
Std:  tensor(43.0756, device='cuda:0') 
ABS Max:  tensor(795.3467, device='cuda:0') 
ABS Min:  tensor(0.0019, device='cuda:0')
Criterion check:  tensor([0.9993, 1.0019, 1.0015, 1.0023, 0.7921, 1.0004, 0.9977, 0.9997, 0.9976,
        1.0011], device='cuda:0') tensor(215, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0021, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.9104, device='cuda:0')
min of grad d_p:  tensor(-0.4230, device='cuda:0')
max|min: (J_L, Jta/N)  (1.9103543758392334, 1.9103559255599976, ratio: 1.0000008344650269)|(-0.42300552129745483, -0.42300787568092346)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.8655e-06, device='cuda:0') mean:  tensor(-1.6960e-09, device='cuda:0') min:  tensor(-9.8348e-06, device='cuda:0') norm:  tensor(0.0001, device='cuda:0') MSE:  tensor(1.5821e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0038, device='cuda:0') mean:  tensor(4.6699e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0892, device='cuda:0') MSE:  tensor(1.1242e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0261, device='cuda:0')
min of d_p_list:  tensor(-0.0325, device='cuda:0')
Epoch:  9  
Training Loss: 0.2527755796909332
Test Loss:  0.2535669505596161
Test Acc:  0.0
Valid Loss:  0.221565842628479
Valid Acc:  0.0
std:  0.004080296624458268 
thres:  0.00025483075082302094
Preserved_eigens number check:  512
  1%|          | 9/1000 [02:11<4:02:49, 14.70s/it]Epoch:   10
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(-16.5347, device='cuda:0') 
Std:  tensor(247.3636, device='cuda:0') 
ABS Max:  tensor(5236.3931, device='cuda:0') 
ABS Min:  tensor(0.0020, device='cuda:0')
Criterion check:  tensor([0.9989, 1.0008, 1.0000, 1.0030, 1.0014, 0.9989, 1.0013, 0.9971, 1.0042,
        0.9979], device='cuda:0') tensor(263, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.5171, device='cuda:0')
min of grad d_p:  tensor(-0.4200, device='cuda:0')
max|min: (J_L, Jta/N)  (0.5170605182647705, 0.5170589685440063, ratio: 0.9999970197677612)|(-0.42003965377807617, -0.42004287242889404)

 check Jacobi res:  torch.Size([793601]) max:  tensor(9.2685e-06, device='cuda:0') mean:  tensor(4.9045e-09, device='cuda:0') min:  tensor(-5.6475e-06, device='cuda:0') norm:  tensor(0.0001, device='cuda:0') MSE:  tensor(1.5397e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0007, device='cuda:0') mean:  tensor(3.0964e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0503, device='cuda:0') MSE:  tensor(6.3381e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0200, device='cuda:0')
min of d_p_list:  tensor(-0.0119, device='cuda:0')
Epoch:  10  
Training Loss: 0.24795179069042206
Test Loss:  0.2485085129737854
Test Acc:  0.0
Valid Loss:  0.21342569589614868
Valid Acc:  0.0
std:  0.004157767159594312 
thres:  0.0002525851309299469
Preserved_eigens number check:  512
  1%|          | 10/1000 [02:25<4:02:29, 14.70s/it]Epoch:   11
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(7.2186, device='cuda:0') 
Std:  tensor(118.2265, device='cuda:0') 
ABS Max:  tensor(1768.3898, device='cuda:0') 
ABS Min:  tensor(0.0186, device='cuda:0')
Criterion check:  tensor([0.9864, 1.0018, 0.9979, 1.0000, 1.0016, 0.9990, 0.9964, 1.0131, 1.0050,
        0.9780], device='cuda:0') tensor(285, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0016, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3458, device='cuda:0')
min of grad d_p:  tensor(-0.3150, device='cuda:0')
max|min: (J_L, Jta/N)  (0.3458327651023865, 0.34583115577697754, ratio: 0.9999953508377075)|(-0.315008282661438, -0.315009742975235)

 check Jacobi res:  torch.Size([793601]) max:  tensor(7.0669e-06, device='cuda:0') mean:  tensor(9.9647e-10, device='cuda:0') min:  tensor(-6.8545e-06, device='cuda:0') norm:  tensor(0.0001, device='cuda:0') MSE:  tensor(1.5887e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0052, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.2170, device='cuda:0') MSE:  tensor(2.7341e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0032, device='cuda:0')
min of d_p_list:  tensor(-0.0051, device='cuda:0')
Epoch:  11  
Training Loss: 0.2470579594373703
Test Loss:  0.24573394656181335
Test Acc:  0.0
Valid Loss:  0.21388700604438782
Valid Acc:  0.0
std:  0.003597721380606527 
thres:  0.0002504099398851395
Preserved_eigens number check:  512
  1%|          | 11/1000 [02:40<4:02:22, 14.70s/it]Epoch:   12
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(0.8010, device='cuda:0') 
Std:  tensor(127.7665, device='cuda:0') 
ABS Max:  tensor(2195.4888, device='cuda:0') 
ABS Min:  tensor(0.0196, device='cuda:0')
Criterion check:  tensor([0.9596, 0.9966, 0.9777, 1.0015, 0.9988, 0.9997, 1.0029, 1.0612, 1.0274,
        1.0093], device='cuda:0') tensor(272, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(4.1369e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3269, device='cuda:0')
min of grad d_p:  tensor(-0.3055, device='cuda:0')
max|min: (J_L, Jta/N)  (0.3269420564174652, 0.32694143056869507, ratio: 0.9999980926513672)|(-0.3055446743965149, -0.3055449426174164)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.5879e-06, device='cuda:0') mean:  tensor(1.4435e-09, device='cuda:0') min:  tensor(-3.1088e-06, device='cuda:0') norm:  tensor(0.0001, device='cuda:0') MSE:  tensor(1.3375e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0044, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.2042, device='cuda:0') MSE:  tensor(2.5736e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0127, device='cuda:0')
min of d_p_list:  tensor(-0.0222, device='cuda:0')
Epoch:  12  
Training Loss: 0.23017741739749908
Test Loss:  0.22907936573028564
Test Acc:  0.0
Valid Loss:  0.2010265737771988
Valid Acc:  0.0
std:  0.007763369555173046 
thres:  0.0002451715052127838
Preserved_eigens number check:  512
  1%|          | 12/1000 [02:55<4:02:43, 14.74s/it]Epoch:   13
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(7.0050, device='cuda:0') 
Std:  tensor(229.5240, device='cuda:0') 
ABS Max:  tensor(4996.4316, device='cuda:0') 
ABS Min:  tensor(0.0042, device='cuda:0')
Criterion check:  tensor([0.9997, 1.0009, 0.9991, 0.9952, 0.9999, 0.9995, 1.0000, 0.9988, 1.0012,
        1.0037], device='cuda:0') tensor(250, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0012, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.4375, device='cuda:0')
min of grad d_p:  tensor(-0.4056, device='cuda:0')
max|min: (J_L, Jta/N)  (0.43754327297210693, 0.4375455975532532, ratio: 1.0000053644180298)|(-0.40562641620635986, -0.405626118183136)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(-6.9132e-08, device='cuda:0') min:  tensor(-0.0004, device='cuda:0') norm:  tensor(0.0065, device='cuda:0') MSE:  tensor(8.1528e-09, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(1.9037e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0311, device='cuda:0') MSE:  tensor(3.9156e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0023, device='cuda:0')
min of d_p_list:  tensor(-0.0047, device='cuda:0')
Epoch:  13  
Training Loss: 0.2227199375629425
Test Loss:  0.22066329419612885
Test Acc:  0.0
Valid Loss:  0.1953904777765274
Valid Acc:  0.0
std:  0.011586644709779019 
thres:  0.00024013653695583343
Preserved_eigens number check:  512
  1%|▏         | 13/1000 [03:10<4:02:53, 14.77s/it]Epoch:   14
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(16.5935, device='cuda:0') 
Std:  tensor(356.9200, device='cuda:0') 
ABS Max:  tensor(8070.5923, device='cuda:0') 
ABS Min:  tensor(0.0039, device='cuda:0')
Criterion check:  tensor([0.9996, 0.9998, 0.9941, 1.0020, 1.0003, 1.0000, 1.0004, 1.0032, 1.0002,
        0.9998], device='cuda:0') tensor(242, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0010, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3754, device='cuda:0')
min of grad d_p:  tensor(-0.4365, device='cuda:0')
max|min: (J_L, Jta/N)  (0.3754346966743469, 0.3754342198371887, ratio: 0.9999987483024597)|(-0.4364648163318634, -0.4364648163318634)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.3711e-06, device='cuda:0') mean:  tensor(-5.4152e-10, device='cuda:0') min:  tensor(-3.8445e-06, device='cuda:0') norm:  tensor(4.6888e-05, device='cuda:0') MSE:  tensor(5.9082e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(1.3609e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0255, device='cuda:0') MSE:  tensor(3.2186e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0079, device='cuda:0')
min of d_p_list:  tensor(-0.0115, device='cuda:0')
Epoch:  14  
Training Loss: 0.23109568655490875
Test Loss:  0.23156040906906128
Test Acc:  0.0
Valid Loss:  0.20387552678585052
Valid Acc:  0.0
std:  0.009992394103392676 
thres:  0.00023580055832862854
Preserved_eigens number check:  512
  1%|▏         | 14/1000 [03:25<4:02:08, 14.73s/it]Epoch:   15
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-14.1150, device='cuda:0') 
Std:  tensor(404.8748, device='cuda:0') 
ABS Max:  tensor(8935.4805, device='cuda:0') 
ABS Min:  tensor(0.0140, device='cuda:0')
Criterion check:  tensor([0.9989, 0.9970, 1.0007, 0.9606, 1.0025, 1.0027, 0.9982, 1.0173, 0.9830,
        1.0033], device='cuda:0') tensor(283, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0011, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.7764, device='cuda:0')
min of grad d_p:  tensor(-0.3244, device='cuda:0')
max|min: (J_L, Jta/N)  (0.7764168381690979, 0.7764150500297546, ratio: 0.9999976754188538)|(-0.32443779706954956, -0.32443755865097046)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.3246e-06, device='cuda:0') mean:  tensor(8.7668e-10, device='cuda:0') min:  tensor(-2.9951e-06, device='cuda:0') norm:  tensor(4.6581e-05, device='cuda:0') MSE:  tensor(5.8695e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0023, device='cuda:0') mean:  tensor(9.0033e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1525, device='cuda:0') MSE:  tensor(1.9220e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0069, device='cuda:0')
min of d_p_list:  tensor(-0.0052, device='cuda:0')
Epoch:  15  
Training Loss: 0.21183127164840698
Test Loss:  0.21276459097862244
Test Acc:  0.0
Valid Loss:  0.1870025396347046
Valid Acc:  0.0
std:  0.011534084935208492 
thres:  0.00022857645452022552
Preserved_eigens number check:  512
  2%|▏         | 15/1000 [03:39<4:01:48, 14.73s/it]Epoch:   16
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.2823, device='cuda:0') 
Std:  tensor(11.8166, device='cuda:0') 
ABS Max:  tensor(145.9973, device='cuda:0') 
ABS Min:  tensor(0.0010, device='cuda:0')
Criterion check:  tensor([0.9993, 0.9806, 0.9983, 0.9991, 0.9992, 1.0006, 1.0000, 1.0006, 0.9995,
        0.9920], device='cuda:0') tensor(236, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0005, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.4394, device='cuda:0')
min of grad d_p:  tensor(-0.3805, device='cuda:0')
max|min: (J_L, Jta/N)  (0.43939512968063354, 0.4393943250179291, ratio: 0.999998152256012)|(-0.38047248125076294, -0.3804721236228943)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.7551e-06, device='cuda:0') mean:  tensor(6.3068e-10, device='cuda:0') min:  tensor(-1.3262e-06, device='cuda:0') norm:  tensor(4.8453e-05, device='cuda:0') MSE:  tensor(6.1055e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0018, device='cuda:0') mean:  tensor(6.4393e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1037, device='cuda:0') MSE:  tensor(1.3073e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0055, device='cuda:0')
min of d_p_list:  tensor(-0.0060, device='cuda:0')
Epoch:  16  
Training Loss: 0.1845133900642395
Test Loss:  0.1865370273590088
Test Acc:  0.0
Valid Loss:  0.16067437827587128
Valid Acc:  0.0
std:  0.01722090921002068 
thres:  0.00021606754064559935
Preserved_eigens number check:  512
  2%|▏         | 16/1000 [03:54<4:01:43, 14.74s/it]Epoch:   17
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(4.4333, device='cuda:0') 
Std:  tensor(142.3355, device='cuda:0') 
ABS Max:  tensor(3126.2075, device='cuda:0') 
ABS Min:  tensor(0.0004, device='cuda:0')
Criterion check:  tensor([0.9984, 1.0059, 1.0018, 1.0003, 1.0013, 1.0004, 0.9976, 0.9974, 1.0018,
        0.9974], device='cuda:0') tensor(262, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(5.4451e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.8108, device='cuda:0')
min of grad d_p:  tensor(-0.3570, device='cuda:0')
max|min: (J_L, Jta/N)  (0.8108341097831726, 0.8108363151550293, ratio: 1.0000027418136597)|(-0.3569675087928772, -0.3569681942462921)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.6838e-06, device='cuda:0') mean:  tensor(-2.4814e-10, device='cuda:0') min:  tensor(-2.5779e-06, device='cuda:0') norm:  tensor(3.8476e-05, device='cuda:0') MSE:  tensor(4.8483e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0014, device='cuda:0') mean:  tensor(5.6426e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0934, device='cuda:0') MSE:  tensor(1.1767e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0083, device='cuda:0')
min of d_p_list:  tensor(-0.0082, device='cuda:0')
Epoch:  17  
Training Loss: 0.14958256483078003
Test Loss:  0.1533813774585724
Test Acc:  0.0
Valid Loss:  0.12938760221004486
Valid Acc:  0.0
std:  0.02968115868759827 
thres:  0.00019994857013225556
Preserved_eigens number check:  512
  2%|▏         | 17/1000 [04:09<4:01:20, 14.73s/it]Epoch:   18
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.0308, device='cuda:0') 
Std:  tensor(48.0739, device='cuda:0') 
ABS Max:  tensor(729.7614, device='cuda:0') 
ABS Min:  tensor(0.0047, device='cuda:0')
Criterion check:  tensor([1.0007, 1.0039, 0.9915, 0.9999, 1.0030, 0.9898, 1.0002, 0.9987, 0.9969,
        1.0029], device='cuda:0') tensor(244, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0006, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.5560, device='cuda:0')
min of grad d_p:  tensor(-0.3690, device='cuda:0')
max|min: (J_L, Jta/N)  (0.5559910535812378, 0.5559912919998169, ratio: 1.0000004768371582)|(-0.3690128028392792, -0.36901265382766724)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.2907e-06, device='cuda:0') mean:  tensor(-2.2810e-11, device='cuda:0') min:  tensor(-1.1325e-06, device='cuda:0') norm:  tensor(2.8911e-05, device='cuda:0') MSE:  tensor(3.6430e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(7.6608e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0119, device='cuda:0') MSE:  tensor(1.5047e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0026, device='cuda:0')
min of d_p_list:  tensor(-0.0027, device='cuda:0')
Epoch:  18  
Training Loss: 0.14440983533859253
Test Loss:  0.1472986787557602
Test Acc:  0.0
Valid Loss:  0.12485574185848236
Valid Acc:  0.0
std:  0.0338950656318344 
thres:  0.00018428654968738557
Preserved_eigens number check:  512
  2%|▏         | 18/1000 [04:23<4:01:05, 14.73s/it]Epoch:   19
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-1.6111, device='cuda:0') 
Std:  tensor(49.7311, device='cuda:0') 
ABS Max:  tensor(843.3539, device='cuda:0') 
ABS Min:  tensor(0.0030, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0414, 0.9794, 0.9998, 1.0073, 0.9996, 1.0008, 0.9980, 0.9865,
        0.9943], device='cuda:0') tensor(270, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0010, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.4970, device='cuda:0')
min of grad d_p:  tensor(-0.3735, device='cuda:0')
max|min: (J_L, Jta/N)  (0.49704939126968384, 0.4970591962337494, ratio: 1.0000196695327759)|(-0.37354135513305664, -0.37354207038879395)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.9605e-06, device='cuda:0') mean:  tensor(2.8891e-09, device='cuda:0') min:  tensor(-1.4011e-05, device='cuda:0') norm:  tensor(9.6984e-05, device='cuda:0') MSE:  tensor(1.2221e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0035, device='cuda:0') mean:  tensor(4.5443e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0780, device='cuda:0') MSE:  tensor(9.8308e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0073, device='cuda:0')
min of d_p_list:  tensor(-0.0041, device='cuda:0')
Epoch:  19  
Training Loss: 0.13969092071056366
Test Loss:  0.142893448472023
Test Acc:  0.0
Valid Loss:  0.12085827440023422
Valid Acc:  0.0
std:  0.027824758603358035 
thres:  0.00016600559651851654
Preserved_eigens number check:  512
  2%|▏         | 19/1000 [04:38<4:00:53, 14.73s/it]Epoch:   20
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(0.6870, device='cuda:0') 
Std:  tensor(20.1207, device='cuda:0') 
ABS Max:  tensor(315.1940, device='cuda:0') 
ABS Min:  tensor(0.0006, device='cuda:0')
Criterion check:  tensor([1.0001, 0.9999, 0.9994, 1.0001, 0.9991, 0.9990, 0.9998, 1.0009, 1.0009,
        1.0006], device='cuda:0') tensor(237, device='cuda:0')
max of Lambda2 tensor(986346.3750, device='cuda:0')
min of Lambda2 tensor(0.0013, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3998, device='cuda:0')
min of grad d_p:  tensor(-0.3559, device='cuda:0')
max|min: (J_L, Jta/N)  (0.39984050393104553, 0.3998470902442932, ratio: 1.000016450881958)|(-0.3559216856956482, -0.35592207312583923)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.3411e-06, device='cuda:0') mean:  tensor(7.2987e-10, device='cuda:0') min:  tensor(-8.3670e-06, device='cuda:0') norm:  tensor(3.4988e-05, device='cuda:0') MSE:  tensor(4.4087e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(1.1338e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0176, device='cuda:0') MSE:  tensor(2.2234e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0029, device='cuda:0')
min of d_p_list:  tensor(-0.0035, device='cuda:0')
Epoch:  20  
Training Loss: 0.11902666091918945
Test Loss:  0.12106913328170776
Test Acc:  0.0
Valid Loss:  0.10402296483516693
Valid Acc:  0.0
std:  0.02123946652386014 
thres:  0.00014744467437267304
Preserved_eigens number check:  512
  2%|▏         | 20/1000 [04:53<4:00:41, 14.74s/it]Epoch:   21
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-6.3532, device='cuda:0') 
Std:  tensor(100.5409, device='cuda:0') 
ABS Max:  tensor(1923.2025, device='cuda:0') 
ABS Min:  tensor(0.0014, device='cuda:0')
Criterion check:  tensor([0.9996, 1.0011, 1.0002, 1.0008, 1.0033, 0.9962, 0.9988, 0.9925, 1.0041,
        0.9980], device='cuda:0') tensor(256, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0004, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3953, device='cuda:0')
min of grad d_p:  tensor(-0.3459, device='cuda:0')
max|min: (J_L, Jta/N)  (0.39530980587005615, 0.39531075954437256, ratio: 1.000002384185791)|(-0.34587469696998596, -0.3458741009235382)

 check Jacobi res:  torch.Size([793601]) max:  tensor(9.8348e-07, device='cuda:0') mean:  tensor(-7.4090e-10, device='cuda:0') min:  tensor(-3.6955e-06, device='cuda:0') norm:  tensor(5.2362e-05, device='cuda:0') MSE:  tensor(6.5980e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(1.7021e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0270, device='cuda:0') MSE:  tensor(3.4058e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0263, device='cuda:0')
min of d_p_list:  tensor(-0.0106, device='cuda:0')
Epoch:  21  
Training Loss: 0.10277824103832245
Test Loss:  0.10134699940681458
Test Acc:  0.0
Valid Loss:  0.095418781042099
Valid Acc:  0.0
std:  0.01755248334352096 
thres:  0.00013109764456748963
Preserved_eigens number check:  512
  2%|▏         | 21/1000 [05:08<4:00:33, 14.74s/it]Epoch:   22
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-1.3902, device='cuda:0') 
Std:  tensor(180.9029, device='cuda:0') 
ABS Max:  tensor(2517.0059, device='cuda:0') 
ABS Min:  tensor(0.0070, device='cuda:0')
Criterion check:  tensor([0.9855, 1.0016, 1.0007, 0.9974, 0.9988, 1.0014, 0.9996, 0.9838, 1.0922,
        0.9837], device='cuda:0') tensor(251, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0007, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3225, device='cuda:0')
min of grad d_p:  tensor(-0.2608, device='cuda:0')
max|min: (J_L, Jta/N)  (0.3225380778312683, 0.32249048352241516, ratio: 0.9998524188995361)|(-0.2608199715614319, -0.2608139216899872)

 check Jacobi res:  torch.Size([793601]) max:  tensor(7.0669e-05, device='cuda:0') mean:  tensor(4.1290e-09, device='cuda:0') min:  tensor(-6.6116e-05, device='cuda:0') norm:  tensor(0.0035, device='cuda:0') MSE:  tensor(4.3745e-09, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0066, device='cuda:0') mean:  tensor(6.2017e-05, device='cuda:0') min:  tensor(4.6332e-13, device='cuda:0') norm:  tensor(0.1538, device='cuda:0') MSE:  tensor(1.9381e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0015, device='cuda:0')
min of d_p_list:  tensor(-0.0016, device='cuda:0')
Epoch:  22  
Training Loss: 0.10421469807624817
Test Loss:  0.10276429355144501
Test Acc:  0.0
Valid Loss:  0.09535370022058487
Valid Acc:  0.0
std:  0.017376997587398454 
thres:  0.00012202407121658324
Preserved_eigens number check:  512
  2%|▏         | 22/1000 [05:22<4:00:20, 14.75s/it]Epoch:   23
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(42.7000, device='cuda:0') 
Std:  tensor(803.8717, device='cuda:0') 
ABS Max:  tensor(17561.0508, device='cuda:0') 
ABS Min:  tensor(0.0019, device='cuda:0')
Criterion check:  tensor([1.0212, 0.9968, 1.0067, 1.0009, 1.0013, 0.9985, 1.0586, 1.0025, 0.9628,
        1.0139], device='cuda:0') tensor(278, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0005, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2987, device='cuda:0')
min of grad d_p:  tensor(-0.2484, device='cuda:0')
max|min: (J_L, Jta/N)  (0.2986878752708435, 0.29868754744529724, ratio: 0.999998927116394)|(-0.24839869141578674, -0.24839872121810913)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.3709e-06, device='cuda:0') mean:  tensor(-1.3155e-10, device='cuda:0') min:  tensor(-1.2421e-05, device='cuda:0') norm:  tensor(5.0587e-05, device='cuda:0') MSE:  tensor(6.3743e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0009, device='cuda:0') mean:  tensor(3.7971e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0627, device='cuda:0') MSE:  tensor(7.9056e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0015, device='cuda:0')
min of d_p_list:  tensor(-0.0012, device='cuda:0')
Epoch:  23  
Training Loss: 0.10235519707202911
Test Loss:  0.10258427262306213
Test Acc:  0.0
Valid Loss:  0.09331095218658447
Valid Acc:  0.0
std:  0.014434845898755077 
thres:  0.00011361314356327058
Preserved_eigens number check:  512
  2%|▏         | 23/1000 [05:37<3:59:52, 14.73s/it]Epoch:   24
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(6.1967, device='cuda:0') 
Std:  tensor(196.0518, device='cuda:0') 
ABS Max:  tensor(2984.4978, device='cuda:0') 
ABS Min:  tensor(0.0021, device='cuda:0')
Criterion check:  tensor([1.0012, 1.0002, 0.9905, 0.9983, 1.0027, 0.9973, 0.9978, 1.0322, 1.0131,
        1.0028], device='cuda:0') tensor(277, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0008, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2700, device='cuda:0')
min of grad d_p:  tensor(-0.2159, device='cuda:0')
max|min: (J_L, Jta/N)  (0.2699905335903168, 0.26998990774154663, ratio: 0.9999976754188538)|(-0.21590393781661987, -0.21590274572372437)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.5572e-06, device='cuda:0') mean:  tensor(-7.4107e-10, device='cuda:0') min:  tensor(-1.9521e-06, device='cuda:0') norm:  tensor(5.3501e-05, device='cuda:0') MSE:  tensor(6.7416e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0016, device='cuda:0') mean:  tensor(2.3969e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0477, device='cuda:0') MSE:  tensor(6.0057e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0056, device='cuda:0')
min of d_p_list:  tensor(-0.0069, device='cuda:0')
Epoch:  24  
Training Loss: 0.09218445420265198
Test Loss:  0.0928940623998642
Test Acc:  0.0
Valid Loss:  0.08361978828907013
Valid Acc:  0.0
std:  0.00859754936433134 
thres:  0.00010411185026168824
Preserved_eigens number check:  512
  2%|▏         | 24/1000 [05:52<3:59:46, 14.74s/it]Epoch:   25
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-1.4566, device='cuda:0') 
Std:  tensor(67.8678, device='cuda:0') 
ABS Max:  tensor(864.7234, device='cuda:0') 
ABS Min:  tensor(0.0191, device='cuda:0')
Criterion check:  tensor([0.9995, 1.0000, 0.9984, 1.0223, 1.0007, 0.9987, 0.9986, 1.0042, 0.9915,
        0.9935], device='cuda:0') tensor(253, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0023, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2919, device='cuda:0')
min of grad d_p:  tensor(-0.2415, device='cuda:0')
max|min: (J_L, Jta/N)  (0.29187577962875366, 0.29187554121017456, ratio: 0.9999991655349731)|(-0.24148786067962646, -0.24148736894130707)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.8030e-06, device='cuda:0') mean:  tensor(-9.1725e-10, device='cuda:0') min:  tensor(-3.3230e-06, device='cuda:0') norm:  tensor(5.2873e-05, device='cuda:0') MSE:  tensor(6.6624e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0007, device='cuda:0') mean:  tensor(3.1613e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0483, device='cuda:0') MSE:  tensor(6.0908e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0039, device='cuda:0')
min of d_p_list:  tensor(-0.0030, device='cuda:0')
Epoch:  25  
Training Loss: 0.08858538419008255
Test Loss:  0.09045279026031494
Test Acc:  0.0
Valid Loss:  0.07959459722042084
Valid Acc:  0.0
std:  0.006369844288592438 
thres:  9.802359491586685e-05
Preserved_eigens number check:  512
  2%|▎         | 25/1000 [06:07<3:59:27, 14.74s/it]Epoch:   26
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(44.5264, device='cuda:0') 
Std:  tensor(1130.1442, device='cuda:0') 
ABS Max:  tensor(25099.3906, device='cuda:0') 
ABS Min:  tensor(0.0050, device='cuda:0')
Criterion check:  tensor([1.0011, 0.9984, 1.0003, 1.0100, 0.9998, 1.0010, 0.9991, 1.0001, 1.0020,
        0.9978], device='cuda:0') tensor(247, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0002, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2681, device='cuda:0')
min of grad d_p:  tensor(-0.2240, device='cuda:0')
max|min: (J_L, Jta/N)  (0.2680578827857971, 0.26805806159973145, ratio: 1.0000007152557373)|(-0.22404658794403076, -0.22404702007770538)

 check Jacobi res:  torch.Size([793601]) max:  tensor(6.0163e-06, device='cuda:0') mean:  tensor(-7.5466e-11, device='cuda:0') min:  tensor(-6.3544e-06, device='cuda:0') norm:  tensor(6.5858e-05, device='cuda:0') MSE:  tensor(8.2986e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0006, device='cuda:0') mean:  tensor(1.7760e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0295, device='cuda:0') MSE:  tensor(3.7179e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0156, device='cuda:0')
min of d_p_list:  tensor(-0.0114, device='cuda:0')
Epoch:  26  
Training Loss: 0.09016098082065582
Test Loss:  0.097527876496315
Test Acc:  0.0
Valid Loss:  0.08197121322154999
Valid Acc:  0.0
std:  0.006484590517294596 
thres:  9.550014287233353e-05
Preserved_eigens number check:  512
  3%|▎         | 26/1000 [06:21<3:59:09, 14.73s/it]Epoch:   27
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(5.7782, device='cuda:0') 
Std:  tensor(78.6716, device='cuda:0') 
ABS Max:  tensor(1355.2072, device='cuda:0') 
ABS Min:  tensor(0.0008, device='cuda:0')
Criterion check:  tensor([1.0007, 0.9941, 0.9998, 0.9984, 1.0048, 1.0010, 1.0010, 1.0094, 1.0018,
        1.0030], device='cuda:0') tensor(220, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0005, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.5417, device='cuda:0')
min of grad d_p:  tensor(-0.6897, device='cuda:0')
max|min: (J_L, Jta/N)  (0.5416597127914429, 0.5416855812072754, ratio: 1.0000478029251099)|(-0.6896842122077942, -0.689721405506134)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.8743e-05, device='cuda:0') mean:  tensor(-1.0621e-08, device='cuda:0') min:  tensor(-8.2180e-05, device='cuda:0') norm:  tensor(0.0023, device='cuda:0') MSE:  tensor(2.8503e-09, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(2.3311e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0388, device='cuda:0') MSE:  tensor(4.8906e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0016, device='cuda:0')
min of d_p_list:  tensor(-0.0010, device='cuda:0')
Epoch:  27  
Training Loss: 0.08369018137454987
Test Loss:  0.08978922665119171
Test Acc:  0.0
Valid Loss:  0.07709260284900665
Valid Acc:  0.0
std:  0.006156787017500821 
thres:  9.139523953199386e-05
Preserved_eigens number check:  512
  3%|▎         | 27/1000 [06:36<3:58:47, 14.72s/it]Epoch:   28
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-448.4481, device='cuda:0') 
Std:  tensor(10170.7695, device='cuda:0') 
ABS Max:  tensor(230131.9062, device='cuda:0') 
ABS Min:  tensor(0.0021, device='cuda:0')
Criterion check:  tensor([1.0017, 0.9931, 1.0101, 1.0011, 0.9951, 0.9944, 1.0018, 0.9639, 0.9953,
        0.5358], device='cuda:0') tensor(248, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0003, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.4769, device='cuda:0')
min of grad d_p:  tensor(-0.6115, device='cuda:0')
max|min: (J_L, Jta/N)  (0.4769378900527954, 0.4769313633441925, ratio: 0.9999862909317017)|(-0.6115453243255615, -0.6115428805351257)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.1062e-06, device='cuda:0') mean:  tensor(1.4250e-09, device='cuda:0') min:  tensor(-2.8610e-06, device='cuda:0') norm:  tensor(0.0001, device='cuda:0') MSE:  tensor(1.4441e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0086, device='cuda:0') mean:  tensor(6.6422e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1903, device='cuda:0') MSE:  tensor(2.3984e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0013, device='cuda:0')
min of d_p_list:  tensor(-0.0015, device='cuda:0')
Epoch:  28  
Training Loss: 0.07731212675571442
Test Loss:  0.0827399268746376
Test Acc:  0.0
Valid Loss:  0.07103634625673294
Valid Acc:  0.0
std:  0.005335024909234947 
thres:  8.638662546873092e-05
Preserved_eigens number check:  512
  3%|▎         | 28/1000 [06:51<3:58:34, 14.73s/it]Epoch:   29
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.4378, device='cuda:0') 
Std:  tensor(60.9986, device='cuda:0') 
ABS Max:  tensor(561.3590, device='cuda:0') 
ABS Min:  tensor(0.0009, device='cuda:0')
Criterion check:  tensor([0.9971, 0.9937, 1.0053, 0.9971, 0.9963, 0.9980, 0.9965, 0.7768, 1.0098,
        0.9290], device='cuda:0') tensor(255, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0001, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.4397, device='cuda:0')
min of grad d_p:  tensor(-0.5536, device='cuda:0')
max|min: (J_L, Jta/N)  (0.43968284130096436, 0.4396647810935974, ratio: 0.9999589323997498)|(-0.5536343455314636, -0.5536025762557983)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.6776e-05, device='cuda:0') mean:  tensor(-3.3067e-08, device='cuda:0') min:  tensor(-6.6914e-05, device='cuda:0') norm:  tensor(0.0020, device='cuda:0') MSE:  tensor(2.5561e-09, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0017, device='cuda:0') mean:  tensor(6.7020e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1144, device='cuda:0') MSE:  tensor(1.4419e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0026, device='cuda:0')
min of d_p_list:  tensor(-0.0038, device='cuda:0')
Epoch:  29  
Training Loss: 0.07752653956413269
Test Loss:  0.08446577936410904
Test Acc:  0.0
Valid Loss:  0.06921279430389404
Valid Acc:  0.0
std:  0.005370807496266141 
thres:  8.345504254102706e-05
Preserved_eigens number check:  512
  3%|▎         | 29/1000 [07:05<3:58:12, 14.72s/it]Epoch:   30
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-2.1159, device='cuda:0') 
Std:  tensor(25.1883, device='cuda:0') 
ABS Max:  tensor(455.1800, device='cuda:0') 
ABS Min:  tensor(0.0100, device='cuda:0')
Criterion check:  tensor([0.9992, 0.9985, 1.0001, 1.0002, 1.0019, 0.9990, 1.0103, 1.1379, 1.0025,
        0.9977], device='cuda:0') tensor(225, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0001, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.5085, device='cuda:0')
min of grad d_p:  tensor(-0.6331, device='cuda:0')
max|min: (J_L, Jta/N)  (0.5084530711174011, 0.5084442496299744, ratio: 0.9999826550483704)|(-0.6330547332763672, -0.6330528259277344)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.0133e-05, device='cuda:0') mean:  tensor(1.6914e-09, device='cuda:0') min:  tensor(-3.0538e-06, device='cuda:0') norm:  tensor(0.0001, device='cuda:0') MSE:  tensor(1.7663e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0023, device='cuda:0') mean:  tensor(3.5773e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0715, device='cuda:0') MSE:  tensor(9.0131e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0018, device='cuda:0')
min of d_p_list:  tensor(-0.0018, device='cuda:0')
Epoch:  30  
Training Loss: 0.06603411585092545
Test Loss:  0.07159788906574249
Test Acc:  0.0
Valid Loss:  0.061361055821180344
Valid Acc:  0.0
std:  0.0079960516053196 
thres:  7.894478887319564e-05
Preserved_eigens number check:  512
  3%|▎         | 30/1000 [07:20<3:57:44, 14.71s/it]Epoch:   31
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(-18.8327, device='cuda:0') 
Std:  tensor(401.9451, device='cuda:0') 
ABS Max:  tensor(8135.7212, device='cuda:0') 
ABS Min:  tensor(0.0070, device='cuda:0')
Criterion check:  tensor([0.9968, 0.9974, 1.0014, 1.0020, 1.0022, 0.9981, 0.9790, 0.9971, 0.9989,
        0.9985], device='cuda:0') tensor(268, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(3.3035e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2838, device='cuda:0')
min of grad d_p:  tensor(-0.3983, device='cuda:0')
max|min: (J_L, Jta/N)  (0.28377020359039307, 0.283697247505188, ratio: 0.9997429251670837)|(-0.39829912781715393, -0.3981846570968628)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(-4.2278e-08, device='cuda:0') min:  tensor(-0.0001, device='cuda:0') norm:  tensor(0.0047, device='cuda:0') MSE:  tensor(5.9086e-09, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(1.4089e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0236, device='cuda:0') MSE:  tensor(2.9696e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0015, device='cuda:0')
min of d_p_list:  tensor(-0.0013, device='cuda:0')
Epoch:  31  
Training Loss: 0.05770786851644516
Test Loss:  0.06259644776582718
Test Acc:  0.0
Valid Loss:  0.05310150235891342
Valid Acc:  0.0
std:  0.009319303956470373 
thres:  7.245416641235351e-05
Preserved_eigens number check:  512
  3%|▎         | 31/1000 [07:35<3:57:18, 14.69s/it]Epoch:   32
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(0.4945, device='cuda:0') 
Std:  tensor(12.3700, device='cuda:0') 
ABS Max:  tensor(163.1887, device='cuda:0') 
ABS Min:  tensor(0.0060, device='cuda:0')
Criterion check:  tensor([1.0009, 0.9996, 1.0002, 1.0002, 0.9988, 0.9997, 0.9929, 0.9954, 0.9993,
        0.9990], device='cuda:0') tensor(233, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0019, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2607, device='cuda:0')
min of grad d_p:  tensor(-0.3732, device='cuda:0')
max|min: (J_L, Jta/N)  (0.2606721520423889, 0.26066920161247253, ratio: 0.9999886751174927)|(-0.3732379674911499, -0.37323686480522156)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.4571e-06, device='cuda:0') mean:  tensor(9.7928e-10, device='cuda:0') min:  tensor(-3.5325e-06, device='cuda:0') norm:  tensor(5.4601e-05, device='cuda:0') MSE:  tensor(6.8802e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(1.9844e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0310, device='cuda:0') MSE:  tensor(3.9039e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0111, device='cuda:0')
min of d_p_list:  tensor(-0.0132, device='cuda:0')
Epoch:  32  
Training Loss: 0.063043013215065
Test Loss:  0.067935511469841
Test Acc:  0.0
Valid Loss:  0.05991227924823761
Valid Acc:  0.0
std:  0.007890599379468535 
thres:  6.832473278045654e-05
Preserved_eigens number check:  512
  3%|▎         | 32/1000 [07:50<3:57:11, 14.70s/it]Epoch:   33
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(56.7120, device='cuda:0') 
Std:  tensor(1343.1058, device='cuda:0') 
ABS Max:  tensor(30349.7520, device='cuda:0') 
ABS Min:  tensor(0.0019, device='cuda:0')
Criterion check:  tensor([0.9950, 1.0083, 0.9956, 0.9987, 1.0023, 1.0014, 0.9993, 1.0009, 0.9766,
        1.0117], device='cuda:0') tensor(277, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0012, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1674, device='cuda:0')
min of grad d_p:  tensor(-0.2005, device='cuda:0')
max|min: (J_L, Jta/N)  (0.16738468408584595, 0.16738450527191162, ratio: 0.999998927116394)|(-0.20045079290866852, -0.20045118033885956)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.6049e-06, device='cuda:0') mean:  tensor(2.6886e-10, device='cuda:0') min:  tensor(-5.1148e-06, device='cuda:0') norm:  tensor(2.9056e-05, device='cuda:0') MSE:  tensor(3.6613e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0023, device='cuda:0') mean:  tensor(5.5406e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0979, device='cuda:0') MSE:  tensor(1.2337e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0028, device='cuda:0')
min of d_p_list:  tensor(-0.0040, device='cuda:0')
Epoch:  33  
Training Loss: 0.059809185564517975
Test Loss:  0.06324759125709534
Test Acc:  0.0
Valid Loss:  0.05532468855381012
Valid Acc:  0.0
std:  0.00695382623723411 
thres:  6.482414454221725e-05
Preserved_eigens number check:  512
  3%|▎         | 33/1000 [08:04<3:57:02, 14.71s/it]Epoch:   34
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.0136, device='cuda:0') 
Std:  tensor(46.9280, device='cuda:0') 
ABS Max:  tensor(702.4800, device='cuda:0') 
ABS Min:  tensor(0.0027, device='cuda:0')
Criterion check:  tensor([1.0023, 0.9992, 0.9939, 1.0005, 0.9985, 0.9992, 0.9992, 1.0001, 1.0016,
        1.0406], device='cuda:0') tensor(246, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0022, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1621, device='cuda:0')
min of grad d_p:  tensor(-0.1826, device='cuda:0')
max|min: (J_L, Jta/N)  (0.16210687160491943, 0.16210709512233734, ratio: 1.0000014305114746)|(-0.18260464072227478, -0.18260470032691956)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.1830e-06, device='cuda:0') mean:  tensor(3.6801e-11, device='cuda:0') min:  tensor(-1.0943e-06, device='cuda:0') norm:  tensor(1.9216e-05, device='cuda:0') MSE:  tensor(2.4213e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(1.4883e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0254, device='cuda:0') MSE:  tensor(3.2024e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0025, device='cuda:0')
min of d_p_list:  tensor(-0.0024, device='cuda:0')
Epoch:  34  
Training Loss: 0.06032732501626015
Test Loss:  0.06366509199142456
Test Acc:  0.0
Valid Loss:  0.05498197302222252
Valid Acc:  0.0
std:  0.0028805015893668393 
thres:  6.138430163264275e-05
Preserved_eigens number check:  512
  3%|▎         | 34/1000 [08:19<3:57:09, 14.73s/it]Epoch:   35
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-31.4129, device='cuda:0') 
Std:  tensor(511.6685, device='cuda:0') 
ABS Max:  tensor(10785.5508, device='cuda:0') 
ABS Min:  tensor(0.0393, device='cuda:0')
Criterion check:  tensor([1.0077, 0.9843, 0.9755, 0.9892, 1.0082, 0.9865, 0.9914, 1.0000, 0.9539,
        1.0069], device='cuda:0') tensor(273, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0004, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1499, device='cuda:0')
min of grad d_p:  tensor(-0.1860, device='cuda:0')
max|min: (J_L, Jta/N)  (0.14987263083457947, 0.14987266063690186, ratio: 1.000000238418579)|(-0.18603327870368958, -0.18603308498859406)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.4624e-06, device='cuda:0') mean:  tensor(-1.4558e-10, device='cuda:0') min:  tensor(-7.5251e-07, device='cuda:0') norm:  tensor(2.0493e-05, device='cuda:0') MSE:  tensor(2.5823e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0019, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1878, device='cuda:0') MSE:  tensor(2.3668e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0025, device='cuda:0')
min of d_p_list:  tensor(-0.0025, device='cuda:0')
Epoch:  35  
Training Loss: 0.053088195621967316
Test Loss:  0.056306857615709305
Test Acc:  0.0
Valid Loss:  0.04847048595547676
Valid Acc:  0.0
std:  0.0033217970917151464 
thres:  5.879511758685112e-05
Preserved_eigens number check:  512
  4%|▎         | 35/1000 [08:34<3:57:08, 14.74s/it]Epoch:   36
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-33.9847, device='cuda:0') 
Std:  tensor(985.4872, device='cuda:0') 
ABS Max:  tensor(21730.7500, device='cuda:0') 
ABS Min:  tensor(0.0125, device='cuda:0')
Criterion check:  tensor([0.9984, 1.0021, 0.9995, 3.7053, 0.9995, 0.9996, 0.9990, 1.0009, 1.0002,
        0.9962], device='cuda:0') tensor(273, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0010, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1391, device='cuda:0')
min of grad d_p:  tensor(-0.1732, device='cuda:0')
max|min: (J_L, Jta/N)  (0.13907663524150848, 0.13907650113105774, ratio: 0.9999990463256836)|(-0.17315088212490082, -0.17315052449703217)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.2144e-06, device='cuda:0') mean:  tensor(1.4189e-10, device='cuda:0') min:  tensor(-8.4192e-07, device='cuda:0') norm:  tensor(3.5360e-05, device='cuda:0') MSE:  tensor(4.4557e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0009, device='cuda:0') mean:  tensor(2.2215e-05, device='cuda:0') min:  tensor(9.8169e-13, device='cuda:0') norm:  tensor(0.0346, device='cuda:0') MSE:  tensor(4.3566e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0047, device='cuda:0')
min of d_p_list:  tensor(-0.0043, device='cuda:0')
Epoch:  36  
Training Loss: 0.052359744906425476
Test Loss:  0.054222263395786285
Test Acc:  0.0
Valid Loss:  0.047355856746435165
Valid Acc:  0.0
std:  0.004235164822244729 
thres:  5.772549286484718e-05
Preserved_eigens number check:  512
  4%|▎         | 36/1000 [08:49<3:56:48, 14.74s/it]Epoch:   37
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(0.6013, device='cuda:0') 
Std:  tensor(44.4142, device='cuda:0') 
ABS Max:  tensor(426.8043, device='cuda:0') 
ABS Min:  tensor(0.0036, device='cuda:0')
Criterion check:  tensor([1.0052, 1.0056, 0.9806, 1.0835, 0.9986, 0.9987, 1.0029, 1.0172, 0.9995,
        1.0121], device='cuda:0') tensor(248, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0010, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2563, device='cuda:0')
min of grad d_p:  tensor(-0.4509, device='cuda:0')
max|min: (J_L, Jta/N)  (0.2562914490699768, 0.2563250660896301, ratio: 1.0001311302185059)|(-0.4509183168411255, -0.45093265175819397)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.2204e-05, device='cuda:0') mean:  tensor(3.6625e-08, device='cuda:0') min:  tensor(-3.3826e-05, device='cuda:0') norm:  tensor(0.0015, device='cuda:0') MSE:  tensor(1.9408e-09, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0013, device='cuda:0') mean:  tensor(2.2414e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0437, device='cuda:0') MSE:  tensor(5.5007e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0059, device='cuda:0')
min of d_p_list:  tensor(-0.0075, device='cuda:0')
Epoch:  37  
Training Loss: 0.03920280933380127
Test Loss:  0.04336667060852051
Test Acc:  0.0
Valid Loss:  0.03678640350699425
Valid Acc:  0.0
std:  0.007626608992916191 
thres:  5.295745208859444e-05
Preserved_eigens number check:  512
  4%|▎         | 37/1000 [09:03<3:56:18, 14.72s/it]Epoch:   38
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(4.2327, device='cuda:0') 
Std:  tensor(55.4393, device='cuda:0') 
ABS Max:  tensor(1184.5919, device='cuda:0') 
ABS Min:  tensor(0.0035, device='cuda:0')
Criterion check:  tensor([1.0010, 1.0001, 0.9988, 1.0048, 1.0001, 1.0001, 1.0002, 0.9997, 1.0011,
        1.0016], device='cuda:0') tensor(263, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0002, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2239, device='cuda:0')
min of grad d_p:  tensor(-0.1399, device='cuda:0')
max|min: (J_L, Jta/N)  (0.22391414642333984, 0.22391611337661743, ratio: 1.0000088214874268)|(-0.1399078667163849, -0.13990771770477295)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.9744e-06, device='cuda:0') mean:  tensor(2.9890e-10, device='cuda:0') min:  tensor(-3.7011e-06, device='cuda:0') norm:  tensor(4.6965e-05, device='cuda:0') MSE:  tensor(5.9180e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0006, device='cuda:0') mean:  tensor(2.1957e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0337, device='cuda:0') MSE:  tensor(4.2520e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0039, device='cuda:0')
min of d_p_list:  tensor(-0.0042, device='cuda:0')
Epoch:  38  
Training Loss: 0.04722702130675316
Test Loss:  0.05090795084834099
Test Acc:  0.0
Valid Loss:  0.04400882124900818
Valid Acc:  0.0
std:  0.00700078906256514 
thres:  5.044101923704147e-05
Preserved_eigens number check:  512
  4%|▍         | 38/1000 [09:18<3:55:59, 14.72s/it]Epoch:   39
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(31.3704, device='cuda:0') 
Std:  tensor(474.2953, device='cuda:0') 
ABS Max:  tensor(5295.0962, device='cuda:0') 
ABS Min:  tensor(0.0022, device='cuda:0')
Criterion check:  tensor([0.1968, 0.9784, 0.9468, 1.0920, 1.6266, 0.9737, 1.0404, 0.9733, 0.8021,
        1.0964], device='cuda:0') tensor(269, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(2.9951e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1548, device='cuda:0')
min of grad d_p:  tensor(-0.1641, device='cuda:0')
max|min: (J_L, Jta/N)  (0.15484005212783813, 0.15454678237438202, ratio: 0.9981060028076172)|(-0.1640685498714447, -0.1639920324087143)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(-5.3970e-07, device='cuda:0') min:  tensor(-0.0017, device='cuda:0') norm:  tensor(0.0297, device='cuda:0') MSE:  tensor(3.7398e-08, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0600, device='cuda:0') mean:  tensor(0.0007, device='cuda:0') min:  tensor(6.5434e-14, device='cuda:0') norm:  tensor(1.6066, device='cuda:0') MSE:  tensor(2.0245e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0010, device='cuda:0')
min of d_p_list:  tensor(-0.0008, device='cuda:0')
Epoch:  39  
Training Loss: 0.041216686367988586
Test Loss:  0.044541649520397186
Test Acc:  0.0
Valid Loss:  0.03877243399620056
Valid Acc:  0.0
std:  0.0056455506463510404 
thres:  4.6618891507387166e-05
Preserved_eigens number check:  512
  4%|▍         | 39/1000 [09:33<3:55:31, 14.71s/it]Epoch:   40
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(0.6668, device='cuda:0') 
Std:  tensor(18.7160, device='cuda:0') 
ABS Max:  tensor(391.2335, device='cuda:0') 
ABS Min:  tensor(0.0020, device='cuda:0')
Criterion check:  tensor([1.0125, 0.9999, 0.9986, 0.9994, 0.9987, 1.0000, 1.0010, 0.9983, 0.9982,
        0.9956], device='cuda:0') tensor(202, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0004, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1261, device='cuda:0')
min of grad d_p:  tensor(-0.1765, device='cuda:0')
max|min: (J_L, Jta/N)  (0.12608881294727325, 0.1260889172554016, ratio: 1.0000008344650269)|(-0.1765184998512268, -0.17651955783367157)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.0781e-05, device='cuda:0') mean:  tensor(1.9506e-09, device='cuda:0') min:  tensor(-8.2627e-06, device='cuda:0') norm:  tensor(0.0002, device='cuda:0') MSE:  tensor(2.7930e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0012, device='cuda:0') mean:  tensor(2.0535e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0379, device='cuda:0') MSE:  tensor(4.7788e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0012, device='cuda:0')
min of d_p_list:  tensor(-0.0019, device='cuda:0')
Epoch:  40  
Training Loss: 0.03984202444553375
Test Loss:  0.04293183237314224
Test Acc:  0.0
Valid Loss:  0.037258535623550415
Valid Acc:  0.0
std:  0.005066419480907741 
thres:  4.3969657272100446e-05
Preserved_eigens number check:  512
  4%|▍         | 40/1000 [09:47<3:55:39, 14.73s/it]Epoch:   41
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(148.6171, device='cuda:0') 
Std:  tensor(3531.2476, device='cuda:0') 
ABS Max:  tensor(79783.7656, device='cuda:0') 
ABS Min:  tensor(0.0004, device='cuda:0')
Criterion check:  tensor([0.9878, 1.0000, 1.0003, 1.0005, 1.0002, 1.0001, 1.0121, 1.0003, 0.9978,
        0.9992], device='cuda:0') tensor(201, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0004, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1215, device='cuda:0')
min of grad d_p:  tensor(-0.1569, device='cuda:0')
max|min: (J_L, Jta/N)  (0.12153909355401993, 0.1215389296412468, ratio: 0.9999986290931702)|(-0.15693840384483337, -0.15693794190883636)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.5481e-06, device='cuda:0') mean:  tensor(-6.5303e-10, device='cuda:0') min:  tensor(-7.3239e-06, device='cuda:0') norm:  tensor(7.6301e-05, device='cuda:0') MSE:  tensor(9.6145e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(6.2047e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0106, device='cuda:0') MSE:  tensor(1.3363e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0010, device='cuda:0')
min of d_p_list:  tensor(-0.0015, device='cuda:0')
Epoch:  41  
Training Loss: 0.03851652890443802
Test Loss:  0.041395798325538635
Test Acc:  0.0
Valid Loss:  0.03563159331679344
Valid Acc:  0.0
std:  0.0031419466707639063 
thres:  4.120101407170296e-05
Preserved_eigens number check:  512
  4%|▍         | 41/1000 [10:02<3:56:03, 14.77s/it]Epoch:   42
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(1.6260, device='cuda:0') 
Std:  tensor(24.0639, device='cuda:0') 
ABS Max:  tensor(383.2886, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([1.0046, 0.9997, 0.9903, 1.0001, 1.0022, 1.0005, 1.0001, 1.0017, 0.9971,
        0.9978], device='cuda:0') tensor(226, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0011, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1503, device='cuda:0')
min of grad d_p:  tensor(-0.1613, device='cuda:0')
max|min: (J_L, Jta/N)  (0.15032486617565155, 0.15032804012298584, ratio: 1.0000211000442505)|(-0.1613236516714096, -0.16132353246212006)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.2389e-06, device='cuda:0') mean:  tensor(-6.9930e-10, device='cuda:0') min:  tensor(-3.3826e-06, device='cuda:0') norm:  tensor(6.5129e-05, device='cuda:0') MSE:  tensor(8.2068e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(2.6103e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0421, device='cuda:0') MSE:  tensor(5.3095e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0027, device='cuda:0')
min of d_p_list:  tensor(-0.0037, device='cuda:0')
Epoch:  42  
Training Loss: 0.036677055060863495
Test Loss:  0.038731299340724945
Test Acc:  0.0
Valid Loss:  0.03420431166887283
Valid Acc:  0.0
std:  0.0035932336533365627 
thres:  4.0695863217115405e-05
Preserved_eigens number check:  512
  4%|▍         | 42/1000 [10:17<3:57:26, 14.87s/it]Epoch:   43
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-21.1407, device='cuda:0') 
Std:  tensor(454.6302, device='cuda:0') 
ABS Max:  tensor(10251.0498, device='cuda:0') 
ABS Min:  tensor(0.0016, device='cuda:0')
Criterion check:  tensor([1.0033, 1.0013, 0.9982, 0.9997, 1.0027, 1.0001, 1.0010, 0.9971, 1.0021,
        0.9946], device='cuda:0') tensor(244, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0022, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.4204, device='cuda:0')
min of grad d_p:  tensor(-0.1743, device='cuda:0')
max|min: (J_L, Jta/N)  (0.42036551237106323, 0.42036375403404236, ratio: 0.9999958276748657)|(-0.174284428358078, -0.17428457736968994)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.9372e-06, device='cuda:0') mean:  tensor(1.3910e-11, device='cuda:0') min:  tensor(-1.8850e-06, device='cuda:0') norm:  tensor(3.8931e-05, device='cuda:0') MSE:  tensor(4.9057e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0022, device='cuda:0') mean:  tensor(2.6657e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0557, device='cuda:0') MSE:  tensor(7.0127e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0008, device='cuda:0')
min of d_p_list:  tensor(-0.0010, device='cuda:0')
Epoch:  43  
Training Loss: 0.033216286450624466
Test Loss:  0.03524558246135712
Test Acc:  0.0
Valid Loss:  0.03118886798620224
Valid Acc:  0.0
std:  0.0027779324977254037 
thres:  3.789371624588966e-05
Preserved_eigens number check:  512
  4%|▍         | 43/1000 [10:32<3:57:02, 14.86s/it]Epoch:   44
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-29.5598, device='cuda:0') 
Std:  tensor(715.3335, device='cuda:0') 
ABS Max:  tensor(16176.6602, device='cuda:0') 
ABS Min:  tensor(0.0007, device='cuda:0')
Criterion check:  tensor([1.0002, 1.0004, 1.0017, 0.9909, 0.9980, 1.0000, 1.0012, 1.0004, 1.0021,
        0.9999], device='cuda:0') tensor(214, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0005, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.5508, device='cuda:0')
min of grad d_p:  tensor(-0.1699, device='cuda:0')
max|min: (J_L, Jta/N)  (0.550785481929779, 0.5507835745811462, ratio: 0.999996542930603)|(-0.16986387968063354, -0.16986410319805145)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.3842e-06, device='cuda:0') mean:  tensor(-7.7547e-10, device='cuda:0') min:  tensor(-3.7067e-06, device='cuda:0') norm:  tensor(6.3451e-05, device='cuda:0') MSE:  tensor(7.9953e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(1.5678e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0276, device='cuda:0') MSE:  tensor(3.4724e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0015, device='cuda:0')
min of d_p_list:  tensor(-0.0016, device='cuda:0')
Epoch:  44  
Training Loss: 0.03355462849140167
Test Loss:  0.03534739091992378
Test Acc:  0.0
Valid Loss:  0.03143862262368202
Valid Acc:  0.0
std:  0.0026316789598105047 
thres:  3.6361304670572286e-05
Preserved_eigens number check:  512
  4%|▍         | 44/1000 [10:47<3:56:15, 14.83s/it]Epoch:   45
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.4470, device='cuda:0') 
Std:  tensor(28.5507, device='cuda:0') 
ABS Max:  tensor(425.9673, device='cuda:0') 
ABS Min:  tensor(0.0055, device='cuda:0')
Criterion check:  tensor([0.9995, 0.9999, 1.0001, 1.0062, 1.0005, 1.0003, 1.0000, 0.9997, 1.0017,
        0.9975], device='cuda:0') tensor(246, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0002, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1701, device='cuda:0')
min of grad d_p:  tensor(-0.1665, device='cuda:0')
max|min: (J_L, Jta/N)  (0.17008504271507263, 0.17008110880851746, ratio: 0.9999768733978271)|(-0.16647619009017944, -0.1664762645959854)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.7593e-06, device='cuda:0') mean:  tensor(-3.9687e-10, device='cuda:0') min:  tensor(-4.5896e-06, device='cuda:0') norm:  tensor(9.7558e-05, device='cuda:0') MSE:  tensor(1.2293e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(5.5572e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0089, device='cuda:0') MSE:  tensor(1.1248e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0035, device='cuda:0')
min of d_p_list:  tensor(-0.0040, device='cuda:0')
Epoch:  45  
Training Loss: 0.031636811792850494
Test Loss:  0.03371955826878548
Test Acc:  0.0
Valid Loss:  0.030687551945447922
Valid Acc:  0.0
std:  0.002504755101890477 
thres:  3.472026214003563e-05
Preserved_eigens number check:  512
  4%|▍         | 45/1000 [11:02<3:55:35, 14.80s/it]Epoch:   46
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-3.4868, device='cuda:0') 
Std:  tensor(95.7270, device='cuda:0') 
ABS Max:  tensor(1602.0085, device='cuda:0') 
ABS Min:  tensor(0.0073, device='cuda:0')
Criterion check:  tensor([0.9961, 0.9991, 1.0018, 0.9874, 0.9999, 1.0083, 1.0003, 1.0021, 0.9870,
        0.9552], device='cuda:0') tensor(251, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0008, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1749, device='cuda:0')
min of grad d_p:  tensor(-0.2038, device='cuda:0')
max|min: (J_L, Jta/N)  (0.17492176592350006, 0.1749098151922226, ratio: 0.9999316930770874)|(-0.20380595326423645, -0.20380637049674988)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.2398e-05, device='cuda:0') mean:  tensor(2.3268e-09, device='cuda:0') min:  tensor(-6.4783e-06, device='cuda:0') norm:  tensor(0.0002, device='cuda:0') MSE:  tensor(2.8064e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0007, device='cuda:0') mean:  tensor(1.9942e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0339, device='cuda:0') MSE:  tensor(4.2671e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0016, device='cuda:0')
min of d_p_list:  tensor(-0.0009, device='cuda:0')
Epoch:  46  
Training Loss: 0.028896305710077286
Test Loss:  0.03079940751194954
Test Acc:  0.0
Valid Loss:  0.02785302884876728
Valid Acc:  0.0
std:  0.002544251516336998 
thres:  3.2796217501163485e-05
Preserved_eigens number check:  512
  5%|▍         | 46/1000 [11:16<3:55:11, 14.79s/it]Epoch:   47
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-4.3215, device='cuda:0') 
Std:  tensor(62.8265, device='cuda:0') 
ABS Max:  tensor(1184.3236, device='cuda:0') 
ABS Min:  tensor(0.0016, device='cuda:0')
Criterion check:  tensor([1.0017, 0.9997, 1.0008, 1.0210, 0.9996, 1.0025, 0.9975, 0.9993, 1.0013,
        0.9983], device='cuda:0') tensor(210, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0002, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1351, device='cuda:0')
min of grad d_p:  tensor(-0.1975, device='cuda:0')
max|min: (J_L, Jta/N)  (0.13508538901805878, 0.13508525490760803, ratio: 0.9999989867210388)|(-0.19750265777111053, -0.1975020468235016)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.6673e-06, device='cuda:0') mean:  tensor(-3.5125e-10, device='cuda:0') min:  tensor(-2.4140e-06, device='cuda:0') norm:  tensor(5.6547e-05, device='cuda:0') MSE:  tensor(7.1254e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(4.5449e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0077, device='cuda:0') MSE:  tensor(9.6501e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0025, device='cuda:0')
min of d_p_list:  tensor(-0.0017, device='cuda:0')
Epoch:  47  
Training Loss: 0.02551649697124958
Test Loss:  0.027354855090379715
Test Acc:  0.0
Valid Loss:  0.02448035404086113
Valid Acc:  0.0
std:  0.0030129022004193183 
thres:  3.05641058832407e-05
Preserved_eigens number check:  512
  5%|▍         | 47/1000 [11:31<3:54:41, 14.78s/it]Epoch:   48
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(8.4001, device='cuda:0') 
Std:  tensor(251.7927, device='cuda:0') 
ABS Max:  tensor(4618.3687, device='cuda:0') 
ABS Min:  tensor(0.0065, device='cuda:0')
Criterion check:  tensor([0.9933, 0.9938, 0.9951, 1.0136, 1.0006, 0.9958, 0.9959, 0.9999, 1.0097,
        0.9228], device='cuda:0') tensor(266, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0002, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1531, device='cuda:0')
min of grad d_p:  tensor(-0.1832, device='cuda:0')
max|min: (J_L, Jta/N)  (0.1531156450510025, 0.15311577916145325, ratio: 1.0000008344650269)|(-0.1831723153591156, -0.18317216634750366)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.2783e-07, device='cuda:0') mean:  tensor(-1.2907e-10, device='cuda:0') min:  tensor(-6.4715e-07, device='cuda:0') norm:  tensor(1.3561e-05, device='cuda:0') MSE:  tensor(1.7088e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0007, device='cuda:0') mean:  tensor(1.9220e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0346, device='cuda:0') MSE:  tensor(4.3546e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0015, device='cuda:0')
min of d_p_list:  tensor(-0.0019, device='cuda:0')
Epoch:  48  
Training Loss: 0.02703784592449665
Test Loss:  0.028413522988557816
Test Acc:  0.0
Valid Loss:  0.025384534150362015
Valid Acc:  0.0
std:  0.002937812805953151 
thres:  2.932841777801514e-05
Preserved_eigens number check:  512
  5%|▍         | 48/1000 [11:46<3:54:06, 14.75s/it]Epoch:   49
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(0.8637, device='cuda:0') 
Std:  tensor(39.8505, device='cuda:0') 
ABS Max:  tensor(719.5085, device='cuda:0') 
ABS Min:  tensor(0.0045, device='cuda:0')
Criterion check:  tensor([0.9991, 0.9989, 0.9987, 0.9988, 1.0005, 1.0004, 1.0002, 1.0005, 0.9992,
        0.9987], device='cuda:0') tensor(241, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0009, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1602, device='cuda:0')
min of grad d_p:  tensor(-0.1630, device='cuda:0')
max|min: (J_L, Jta/N)  (0.16022354364395142, 0.1602267026901245, ratio: 1.0000196695327759)|(-0.16295740008354187, -0.16295745968818665)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.0661e-07, device='cuda:0') mean:  tensor(-1.1309e-09, device='cuda:0') min:  tensor(-7.0482e-06, device='cuda:0') norm:  tensor(5.6090e-05, device='cuda:0') MSE:  tensor(7.0678e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(8.5749e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0148, device='cuda:0') MSE:  tensor(1.8686e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0019, device='cuda:0')
min of d_p_list:  tensor(-0.0022, device='cuda:0')
Epoch:  49  
Training Loss: 0.02577735111117363
Test Loss:  0.027393518015742302
Test Acc:  0.0
Valid Loss:  0.02419077418744564
Valid Acc:  0.0
std:  0.0022718155384062327 
thres:  2.777296230196953e-05
Preserved_eigens number check:  512
  5%|▍         | 49/1000 [12:01<3:53:46, 14.75s/it]Epoch:   50
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.0396, device='cuda:0') 
Std:  tensor(17.5134, device='cuda:0') 
ABS Max:  tensor(248.4704, device='cuda:0') 
ABS Min:  tensor(0.0009, device='cuda:0')
Criterion check:  tensor([0.9999, 0.9997, 1.0005, 0.9994, 0.9995, 1.0017, 1.0001, 0.9991, 1.0034,
        0.9985], device='cuda:0') tensor(242, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0005, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1859, device='cuda:0')
min of grad d_p:  tensor(-0.1593, device='cuda:0')
max|min: (J_L, Jta/N)  (0.18585485219955444, 0.18585626780986786, ratio: 1.0000076293945312)|(-0.1592894345521927, -0.1592891961336136)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.0133e-06, device='cuda:0') mean:  tensor(-2.7684e-10, device='cuda:0') min:  tensor(-1.8179e-06, device='cuda:0') norm:  tensor(2.9962e-05, device='cuda:0') MSE:  tensor(3.7755e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(6.9336e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0112, device='cuda:0') MSE:  tensor(1.4139e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0015, device='cuda:0')
min of d_p_list:  tensor(-0.0012, device='cuda:0')
Epoch:  50  
Training Loss: 0.022898802533745766
Test Loss:  0.024128632619976997
Test Acc:  0.0
Valid Loss:  0.02150726318359375
Valid Acc:  0.0
std:  0.001967905922460219 
thres:  2.6025360450148582e-05
Preserved_eigens number check:  512
  5%|▌         | 50/1000 [12:15<3:53:28, 14.75s/it]Epoch:   51
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-1.1580, device='cuda:0') 
Std:  tensor(40.7879, device='cuda:0') 
ABS Max:  tensor(739.2083, device='cuda:0') 
ABS Min:  tensor(0.0073, device='cuda:0')
Criterion check:  tensor([1.0001, 1.0004, 1.0015, 1.0005, 1.0003, 0.9991, 1.0002, 0.9997, 0.9953,
        0.9996], device='cuda:0') tensor(221, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0008, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1831, device='cuda:0')
min of grad d_p:  tensor(-0.1379, device='cuda:0')
max|min: (J_L, Jta/N)  (0.18313626945018768, 0.18313927948474884, ratio: 1.000016450881958)|(-0.13787537813186646, -0.13787482678890228)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.3709e-06, device='cuda:0') mean:  tensor(-9.5905e-10, device='cuda:0') min:  tensor(-3.3528e-06, device='cuda:0') norm:  tensor(5.6520e-05, device='cuda:0') MSE:  tensor(7.1220e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(6.7486e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0115, device='cuda:0') MSE:  tensor(1.4454e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0018, device='cuda:0')
min of d_p_list:  tensor(-0.0027, device='cuda:0')
Epoch:  51  
Training Loss: 0.020907055586576462
Test Loss:  0.021695846691727638
Test Acc:  0.0
Valid Loss:  0.019691212102770805
Valid Acc:  0.0
std:  0.00221595862245022 
thres:  2.442751042544842e-05
Preserved_eigens number check:  512
  5%|▌         | 51/1000 [12:30<3:53:07, 14.74s/it]Epoch:   52
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(19.4771, device='cuda:0') 
Std:  tensor(350.0192, device='cuda:0') 
ABS Max:  tensor(6097.8301, device='cuda:0') 
ABS Min:  tensor(0.0016, device='cuda:0')
Criterion check:  tensor([1.0009, 0.9993, 1.0005, 0.9977, 0.9989, 1.0015, 1.0003, 0.9983, 1.0044,
        0.9899], device='cuda:0') tensor(247, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0012, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1517, device='cuda:0')
min of grad d_p:  tensor(-0.1357, device='cuda:0')
max|min: (J_L, Jta/N)  (0.1517026424407959, 0.1517048180103302, ratio: 1.000014305114746)|(-0.1357285976409912, -0.13572780787944794)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.0154e-06, device='cuda:0') mean:  tensor(-4.9586e-10, device='cuda:0') min:  tensor(-5.2974e-06, device='cuda:0') norm:  tensor(5.2225e-05, device='cuda:0') MSE:  tensor(6.5807e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(1.7009e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0275, device='cuda:0') MSE:  tensor(3.4644e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0027, device='cuda:0')
min of d_p_list:  tensor(-0.0033, device='cuda:0')
Epoch:  52  
Training Loss: 0.017322197556495667
Test Loss:  0.018746845424175262
Test Acc:  0.0
Valid Loss:  0.01592397317290306
Valid Acc:  0.0
std:  0.003476280591986203 
thres:  2.2788650542497634e-05
Preserved_eigens number check:  512
  5%|▌         | 52/1000 [12:45<3:52:48, 14.73s/it]Epoch:   53
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-1.2615, device='cuda:0') 
Std:  tensor(69.9517, device='cuda:0') 
ABS Max:  tensor(1366.9564, device='cuda:0') 
ABS Min:  tensor(0.0006, device='cuda:0')
Criterion check:  tensor([0.9978, 0.9970, 1.0002, 0.9887, 0.9998, 1.0023, 1.0010, 1.0011, 0.9991,
        1.1405], device='cuda:0') tensor(239, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0008, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1271, device='cuda:0')
min of grad d_p:  tensor(-0.1257, device='cuda:0')
max|min: (J_L, Jta/N)  (0.12714552879333496, 0.12714114785194397, ratio: 0.9999655485153198)|(-0.12573882937431335, -0.12573924660682678)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.5300e-06, device='cuda:0') mean:  tensor(1.1494e-09, device='cuda:0') min:  tensor(-1.6950e-06, device='cuda:0') norm:  tensor(7.8709e-05, device='cuda:0') MSE:  tensor(9.9180e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(1.2051e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0222, device='cuda:0') MSE:  tensor(2.7918e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0012, device='cuda:0')
min of d_p_list:  tensor(-0.0015, device='cuda:0')
Epoch:  53  
Training Loss: 0.01667734421789646
Test Loss:  0.017977090552449226
Test Acc:  0.0
Valid Loss:  0.015346359461545944
Valid Acc:  0.0
std:  0.003413122858829292 
thres:  2.0716550201177597e-05
Preserved_eigens number check:  512
  5%|▌         | 53/1000 [13:00<3:52:25, 14.73s/it]Epoch:   54
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-41.8424, device='cuda:0') 
Std:  tensor(991.0028, device='cuda:0') 
ABS Max:  tensor(22418.0918, device='cuda:0') 
ABS Min:  tensor(0.0025, device='cuda:0')
Criterion check:  tensor([1.0009, 1.0022, 0.9997, 0.9978, 1.0009, 1.0000, 0.9995, 0.9995, 1.0001,
        0.9971], device='cuda:0') tensor(256, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0002, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1412, device='cuda:0')
min of grad d_p:  tensor(-0.1193, device='cuda:0')
max|min: (J_L, Jta/N)  (0.14116394519805908, 0.14116749167442322, ratio: 1.0000251531600952)|(-0.1193409115076065, -0.11934036016464233)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.0431e-06, device='cuda:0') mean:  tensor(-6.4196e-10, device='cuda:0') min:  tensor(-3.6806e-06, device='cuda:0') norm:  tensor(7.6140e-05, device='cuda:0') MSE:  tensor(9.5943e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(1.1333e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0184, device='cuda:0') MSE:  tensor(2.3215e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0039, device='cuda:0')
min of d_p_list:  tensor(-0.0033, device='cuda:0')
Epoch:  54  
Training Loss: 0.01801111549139023
Test Loss:  0.01938347890973091
Test Acc:  0.0
Valid Loss:  0.016372671350836754
Valid Acc:  0.0
std:  0.0023618563133781995 
thres:  1.9163303077220916e-05
Preserved_eigens number check:  512
  5%|▌         | 54/1000 [13:14<3:52:43, 14.76s/it]Epoch:   55
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.6820, device='cuda:0') 
Std:  tensor(125.0631, device='cuda:0') 
ABS Max:  tensor(1694.2205, device='cuda:0') 
ABS Min:  tensor(0.0092, device='cuda:0')
Criterion check:  tensor([1.0023, 1.0088, 1.0166, 1.0044, 0.9985, 1.0005, 1.0016, 1.0021, 1.0021,
        0.9792], device='cuda:0') tensor(272, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0014, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1057, device='cuda:0')
min of grad d_p:  tensor(-0.1363, device='cuda:0')
max|min: (J_L, Jta/N)  (0.1056564450263977, 0.1056569293141365, ratio: 1.000004529953003)|(-0.13633738458156586, -0.13633757829666138)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.4273e-07, device='cuda:0') mean:  tensor(-2.6446e-10, device='cuda:0') min:  tensor(-4.0941e-06, device='cuda:0') norm:  tensor(1.3487e-05, device='cuda:0') MSE:  tensor(1.6995e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0011, device='cuda:0') mean:  tensor(3.8424e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0641, device='cuda:0') MSE:  tensor(8.0719e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0083, device='cuda:0')
min of d_p_list:  tensor(-0.0134, device='cuda:0')
Epoch:  55  
Training Loss: 0.03394594043493271
Test Loss:  0.034794408828020096
Test Acc:  0.0
Valid Loss:  0.029216017574071884
Valid Acc:  0.0
std:  0.0064506803691327455 
thres:  2.1372730657458305e-05
Preserved_eigens number check:  512
  6%|▌         | 55/1000 [13:29<3:52:10, 14.74s/it]Epoch:   56
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(2.4864, device='cuda:0') 
Std:  tensor(44.1171, device='cuda:0') 
ABS Max:  tensor(737.0163, device='cuda:0') 
ABS Min:  tensor(0.0068, device='cuda:0')
Criterion check:  tensor([0.9978, 1.0863, 1.0033, 1.0061, 1.0003, 1.0004, 1.0005, 1.0017, 0.9984,
        0.9297], device='cuda:0') tensor(244, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0007, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1542, device='cuda:0')
min of grad d_p:  tensor(-0.1239, device='cuda:0')
max|min: (J_L, Jta/N)  (0.15421244502067566, 0.15421298146247864, ratio: 1.000003457069397)|(-0.12393095344305038, -0.12393102049827576)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.1155e-06, device='cuda:0') mean:  tensor(-3.5073e-10, device='cuda:0') min:  tensor(-6.8545e-07, device='cuda:0') norm:  tensor(1.9893e-05, device='cuda:0') MSE:  tensor(2.5067e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(9.7126e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0152, device='cuda:0') MSE:  tensor(1.9121e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0090, device='cuda:0')
min of d_p_list:  tensor(-0.0082, device='cuda:0')
Epoch:  56  
Training Loss: 0.03698360174894333
Test Loss:  0.03635184466838837
Test Acc:  0.0
Valid Loss:  0.031677331775426865
Valid Acc:  0.0
std:  0.00894256967302746 
thres:  2.458803988993168e-05
Preserved_eigens number check:  512
  6%|▌         | 56/1000 [13:44<3:51:52, 14.74s/it]Epoch:   57
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(9.7050, device='cuda:0') 
Std:  tensor(1488.8313, device='cuda:0') 
ABS Max:  tensor(23025.0254, device='cuda:0') 
ABS Min:  tensor(0.0382, device='cuda:0')
Criterion check:  tensor([1.0506, 0.9904, 1.1065, 1.0179, 0.8996, 1.0170, 1.0136, 0.9307, 1.1212,
        0.9814], device='cuda:0') tensor(267, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0007, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3433, device='cuda:0')
min of grad d_p:  tensor(-0.1412, device='cuda:0')
max|min: (J_L, Jta/N)  (0.3433164656162262, 0.34332916140556335, ratio: 1.0000369548797607)|(-0.1411668360233307, -0.14116570353507996)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.1669e-05, device='cuda:0') mean:  tensor(-8.5173e-10, device='cuda:0') min:  tensor(-1.4387e-05, device='cuda:0') norm:  tensor(0.0007, device='cuda:0') MSE:  tensor(8.4151e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0184, device='cuda:0') mean:  tensor(0.0006, device='cuda:0') min:  tensor(1.5910e-13, device='cuda:0') norm:  tensor(0.9690, device='cuda:0') MSE:  tensor(1.2210e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0027, device='cuda:0')
min of d_p_list:  tensor(-0.0014, device='cuda:0')
Epoch:  57  
Training Loss: 0.03149241581559181
Test Loss:  0.0313323512673378
Test Acc:  0.0
Valid Loss:  0.027961358428001404
Valid Acc:  0.0
std:  0.008421005721303748 
thres:  2.742208354175091e-05
Preserved_eigens number check:  512
  6%|▌         | 57/1000 [13:59<3:51:48, 14.75s/it]Epoch:   58
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-3.0502, device='cuda:0') 
Std:  tensor(84.2336, device='cuda:0') 
ABS Max:  tensor(1645.6125, device='cuda:0') 
ABS Min:  tensor(0.0005, device='cuda:0')
Criterion check:  tensor([0.9996, 1.0009, 1.0888, 1.0048, 1.0008, 1.0011, 0.9990, 0.9970, 1.0016,
        0.9990], device='cuda:0') tensor(229, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0006, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3925, device='cuda:0')
min of grad d_p:  tensor(-0.1431, device='cuda:0')
max|min: (J_L, Jta/N)  (0.39249908924102783, 0.39249804615974426, ratio: 0.9999973177909851)|(-0.1430632770061493, -0.14306262135505676)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.2096e-06, device='cuda:0') mean:  tensor(4.0767e-12, device='cuda:0') min:  tensor(-7.4506e-07, device='cuda:0') norm:  tensor(2.7875e-05, device='cuda:0') MSE:  tensor(3.5125e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0018, device='cuda:0') mean:  tensor(6.7096e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1069, device='cuda:0') MSE:  tensor(1.3469e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0059, device='cuda:0')
min of d_p_list:  tensor(-0.0079, device='cuda:0')
Epoch:  58  
Training Loss: 0.034100357443094254
Test Loss:  0.034995466470718384
Test Acc:  0.0
Valid Loss:  0.03190566971898079
Valid Acc:  0.0
std:  0.0066783879489866185 
thres:  3.0906686186790465e-05
Preserved_eigens number check:  512
  6%|▌         | 58/1000 [14:13<3:51:36, 14.75s/it]Epoch:   59
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(2.7444, device='cuda:0') 
Std:  tensor(54.8287, device='cuda:0') 
ABS Max:  tensor(833.3192, device='cuda:0') 
ABS Min:  tensor(0.0012, device='cuda:0')
Criterion check:  tensor([0.9984, 1.0011, 1.6170, 1.0135, 1.0157, 1.0004, 1.0055, 1.0171, 0.9999,
        1.0030], device='cuda:0') tensor(251, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0007, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3505, device='cuda:0')
min of grad d_p:  tensor(-0.1425, device='cuda:0')
max|min: (J_L, Jta/N)  (0.35050642490386963, 0.35050827264785767, ratio: 1.0000052452087402)|(-0.1424580216407776, -0.1424582600593567)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.3158e-05, device='cuda:0') mean:  tensor(-4.6502e-10, device='cuda:0') min:  tensor(-2.6822e-06, device='cuda:0') norm:  tensor(4.4198e-05, device='cuda:0') MSE:  tensor(5.5693e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0011, device='cuda:0') mean:  tensor(5.0053e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0804, device='cuda:0') MSE:  tensor(1.0129e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0017, device='cuda:0')
min of d_p_list:  tensor(-0.0031, device='cuda:0')
Epoch:  59  
Training Loss: 0.028385531157255173
Test Loss:  0.029483500868082047
Test Acc:  0.0
Valid Loss:  0.026793304830789566
Valid Acc:  0.0
std:  0.0028823291632672837 
thres:  3.2981569319963455e-05
Preserved_eigens number check:  512
  6%|▌         | 59/1000 [14:28<3:51:25, 14.76s/it]Epoch:   60
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.3116, device='cuda:0') 
Std:  tensor(39.6374, device='cuda:0') 
ABS Max:  tensor(566.2184, device='cuda:0') 
ABS Min:  tensor(0.0004, device='cuda:0')
Criterion check:  tensor([1.0008, 0.9995, 1.0006, 1.0071, 1.0006, 0.9997, 1.0031, 0.9994, 0.9868,
        0.9996], device='cuda:0') tensor(226, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0008, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2464, device='cuda:0')
min of grad d_p:  tensor(-0.1349, device='cuda:0')
max|min: (J_L, Jta/N)  (0.24637733399868011, 0.24637900292873383, ratio: 1.0000067949295044)|(-0.1349261999130249, -0.1349264532327652)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.4502e-06, device='cuda:0') mean:  tensor(-2.5181e-10, device='cuda:0') min:  tensor(-1.9670e-06, device='cuda:0') norm:  tensor(3.3908e-05, device='cuda:0') MSE:  tensor(4.2727e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(1.3693e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0222, device='cuda:0') MSE:  tensor(2.8005e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0040, device='cuda:0')
min of d_p_list:  tensor(-0.0043, device='cuda:0')
Epoch:  60  
Training Loss: 0.02651810646057129
Test Loss:  0.026880694553256035
Test Acc:  0.0
Valid Loss:  0.025026053190231323
Valid Acc:  0.0
std:  0.0037775892843008954 
thres:  3.149600252509118e-05
Preserved_eigens number check:  512
  6%|▌         | 60/1000 [14:43<3:50:53, 14.74s/it]Epoch:   61
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.9320, device='cuda:0') 
Std:  tensor(12.6806, device='cuda:0') 
ABS Max:  tensor(164.1154, device='cuda:0') 
ABS Min:  tensor(0.0011, device='cuda:0')
Criterion check:  tensor([0.9977, 0.9998, 1.0030, 1.0003, 0.9973, 0.9989, 1.0004, 0.9961, 0.9986,
        1.0013], device='cuda:0') tensor(206, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0007, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3284, device='cuda:0')
min of grad d_p:  tensor(-0.1611, device='cuda:0')
max|min: (J_L, Jta/N)  (0.3283722996711731, 0.3283733129501343, ratio: 1.0000030994415283)|(-0.1611061692237854, -0.16110597550868988)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.6561e-06, device='cuda:0') mean:  tensor(-3.3224e-10, device='cuda:0') min:  tensor(-1.5907e-06, device='cuda:0') norm:  tensor(2.5915e-05, device='cuda:0') MSE:  tensor(3.2655e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0009, device='cuda:0') mean:  tensor(9.5854e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0216, device='cuda:0') MSE:  tensor(2.7205e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0013, device='cuda:0')
min of d_p_list:  tensor(-0.0018, device='cuda:0')
Epoch:  61  
Training Loss: 0.023578982800245285
Test Loss:  0.023899393156170845
Test Acc:  0.0
Valid Loss:  0.02301730588078499
Valid Acc:  0.0
std:  0.0036872645214126383 
thres:  2.8815078735351563e-05
Preserved_eigens number check:  512
  6%|▌         | 61/1000 [14:58<3:51:13, 14.77s/it]Epoch:   62
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(10.6408, device='cuda:0') 
Std:  tensor(479.9547, device='cuda:0') 
ABS Max:  tensor(6355.2446, device='cuda:0') 
ABS Min:  tensor(0.0034, device='cuda:0')
Criterion check:  tensor([0.9540, 0.9789, 0.9772, 1.0120, 0.8813, 1.0020, 1.0050, 1.0321, 0.9622,
        1.0207], device='cuda:0') tensor(260, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(9.3129e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3158, device='cuda:0')
min of grad d_p:  tensor(-0.1505, device='cuda:0')
max|min: (J_L, Jta/N)  (0.315801739692688, 0.31579840183258057, ratio: 0.9999894499778748)|(-0.15048757195472717, -0.1504867970943451)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.7849e-06, device='cuda:0') mean:  tensor(1.3161e-09, device='cuda:0') min:  tensor(-2.8504e-06, device='cuda:0') norm:  tensor(6.8646e-05, device='cuda:0') MSE:  tensor(8.6499e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0299, device='cuda:0') mean:  tensor(0.0005, device='cuda:0') min:  tensor(2.0836e-13, device='cuda:0') norm:  tensor(0.8924, device='cuda:0') MSE:  tensor(1.1245e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0180, device='cuda:0')
min of d_p_list:  tensor(-0.0231, device='cuda:0')
Epoch:  62  
Training Loss: 0.07486392557621002
Test Loss:  0.07335953414440155
Test Acc:  0.0
Valid Loss:  0.06939032673835754
Valid Acc:  0.0
std:  0.01900047466777013 
thres:  3.74893806874752e-05
Preserved_eigens number check:  512
  6%|▌         | 62/1000 [15:12<3:51:00, 14.78s/it]Epoch:   63
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-319.3634, device='cuda:0') 
Std:  tensor(6473.0488, device='cuda:0') 
ABS Max:  tensor(145519.3750, device='cuda:0') 
ABS Min:  tensor(0.0252, device='cuda:0')
Criterion check:  tensor([0.9753, 0.8696, 1.0187, 1.0074, 0.9951, 1.0041, 0.8899, 0.9998, 1.0091,
        1.2272], device='cuda:0') tensor(287, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0014, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1589, device='cuda:0')
min of grad d_p:  tensor(-0.1480, device='cuda:0')
max|min: (J_L, Jta/N)  (0.15887099504470825, 0.15887098014354706, ratio: 0.9999998807907104)|(-0.14802223443984985, -0.14802229404449463)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.5167e-06, device='cuda:0') mean:  tensor(3.3851e-10, device='cuda:0') min:  tensor(-8.4937e-07, device='cuda:0') norm:  tensor(2.9507e-05, device='cuda:0') MSE:  tensor(3.7182e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0020, device='cuda:0') mean:  tensor(6.8074e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1159, device='cuda:0') MSE:  tensor(1.4606e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0027, device='cuda:0')
min of d_p_list:  tensor(-0.0028, device='cuda:0')
Epoch:  63  
Training Loss: 0.06599827110767365
Test Loss:  0.06644462049007416
Test Acc:  0.0
Valid Loss:  0.05927363410592079
Valid Acc:  0.0
std:  0.02192198058211077 
thres:  4.386896342039108e-05
Preserved_eigens number check:  512
  6%|▋         | 63/1000 [15:27<3:50:35, 14.77s/it]Epoch:   64
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(2.6038, device='cuda:0') 
Std:  tensor(103.8998, device='cuda:0') 
ABS Max:  tensor(1406.5496, device='cuda:0') 
ABS Min:  tensor(0.0134, device='cuda:0')
Criterion check:  tensor([1.0002, 0.9947, 0.9992, 0.9891, 0.9987, 1.0009, 1.0017, 0.9862, 0.9995,
        0.9972], device='cuda:0') tensor(270, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0006, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1423, device='cuda:0')
min of grad d_p:  tensor(-0.1427, device='cuda:0')
max|min: (J_L, Jta/N)  (0.14229300618171692, 0.14229288697242737, ratio: 0.9999991655349731)|(-0.14265719056129456, -0.14265726506710052)

 check Jacobi res:  torch.Size([793601]) max:  tensor(6.9663e-07, device='cuda:0') mean:  tensor(2.3312e-10, device='cuda:0') min:  tensor(-6.8080e-07, device='cuda:0') norm:  tensor(1.6565e-05, device='cuda:0') MSE:  tensor(2.0873e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0008, device='cuda:0') mean:  tensor(3.0182e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0471, device='cuda:0') MSE:  tensor(5.9358e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0018, device='cuda:0')
min of d_p_list:  tensor(-0.0024, device='cuda:0')
Epoch:  64  
Training Loss: 0.060407694429159164
Test Loss:  0.06166231632232666
Test Acc:  0.0
Valid Loss:  0.05350804701447487
Valid Acc:  0.0
std:  0.02112617013953538 
thres:  5.027339607477188e-05
Preserved_eigens number check:  512
  6%|▋         | 64/1000 [15:42<3:50:09, 14.75s/it]Epoch:   65
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(-0.3931, device='cuda:0') 
Std:  tensor(116.9236, device='cuda:0') 
ABS Max:  tensor(2282.5305, device='cuda:0') 
ABS Min:  tensor(0.0011, device='cuda:0')
Criterion check:  tensor([1.0002, 0.9984, 0.9960, 1.0057, 1.0008, 0.9998, 1.0010, 1.0014, 1.0008,
        1.0003], device='cuda:0') tensor(259, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(8.7868e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1450, device='cuda:0')
min of grad d_p:  tensor(-0.1388, device='cuda:0')
max|min: (J_L, Jta/N)  (0.14504262804985046, 0.14504249393939972, ratio: 0.9999990463256836)|(-0.13883835077285767, -0.13883836567401886)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.3900e-06, device='cuda:0') mean:  tensor(1.4265e-10, device='cuda:0') min:  tensor(-1.1355e-06, device='cuda:0') norm:  tensor(1.4245e-05, device='cuda:0') MSE:  tensor(1.7950e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(1.1693e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0184, device='cuda:0') MSE:  tensor(2.3196e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0119, device='cuda:0')
min of d_p_list:  tensor(-0.0203, device='cuda:0')
Epoch:  65  
Training Loss: 0.047926165163517
Test Loss:  0.05105198919773102
Test Acc:  0.0
Valid Loss:  0.043337807059288025
Valid Acc:  0.0
std:  0.017782632182179507 
thres:  5.4555007815361024e-05
Preserved_eigens number check:  512
  6%|▋         | 65/1000 [15:57<3:49:32, 14.73s/it]Epoch:   66
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.5737, device='cuda:0') 
Std:  tensor(40.6295, device='cuda:0') 
ABS Max:  tensor(686.3816, device='cuda:0') 
ABS Min:  tensor(0.0011, device='cuda:0')
Criterion check:  tensor([0.9991, 1.0002, 0.9995, 1.0006, 0.9998, 1.0002, 1.0000, 1.0021, 0.9991,
        1.0017], device='cuda:0') tensor(215, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0009, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2721, device='cuda:0')
min of grad d_p:  tensor(-0.1408, device='cuda:0')
max|min: (J_L, Jta/N)  (0.2720807194709778, 0.2720799446105957, ratio: 0.9999971389770508)|(-0.14080730080604553, -0.1408071517944336)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.0457e-06, device='cuda:0') mean:  tensor(5.8524e-10, device='cuda:0') min:  tensor(-1.1450e-06, device='cuda:0') norm:  tensor(2.4959e-05, device='cuda:0') MSE:  tensor(3.1451e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(1.2532e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0203, device='cuda:0') MSE:  tensor(2.5575e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0009, device='cuda:0')
min of d_p_list:  tensor(-0.0010, device='cuda:0')
Epoch:  66  
Training Loss: 0.04577711224555969
Test Loss:  0.04918522387742996
Test Acc:  0.0
Valid Loss:  0.04016605019569397
Valid Acc:  0.0
std:  0.01095532720968668 
thres:  5.899463370442391e-05
Preserved_eigens number check:  512
  7%|▋         | 66/1000 [16:11<3:49:24, 14.74s/it]Epoch:   67
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(69.2734, device='cuda:0') 
Std:  tensor(1732.9076, device='cuda:0') 
ABS Max:  tensor(33133.2891, device='cuda:0') 
ABS Min:  tensor(0.0246, device='cuda:0')
Criterion check:  tensor([0.9299, 1.0449, 0.9937, 1.0180, 1.0181, 0.9301, 1.0155, 0.8861, 0.9713,
        0.9490], device='cuda:0') tensor(249, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0009, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2691, device='cuda:0')
min of grad d_p:  tensor(-0.1355, device='cuda:0')
max|min: (J_L, Jta/N)  (0.26911139488220215, 0.2692352533340454, ratio: 1.0004602670669556)|(-0.13553082942962646, -0.13556525111198425)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.2500e-05, device='cuda:0') mean:  tensor(-4.6805e-08, device='cuda:0') min:  tensor(-0.0001, device='cuda:0') norm:  tensor(0.0034, device='cuda:0') MSE:  tensor(4.2740e-09, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0976, device='cuda:0') mean:  tensor(0.0023, device='cuda:0') min:  tensor(8.2053e-14, device='cuda:0') norm:  tensor(3.9551, device='cuda:0') MSE:  tensor(4.9838e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0087, device='cuda:0')
min of d_p_list:  tensor(-0.0065, device='cuda:0')
Epoch:  67  
Training Loss: 0.04643990844488144
Test Loss:  0.048495370894670486
Test Acc:  0.0
Valid Loss:  0.040439557284116745
Valid Acc:  0.0
std:  0.008298165137073994 
thres:  5.330983027815819e-05
Preserved_eigens number check:  512
  7%|▋         | 67/1000 [16:26<3:49:18, 14.75s/it]Epoch:   68
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(3.3248, device='cuda:0') 
Std:  tensor(53.2096, device='cuda:0') 
ABS Max:  tensor(1080.0400, device='cuda:0') 
ABS Min:  tensor(0.0005, device='cuda:0')
Criterion check:  tensor([1.0097, 1.0001, 1.0003, 0.9994, 1.0001, 1.0002, 0.9985, 1.0017, 1.0026,
        0.9941], device='cuda:0') tensor(237, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0012, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1223, device='cuda:0')
min of grad d_p:  tensor(-0.1235, device='cuda:0')
max|min: (J_L, Jta/N)  (0.12230760604143143, 0.12230759114027023, ratio: 0.9999998807907104)|(-0.12352724373340607, -0.12352709472179413)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.6561e-06, device='cuda:0') mean:  tensor(7.9650e-10, device='cuda:0') min:  tensor(-7.3144e-07, device='cuda:0') norm:  tensor(4.0202e-05, device='cuda:0') MSE:  tensor(5.0658e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(1.1513e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0186, device='cuda:0') MSE:  tensor(2.3463e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0012, device='cuda:0')
min of d_p_list:  tensor(-0.0014, device='cuda:0')
Epoch:  68  
Training Loss: 0.04400651901960373
Test Loss:  0.045813508331775665
Test Acc:  0.0
Valid Loss:  0.03800361976027489
Valid Acc:  0.0
std:  0.005884307281567765 
thres:  4.891147986054421e-05
Preserved_eigens number check:  512
  7%|▋         | 68/1000 [16:41<3:48:59, 14.74s/it]Epoch:   69
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(0.9923, device='cuda:0') 
Std:  tensor(25.0942, device='cuda:0') 
ABS Max:  tensor(500.4550, device='cuda:0') 
ABS Min:  tensor(0.0004, device='cuda:0')
Criterion check:  tensor([1.0318, 0.9999, 0.9998, 1.0009, 1.0003, 0.9998, 0.9977, 1.0002, 0.9988,
        0.9979], device='cuda:0') tensor(194, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0006, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1168, device='cuda:0')
min of grad d_p:  tensor(-0.1199, device='cuda:0')
max|min: (J_L, Jta/N)  (0.11675503849983215, 0.11675515025854111, ratio: 1.0000009536743164)|(-0.11993971467018127, -0.1199398785829544)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.4603e-06, device='cuda:0') mean:  tensor(-5.0587e-10, device='cuda:0') min:  tensor(-1.6661e-06, device='cuda:0') norm:  tensor(3.1735e-05, device='cuda:0') MSE:  tensor(3.9989e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(7.7349e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0125, device='cuda:0') MSE:  tensor(1.5792e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0037, device='cuda:0')
min of d_p_list:  tensor(-0.0037, device='cuda:0')
Epoch:  69  
Training Loss: 0.03464911878108978
Test Loss:  0.036421116441488266
Test Acc:  0.0
Valid Loss:  0.030738627538084984
Valid Acc:  0.0
std:  0.00472602393538577 
thres:  4.375976473093033e-05
Preserved_eigens number check:  512
  7%|▋         | 69/1000 [16:56<3:49:27, 14.79s/it]Epoch:   70
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.6605, device='cuda:0') 
Std:  tensor(35.9765, device='cuda:0') 
ABS Max:  tensor(654.7383, device='cuda:0') 
ABS Min:  tensor(0.0043, device='cuda:0')
Criterion check:  tensor([1.0214, 1.0004, 0.9985, 1.0016, 0.9991, 0.9989, 1.0016, 1.0021, 0.9970,
        1.0025], device='cuda:0') tensor(227, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0009, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1167, device='cuda:0')
min of grad d_p:  tensor(-0.1203, device='cuda:0')
max|min: (J_L, Jta/N)  (0.11674540489912033, 0.11674493551254272, ratio: 0.9999960064888)|(-0.12026319652795792, -0.1202629804611206)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.7858e-05, device='cuda:0') mean:  tensor(7.5244e-09, device='cuda:0') min:  tensor(-7.7914e-06, device='cuda:0') norm:  tensor(0.0006, device='cuda:0') MSE:  tensor(6.9385e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0024, device='cuda:0') mean:  tensor(2.9526e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0599, device='cuda:0') MSE:  tensor(7.5482e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0056, device='cuda:0')
min of d_p_list:  tensor(-0.0035, device='cuda:0')
Epoch:  70  
Training Loss: 0.033340781927108765
Test Loss:  0.03445185720920563
Test Acc:  0.0
Valid Loss:  0.029689498245716095
Valid Acc:  0.0
std:  0.005662616717742556 
thres:  4.084268808364868e-05
Preserved_eigens number check:  512
  7%|▋         | 70/1000 [17:10<3:49:05, 14.78s/it]Epoch:   71
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-1.8041, device='cuda:0') 
Std:  tensor(56.5708, device='cuda:0') 
ABS Max:  tensor(1222.2859, device='cuda:0') 
ABS Min:  tensor(0.0012, device='cuda:0')
Criterion check:  tensor([1.0030, 1.0024, 1.0001, 0.9996, 1.0001, 1.0000, 0.9960, 0.9997, 1.0101,
        0.9953], device='cuda:0') tensor(221, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0009, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1153, device='cuda:0')
min of grad d_p:  tensor(-0.1795, device='cuda:0')
max|min: (J_L, Jta/N)  (0.11526288092136383, 0.11526187509298325, ratio: 0.9999912977218628)|(-0.1795436143875122, -0.17955875396728516)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.5706e-05, device='cuda:0') mean:  tensor(3.7506e-09, device='cuda:0') min:  tensor(-7.2144e-06, device='cuda:0') norm:  tensor(0.0003, device='cuda:0') MSE:  tensor(3.4751e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(1.0419e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0175, device='cuda:0') MSE:  tensor(2.2056e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0027, device='cuda:0')
min of d_p_list:  tensor(-0.0031, device='cuda:0')
Epoch:  71  
Training Loss: 0.030731817707419395
Test Loss:  0.03141004964709282
Test Acc:  0.0
Valid Loss:  0.028739027678966522
Valid Acc:  0.0
std:  0.006211845472444856 
thres:  3.7833629176020625e-05
Preserved_eigens number check:  512
  7%|▋         | 71/1000 [17:25<3:48:18, 14.75s/it]Epoch:   72
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(1.3599, device='cuda:0') 
Std:  tensor(43.1142, device='cuda:0') 
ABS Max:  tensor(947.4658, device='cuda:0') 
ABS Min:  tensor(0.0018, device='cuda:0')
Criterion check:  tensor([1.0019, 1.0009, 1.0005, 1.0010, 0.9999, 0.9918, 1.0460, 1.0000, 1.0021,
        1.0002], device='cuda:0') tensor(201, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0008, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1122, device='cuda:0')
min of grad d_p:  tensor(-0.1102, device='cuda:0')
max|min: (J_L, Jta/N)  (0.11224634945392609, 0.11224645376205444, ratio: 1.0000009536743164)|(-0.11018688976764679, -0.11018695682287216)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.0531e-06, device='cuda:0') mean:  tensor(5.9848e-10, device='cuda:0') min:  tensor(-2.1583e-06, device='cuda:0') norm:  tensor(6.9926e-05, device='cuda:0') MSE:  tensor(8.8113e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(8.9214e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0140, device='cuda:0') MSE:  tensor(1.7694e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0011, device='cuda:0')
min of d_p_list:  tensor(-0.0012, device='cuda:0')
Epoch:  72  
Training Loss: 0.028954386711120605
Test Loss:  0.029507769271731377
Test Acc:  0.0
Valid Loss:  0.02664983458817005
Valid Acc:  0.0
std:  0.005226075596547835 
thres:  3.4336524829268455e-05
Preserved_eigens number check:  512
  7%|▋         | 72/1000 [17:40<3:47:50, 14.73s/it]Epoch:   73
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(1.1437, device='cuda:0') 
Std:  tensor(26.2338, device='cuda:0') 
ABS Max:  tensor(295.2787, device='cuda:0') 
ABS Min:  tensor(0.0033, device='cuda:0')
Criterion check:  tensor([0.9890, 1.0022, 1.0000, 0.9995, 0.9996, 1.0007, 1.0031, 0.9982, 0.9951,
        1.0018], device='cuda:0') tensor(218, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0005, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1049, device='cuda:0')
min of grad d_p:  tensor(-0.1060, device='cuda:0')
max|min: (J_L, Jta/N)  (0.10493654012680054, 0.10493606328964233, ratio: 0.9999954700469971)|(-0.10598734021186829, -0.10598720610141754)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.6417e-06, device='cuda:0') mean:  tensor(1.0092e-09, device='cuda:0') min:  tensor(-2.6941e-06, device='cuda:0') norm:  tensor(8.2160e-05, device='cuda:0') MSE:  tensor(1.0353e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0006, device='cuda:0') mean:  tensor(1.4672e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0244, device='cuda:0') MSE:  tensor(3.0750e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0207, device='cuda:0')
min of d_p_list:  tensor(-0.0202, device='cuda:0')
Epoch:  73  
Training Loss: 0.05215063318610191
Test Loss:  0.05477987974882126
Test Acc:  0.0
Valid Loss:  0.04776249825954437
Valid Acc:  0.0
std:  0.008332198755438548 
thres:  3.596534766256809e-05
Preserved_eigens number check:  512
  7%|▋         | 73/1000 [17:55<3:47:43, 14.74s/it]Epoch:   74
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.5431, device='cuda:0') 
Std:  tensor(89.7365, device='cuda:0') 
ABS Max:  tensor(1370.3269, device='cuda:0') 
ABS Min:  tensor(0.0018, device='cuda:0')
Criterion check:  tensor([0.9907, 0.9993, 1.0117, 0.9990, 1.0033, 0.9906, 1.0031, 1.0087, 0.9982,
        0.9147], device='cuda:0') tensor(278, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0007, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1792, device='cuda:0')
min of grad d_p:  tensor(-0.3734, device='cuda:0')
max|min: (J_L, Jta/N)  (0.17916527390480042, 0.17916633188724518, ratio: 1.0000059604644775)|(-0.3734329044818878, -0.37343475222587585)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.9670e-06, device='cuda:0') mean:  tensor(3.8123e-10, device='cuda:0') min:  tensor(-1.1921e-06, device='cuda:0') norm:  tensor(3.3455e-05, device='cuda:0') MSE:  tensor(4.2157e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0044, device='cuda:0') mean:  tensor(7.5143e-05, device='cuda:0') min:  tensor(1.0009e-13, device='cuda:0') norm:  tensor(0.1408, device='cuda:0') MSE:  tensor(1.7739e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0008, device='cuda:0')
min of d_p_list:  tensor(-0.0007, device='cuda:0')
Epoch:  74  
Training Loss: 0.040585823357105255
Test Loss:  0.04238449037075043
Test Acc:  0.0
Valid Loss:  0.03662030026316643
Valid Acc:  0.0
std:  0.008481687631968686 
thres:  3.715268857777119e-05
Preserved_eigens number check:  512
  7%|▋         | 74/1000 [18:10<3:48:42, 14.82s/it]Epoch:   75
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-4.0507, device='cuda:0') 
Std:  tensor(113.4711, device='cuda:0') 
ABS Max:  tensor(1577.7593, device='cuda:0') 
ABS Min:  tensor(0.0024, device='cuda:0')
Criterion check:  tensor([1.0001, 1.0002, 0.9993, 1.0002, 0.9963, 1.0004, 1.0410, 0.9991, 1.0004,
        1.0018], device='cuda:0') tensor(208, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0002, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1768, device='cuda:0')
min of grad d_p:  tensor(-0.3301, device='cuda:0')
max|min: (J_L, Jta/N)  (0.17681564390659332, 0.17681293189525604, ratio: 0.9999846816062927)|(-0.3300892114639282, -0.330083966255188)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.8759e-06, device='cuda:0') mean:  tensor(-8.7629e-10, device='cuda:0') min:  tensor(-5.5432e-06, device='cuda:0') norm:  tensor(9.5563e-05, device='cuda:0') MSE:  tensor(1.2042e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(1.0915e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0176, device='cuda:0') MSE:  tensor(2.2188e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0022, device='cuda:0')
min of d_p_list:  tensor(-0.0026, device='cuda:0')
Epoch:  75  
Training Loss: 0.03795602172613144
Test Loss:  0.03991507738828659
Test Acc:  0.0
Valid Loss:  0.033776503056287766
Valid Acc:  0.0
std:  0.00826498335854158 
thres:  3.807573653757572e-05
Preserved_eigens number check:  512
  8%|▊         | 75/1000 [18:25<3:49:00, 14.85s/it]Epoch:   76
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-52.0060, device='cuda:0') 
Std:  tensor(858.1458, device='cuda:0') 
ABS Max:  tensor(16857.8945, device='cuda:0') 
ABS Min:  tensor(2.0280e-05, device='cuda:0')
Criterion check:  tensor([1.0086, 0.9922, 1.0046, 0.9999, 0.9761, 0.9999, 1.0083, 1.0058, 1.0031,
        0.9999], device='cuda:0') tensor(249, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0008, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1228, device='cuda:0')
min of grad d_p:  tensor(-0.1338, device='cuda:0')
max|min: (J_L, Jta/N)  (0.12281971424818039, 0.12260744720697403, ratio: 0.9982717037200928)|(-0.13383731245994568, -0.13360361754894257)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(-1.6368e-08, device='cuda:0') min:  tensor(-0.0002, device='cuda:0') norm:  tensor(0.0051, device='cuda:0') MSE:  tensor(6.3971e-09, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0025, device='cuda:0') mean:  tensor(7.3508e-05, device='cuda:0') min:  tensor(9.0298e-16, device='cuda:0') norm:  tensor(0.1208, device='cuda:0') MSE:  tensor(1.5216e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0021, device='cuda:0')
min of d_p_list:  tensor(-0.0017, device='cuda:0')
Epoch:  76  
Training Loss: 0.03365956246852875
Test Loss:  0.03544803336262703
Test Acc:  0.0
Valid Loss:  0.02998875267803669
Valid Acc:  0.0
std:  0.007815431674985125 
thres:  3.8661285489797596e-05
Preserved_eigens number check:  512
  8%|▊         | 76/1000 [18:39<3:47:56, 14.80s/it]Epoch:   77
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-1.6602, device='cuda:0') 
Std:  tensor(37.2449, device='cuda:0') 
ABS Max:  tensor(799.3284, device='cuda:0') 
ABS Min:  tensor(0.0045, device='cuda:0')
Criterion check:  tensor([1.0007, 0.9974, 1.0009, 1.0347, 0.9969, 0.9979, 0.9999, 0.9986, 0.9988,
        0.9916], device='cuda:0') tensor(228, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0002, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1751, device='cuda:0')
min of grad d_p:  tensor(-0.2299, device='cuda:0')
max|min: (J_L, Jta/N)  (0.1751437783241272, 0.17515334486961365, ratio: 1.0000545978546143)|(-0.22994889318943024, -0.2299664318561554)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.7688e-05, device='cuda:0') mean:  tensor(2.6845e-09, device='cuda:0') min:  tensor(-9.8795e-06, device='cuda:0') norm:  tensor(0.0003, device='cuda:0') MSE:  tensor(4.1095e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0007, device='cuda:0') mean:  tensor(2.1585e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0374, device='cuda:0') MSE:  tensor(4.7136e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0098, device='cuda:0')
min of d_p_list:  tensor(-0.0092, device='cuda:0')
Epoch:  77  
Training Loss: 0.039280347526073456
Test Loss:  0.040653046220541
Test Acc:  0.0
Valid Loss:  0.03602254018187523
Valid Acc:  0.0
std:  0.006168291852477358 
thres:  4.072647765278816e-05
Preserved_eigens number check:  512
  8%|▊         | 77/1000 [18:54<3:47:18, 14.78s/it]Epoch:   78
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(0.8561, device='cuda:0') 
Std:  tensor(24.6444, device='cuda:0') 
ABS Max:  tensor(471.1213, device='cuda:0') 
ABS Min:  tensor(0.0004, device='cuda:0')
Criterion check:  tensor([0.8789, 1.0004, 0.9693, 1.0011, 1.0006, 0.9984, 1.0047, 0.9996, 0.9996,
        0.9930], device='cuda:0') tensor(223, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(7.2706e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1177, device='cuda:0')
min of grad d_p:  tensor(-0.1247, device='cuda:0')
max|min: (J_L, Jta/N)  (0.11766920238733292, 0.11766935139894485, ratio: 1.000001311302185)|(-0.12472791224718094, -0.12472805380821228)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.4529e-06, device='cuda:0') mean:  tensor(-8.2163e-10, device='cuda:0') min:  tensor(-3.7178e-06, device='cuda:0') norm:  tensor(6.5241e-05, device='cuda:0') MSE:  tensor(8.2209e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0011, device='cuda:0') mean:  tensor(1.1059e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0264, device='cuda:0') MSE:  tensor(3.3248e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0009, device='cuda:0')
min of d_p_list:  tensor(-0.0008, device='cuda:0')
Epoch:  78  
Training Loss: 0.033722907304763794
Test Loss:  0.034558527171611786
Test Acc:  0.0
Valid Loss:  0.03068581223487854
Valid Acc:  0.0
std:  0.0028587260668181554 
thres:  3.704093247652054e-05
Preserved_eigens number check:  512
  8%|▊         | 78/1000 [19:09<3:46:40, 14.75s/it]Epoch:   79
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-2.5363, device='cuda:0') 
Std:  tensor(59.3116, device='cuda:0') 
ABS Max:  tensor(1319.1903, device='cuda:0') 
ABS Min:  tensor(0.0025, device='cuda:0')
Criterion check:  tensor([0.9992, 1.0005, 1.0003, 0.9993, 0.9990, 0.9994, 1.0008, 1.0001, 1.0027,
        0.9974], device='cuda:0') tensor(216, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0001, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1208, device='cuda:0')
min of grad d_p:  tensor(-0.1188, device='cuda:0')
max|min: (J_L, Jta/N)  (0.12076166272163391, 0.1207641214132309, ratio: 1.0000203847885132)|(-0.11875967681407928, -0.1187596470117569)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.2245e-06, device='cuda:0') mean:  tensor(6.3594e-10, device='cuda:0') min:  tensor(-2.6301e-06, device='cuda:0') norm:  tensor(8.2353e-05, device='cuda:0') MSE:  tensor(1.0377e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(5.8173e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0090, device='cuda:0') MSE:  tensor(1.1287e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0013, device='cuda:0')
min of d_p_list:  tensor(-0.0011, device='cuda:0')
Epoch:  79  
Training Loss: 0.030933164060115814
Test Loss:  0.03125164285302162
Test Acc:  0.0
Valid Loss:  0.02789393998682499
Valid Acc:  0.0
std:  0.003064812914288735 
thres:  3.5110400617122654e-05
Preserved_eigens number check:  512
  8%|▊         | 79/1000 [19:23<3:46:10, 14.73s/it]Epoch:   80
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(2.6193, device='cuda:0') 
Std:  tensor(33.7781, device='cuda:0') 
ABS Max:  tensor(550.5170, device='cuda:0') 
ABS Min:  tensor(0.0031, device='cuda:0')
Criterion check:  tensor([0.9993, 1.0004, 0.9995, 0.9994, 0.9988, 1.0009, 1.0001, 0.9999, 1.0057,
        0.9998], device='cuda:0') tensor(236, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(2.4613e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1319, device='cuda:0')
min of grad d_p:  tensor(-0.1170, device='cuda:0')
max|min: (J_L, Jta/N)  (0.1319434940814972, 0.13194546103477478, ratio: 1.0000149011611938)|(-0.11698130518198013, -0.11698155105113983)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.6683e-06, device='cuda:0') mean:  tensor(9.1366e-10, device='cuda:0') min:  tensor(-2.1309e-06, device='cuda:0') norm:  tensor(8.4495e-05, device='cuda:0') MSE:  tensor(1.0647e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(8.7604e-05, device='cuda:0') mean:  tensor(3.9280e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0060, device='cuda:0') MSE:  tensor(7.5790e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0012, device='cuda:0')
min of d_p_list:  tensor(-0.0010, device='cuda:0')
Epoch:  80  
Training Loss: 0.027106471359729767
Test Loss:  0.027344943955540657
Test Acc:  0.0
Valid Loss:  0.024623055011034012
Valid Acc:  0.0
std:  0.003984674803008423 
thres:  3.2940490543842315e-05
Preserved_eigens number check:  512
  8%|▊         | 80/1000 [19:38<3:45:25, 14.70s/it]Epoch:   81
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(8.1011, device='cuda:0') 
Std:  tensor(194.6923, device='cuda:0') 
ABS Max:  tensor(3924.9497, device='cuda:0') 
ABS Min:  tensor(0.0019, device='cuda:0')
Criterion check:  tensor([0.9989, 1.0004, 0.9992, 1.0000, 1.0011, 1.0014, 0.9984, 1.0003, 0.9881,
        0.9996], device='cuda:0') tensor(231, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0001, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1323, device='cuda:0')
min of grad d_p:  tensor(-0.1129, device='cuda:0')
max|min: (J_L, Jta/N)  (0.13225311040878296, 0.13225463032722473, ratio: 1.0000114440917969)|(-0.11289175599813461, -0.11289185285568237)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.7046e-06, device='cuda:0') mean:  tensor(3.9222e-10, device='cuda:0') min:  tensor(-1.6540e-06, device='cuda:0') norm:  tensor(5.4420e-05, device='cuda:0') MSE:  tensor(6.8574e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(5.8798e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0096, device='cuda:0') MSE:  tensor(1.2067e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0009, device='cuda:0')
min of d_p_list:  tensor(-0.0007, device='cuda:0')
Epoch:  81  
Training Loss: 0.02430003695189953
Test Loss:  0.024765102192759514
Test Acc:  0.0
Valid Loss:  0.022217202931642532
Valid Acc:  0.0
std:  0.005215522920877813 
thres:  3.1068585440516474e-05
Preserved_eigens number check:  512
  8%|▊         | 81/1000 [19:53<3:45:08, 14.70s/it]Epoch:   82
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(4.5197, device='cuda:0') 
Std:  tensor(77.2068, device='cuda:0') 
ABS Max:  tensor(981.0718, device='cuda:0') 
ABS Min:  tensor(0.0098, device='cuda:0')
Criterion check:  tensor([0.9815, 1.0006, 1.0011, 0.9966, 1.0015, 0.9997, 1.0806, 1.0002, 1.0210,
        1.0004], device='cuda:0') tensor(270, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0003, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1015, device='cuda:0')
min of grad d_p:  tensor(-0.1086, device='cuda:0')
max|min: (J_L, Jta/N)  (0.10154738277196884, 0.10154564678668976, ratio: 0.9999828934669495)|(-0.10859208554029465, -0.10859168320894241)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.8030e-06, device='cuda:0') mean:  tensor(-4.8440e-10, device='cuda:0') min:  tensor(-2.8061e-06, device='cuda:0') norm:  tensor(5.6032e-05, device='cuda:0') MSE:  tensor(7.0604e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0016, device='cuda:0') mean:  tensor(3.2459e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0575, device='cuda:0') MSE:  tensor(7.2426e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0039, device='cuda:0')
min of d_p_list:  tensor(-0.0032, device='cuda:0')
Epoch:  82  
Training Loss: 0.023131394758820534
Test Loss:  0.023736469447612762
Test Acc:  0.0
Valid Loss:  0.02132955566048622
Valid Acc:  0.0
std:  0.003985388838319936 
thres:  2.7838794887065888e-05
Preserved_eigens number check:  512
  8%|▊         | 82/1000 [20:07<3:44:50, 14.70s/it]Epoch:   83
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(-0.9866, device='cuda:0') 
Std:  tensor(51.5473, device='cuda:0') 
ABS Max:  tensor(1047.6967, device='cuda:0') 
ABS Min:  tensor(0.0015, device='cuda:0')
Criterion check:  tensor([0.9981, 1.0004, 0.9893, 1.0022, 1.0007, 0.9999, 1.0007, 0.9998, 0.9953,
        0.9955], device='cuda:0') tensor(239, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(4.1932e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1063, device='cuda:0')
min of grad d_p:  tensor(-0.0908, device='cuda:0')
max|min: (J_L, Jta/N)  (0.10628744959831238, 0.10628653317689896, ratio: 0.9999913573265076)|(-0.09082494676113129, -0.09082484245300293)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.0431e-06, device='cuda:0') mean:  tensor(-7.2567e-11, device='cuda:0') min:  tensor(-1.2368e-06, device='cuda:0') norm:  tensor(2.6583e-05, device='cuda:0') MSE:  tensor(3.3497e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(4.6637e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0076, device='cuda:0') MSE:  tensor(9.5468e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0047, device='cuda:0')
min of d_p_list:  tensor(-0.0050, device='cuda:0')
Epoch:  83  
Training Loss: 0.0247614998370409
Test Loss:  0.02523866295814514
Test Acc:  0.0
Valid Loss:  0.02276814915239811
Valid Acc:  0.0
std:  0.0027641353832008773 
thres:  2.604651339352131e-05
Preserved_eigens number check:  512
  8%|▊         | 83/1000 [20:22<3:44:29, 14.69s/it]Epoch:   84
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-108.5499, device='cuda:0') 
Std:  tensor(3121.4563, device='cuda:0') 
ABS Max:  tensor(47774.4883, device='cuda:0') 
ABS Min:  tensor(0.1275, device='cuda:0')
Criterion check:  tensor([0.8784, 0.9920, 1.0018, 0.2663, 0.9949, 0.9881, 0.9979, 1.0031, 1.1095,
        1.0352], device='cuda:0') tensor(265, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0012, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3075, device='cuda:0')
min of grad d_p:  tensor(-0.1603, device='cuda:0')
max|min: (J_L, Jta/N)  (0.3074962794780731, 0.3074912130832672, ratio: 0.999983549118042)|(-0.16030554473400116, -0.16029416024684906)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.3346e-06, device='cuda:0') mean:  tensor(-1.9942e-09, device='cuda:0') min:  tensor(-1.1533e-05, device='cuda:0') norm:  tensor(0.0002, device='cuda:0') MSE:  tensor(2.5848e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0462, device='cuda:0') mean:  tensor(0.0006, device='cuda:0') min:  tensor(2.9705e-13, device='cuda:0') norm:  tensor(1.3388, device='cuda:0') MSE:  tensor(1.6870e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0151, device='cuda:0')
min of d_p_list:  tensor(-0.0243, device='cuda:0')
Epoch:  84  
Training Loss: 0.07014747709035873
Test Loss:  0.07055975496768951
Test Acc:  0.0
Valid Loss:  0.06935186684131622
Valid Acc:  0.0
std:  0.018175067521464583 
thres:  3.388937599956989e-05
Preserved_eigens number check:  512
  8%|▊         | 84/1000 [20:37<3:44:06, 14.68s/it]Epoch:   85
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(0.0209, device='cuda:0') 
Std:  tensor(6.9876, device='cuda:0') 
ABS Max:  tensor(100.0444, device='cuda:0') 
ABS Min:  tensor(0.0006, device='cuda:0')
Criterion check:  tensor([1.0013, 0.9999, 1.0004, 1.0002, 1.0007, 0.9419, 0.9997, 0.9985, 1.1169,
        1.0005], device='cuda:0') tensor(197, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0003, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.5315, device='cuda:0')
min of grad d_p:  tensor(-0.5397, device='cuda:0')
max|min: (J_L, Jta/N)  (0.5314508676528931, 0.5314493179321289, ratio: 0.999997079372406)|(-0.539652943611145, -0.5396576523780823)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.6624e-06, device='cuda:0') mean:  tensor(1.7557e-09, device='cuda:0') min:  tensor(-7.7486e-07, device='cuda:0') norm:  tensor(7.9591e-05, device='cuda:0') MSE:  tensor(1.0029e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0010, device='cuda:0') mean:  tensor(9.7824e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0233, device='cuda:0') MSE:  tensor(2.9391e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0019, device='cuda:0')
min of d_p_list:  tensor(-0.0017, device='cuda:0')
Epoch:  85  
Training Loss: 0.051296379417181015
Test Loss:  0.0528518408536911
Test Acc:  0.0
Valid Loss:  0.0486556701362133
Valid Acc:  0.0
std:  0.01892950627623951 
thres:  3.8727357611060146e-05
Preserved_eigens number check:  512
  8%|▊         | 85/1000 [20:52<3:46:49, 14.87s/it]Epoch:   86
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(3.5006, device='cuda:0') 
Std:  tensor(104.1028, device='cuda:0') 
ABS Max:  tensor(2288.4084, device='cuda:0') 
ABS Min:  tensor(0.0021, device='cuda:0')
Criterion check:  tensor([1.0022, 1.0007, 1.0003, 0.9941, 0.9996, 1.0556, 1.0001, 1.0730, 1.0126,
        1.0026], device='cuda:0') tensor(213, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0011, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.4806, device='cuda:0')
min of grad d_p:  tensor(-0.5072, device='cuda:0')
max|min: (J_L, Jta/N)  (0.4805813431739807, 0.4803232252597809, ratio: 0.999462902545929)|(-0.5072429180145264, -0.5070697665214539)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(3.2566e-08, device='cuda:0') min:  tensor(-0.0002, device='cuda:0') norm:  tensor(0.0051, device='cuda:0') MSE:  tensor(6.4625e-09, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0021, device='cuda:0') mean:  tensor(2.6591e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0594, device='cuda:0') MSE:  tensor(7.4851e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0059, device='cuda:0')
min of d_p_list:  tensor(-0.0056, device='cuda:0')
Epoch:  86  
Training Loss: 0.053178586065769196
Test Loss:  0.05591322481632233
Test Acc:  0.0
Valid Loss:  0.04830171912908554
Valid Acc:  0.0
std:  0.018030681307008165 
thres:  4.4503067433834074e-05
Preserved_eigens number check:  512
  9%|▊         | 86/1000 [21:07<3:45:38, 14.81s/it]Epoch:   87
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(-0.5234, device='cuda:0') 
Std:  tensor(27.0155, device='cuda:0') 
ABS Max:  tensor(306.7967, device='cuda:0') 
ABS Min:  tensor(0.0027, device='cuda:0')
Criterion check:  tensor([1.0018, 1.0009, 1.0012, 1.0011, 1.0006, 1.0279, 0.9996, 0.9993, 0.9968,
        1.0038], device='cuda:0') tensor(223, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(2.9362e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.5580, device='cuda:0')
min of grad d_p:  tensor(-0.4299, device='cuda:0')
max|min: (J_L, Jta/N)  (0.5579955577850342, 0.5579977035522461, ratio: 1.0000038146972656)|(-0.429904043674469, -0.42990249395370483)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.0513e-07, device='cuda:0') mean:  tensor(-1.3593e-09, device='cuda:0') min:  tensor(-2.9802e-06, device='cuda:0') norm:  tensor(4.6227e-05, device='cuda:0') MSE:  tensor(5.8250e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0009, device='cuda:0') mean:  tensor(1.4657e-05, device='cuda:0') min:  tensor(2.4480e-13, device='cuda:0') norm:  tensor(0.0282, device='cuda:0') MSE:  tensor(3.5480e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0021, device='cuda:0')
min of d_p_list:  tensor(-0.0023, device='cuda:0')
Epoch:  87  
Training Loss: 0.047127772122621536
Test Loss:  0.0495402067899704
Test Acc:  0.0
Valid Loss:  0.04186849668622017
Valid Acc:  0.0
std:  0.014563672602971426 
thres:  4.930234290659428e-05
Preserved_eigens number check:  512
  9%|▊         | 87/1000 [21:21<3:45:08, 14.80s/it]Epoch:   88
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.5921, device='cuda:0') 
Std:  tensor(21.1359, device='cuda:0') 
ABS Max:  tensor(281.9559, device='cuda:0') 
ABS Min:  tensor(0.0022, device='cuda:0')
Criterion check:  tensor([1.0011, 0.9998, 0.9990, 0.9997, 0.9992, 1.0060, 0.9973, 1.0019, 1.0008,
        1.0011], device='cuda:0') tensor(212, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0004, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.5741, device='cuda:0')
min of grad d_p:  tensor(-0.4597, device='cuda:0')
max|min: (J_L, Jta/N)  (0.5741111040115356, 0.5740604400634766, ratio: 0.9999117255210876)|(-0.45969900488853455, -0.4597897231578827)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(7.3282e-08, device='cuda:0') min:  tensor(-8.3173e-05, device='cuda:0') norm:  tensor(0.0054, device='cuda:0') MSE:  tensor(6.8214e-09, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0022, device='cuda:0') mean:  tensor(4.9630e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0811, device='cuda:0') MSE:  tensor(1.0223e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0085, device='cuda:0')
min of d_p_list:  tensor(-0.0083, device='cuda:0')
Epoch:  88  
Training Loss: 0.032110199332237244
Test Loss:  0.03355088084936142
Test Acc:  0.0
Valid Loss:  0.03190431743860245
Valid Acc:  0.0
std:  0.012190315366678769 
thres:  5.077208280563354e-05
Preserved_eigens number check:  512
  9%|▉         | 88/1000 [21:36<3:44:13, 14.75s/it]Epoch:   89
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(2.3783, device='cuda:0') 
Std:  tensor(110.6093, device='cuda:0') 
ABS Max:  tensor(1902.9740, device='cuda:0') 
ABS Min:  tensor(0.0123, device='cuda:0')
Criterion check:  tensor([0.9934, 0.9936, 0.9858, 1.0086, 0.9896, 1.0170, 1.0053, 1.0046, 0.9823,
        1.0167], device='cuda:0') tensor(267, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0001, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3220, device='cuda:0')
min of grad d_p:  tensor(-0.3267, device='cuda:0')
max|min: (J_L, Jta/N)  (0.32200685143470764, 0.3219952881336212, ratio: 0.9999641180038452)|(-0.3267102539539337, -0.3266119062900543)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.0640e-05, device='cuda:0') mean:  tensor(-3.2312e-08, device='cuda:0') min:  tensor(-9.8795e-05, device='cuda:0') norm:  tensor(0.0017, device='cuda:0') MSE:  tensor(2.1282e-09, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0052, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(4.3178e-14, device='cuda:0') norm:  tensor(0.2233, device='cuda:0') MSE:  tensor(2.8142e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0044, device='cuda:0')
min of d_p_list:  tensor(-0.0039, device='cuda:0')
Epoch:  89  
Training Loss: 0.04118210822343826
Test Loss:  0.04203728958964348
Test Acc:  0.0
Valid Loss:  0.03664557635784149
Valid Acc:  0.0
std:  0.007639137827983726 
thres:  4.4979009032249453e-05
Preserved_eigens number check:  512
  9%|▉         | 89/1000 [21:51<3:43:41, 14.73s/it]Epoch:   90
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(-2.5988, device='cuda:0') 
Std:  tensor(44.9289, device='cuda:0') 
ABS Max:  tensor(907.9721, device='cuda:0') 
ABS Min:  tensor(1.7580e-05, device='cuda:0')
Criterion check:  tensor([1.0002, 0.9996, 1.0017, 1.0013, 0.9977, 1.0022, 0.9984, 1.0002, 1.0036,
        0.9978], device='cuda:0') tensor(164, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(9.8847e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.6194, device='cuda:0')
min of grad d_p:  tensor(-1.4985, device='cuda:0')
max|min: (J_L, Jta/N)  (1.6193660497665405, 1.6193604469299316, ratio: 0.999996542930603)|(-1.498536467552185, -1.4985358715057373)

 check Jacobi res:  torch.Size([793601]) max:  tensor(7.6294e-06, device='cuda:0') mean:  tensor(1.2051e-09, device='cuda:0') min:  tensor(-2.9802e-06, device='cuda:0') norm:  tensor(9.4374e-05, device='cuda:0') MSE:  tensor(1.1892e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0007, device='cuda:0') mean:  tensor(2.7107e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0481, device='cuda:0') MSE:  tensor(6.0659e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0511, device='cuda:0')
min of d_p_list:  tensor(-0.0545, device='cuda:0')
Epoch:  90  
Training Loss: 0.738572359085083
Test Loss:  0.7721977233886719
Test Acc:  0.0
Valid Loss:  0.661018967628479
Valid Acc:  0.0
std:  0.27815605467327575 
thres:  0.00018243420496582985
Preserved_eigens number check:  512
  9%|▉         | 90/1000 [22:05<3:43:20, 14.73s/it]Epoch:   91
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-11.1435, device='cuda:0') 
Std:  tensor(209.4990, device='cuda:0') 
ABS Max:  tensor(3179.7439, device='cuda:0') 
ABS Min:  tensor(0.0317, device='cuda:0')
Criterion check:  tensor([1.0039, 0.9990, 1.0184, 1.0049, 0.9984, 1.0013, 0.9997, 0.9840, 1.0009,
        1.0052], device='cuda:0') tensor(262, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0001, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.4893, device='cuda:0')
min of grad d_p:  tensor(-0.6340, device='cuda:0')
max|min: (J_L, Jta/N)  (0.4893059730529785, 0.48966825008392334, ratio: 1.0007404088974)|(-0.6339693069458008, -0.6344972252845764)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(-6.9075e-08, device='cuda:0') min:  tensor(-0.0004, device='cuda:0') norm:  tensor(0.0126, device='cuda:0') MSE:  tensor(1.5930e-08, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0065, device='cuda:0') mean:  tensor(0.0002, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.2859, device='cuda:0') MSE:  tensor(3.6025e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0052, device='cuda:0')
min of d_p_list:  tensor(-0.0068, device='cuda:0')
Epoch:  91  
Training Loss: 0.20431262254714966
Test Loss:  0.21865488588809967
Test Acc:  0.0
Valid Loss:  0.18776920437812805
Valid Acc:  0.0
std:  0.27057616469268153 
thres:  0.00021266101226210594
Preserved_eigens number check:  512
  9%|▉         | 91/1000 [22:20<3:42:57, 14.72s/it]Epoch:   92
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(2.2858, device='cuda:0') 
Std:  tensor(108.2886, device='cuda:0') 
ABS Max:  tensor(1880.4780, device='cuda:0') 
ABS Min:  tensor(0.0131, device='cuda:0')
Criterion check:  tensor([1.0009, 0.9993, 1.0049, 1.0035, 1.0009, 0.9988, 1.0015, 0.9866, 1.0007,
        0.9942], device='cuda:0') tensor(253, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(5.8260e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.4632, device='cuda:0')
min of grad d_p:  tensor(-0.4910, device='cuda:0')
max|min: (J_L, Jta/N)  (0.46315187215805054, 0.4631494879722595, ratio: 0.9999948740005493)|(-0.49097195267677307, -0.4909728467464447)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.8312e-06, device='cuda:0') mean:  tensor(8.8521e-10, device='cuda:0') min:  tensor(-6.7055e-07, device='cuda:0') norm:  tensor(4.1108e-05, device='cuda:0') MSE:  tensor(5.1799e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0026, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(3.5013e-13, device='cuda:0') norm:  tensor(0.1694, device='cuda:0') MSE:  tensor(2.1352e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0188, device='cuda:0')
min of d_p_list:  tensor(-0.0133, device='cuda:0')
Epoch:  92  
Training Loss: 0.0796445682644844
Test Loss:  0.08304283022880554
Test Acc:  0.0
Valid Loss:  0.09409086406230927
Valid Acc:  0.0
std:  0.26688497779958903 
thres:  0.00021916437149047853
Preserved_eigens number check:  512
  9%|▉         | 92/1000 [22:35<3:43:19, 14.76s/it]Epoch:   93
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(8.6507, device='cuda:0') 
Std:  tensor(96.2656, device='cuda:0') 
ABS Max:  tensor(1440.7603, device='cuda:0') 
ABS Min:  tensor(0.0357, device='cuda:0')
Criterion check:  tensor([1.0075, 0.9913, 0.9976, 0.9977, 1.0030, 1.0028, 0.9968, 1.0069, 0.9998,
        0.9922], device='cuda:0') tensor(259, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(9.2153e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2105, device='cuda:0')
min of grad d_p:  tensor(-0.1865, device='cuda:0')
max|min: (J_L, Jta/N)  (0.21054024994373322, 0.21054019033908844, ratio: 0.9999997019767761)|(-0.1865471750497818, -0.1865471601486206)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.5986e-05, device='cuda:0') mean:  tensor(-8.8442e-09, device='cuda:0') min:  tensor(-5.7663e-05, device='cuda:0') norm:  tensor(0.0016, device='cuda:0') MSE:  tensor(1.9933e-09, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0010, device='cuda:0') mean:  tensor(3.7451e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0603, device='cuda:0') MSE:  tensor(7.5950e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0065, device='cuda:0')
min of d_p_list:  tensor(-0.0060, device='cuda:0')
Epoch:  93  
Training Loss: 0.0878462865948677
Test Loss:  0.09082375466823578
Test Acc:  0.0
Valid Loss:  0.09023139625787735
Valid Acc:  0.0
std:  0.2599122277576074 
thres:  0.0002303115889430046
Preserved_eigens number check:  512
  9%|▉         | 93/1000 [22:50<3:43:08, 14.76s/it]Epoch:   94
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(0.0666, device='cuda:0') 
Std:  tensor(125.0625, device='cuda:0') 
ABS Max:  tensor(2182.4043, device='cuda:0') 
ABS Min:  tensor(0.0041, device='cuda:0')
Criterion check:  tensor([0.9984, 1.0074, 0.9971, 1.0005, 0.9995, 1.0015, 1.0002, 0.9996, 1.0006,
        1.0032], device='cuda:0') tensor(213, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0003, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.0384, device='cuda:0')
min of grad d_p:  tensor(-0.2276, device='cuda:0')
max|min: (J_L, Jta/N)  (1.038448691368103, 1.0384521484375, ratio: 1.0000033378601074)|(-0.2275504767894745, -0.22755077481269836)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.2480e-06, device='cuda:0') mean:  tensor(-1.0694e-09, device='cuda:0') min:  tensor(-7.6294e-06, device='cuda:0') norm:  tensor(5.5725e-05, device='cuda:0') MSE:  tensor(7.0218e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0013, device='cuda:0') mean:  tensor(3.0128e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0524, device='cuda:0') MSE:  tensor(6.5991e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0167, device='cuda:0')
min of d_p_list:  tensor(-0.0136, device='cuda:0')
Epoch:  94  
Training Loss: 0.11512387543916702
Test Loss:  0.1237720474600792
Test Acc:  0.0
Valid Loss:  0.1240750178694725
Valid Acc:  0.0
std:  0.250669743912904 
thres:  0.0002450999423861504
Preserved_eigens number check:  512
  9%|▉         | 94/1000 [23:05<3:42:56, 14.76s/it]Epoch:   95
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-1.2518, device='cuda:0') 
Std:  tensor(23.2284, device='cuda:0') 
ABS Max:  tensor(353.8426, device='cuda:0') 
ABS Min:  tensor(0.0017, device='cuda:0')
Criterion check:  tensor([0.9997, 1.0000, 1.0003, 1.0011, 0.9998, 0.9994, 0.9992, 1.0004, 1.0025,
        1.0007], device='cuda:0') tensor(237, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0002, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1680, device='cuda:0')
min of grad d_p:  tensor(-0.1379, device='cuda:0')
max|min: (J_L, Jta/N)  (0.16796913743019104, 0.16796907782554626, ratio: 0.9999996423721313)|(-0.13790357112884521, -0.13790369033813477)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.3447e-07, device='cuda:0') mean:  tensor(2.3515e-10, device='cuda:0') min:  tensor(-2.6794e-06, device='cuda:0') norm:  tensor(1.3529e-05, device='cuda:0') MSE:  tensor(1.7048e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(1.1616e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0172, device='cuda:0') MSE:  tensor(2.1627e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0044, device='cuda:0')
min of d_p_list:  tensor(-0.0041, device='cuda:0')
Epoch:  95  
Training Loss: 0.0911169946193695
Test Loss:  0.09606198966503143
Test Acc:  0.0
Valid Loss:  0.09840653091669083
Valid Acc:  0.0
std:  0.04589691695959646 
thres:  0.00011560886949300767
Preserved_eigens number check:  512
 10%|▉         | 95/1000 [23:19<3:42:15, 14.74s/it]Epoch:   96
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(7.1402, device='cuda:0') 
Std:  tensor(131.1005, device='cuda:0') 
ABS Max:  tensor(1833.1205, device='cuda:0') 
ABS Min:  tensor(0.0018, device='cuda:0')
Criterion check:  tensor([0.9974, 0.9980, 1.0024, 1.0021, 1.0005, 0.9992, 0.9986, 0.9988, 1.0016,
        1.0044], device='cuda:0') tensor(256, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0004, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1690, device='cuda:0')
min of grad d_p:  tensor(-0.1338, device='cuda:0')
max|min: (J_L, Jta/N)  (0.16900254786014557, 0.1689983755350113, ratio: 0.999975323677063)|(-0.1338009238243103, -0.13380098342895508)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.6790e-06, device='cuda:0') mean:  tensor(8.4568e-10, device='cuda:0') min:  tensor(-2.4103e-06, device='cuda:0') norm:  tensor(7.9911e-05, device='cuda:0') MSE:  tensor(1.0069e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0013, device='cuda:0') mean:  tensor(4.7741e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0723, device='cuda:0') MSE:  tensor(9.1165e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0027, device='cuda:0')
min of d_p_list:  tensor(-0.0030, device='cuda:0')
Epoch:  96  
Training Loss: 0.07671728730201721
Test Loss:  0.07931626588106155
Test Acc:  0.0
Valid Loss:  0.08421880006790161
Valid Acc:  0.0
std:  0.01356996961046913 
thres:  9.008980244398117e-05
Preserved_eigens number check:  512
 10%|▉         | 96/1000 [23:34<3:41:41, 14.71s/it]Epoch:   97
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-27.9614, device='cuda:0') 
Std:  tensor(847.2397, device='cuda:0') 
ABS Max:  tensor(14327.5635, device='cuda:0') 
ABS Min:  tensor(0.0010, device='cuda:0')
Criterion check:  tensor([1.0043, 0.9975, 1.0002, 0.9951, 0.9999, 1.0029, 0.9988, 1.0010, 0.9997,
        0.9952], device='cuda:0') tensor(261, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0004, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1548, device='cuda:0')
min of grad d_p:  tensor(-0.1251, device='cuda:0')
max|min: (J_L, Jta/N)  (0.15483538806438446, 0.15483538806438446, ratio: 1.0)|(-0.1251407414674759, -0.12514084577560425)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.2340e-07, device='cuda:0') mean:  tensor(-4.6466e-10, device='cuda:0') min:  tensor(-1.8701e-06, device='cuda:0') norm:  tensor(3.1209e-05, device='cuda:0') MSE:  tensor(3.9326e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0010, device='cuda:0') mean:  tensor(5.3280e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0811, device='cuda:0') MSE:  tensor(1.0221e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0079, device='cuda:0')
min of d_p_list:  tensor(-0.0045, device='cuda:0')
Epoch:  97  
Training Loss: 0.08264195919036865
Test Loss:  0.08457013964653015
Test Acc:  0.0
Valid Loss:  0.08525483310222626
Valid Acc:  0.0
std:  0.013155158362700299 
thres:  9.068928062915801e-05
Preserved_eigens number check:  512
 10%|▉         | 97/1000 [23:49<3:41:14, 14.70s/it]Epoch:   98
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(1.4046, device='cuda:0') 
Std:  tensor(150.0855, device='cuda:0') 
ABS Max:  tensor(3001.2053, device='cuda:0') 
ABS Min:  tensor(0.0012, device='cuda:0')
Criterion check:  tensor([1.0070, 1.0036, 0.9980, 0.9992, 0.9988, 0.9999, 0.9957, 1.0018, 1.0096,
        0.9990], device='cuda:0') tensor(246, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0004, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2583, device='cuda:0')
min of grad d_p:  tensor(-0.1247, device='cuda:0')
max|min: (J_L, Jta/N)  (0.2583265006542206, 0.2583230435848236, ratio: 0.9999865889549255)|(-0.12472737580537796, -0.1247272938489914)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.0829e-06, device='cuda:0') mean:  tensor(7.3391e-10, device='cuda:0') min:  tensor(-1.9893e-06, device='cuda:0') norm:  tensor(6.5635e-05, device='cuda:0') MSE:  tensor(8.2705e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0016, device='cuda:0') mean:  tensor(7.0775e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1102, device='cuda:0') MSE:  tensor(1.3891e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0020, device='cuda:0')
min of d_p_list:  tensor(-0.0034, device='cuda:0')
Epoch:  98  
Training Loss: 0.07330542057752609
Test Loss:  0.07427767664194107
Test Acc:  0.0
Valid Loss:  0.0748649463057518
Valid Acc:  0.0
std:  0.01494737151506897 
thres:  8.77811074256897e-05
Preserved_eigens number check:  512
 10%|▉         | 98/1000 [24:03<3:40:46, 14.69s/it]Epoch:   99
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-273.8838, device='cuda:0') 
Std:  tensor(6168.9375, device='cuda:0') 
ABS Max:  tensor(139584.6875, device='cuda:0') 
ABS Min:  tensor(0.0009, device='cuda:0')
Criterion check:  tensor([0.9993, 1.0014, 1.0013, 1.0012, 1.0004, 0.9999, 1.0001, 1.0025, 1.0016,
        1.0001], device='cuda:0') tensor(175, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0017, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.4163, device='cuda:0')
min of grad d_p:  tensor(-0.2250, device='cuda:0')
max|min: (J_L, Jta/N)  (0.41631126403808594, 0.41631820797920227, ratio: 1.000016689300537)|(-0.22499263286590576, -0.22500640153884888)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.4111e-05, device='cuda:0') mean:  tensor(1.8148e-09, device='cuda:0') min:  tensor(-7.4506e-06, device='cuda:0') norm:  tensor(0.0002, device='cuda:0') MSE:  tensor(3.0769e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(1.1322e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0181, device='cuda:0') MSE:  tensor(2.2770e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0781, device='cuda:0')
min of d_p_list:  tensor(-0.1011, device='cuda:0')
Epoch:  99  
Training Loss: 0.5411937236785889
Test Loss:  0.590300440788269
Test Acc:  0.0
Valid Loss:  0.4897989332675934
Valid Acc:  0.0
std:  0.18419847451863147 
thres:  0.00017299507707357406
Preserved_eigens number check:  512
 10%|▉         | 99/1000 [24:18<3:40:33, 14.69s/it]Epoch:   100
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(-4.3402, device='cuda:0') 
Std:  tensor(48.5307, device='cuda:0') 
ABS Max:  tensor(778.3118, device='cuda:0') 
ABS Min:  tensor(0.0060, device='cuda:0')
Criterion check:  tensor([1.0008, 0.9931, 1.0000, 0.9997, 1.0002, 0.9994, 0.9998, 0.9998, 0.9997,
        1.0011], device='cuda:0') tensor(261, device='cuda:0')
max of Lambda2 tensor(268692.4688, device='cuda:0')
min of Lambda2 tensor(8.2427e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1891, device='cuda:0')
min of grad d_p:  tensor(-0.1873, device='cuda:0')
max|min: (J_L, Jta/N)  (0.18910953402519226, 0.18910954892635345, ratio: 1.0000001192092896)|(-0.18725883960723877, -0.18725895881652832)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.3288e-06, device='cuda:0') mean:  tensor(-5.1147e-11, device='cuda:0') min:  tensor(-5.5879e-07, device='cuda:0') norm:  tensor(1.0022e-05, device='cuda:0') MSE:  tensor(1.2628e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(9.0519e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0131, device='cuda:0') MSE:  tensor(1.6471e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0025, device='cuda:0')
min of d_p_list:  tensor(-0.0030, device='cuda:0')
Epoch:  100  
Training Loss: 0.19390112161636353
Test Loss:  0.20534026622772217
Test Acc:  0.0
Valid Loss:  0.180705726146698
Valid Acc:  0.0
std:  0.17959149035212965 
thres:  0.00019355190247297288
Preserved_eigens number check:  512
 10%|█         | 100/1000 [24:32<3:39:51, 14.66s/it]Epoch:   101
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(1.2697, device='cuda:0') 
Std:  tensor(13.0774, device='cuda:0') 
ABS Max:  tensor(166.9100, device='cuda:0') 
ABS Min:  tensor(9.7145e-05, device='cuda:0')
Criterion check:  tensor([0.9997, 1.0001, 1.0002, 1.0002, 1.0000, 1.0001, 1.0000, 1.0001, 0.9999,
        1.0003], device='cuda:0') tensor(242, device='cuda:0')
max of Lambda2 tensor(322435.2500, device='cuda:0')
min of Lambda2 tensor(0.0001, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1802, device='cuda:0')
min of grad d_p:  tensor(-0.1789, device='cuda:0')
max|min: (J_L, Jta/N)  (0.1801774501800537, 0.1801774948835373, ratio: 1.000000238418579)|(-0.17891645431518555, -0.17891649901866913)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.1756e-06, device='cuda:0') mean:  tensor(-2.2167e-10, device='cuda:0') min:  tensor(-4.0978e-07, device='cuda:0') norm:  tensor(1.0273e-05, device='cuda:0') MSE:  tensor(1.2944e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(9.9987e-05, device='cuda:0') mean:  tensor(4.1126e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0059, device='cuda:0') MSE:  tensor(7.4951e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0055, device='cuda:0')
min of d_p_list:  tensor(-0.0065, device='cuda:0')
Epoch:  101  
Training Loss: 0.12860742211341858
Test Loss:  0.13332147896289825
Test Acc:  0.0
Valid Loss:  0.12019450962543488
Valid Acc:  0.0
std:  0.173950831008865 
thres:  0.00020392992943525314
Preserved_eigens number check:  512
 10%|█         | 101/1000 [24:47<3:39:45, 14.67s/it]Epoch:   102
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(-44.4469, device='cuda:0') 
Std:  tensor(996.0676, device='cuda:0') 
ABS Max:  tensor(21364.6484, device='cuda:0') 
ABS Min:  tensor(0.0070, device='cuda:0')
Criterion check:  tensor([0.9966, 1.0041, 1.0005, 1.0013, 0.9996, 1.0008, 0.9998, 0.9955, 1.0006,
        1.0037], device='cuda:0') tensor(272, device='cuda:0')
max of Lambda2 tensor(265985.8750, device='cuda:0')
min of Lambda2 tensor(6.6259e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1721, device='cuda:0')
min of grad d_p:  tensor(-0.1696, device='cuda:0')
max|min: (J_L, Jta/N)  (0.17211438715457916, 0.17211441695690155, ratio: 1.0000001192092896)|(-0.16960033774375916, -0.1696002036333084)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.4959e-07, device='cuda:0') mean:  tensor(5.5843e-11, device='cuda:0') min:  tensor(-2.6845e-07, device='cuda:0') norm:  tensor(5.9925e-06, device='cuda:0') MSE:  tensor(7.5510e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(1.7901e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0266, device='cuda:0') MSE:  tensor(3.3477e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0133, device='cuda:0')
min of d_p_list:  tensor(-0.0128, device='cuda:0')
Epoch:  102  
Training Loss: 0.11929644644260406
Test Loss:  0.12386199831962585
Test Acc:  0.0
Valid Loss:  0.11404042690992355
Valid Acc:  0.0
std:  0.16939764016867043 
thres:  0.00021126082688570022
Preserved_eigens number check:  512
 10%|█         | 102/1000 [25:02<3:39:55, 14.69s/it]Epoch:   103
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-1.5270, device='cuda:0') 
Std:  tensor(41.6714, device='cuda:0') 
ABS Max:  tensor(538.7745, device='cuda:0') 
ABS Min:  tensor(0.0019, device='cuda:0')
Criterion check:  tensor([0.9995, 0.9995, 1.0003, 1.0002, 1.0041, 1.0002, 0.9995, 0.9973, 0.9998,
        0.9999], device='cuda:0') tensor(243, device='cuda:0')
max of Lambda2 tensor(732583.5000, device='cuda:0')
min of Lambda2 tensor(0.0001, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1709, device='cuda:0')
min of grad d_p:  tensor(-0.1615, device='cuda:0')
max|min: (J_L, Jta/N)  (0.17094533145427704, 0.17094534635543823, ratio: 1.0000001192092896)|(-0.1615009307861328, -0.16150154173374176)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.1590e-06, device='cuda:0') mean:  tensor(3.2280e-10, device='cuda:0') min:  tensor(-5.5911e-07, device='cuda:0') norm:  tensor(1.2489e-05, device='cuda:0') MSE:  tensor(1.5737e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(9.3930e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0144, device='cuda:0') MSE:  tensor(1.8109e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0046, device='cuda:0')
min of d_p_list:  tensor(-0.0036, device='cuda:0')
Epoch:  103  
Training Loss: 0.1021919921040535
Test Loss:  0.10494808852672577
Test Acc:  0.0
Valid Loss:  0.09716466069221497
Valid Acc:  0.0
std:  0.16503044098688763 
thres:  0.0002170381411910057
Preserved_eigens number check:  512
 10%|█         | 103/1000 [25:17<3:39:45, 14.70s/it]Epoch:   104
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(1.4936, device='cuda:0') 
Std:  tensor(30.2996, device='cuda:0') 
ABS Max:  tensor(393.9656, device='cuda:0') 
ABS Min:  tensor(0.0107, device='cuda:0')
Criterion check:  tensor([1.0020, 1.0025, 0.9989, 0.9995, 1.0004, 0.9996, 1.0010, 1.0016, 1.0007,
        0.9962], device='cuda:0') tensor(228, device='cuda:0')
max of Lambda2 tensor(716648.0625, device='cuda:0')
min of Lambda2 tensor(7.0664e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1635, device='cuda:0')
min of grad d_p:  tensor(-0.1529, device='cuda:0')
max|min: (J_L, Jta/N)  (0.16349777579307556, 0.16349780559539795, ratio: 1.000000238418579)|(-0.15287908911705017, -0.15287913382053375)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.4049e-06, device='cuda:0') mean:  tensor(-3.0533e-10, device='cuda:0') min:  tensor(-1.3709e-06, device='cuda:0') norm:  tensor(2.2142e-05, device='cuda:0') MSE:  tensor(2.7901e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(5.3089e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0085, device='cuda:0') MSE:  tensor(1.0679e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0017, device='cuda:0')
min of d_p_list:  tensor(-0.0025, device='cuda:0')
Epoch:  104  
Training Loss: 0.08304917812347412
Test Loss:  0.08420784771442413
Test Acc:  0.0
Valid Loss:  0.07942254096269608
Valid Acc:  0.0
std:  0.037608902944118186 
thres:  0.00012540923207998275
Preserved_eigens number check:  512
 10%|█         | 104/1000 [25:31<3:39:29, 14.70s/it]Epoch:   105
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  509
Criterion check: 
Mean:  tensor(-7.3940, device='cuda:0') 
Std:  tensor(144.8710, device='cuda:0') 
ABS Max:  tensor(3245.0720, device='cuda:0') 
ABS Min:  tensor(0.0032, device='cuda:0')
Criterion check:  tensor([1.0003, 1.0009, 0.9997, 1.0006, 0.9994, 1.0000, 1.0001, 1.0003, 1.0002,
        0.9993], device='cuda:0') tensor(219, device='cuda:0')
max of Lambda2 tensor(591603.2500, device='cuda:0')
min of Lambda2 tensor(2.5507e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1564, device='cuda:0')
min of grad d_p:  tensor(-0.1471, device='cuda:0')
max|min: (J_L, Jta/N)  (0.1563735157251358, 0.1563735157251358, ratio: 1.0)|(-0.1471269428730011, -0.1471269130706787)

 check Jacobi res:  torch.Size([793601]) max:  tensor(9.0152e-07, device='cuda:0') mean:  tensor(3.0111e-10, device='cuda:0') min:  tensor(-4.1454e-07, device='cuda:0') norm:  tensor(1.3734e-05, device='cuda:0') MSE:  tensor(1.7307e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(9.3259e-05, device='cuda:0') mean:  tensor(3.3341e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0051, device='cuda:0') MSE:  tensor(6.4215e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0014, device='cuda:0')
min of d_p_list:  tensor(-0.0017, device='cuda:0')
Epoch:  105  
Training Loss: 0.07152091711759567
Test Loss:  0.07202112674713135
Test Acc:  0.0
Valid Loss:  0.06933516263961792
Valid Acc:  0.0
std:  0.021398955908595665 
thres:  0.00010093319118022919
Preserved_eigens number check:  512
 10%|█         | 105/1000 [25:46<3:39:20, 14.70s/it]Epoch:   106
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(0.4903, device='cuda:0') 
Std:  tensor(81.4470, device='cuda:0') 
ABS Max:  tensor(1430.3700, device='cuda:0') 
ABS Min:  tensor(0.0007, device='cuda:0')
Criterion check:  tensor([0.9995, 0.9982, 1.0011, 0.9997, 1.0014, 1.0002, 0.9992, 1.0006, 1.0004,
        1.0027], device='cuda:0') tensor(244, device='cuda:0')
max of Lambda2 tensor(562084.6875, device='cuda:0')
min of Lambda2 tensor(9.2835e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1490, device='cuda:0')
min of grad d_p:  tensor(-0.1399, device='cuda:0')
max|min: (J_L, Jta/N)  (0.1489611268043518, 0.14896121621131897, ratio: 1.0000005960464478)|(-0.13987571001052856, -0.13987575471401215)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.0664e-07, device='cuda:0') mean:  tensor(2.4032e-10, device='cuda:0') min:  tensor(-2.3097e-07, device='cuda:0') norm:  tensor(8.3419e-06, device='cuda:0') MSE:  tensor(1.0511e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(8.0670e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0118, device='cuda:0') MSE:  tensor(1.4819e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0028, device='cuda:0')
min of d_p_list:  tensor(-0.0030, device='cuda:0')
Epoch:  106  
Training Loss: 0.06488151848316193
Test Loss:  0.06570221483707428
Test Acc:  0.0
Valid Loss:  0.06374134123325348
Valid Acc:  0.0
std:  0.02005611357020359 
thres:  8.818801045417786e-05
Preserved_eigens number check:  512
 11%|█         | 106/1000 [26:01<3:39:02, 14.70s/it]Epoch:   107
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(0.8719, device='cuda:0') 
Std:  tensor(132.9114, device='cuda:0') 
ABS Max:  tensor(2264.0386, device='cuda:0') 
ABS Min:  tensor(0.0071, device='cuda:0')
Criterion check:  tensor([0.9980, 0.9962, 1.0008, 1.0025, 1.0019, 0.9999, 1.0004, 1.0005, 0.9994,
        1.0020], device='cuda:0') tensor(244, device='cuda:0')
max of Lambda2 tensor(735726.0625, device='cuda:0')
min of Lambda2 tensor(2.9309e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1434, device='cuda:0')
min of grad d_p:  tensor(-0.1378, device='cuda:0')
max|min: (J_L, Jta/N)  (0.14343377947807312, 0.14343364536762238, ratio: 0.9999990463256836)|(-0.1377691924571991, -0.13776817917823792)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.6077e-07, device='cuda:0') mean:  tensor(-3.3054e-10, device='cuda:0') min:  tensor(-3.7029e-06, device='cuda:0') norm:  tensor(1.6516e-05, device='cuda:0') MSE:  tensor(2.0811e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(7.7423e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0122, device='cuda:0') MSE:  tensor(1.5354e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0240, device='cuda:0')
min of d_p_list:  tensor(-0.0145, device='cuda:0')
Epoch:  107  
Training Loss: 0.07871630787849426
Test Loss:  0.08127918839454651
Test Acc:  0.0
Valid Loss:  0.076400026679039
Valid Acc:  0.0
std:  0.012679647381250417 
thres:  8.007198274135589e-05
Preserved_eigens number check:  512
 11%|█         | 107/1000 [26:15<3:38:38, 14.69s/it]Epoch:   108
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(2.1038, device='cuda:0') 
Std:  tensor(38.0090, device='cuda:0') 
ABS Max:  tensor(417.0411, device='cuda:0') 
ABS Min:  tensor(0.0013, device='cuda:0')
Criterion check:  tensor([1.0001, 1.0064, 1.0004, 1.0002, 1.0004, 0.9996, 0.9997, 1.0005, 0.9996,
        1.0021], device='cuda:0') tensor(257, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0001, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1489, device='cuda:0')
min of grad d_p:  tensor(-0.2251, device='cuda:0')
max|min: (J_L, Jta/N)  (0.14891156554222107, 0.14891153573989868, ratio: 0.9999998211860657)|(-0.2250910997390747, -0.2250727266073227)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.4117e-05, device='cuda:0') mean:  tensor(-1.7919e-08, device='cuda:0') min:  tensor(-3.4867e-05, device='cuda:0') norm:  tensor(0.0008, device='cuda:0') MSE:  tensor(9.7288e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(8.3828e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0124, device='cuda:0') MSE:  tensor(1.5667e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0153, device='cuda:0')
min of d_p_list:  tensor(-0.0137, device='cuda:0')
Epoch:  108  
Training Loss: 0.08361472189426422
Test Loss:  0.08636472374200821
Test Acc:  0.0
Valid Loss:  0.08326566219329834
Valid Acc:  0.0
std:  0.007184712678659712 
thres:  7.635652869939805e-05
Preserved_eigens number check:  512
 11%|█         | 108/1000 [26:30<3:38:38, 14.71s/it]Epoch:   109
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(2.0388, device='cuda:0') 
Std:  tensor(72.7771, device='cuda:0') 
ABS Max:  tensor(1026.1086, device='cuda:0') 
ABS Min:  tensor(0.0017, device='cuda:0')
Criterion check:  tensor([0.9985, 0.9994, 0.9997, 1.0001, 1.3827, 0.9996, 0.9979, 0.9991, 1.0003,
        1.0102], device='cuda:0') tensor(225, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0001, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1357, device='cuda:0')
min of grad d_p:  tensor(-0.3485, device='cuda:0')
max|min: (J_L, Jta/N)  (0.1356814205646515, 0.13568143546581268, ratio: 1.0000001192092896)|(-0.3485472798347473, -0.3485468327999115)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.5390e-07, device='cuda:0') mean:  tensor(-2.3359e-10, device='cuda:0') min:  tensor(-8.9407e-07, device='cuda:0') norm:  tensor(1.0400e-05, device='cuda:0') MSE:  tensor(1.3105e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0008, device='cuda:0') mean:  tensor(2.6649e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0415, device='cuda:0') MSE:  tensor(5.2330e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0019, device='cuda:0')
min of d_p_list:  tensor(-0.0018, device='cuda:0')
Epoch:  109  
Training Loss: 0.06548021733760834
Test Loss:  0.0670989602804184
Test Acc:  0.0
Valid Loss:  0.06615133583545685
Valid Acc:  0.0
std:  0.007346691735474138 
thres:  7.284273654222488e-05
Preserved_eigens number check:  512
 11%|█         | 109/1000 [26:45<3:38:28, 14.71s/it]Epoch:   110
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-7.5151, device='cuda:0') 
Std:  tensor(109.7780, device='cuda:0') 
ABS Max:  tensor(2028.5496, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([1.0020, 0.9950, 1.0006, 1.0009, 1.0024, 0.9939, 1.0008, 0.9997, 0.9995,
        1.0009], device='cuda:0') tensor(229, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0006, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1295, device='cuda:0')
min of grad d_p:  tensor(-0.3170, device='cuda:0')
max|min: (J_L, Jta/N)  (0.1294843852519989, 0.1294843852519989, ratio: 1.0)|(-0.3169887065887451, -0.3169899582862854)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.4603e-06, device='cuda:0') mean:  tensor(6.4520e-10, device='cuda:0') min:  tensor(-3.0960e-07, device='cuda:0') norm:  tensor(2.2387e-05, device='cuda:0') MSE:  tensor(2.8210e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0010, device='cuda:0') mean:  tensor(1.1844e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0241, device='cuda:0') MSE:  tensor(3.0326e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0208, device='cuda:0')
min of d_p_list:  tensor(-0.0135, device='cuda:0')
Epoch:  110  
Training Loss: 0.07725115120410919
Test Loss:  0.07455518841743469
Test Acc:  0.0
Valid Loss:  0.07552212476730347
Valid Acc:  0.0
std:  0.007496521779905147 
thres:  7.398878335952759e-05
Preserved_eigens number check:  512
 11%|█         | 110/1000 [27:00<3:38:20, 14.72s/it]Epoch:   111
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(2.5296, device='cuda:0') 
Std:  tensor(206.6786, device='cuda:0') 
ABS Max:  tensor(2538.3286, device='cuda:0') 
ABS Min:  tensor(0.0115, device='cuda:0')
Criterion check:  tensor([0.9821, 0.9983, 0.9951, 0.9917, 1.0020, 0.9824, 1.0080, 1.0011, 1.0065,
        1.0228], device='cuda:0') tensor(252, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0004, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1523, device='cuda:0')
min of grad d_p:  tensor(-0.4884, device='cuda:0')
max|min: (J_L, Jta/N)  (0.15232163667678833, 0.15232162177562714, ratio: 0.9999998807907104)|(-0.48842090368270874, -0.4884199798107147)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.2527e-07, device='cuda:0') mean:  tensor(-5.5370e-10, device='cuda:0') min:  tensor(-1.2219e-06, device='cuda:0') norm:  tensor(2.1328e-05, device='cuda:0') MSE:  tensor(2.6874e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0065, device='cuda:0') mean:  tensor(8.7321e-05, device='cuda:0') min:  tensor(1.3642e-13, device='cuda:0') norm:  tensor(0.1691, device='cuda:0') MSE:  tensor(2.1314e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(1.1164, device='cuda:0')
min of d_p_list:  tensor(-2.5309, device='cuda:0')
Epoch:  111  
Training Loss: 2633.48291015625
Test Loss:  2718.804443359375
Test Acc:  0.0
Valid Loss:  2568.447998046875
Valid Acc:  0.0
std:  1053.3626578395015 
thres:  0.5267575945109129
Preserved_eigens number check:  512
 11%|█         | 111/1000 [27:14<3:38:21, 14.74s/it]Epoch:   112
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  509
Criterion check: 
Mean:  tensor(-61.8164, device='cuda:0') 
Std:  tensor(1273.7242, device='cuda:0') 
ABS Max:  tensor(28391.0508, device='cuda:0') 
ABS Min:  tensor(0.0060, device='cuda:0')
Criterion check:  tensor([0.9995, 1.0000, 1.0000, 0.9999, 1.0004, 0.9999, 1.0004, 1.0003, 1.0010,
        0.9998], device='cuda:0') tensor(272, device='cuda:0')
max of Lambda2 tensor(199251.7656, device='cuda:0')
min of Lambda2 tensor(2.2994e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.1451, device='cuda:0')
min of grad d_p:  tensor(-0.3162, device='cuda:0')
max|min: (J_L, Jta/N)  (1.1451340913772583, 1.1451321840286255, ratio: 0.9999983310699463)|(-0.31622928380966187, -0.3162291646003723)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.9073e-06, device='cuda:0') mean:  tensor(8.1557e-11, device='cuda:0') min:  tensor(-5.9605e-07, device='cuda:0') norm:  tensor(1.0390e-05, device='cuda:0') MSE:  tensor(1.3092e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0011, device='cuda:0') mean:  tensor(2.3979e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0380, device='cuda:0') MSE:  tensor(4.7884e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0506, device='cuda:0')
min of d_p_list:  tensor(-0.0481, device='cuda:0')
Epoch:  112  
Training Loss: 12.803594589233398
Test Loss:  13.993704795837402
Test Acc:  0.0
Valid Loss:  12.247145652770996
Valid Acc:  0.0
std:  1052.101718793228 
thres:  0.5293025701671839
Preserved_eigens number check:  512
 11%|█         | 112/1000 [27:29<3:37:46, 14.71s/it]Epoch:   113
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  510
Criterion check: 
Mean:  tensor(105.8905, device='cuda:0') 
Std:  tensor(3312.4500, device='cuda:0') 
ABS Max:  tensor(72157., device='cuda:0') 
ABS Min:  tensor(0.0090, device='cuda:0')
Criterion check:  tensor([1.0001, 0.9998, 1.0000, 1.0000, 0.9999, 0.9998, 1.0000, 1.0000, 1.0002,
        1.0011], device='cuda:0') tensor(252, device='cuda:0')
max of Lambda2 tensor(156831.6719, device='cuda:0')
min of Lambda2 tensor(3.7331e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.8676, device='cuda:0')
min of grad d_p:  tensor(-0.3101, device='cuda:0')
max|min: (J_L, Jta/N)  (0.8675666451454163, 0.8675650358200073, ratio: 0.999998152256012)|(-0.3101440966129303, -0.3101440966129303)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.6093e-06, device='cuda:0') mean:  tensor(3.4301e-11, device='cuda:0') min:  tensor(-3.1292e-07, device='cuda:0') norm:  tensor(7.6410e-06, device='cuda:0') MSE:  tensor(9.6282e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0006, device='cuda:0') mean:  tensor(1.2623e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0208, device='cuda:0') MSE:  tensor(2.6257e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0189, device='cuda:0')
min of d_p_list:  tensor(-0.0193, device='cuda:0')
Epoch:  113  
Training Loss: 3.925877094268799
Test Loss:  4.382749557495117
Test Acc:  0.0
Valid Loss:  3.6932690143585205
Valid Acc:  0.0
std:  1051.7162305169516 
thres:  0.5300710226416588
Preserved_eigens number check:  512
 11%|█▏        | 113/1000 [27:44<3:37:15, 14.70s/it]Epoch:   114
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  509
Criterion check: 
Mean:  tensor(6.7292, device='cuda:0') 
Std:  tensor(183.9246, device='cuda:0') 
ABS Max:  tensor(3435.9199, device='cuda:0') 
ABS Min:  tensor(0.0081, device='cuda:0')
Criterion check:  tensor([0.9999, 1.0001, 0.9999, 1.0001, 0.9999, 1.0000, 1.0000, 0.9997, 0.9989,
        0.9996], device='cuda:0') tensor(258, device='cuda:0')
max of Lambda2 tensor(154384.2188, device='cuda:0')
min of Lambda2 tensor(1.3027e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.6722, device='cuda:0')
min of grad d_p:  tensor(-0.2933, device='cuda:0')
max|min: (J_L, Jta/N)  (0.672158420085907, 0.6721595525741577, ratio: 1.0000016689300537)|(-0.29331356287002563, -0.293313592672348)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.1077e-07, device='cuda:0') mean:  tensor(-1.5207e-11, device='cuda:0') min:  tensor(-1.1325e-06, device='cuda:0') norm:  tensor(8.2989e-06, device='cuda:0') MSE:  tensor(1.0457e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0013, device='cuda:0') mean:  tensor(1.8634e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0285, device='cuda:0') MSE:  tensor(3.5959e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0108, device='cuda:0')
min of d_p_list:  tensor(-0.0068, device='cuda:0')
Epoch:  114  
Training Loss: 1.8824162483215332
Test Loss:  2.120082139968872
Test Acc:  0.0
Valid Loss:  1.7486603260040283
Valid Acc:  0.0
std:  1051.5333391134923 
thres:  0.5304344098478556
Preserved_eigens number check:  512
 11%|█▏        | 114/1000 [27:59<3:38:18, 14.78s/it]Epoch:   115
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  509
Criterion check: 
Mean:  tensor(30.1612, device='cuda:0') 
Std:  tensor(1215.9321, device='cuda:0') 
ABS Max:  tensor(26215.4004, device='cuda:0') 
ABS Min:  tensor(0.0041, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0001, 1.0001, 1.0004, 1.0004, 0.9998, 1.0004, 0.9995, 1.0008,
        1.0020], device='cuda:0') tensor(281, device='cuda:0')
max of Lambda2 tensor(154586.6094, device='cuda:0')
min of Lambda2 tensor(3.3692e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.9325, device='cuda:0')
min of grad d_p:  tensor(-0.2790, device='cuda:0')
max|min: (J_L, Jta/N)  (0.9324662089347839, 0.9324659705162048, ratio: 0.9999997615814209)|(-0.2789647877216339, -0.2789647579193115)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.9802e-07, device='cuda:0') mean:  tensor(1.1060e-10, device='cuda:0') min:  tensor(-3.4613e-07, device='cuda:0') norm:  tensor(6.4977e-06, device='cuda:0') MSE:  tensor(8.1876e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(1.8748e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0286, device='cuda:0') MSE:  tensor(3.6094e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0108, device='cuda:0')
min of d_p_list:  tensor(-0.0049, device='cuda:0')
Epoch:  115  
Training Loss: 1.1791208982467651
Test Loss:  1.33204185962677
Test Acc:  0.0
Valid Loss:  1.0858632326126099
Valid Acc:  0.0
std:  1051.4222765961179 
thres:  0.5306547837972642
Preserved_eigens number check:  512
 12%|█▏        | 115/1000 [28:14<3:39:15, 14.87s/it]Epoch:   116
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  507
Criterion check: 
Mean:  tensor(-0.1817, device='cuda:0') 
Std:  tensor(12.0136, device='cuda:0') 
ABS Max:  tensor(135.6427, device='cuda:0') 
ABS Min:  tensor(0.0004, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0001, 1.0001, 1.0000,
        1.0003], device='cuda:0') tensor(244, device='cuda:0')
max of Lambda2 tensor(148288.5469, device='cuda:0')
min of Lambda2 tensor(2.2546e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.7571, device='cuda:0')
min of grad d_p:  tensor(-0.2643, device='cuda:0')
max|min: (J_L, Jta/N)  (0.7570620775222778, 0.7570619583129883, ratio: 0.9999998211860657)|(-0.26427915692329407, -0.26427924633026123)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.2783e-07, device='cuda:0') mean:  tensor(4.4849e-11, device='cuda:0') min:  tensor(-2.5332e-07, device='cuda:0') norm:  tensor(5.5917e-06, device='cuda:0') MSE:  tensor(7.0460e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(2.0591e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0031, device='cuda:0') MSE:  tensor(3.9609e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1147, device='cuda:0')
min of d_p_list:  tensor(-0.1324, device='cuda:0')
Epoch:  116  
Training Loss: 1.030903935432434
Test Loss:  1.1421685218811035
Test Acc:  0.0
Valid Loss:  0.9149748086929321
Valid Acc:  0.0
std:  4.441412276981853 
thres:  0.004164382553100586
Preserved_eigens number check:  512
 12%|█▏        | 116/1000 [28:28<3:38:19, 14.82s/it]Epoch:   117
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  506
Criterion check: 
Mean:  tensor(8.5445, device='cuda:0') 
Std:  tensor(196.6542, device='cuda:0') 
ABS Max:  tensor(4442.5405, device='cuda:0') 
ABS Min:  tensor(0.0011, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0012, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0001, 1.0000,
        1.0002], device='cuda:0') tensor(218, device='cuda:0')
max of Lambda2 tensor(130895.9453, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.6932, device='cuda:0')
min of grad d_p:  tensor(-0.4720, device='cuda:0')
max|min: (J_L, Jta/N)  (0.693155825138092, 0.6931557655334473, ratio: 0.9999999403953552)|(-0.4719933867454529, -0.4719928503036499)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.7684e-07, device='cuda:0') mean:  tensor(-2.0418e-11, device='cuda:0') min:  tensor(-5.3644e-07, device='cuda:0') norm:  tensor(5.3755e-06, device='cuda:0') MSE:  tensor(6.7735e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(7.1794e-05, device='cuda:0') mean:  tensor(2.6249e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0040, device='cuda:0') MSE:  tensor(5.0472e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0107, device='cuda:0')
min of d_p_list:  tensor(-0.0094, device='cuda:0')
Epoch:  117  
Training Loss: 0.89609694480896
Test Loss:  0.9984936714172363
Test Acc:  0.0
Valid Loss:  0.8027138710021973
Valid Acc:  0.0
std:  1.1241638005499968 
thres:  0.0017828830242156983
Preserved_eigens number check:  512
 12%|█▏        | 117/1000 [28:43<3:37:35, 14.79s/it]Epoch:   118
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  505
Criterion check: 
Mean:  tensor(-6.8203, device='cuda:0') 
Std:  tensor(124.6024, device='cuda:0') 
ABS Max:  tensor(1975.3170, device='cuda:0') 
ABS Min:  tensor(0.0014, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0059, 1.0000, 1.0000, 1.0000, 1.0001, 0.9998, 0.9986, 1.0000,
        0.9993], device='cuda:0') tensor(264, device='cuda:0')
max of Lambda2 tensor(131276.7188, device='cuda:0')
min of Lambda2 tensor(5.7482e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.6540, device='cuda:0')
min of grad d_p:  tensor(-0.3890, device='cuda:0')
max|min: (J_L, Jta/N)  (0.6539973020553589, 0.6539969444274902, ratio: 0.999999463558197)|(-0.3890022337436676, -0.3890022039413452)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.5763e-07, device='cuda:0') mean:  tensor(5.0879e-11, device='cuda:0') min:  tensor(-4.1723e-07, device='cuda:0') norm:  tensor(5.6607e-06, device='cuda:0') MSE:  tensor(7.1329e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0006, device='cuda:0') mean:  tensor(7.2529e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0117, device='cuda:0') MSE:  tensor(1.4737e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0122, device='cuda:0')
min of d_p_list:  tensor(-0.0127, device='cuda:0')
Epoch:  118  
Training Loss: 0.7249699831008911
Test Loss:  0.8058701753616333
Test Acc:  0.0
Valid Loss:  0.6535160541534424
Valid Acc:  0.0
std:  0.39907803842056605 
thres:  0.0011427016019821168
Preserved_eigens number check:  512
 12%|█▏        | 118/1000 [28:58<3:36:26, 14.72s/it]Epoch:   119
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  507
Criterion check: 
Mean:  tensor(2.2948, device='cuda:0') 
Std:  tensor(34.5362, device='cuda:0') 
ABS Max:  tensor(713.2931, device='cuda:0') 
ABS Min:  tensor(0.0006, device='cuda:0')
Criterion check:  tensor([1.0000, 0.9999, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0003, 1.0000,
        1.0008], device='cuda:0') tensor(250, device='cuda:0')
max of Lambda2 tensor(133001.2969, device='cuda:0')
min of Lambda2 tensor(3.5760e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.6082, device='cuda:0')
min of grad d_p:  tensor(-0.7171, device='cuda:0')
max|min: (J_L, Jta/N)  (0.6081922054290771, 0.608192503452301, ratio: 1.0000004768371582)|(-0.717099130153656, -0.7170992493629456)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.6822e-07, device='cuda:0') mean:  tensor(1.1701e-11, device='cuda:0') min:  tensor(-3.2783e-07, device='cuda:0') norm:  tensor(4.8165e-06, device='cuda:0') MSE:  tensor(6.0691e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(2.4052e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0039, device='cuda:0') MSE:  tensor(4.9062e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0164, device='cuda:0')
min of d_p_list:  tensor(-0.0274, device='cuda:0')
Epoch:  119  
Training Loss: 0.6420372128486633
Test Loss:  0.712128758430481
Test Acc:  0.0
Valid Loss:  0.5803644061088562
Valid Acc:  0.0
std:  0.19600788043200637 
thres:  0.0008946257948875427
Preserved_eigens number check:  512
 12%|█▏        | 119/1000 [29:12<3:35:15, 14.66s/it]Epoch:   120
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  506
Criterion check: 
Mean:  tensor(116.3190, device='cuda:0') 
Std:  tensor(2686.8638, device='cuda:0') 
ABS Max:  tensor(60776.6406, device='cuda:0') 
ABS Min:  tensor(0.0023, device='cuda:0')
Criterion check:  tensor([1.0000, 0.9998, 1.0000, 1.0000, 0.9999, 0.9998, 1.0001, 1.0003, 1.0000,
        1.0018], device='cuda:0') tensor(239, device='cuda:0')
max of Lambda2 tensor(133577.7656, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.5800, device='cuda:0')
min of grad d_p:  tensor(-1.6269, device='cuda:0')
max|min: (J_L, Jta/N)  (0.5799821019172668, 0.5799819827079773, ratio: 0.9999998211860657)|(-1.6269240379333496, -1.6269246339797974)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.9605e-07, device='cuda:0') mean:  tensor(-3.8511e-11, device='cuda:0') min:  tensor(-2.3842e-07, device='cuda:0') norm:  tensor(5.2637e-06, device='cuda:0') MSE:  tensor(6.6327e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(5.3763e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0084, device='cuda:0') MSE:  tensor(1.0522e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.2005, device='cuda:0')
min of d_p_list:  tensor(-0.1726, device='cuda:0')
Epoch:  120  
Training Loss: 0.6878334283828735
Test Loss:  0.7463928461074829
Test Acc:  0.0
Valid Loss:  0.606501579284668
Valid Acc:  0.0
std:  0.14536051001383596 
thres:  0.0007963683009147644
Preserved_eigens number check:  512
 12%|█▏        | 120/1000 [29:27<3:33:54, 14.58s/it]Epoch:   121
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  503
Criterion check: 
Mean:  tensor(0.5482, device='cuda:0') 
Std:  tensor(14.4738, device='cuda:0') 
ABS Max:  tensor(263.3070, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0001, 1.0000, 1.0000, 1.0000, 1.0000,
        0.9998], device='cuda:0') tensor(205, device='cuda:0')
max of Lambda2 tensor(110791.0391, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.0968, device='cuda:0')
min of grad d_p:  tensor(-0.2219, device='cuda:0')
max|min: (J_L, Jta/N)  (1.0967556238174438, 1.096756100654602, ratio: 1.0000004768371582)|(-0.22190439701080322, -0.22190436720848083)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.9802e-07, device='cuda:0') mean:  tensor(-3.3213e-11, device='cuda:0') min:  tensor(-4.7684e-07, device='cuda:0') norm:  tensor(3.6660e-06, device='cuda:0') MSE:  tensor(4.6195e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(6.3926e-05, device='cuda:0') mean:  tensor(1.7440e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0027, device='cuda:0') MSE:  tensor(3.3480e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0096, device='cuda:0')
min of d_p_list:  tensor(-0.0070, device='cuda:0')
Epoch:  121  
Training Loss: 0.5494881868362427
Test Loss:  0.5898033976554871
Test Acc:  0.0
Valid Loss:  0.49188148975372314
Valid Acc:  0.0
std:  0.1142269597134969 
thres:  0.0007000851511955262
Preserved_eigens number check:  512
 12%|█▏        | 121/1000 [29:41<3:33:08, 14.55s/it]Epoch:   122
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  504
Criterion check: 
Mean:  tensor(-3.1682, device='cuda:0') 
Std:  tensor(112.0374, device='cuda:0') 
ABS Max:  tensor(2344.1685, device='cuda:0') 
ABS Min:  tensor(0.0075, device='cuda:0')
Criterion check:  tensor([0.9999, 0.9996, 1.0001, 1.0000, 0.9999, 1.0000, 1.0000, 0.9999, 0.9999,
        0.9995], device='cuda:0') tensor(241, device='cuda:0')
max of Lambda2 tensor(111176.7344, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(1.0636, device='cuda:0')
min of grad d_p:  tensor(-0.2120, device='cuda:0')
max|min: (J_L, Jta/N)  (1.063563346862793, 1.0635626316070557, ratio: 0.9999993443489075)|(-0.21199268102645874, -0.21199262142181396)

 check Jacobi res:  torch.Size([793601]) max:  tensor(7.1526e-07, device='cuda:0') mean:  tensor(1.6011e-12, device='cuda:0') min:  tensor(-3.0916e-07, device='cuda:0') norm:  tensor(3.7316e-06, device='cuda:0') MSE:  tensor(4.7021e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(6.3988e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0102, device='cuda:0') MSE:  tensor(1.2829e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0373, device='cuda:0')
min of d_p_list:  tensor(-0.0289, device='cuda:0')
Epoch:  122  
Training Loss: 0.46667391061782837
Test Loss:  0.49857276678085327
Test Acc:  0.0
Valid Loss:  0.4184493124485016
Valid Acc:  0.0
std:  0.09425321974407576 
thres:  0.0006142005443572998
Preserved_eigens number check:  512
 12%|█▏        | 122/1000 [29:56<3:32:28, 14.52s/it]Epoch:   123
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  505
Criterion check: 
Mean:  tensor(9.5297, device='cuda:0') 
Std:  tensor(534.5751, device='cuda:0') 
ABS Max:  tensor(8451.8525, device='cuda:0') 
ABS Min:  tensor(0.0313, device='cuda:0')
Criterion check:  tensor([1.0001, 0.9978, 1.0000, 0.9998, 1.0239, 1.0002, 1.0002, 1.0004, 0.9998,
        1.0030], device='cuda:0') tensor(247, device='cuda:0')
max of Lambda2 tensor(110451.5312, device='cuda:0')
min of Lambda2 tensor(4.5678e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.5116, device='cuda:0')
min of grad d_p:  tensor(-0.2104, device='cuda:0')
max|min: (J_L, Jta/N)  (0.511634111404419, 0.511634349822998, ratio: 1.0000004768371582)|(-0.2104494869709015, -0.21044950187206268)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.3842e-07, device='cuda:0') mean:  tensor(-1.4411e-12, device='cuda:0') min:  tensor(-2.4855e-07, device='cuda:0') norm:  tensor(3.5731e-06, device='cuda:0') MSE:  tensor(4.5023e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0020, device='cuda:0') mean:  tensor(2.8614e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0444, device='cuda:0') MSE:  tensor(5.5914e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0131, device='cuda:0')
min of d_p_list:  tensor(-0.0068, device='cuda:0')
Epoch:  123  
Training Loss: 0.4022310972213745
Test Loss:  0.43044212460517883
Test Acc:  0.0
Valid Loss:  0.3622934818267822
Valid Acc:  0.0
std:  0.10606361056310919 
thres:  0.0005496527671813964
Preserved_eigens number check:  512
 12%|█▏        | 123/1000 [30:10<3:32:16, 14.52s/it]Epoch:   124
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  506
Criterion check: 
Mean:  tensor(0.1268, device='cuda:0') 
Std:  tensor(19.0884, device='cuda:0') 
ABS Max:  tensor(347.0524, device='cuda:0') 
ABS Min:  tensor(0.0020, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0026, 1.0000, 1.0000, 1.0000, 1.0000,
        0.9999], device='cuda:0') tensor(214, device='cuda:0')
max of Lambda2 tensor(110381.6406, device='cuda:0')
min of Lambda2 tensor(1.8204e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.4863, device='cuda:0')
min of grad d_p:  tensor(-0.2012, device='cuda:0')
max|min: (J_L, Jta/N)  (0.4862987995147705, 0.48629868030548096, ratio: 0.9999997615814209)|(-0.20123973488807678, -0.20123974978923798)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.0585e-07, device='cuda:0') mean:  tensor(-3.1930e-11, device='cuda:0') min:  tensor(-4.3603e-07, device='cuda:0') norm:  tensor(3.2363e-06, device='cuda:0') MSE:  tensor(4.0780e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(4.4914e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0071, device='cuda:0') MSE:  tensor(8.9745e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0098, device='cuda:0')
min of d_p_list:  tensor(-0.0071, device='cuda:0')
Epoch:  124  
Training Loss: 0.35442304611206055
Test Loss:  0.3794572353363037
Test Acc:  0.0
Valid Loss:  0.3193976879119873
Valid Acc:  0.0
std:  0.1177139106770809 
thres:  0.0004921299338340759
Preserved_eigens number check:  512
 12%|█▏        | 124/1000 [30:25<3:32:01, 14.52s/it]Epoch:   125
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  503
Criterion check: 
Mean:  tensor(-46.8417, device='cuda:0') 
Std:  tensor(11458.5371, device='cuda:0') 
ABS Max:  tensor(200373.3594, device='cuda:0') 
ABS Min:  tensor(0.0104, device='cuda:0')
Criterion check:  tensor([0.9964, 1.0273, 1.0019, 0.9987, 2.0697, 1.0038, 0.9925, 1.0130, 0.9915,
        1.0472], device='cuda:0') tensor(265, device='cuda:0')
max of Lambda2 tensor(110869.9062, device='cuda:0')
min of Lambda2 tensor(1.5593e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.4626, device='cuda:0')
min of grad d_p:  tensor(-0.1921, device='cuda:0')
max|min: (J_L, Jta/N)  (0.4626166820526123, 0.46261686086654663, ratio: 1.0000003576278687)|(-0.19212593138217926, -0.19212594628334045)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.7497e-07, device='cuda:0') mean:  tensor(-1.5464e-11, device='cuda:0') min:  tensor(-3.2783e-07, device='cuda:0') norm:  tensor(3.1704e-06, device='cuda:0') MSE:  tensor(3.9949e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.1331, device='cuda:0') mean:  tensor(0.0016, device='cuda:0') min:  tensor(1.0279e-12, device='cuda:0') norm:  tensor(2.4903, device='cuda:0') MSE:  tensor(3.1380e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1345, device='cuda:0')
min of d_p_list:  tensor(-0.0458, device='cuda:0')
Epoch:  125  
Training Loss: 0.31149953603744507
Test Loss:  0.33680927753448486
Test Acc:  0.0
Valid Loss:  0.27958399057388306
Valid Acc:  0.0
std:  0.08400579379833827 
thres:  0.00041686315536499025
Preserved_eigens number check:  512
 12%|█▎        | 125/1000 [30:39<3:31:54, 14.53s/it]Epoch:   126
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  504
Criterion check: 
Mean:  tensor(21.2557, device='cuda:0') 
Std:  tensor(360.4122, device='cuda:0') 
ABS Max:  tensor(6298.9868, device='cuda:0') 
ABS Min:  tensor(0.0063, device='cuda:0')
Criterion check:  tensor([1.0001, 0.9999, 1.0001, 1.0000, 1.0003, 1.0000, 1.0000, 1.0001, 1.0001,
        1.0003], device='cuda:0') tensor(231, device='cuda:0')
max of Lambda2 tensor(117316.7500, device='cuda:0')
min of Lambda2 tensor(2.6496e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.4706, device='cuda:0')
min of grad d_p:  tensor(-0.1884, device='cuda:0')
max|min: (J_L, Jta/N)  (0.4706028699874878, 0.47060295939445496, ratio: 1.000000238418579)|(-0.18840065598487854, -0.18840061128139496)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.0862e-07, device='cuda:0') mean:  tensor(1.4641e-11, device='cuda:0') min:  tensor(-3.0066e-07, device='cuda:0') norm:  tensor(3.4834e-06, device='cuda:0') MSE:  tensor(4.3893e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(1.0662e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0165, device='cuda:0') MSE:  tensor(2.0836e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0231, device='cuda:0')
min of d_p_list:  tensor(-0.0213, device='cuda:0')
Epoch:  126  
Training Loss: 0.28626930713653564
Test Loss:  0.31141626834869385
Test Acc:  0.0
Valid Loss:  0.2578611969947815
Valid Acc:  0.0
std:  0.06464268783820301 
thres:  0.0003642193794250488
Preserved_eigens number check:  512
 13%|█▎        | 126/1000 [30:54<3:31:26, 14.52s/it]Epoch:   127
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  506
Criterion check: 
Mean:  tensor(-4.7652, device='cuda:0') 
Std:  tensor(81.6528, device='cuda:0') 
ABS Max:  tensor(1384.8691, device='cuda:0') 
ABS Min:  tensor(0.0005, device='cuda:0')
Criterion check:  tensor([0.9999, 1.0000, 0.9999, 1.0000, 0.9995, 1.0000, 1.0001, 1.0001, 1.0000,
        1.0003], device='cuda:0') tensor(218, device='cuda:0')
max of Lambda2 tensor(110487.3672, device='cuda:0')
min of Lambda2 tensor(4.9847e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.4618, device='cuda:0')
min of grad d_p:  tensor(-0.1966, device='cuda:0')
max|min: (J_L, Jta/N)  (0.46182161569595337, 0.461821585893631, ratio: 0.9999999403953552)|(-0.19655869901180267, -0.19655868411064148)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.3842e-07, device='cuda:0') mean:  tensor(-2.5890e-11, device='cuda:0') min:  tensor(-3.1738e-07, device='cuda:0') norm:  tensor(2.9185e-06, device='cuda:0') MSE:  tensor(3.6776e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(2.7762e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0044, device='cuda:0') MSE:  tensor(5.5126e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0081, device='cuda:0')
min of d_p_list:  tensor(-0.0057, device='cuda:0')
Epoch:  127  
Training Loss: 0.26265808939933777
Test Loss:  0.2847234010696411
Test Acc:  0.0
Valid Loss:  0.23666143417358398
Valid Acc:  0.0
std:  0.04977280193639924 
thres:  0.00032341621518135075
Preserved_eigens number check:  512
 13%|█▎        | 127/1000 [31:08<3:31:12, 14.52s/it]Epoch:   128
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  505
Criterion check: 
Mean:  tensor(0.4914, device='cuda:0') 
Std:  tensor(23.1741, device='cuda:0') 
ABS Max:  tensor(284.1172, device='cuda:0') 
ABS Min:  tensor(0.0028, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 0.9999, 1.0000, 1.0001, 1.0000, 1.0000, 1.0001, 0.9999,
        1.0000], device='cuda:0') tensor(216, device='cuda:0')
max of Lambda2 tensor(112070.7422, device='cuda:0')
min of Lambda2 tensor(4.1605e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.4391, device='cuda:0')
min of grad d_p:  tensor(-0.1886, device='cuda:0')
max|min: (J_L, Jta/N)  (0.4390510320663452, 0.43905118107795715, ratio: 1.0000003576278687)|(-0.18862923979759216, -0.1886294186115265)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.7881e-07, device='cuda:0') mean:  tensor(1.8885e-11, device='cuda:0') min:  tensor(-3.1920e-07, device='cuda:0') norm:  tensor(2.9080e-06, device='cuda:0') MSE:  tensor(3.6644e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(3.5470e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0059, device='cuda:0') MSE:  tensor(7.4728e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0121, device='cuda:0')
min of d_p_list:  tensor(-0.0117, device='cuda:0')
Epoch:  128  
Training Loss: 0.24138081073760986
Test Loss:  0.2607569992542267
Test Acc:  0.0
Valid Loss:  0.21819081902503967
Valid Acc:  0.0
std:  0.03931950681756721 
thres:  0.0002912461578845978
Preserved_eigens number check:  512
 13%|█▎        | 128/1000 [31:23<3:31:02, 14.52s/it]Epoch:   129
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  505
Criterion check: 
Mean:  tensor(-0.6407, device='cuda:0') 
Std:  tensor(70.0522, device='cuda:0') 
ABS Max:  tensor(1462.1865, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([1.0000, 0.9999, 1.0002, 1.0000, 1.0002, 1.0001, 1.0000, 1.0001, 1.0001,
        1.0003], device='cuda:0') tensor(245, device='cuda:0')
max of Lambda2 tensor(113027.3438, device='cuda:0')
min of Lambda2 tensor(2.4189e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.4211, device='cuda:0')
min of grad d_p:  tensor(-0.1798, device='cuda:0')
max|min: (J_L, Jta/N)  (0.42110830545425415, 0.4211081564426422, ratio: 0.9999996423721313)|(-0.17978957295417786, -0.17978955805301666)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.6549e-07, device='cuda:0') mean:  tensor(2.3795e-11, device='cuda:0') min:  tensor(-1.9372e-07, device='cuda:0') norm:  tensor(2.9891e-06, device='cuda:0') MSE:  tensor(3.7666e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(4.2539e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0067, device='cuda:0') MSE:  tensor(8.3811e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0126, device='cuda:0')
min of d_p_list:  tensor(-0.0081, device='cuda:0')
Epoch:  129  
Training Loss: 0.21364711225032806
Test Loss:  0.2311570942401886
Test Acc:  0.0
Valid Loss:  0.19361355900764465
Valid Acc:  0.0
std:  0.034049487656054825 
thres:  0.00026309097111225127
Preserved_eigens number check:  512
 13%|█▎        | 129/1000 [31:37<3:31:35, 14.58s/it]Epoch:   130
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  505
Criterion check: 
Mean:  tensor(-28.4068, device='cuda:0') 
Std:  tensor(714.1338, device='cuda:0') 
ABS Max:  tensor(15956.0361, device='cuda:0') 
ABS Min:  tensor(0.0068, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0000, 1.0000, 0.9995, 1.0000, 1.0001, 0.9997, 0.9997,
        0.9996], device='cuda:0') tensor(253, device='cuda:0')
max of Lambda2 tensor(111872.9453, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.4028, device='cuda:0')
min of grad d_p:  tensor(-0.1711, device='cuda:0')
max|min: (J_L, Jta/N)  (0.4028047025203705, 0.40280482172966003, ratio: 1.000000238418579)|(-0.17112433910369873, -0.17112435400485992)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.9802e-07, device='cuda:0') mean:  tensor(-4.3287e-12, device='cuda:0') min:  tensor(-2.0862e-07, device='cuda:0') norm:  tensor(2.6964e-06, device='cuda:0') MSE:  tensor(3.3977e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(6.8977e-05, device='cuda:0') mean:  tensor(1.2605e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0019, device='cuda:0') MSE:  tensor(2.4364e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0086, device='cuda:0')
min of d_p_list:  tensor(-0.0086, device='cuda:0')
Epoch:  130  
Training Loss: 0.19704094529151917
Test Loss:  0.21327069401741028
Test Acc:  0.0
Valid Loss:  0.17886799573898315
Valid Acc:  0.0
std:  0.03223631803383617 
thres:  0.0002401992529630661
Preserved_eigens number check:  512
 13%|█▎        | 130/1000 [31:52<3:31:13, 14.57s/it]Epoch:   131
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  505
Criterion check: 
Mean:  tensor(-2.7423, device='cuda:0') 
Std:  tensor(74.8426, device='cuda:0') 
ABS Max:  tensor(1650.0267, device='cuda:0') 
ABS Min:  tensor(0.0011, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000,
        1.0001], device='cuda:0') tensor(205, device='cuda:0')
max of Lambda2 tensor(113547.9531, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3862, device='cuda:0')
min of grad d_p:  tensor(-0.1637, device='cuda:0')
max|min: (J_L, Jta/N)  (0.38617318868637085, 0.3861730098724365, ratio: 0.9999995231628418)|(-0.16366827487945557, -0.1636682003736496)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.7881e-07, device='cuda:0') mean:  tensor(1.9982e-11, device='cuda:0') min:  tensor(-2.6217e-07, device='cuda:0') norm:  tensor(2.6972e-06, device='cuda:0') MSE:  tensor(3.3987e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(4.6782e-05, device='cuda:0') mean:  tensor(1.2607e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0020, device='cuda:0') MSE:  tensor(2.4612e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0077, device='cuda:0')
min of d_p_list:  tensor(-0.0044, device='cuda:0')
Epoch:  131  
Training Loss: 0.18120157718658447
Test Loss:  0.1957779973745346
Test Acc:  0.0
Valid Loss:  0.1647830307483673
Valid Acc:  0.0
std:  0.02948332166499023 
thres:  0.0002191857069730759
Preserved_eigens number check:  512
 13%|█▎        | 131/1000 [32:07<3:31:14, 14.59s/it]Epoch:   132
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  504
Criterion check: 
Mean:  tensor(0.6310, device='cuda:0') 
Std:  tensor(16.2593, device='cuda:0') 
ABS Max:  tensor(264.3440, device='cuda:0') 
ABS Min:  tensor(0.0039, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 0.9999, 0.9998, 1.0001,
        0.9998], device='cuda:0') tensor(199, device='cuda:0')
max of Lambda2 tensor(113938.1094, device='cuda:0')
min of Lambda2 tensor(1.0585e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3692, device='cuda:0')
min of grad d_p:  tensor(-0.1595, device='cuda:0')
max|min: (J_L, Jta/N)  (0.3691978454589844, 0.3691977858543396, ratio: 0.9999998211860657)|(-0.15954655408859253, -0.15954658389091492)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.7881e-07, device='cuda:0') mean:  tensor(-1.1316e-11, device='cuda:0') min:  tensor(-2.5285e-07, device='cuda:0') norm:  tensor(2.4168e-06, device='cuda:0') MSE:  tensor(3.0454e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(2.3324e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0037, device='cuda:0') MSE:  tensor(4.6730e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0088, device='cuda:0')
min of d_p_list:  tensor(-0.0070, device='cuda:0')
Epoch:  132  
Training Loss: 0.16479088366031647
Test Loss:  0.17737361788749695
Test Acc:  0.0
Valid Loss:  0.14960217475891113
Valid Acc:  0.0
std:  0.02645631138153909 
thres:  0.00019961226582527162
Preserved_eigens number check:  512
 13%|█▎        | 132/1000 [32:21<3:31:04, 14.59s/it]Epoch:   133
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  504
Criterion check: 
Mean:  tensor(-4.0543, device='cuda:0') 
Std:  tensor(136.2042, device='cuda:0') 
ABS Max:  tensor(2614.2161, device='cuda:0') 
ABS Min:  tensor(0.0009, device='cuda:0')
Criterion check:  tensor([0.9999, 1.0001, 0.9999, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 0.9999,
        1.0001], device='cuda:0') tensor(196, device='cuda:0')
max of Lambda2 tensor(114984., device='cuda:0')
min of Lambda2 tensor(7.1765e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3556, device='cuda:0')
min of grad d_p:  tensor(-0.1551, device='cuda:0')
max|min: (J_L, Jta/N)  (0.355598509311676, 0.3555985391139984, ratio: 1.0000001192092896)|(-0.1551414430141449, -0.1551414579153061)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.1921e-07, device='cuda:0') mean:  tensor(-3.6499e-11, device='cuda:0') min:  tensor(-2.0288e-07, device='cuda:0') norm:  tensor(2.3831e-06, device='cuda:0') MSE:  tensor(3.0029e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(6.4283e-05, device='cuda:0') mean:  tensor(1.2939e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0022, device='cuda:0') MSE:  tensor(2.7795e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0346, device='cuda:0')
min of d_p_list:  tensor(-0.0279, device='cuda:0')
Epoch:  133  
Training Loss: 0.16501586139202118
Test Loss:  0.17830094695091248
Test Acc:  0.0
Valid Loss:  0.14709794521331787
Valid Acc:  0.0
std:  0.018897940721088746 
thres:  0.00018433927595615387
Preserved_eigens number check:  512
 13%|█▎        | 133/1000 [32:36<3:30:54, 14.60s/it]Epoch:   134
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  504
Criterion check: 
Mean:  tensor(0.3019, device='cuda:0') 
Std:  tensor(11.9206, device='cuda:0') 
ABS Max:  tensor(127.5151, device='cuda:0') 
ABS Min:  tensor(0.0016, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000,
        1.0000], device='cuda:0') tensor(203, device='cuda:0')
max of Lambda2 tensor(112881.3594, device='cuda:0')
min of Lambda2 tensor(1.4525e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3315, device='cuda:0')
min of grad d_p:  tensor(-0.1626, device='cuda:0')
max|min: (J_L, Jta/N)  (0.33149802684783936, 0.33149805665016174, ratio: 1.0000001192092896)|(-0.16260983049869537, -0.16260984539985657)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.2861e-07, device='cuda:0') mean:  tensor(-3.5400e-11, device='cuda:0') min:  tensor(-2.0862e-07, device='cuda:0') norm:  tensor(2.4996e-06, device='cuda:0') MSE:  tensor(3.1497e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(6.0589e-05, device='cuda:0') mean:  tensor(1.2507e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0021, device='cuda:0') MSE:  tensor(2.6072e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0519, device='cuda:0')
min of d_p_list:  tensor(-0.0482, device='cuda:0')
Epoch:  134  
Training Loss: 0.13022367656230927
Test Loss:  0.1407586634159088
Test Acc:  0.0
Valid Loss:  0.1168065220117569
Valid Acc:  0.0
std:  0.022196016411055744 
thres:  0.00016765458881855012
Preserved_eigens number check:  512
 13%|█▎        | 134/1000 [32:50<3:30:46, 14.60s/it]Epoch:   135
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  506
Criterion check: 
Mean:  tensor(5.3679, device='cuda:0') 
Std:  tensor(243.7895, device='cuda:0') 
ABS Max:  tensor(3905.0376, device='cuda:0') 
ABS Min:  tensor(0.0014, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0002, 0.9998, 1.0000, 0.9987, 1.0000, 1.0001, 0.9999, 1.0009,
        0.9994], device='cuda:0') tensor(222, device='cuda:0')
max of Lambda2 tensor(109157.0703, device='cuda:0')
min of Lambda2 tensor(3.5548e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.3127, device='cuda:0')
min of grad d_p:  tensor(-0.1659, device='cuda:0')
max|min: (J_L, Jta/N)  (0.3127176761627197, 0.3127177953720093, ratio: 1.0000003576278687)|(-0.16585013270378113, -0.16585010290145874)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.2021e-07, device='cuda:0') mean:  tensor(-1.1946e-11, device='cuda:0') min:  tensor(-2.6877e-07, device='cuda:0') norm:  tensor(2.3264e-06, device='cuda:0') MSE:  tensor(2.9314e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(4.5672e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0073, device='cuda:0') MSE:  tensor(9.2483e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0084, device='cuda:0')
min of d_p_list:  tensor(-0.0059, device='cuda:0')
Epoch:  135  
Training Loss: 0.12662865221500397
Test Loss:  0.13630536198616028
Test Acc:  0.0
Valid Loss:  0.11320026218891144
Valid Acc:  0.0
std:  0.02140704111633573 
thres:  0.00015357213020324707
Preserved_eigens number check:  512
 14%|█▎        | 135/1000 [33:08<3:41:19, 15.35s/it]Epoch:   136
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  505
Criterion check: 
Mean:  tensor(10.5674, device='cuda:0') 
Std:  tensor(164.3968, device='cuda:0') 
ABS Max:  tensor(3596.3818, device='cuda:0') 
ABS Min:  tensor(0.0004, device='cuda:0')
Criterion check:  tensor([0.9999, 1.0002, 1.0001, 1.0000, 0.9990, 1.0000, 1.0001, 1.0003, 1.0006,
        1.0027], device='cuda:0') tensor(246, device='cuda:0')
max of Lambda2 tensor(106634.3438, device='cuda:0')
min of Lambda2 tensor(5.8147e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2988, device='cuda:0')
min of grad d_p:  tensor(-0.1590, device='cuda:0')
max|min: (J_L, Jta/N)  (0.2987635135650635, 0.2987634837627411, ratio: 0.9999998807907104)|(-0.15898750722408295, -0.15898753702640533)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.1921e-07, device='cuda:0') mean:  tensor(-2.0552e-11, device='cuda:0') min:  tensor(-2.7983e-07, device='cuda:0') norm:  tensor(2.2004e-06, device='cuda:0') MSE:  tensor(2.7726e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(2.4174e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0039, device='cuda:0') MSE:  tensor(4.8543e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0061, device='cuda:0')
min of d_p_list:  tensor(-0.0080, device='cuda:0')
Epoch:  136  
Training Loss: 0.12028592079877853
Test Loss:  0.12884704768657684
Test Acc:  0.0
Valid Loss:  0.10728533565998077
Valid Acc:  0.0
std:  0.019461495338560557 
thres:  0.00014138899892568587
Preserved_eigens number check:  512
 14%|█▎        | 136/1000 [33:28<4:03:57, 16.94s/it]Epoch:   137
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  505
Criterion check: 
Mean:  tensor(13.9516, device='cuda:0') 
Std:  tensor(167.9851, device='cuda:0') 
ABS Max:  tensor(3116.8447, device='cuda:0') 
ABS Min:  tensor(0.0115, device='cuda:0')
Criterion check:  tensor([1.0003, 1.0014, 0.9999, 1.0000, 0.9977, 0.9999, 1.0000, 0.9998, 1.0016,
        1.0093], device='cuda:0') tensor(268, device='cuda:0')
max of Lambda2 tensor(106989.2344, device='cuda:0')
min of Lambda2 tensor(1.3831e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2849, device='cuda:0')
min of grad d_p:  tensor(-0.1526, device='cuda:0')
max|min: (J_L, Jta/N)  (0.2849441170692444, 0.2849441170692444, ratio: 1.0)|(-0.1526426076889038, -0.15264253318309784)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.3040e-07, device='cuda:0') mean:  tensor(-2.1636e-11, device='cuda:0') min:  tensor(-1.3411e-07, device='cuda:0') norm:  tensor(2.1228e-06, device='cuda:0') MSE:  tensor(2.6748e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(9.8256e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0153, device='cuda:0') MSE:  tensor(1.9283e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0147, device='cuda:0')
min of d_p_list:  tensor(-0.0125, device='cuda:0')
Epoch:  137  
Training Loss: 0.11556103825569153
Test Loss:  0.12370665371417999
Test Acc:  0.0
Valid Loss:  0.10261057317256927
Valid Acc:  0.0
std:  0.017484100271899932 
thres:  0.0001315430298447609
Preserved_eigens number check:  512
 14%|█▎        | 137/1000 [33:43<3:54:27, 16.30s/it]Epoch:   138
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  505
Criterion check: 
Mean:  tensor(21.7234, device='cuda:0') 
Std:  tensor(644.4422, device='cuda:0') 
ABS Max:  tensor(14170.3057, device='cuda:0') 
ABS Min:  tensor(0.0029, device='cuda:0')
Criterion check:  tensor([1.0001, 0.9998, 1.0008, 1.0000, 1.0011, 1.0003, 1.0000, 0.9997, 1.0001,
        1.0008], device='cuda:0') tensor(221, device='cuda:0')
max of Lambda2 tensor(108502.5469, device='cuda:0')
min of Lambda2 tensor(3.7041e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2730, device='cuda:0')
min of grad d_p:  tensor(-0.1467, device='cuda:0')
max|min: (J_L, Jta/N)  (0.2729825973510742, 0.2729825973510742, ratio: 1.0)|(-0.14673197269439697, -0.14673201739788055)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.1808e-07, device='cuda:0') mean:  tensor(3.5513e-11, device='cuda:0') min:  tensor(-1.3411e-07, device='cuda:0') norm:  tensor(2.1261e-06, device='cuda:0') MSE:  tensor(2.6791e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(7.1951e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0116, device='cuda:0') MSE:  tensor(1.4569e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0090, device='cuda:0')
min of d_p_list:  tensor(-0.0087, device='cuda:0')
Epoch:  138  
Training Loss: 0.10859885811805725
Test Loss:  0.11606903374195099
Test Acc:  0.0
Valid Loss:  0.09674277156591415
Valid Acc:  0.0
std:  0.0077187787160867445 
thres:  0.0001202596291899681
Preserved_eigens number check:  512
 14%|█▍        | 138/1000 [33:58<3:46:42, 15.78s/it]Epoch:   139
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  505
Criterion check: 
Mean:  tensor(0.8400, device='cuda:0') 
Std:  tensor(40.0994, device='cuda:0') 
ABS Max:  tensor(500.2874, device='cuda:0') 
ABS Min:  tensor(0.0007, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0011, 1.0000, 1.0002, 1.0000, 1.0001, 1.0001, 1.0003,
        1.0006], device='cuda:0') tensor(228, device='cuda:0')
max of Lambda2 tensor(108695.3047, device='cuda:0')
min of Lambda2 tensor(1.6921e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2603, device='cuda:0')
min of grad d_p:  tensor(-0.1399, device='cuda:0')
max|min: (J_L, Jta/N)  (0.26030731201171875, 0.26030731201171875, ratio: 1.0)|(-0.13987429440021515, -0.13987430930137634)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.3411e-07, device='cuda:0') mean:  tensor(-3.8130e-12, device='cuda:0') min:  tensor(-1.0431e-07, device='cuda:0') norm:  tensor(1.8136e-06, device='cuda:0') MSE:  tensor(2.2853e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(3.4929e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0054, device='cuda:0') MSE:  tensor(6.8205e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0090, device='cuda:0')
min of d_p_list:  tensor(-0.0070, device='cuda:0')
Epoch:  139  
Training Loss: 0.09971386194229126
Test Loss:  0.1064007580280304
Test Acc:  0.0
Valid Loss:  0.08887487649917603
Valid Acc:  0.0
std:  0.009322813721913013 
thres:  0.0001141576662659645
Preserved_eigens number check:  512
 14%|█▍        | 139/1000 [34:12<3:41:06, 15.41s/it]Epoch:   140
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  507
Criterion check: 
Mean:  tensor(-0.9766, device='cuda:0') 
Std:  tensor(48.9282, device='cuda:0') 
ABS Max:  tensor(678.7715, device='cuda:0') 
ABS Min:  tensor(0.0007, device='cuda:0')
Criterion check:  tensor([1.0000, 0.9999, 0.9993, 1.0000, 0.9999, 0.9999, 1.0000, 1.0001, 1.0002,
        1.0020], device='cuda:0') tensor(229, device='cuda:0')
max of Lambda2 tensor(109721.1719, device='cuda:0')
min of Lambda2 tensor(8.0545e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2489, device='cuda:0')
min of grad d_p:  tensor(-0.1342, device='cuda:0')
max|min: (J_L, Jta/N)  (0.24886494874954224, 0.24886493384838104, ratio: 0.9999999403953552)|(-0.13423678278923035, -0.13423684239387512)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.5239e-07, device='cuda:0') mean:  tensor(-1.5272e-11, device='cuda:0') min:  tensor(-1.2942e-07, device='cuda:0') norm:  tensor(1.8166e-06, device='cuda:0') MSE:  tensor(2.2891e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(5.6632e-05, device='cuda:0') mean:  tensor(1.7602e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0028, device='cuda:0') MSE:  tensor(3.5185e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0074, device='cuda:0')
min of d_p_list:  tensor(-0.0064, device='cuda:0')
Epoch:  140  
Training Loss: 0.09157687425613403
Test Loss:  0.097590871155262
Test Acc:  0.0
Valid Loss:  0.08165740966796875
Valid Acc:  0.0
std:  0.010423200354036643 
thres:  0.00010714731067419053
Preserved_eigens number check:  512
 14%|█▍        | 140/1000 [34:27<3:37:43, 15.19s/it]Epoch:   141
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  504
Criterion check: 
Mean:  tensor(11.3719, device='cuda:0') 
Std:  tensor(146.4382, device='cuda:0') 
ABS Max:  tensor(2882.3904, device='cuda:0') 
ABS Min:  tensor(0.0016, device='cuda:0')
Criterion check:  tensor([1.0000, 0.9999, 0.9991, 1.0000, 0.9999, 1.0002, 1.0000, 1.0000, 1.0000,
        0.9987], device='cuda:0') tensor(217, device='cuda:0')
max of Lambda2 tensor(110081.7891, device='cuda:0')
min of Lambda2 tensor(5.2710e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2378, device='cuda:0')
min of grad d_p:  tensor(-0.1319, device='cuda:0')
max|min: (J_L, Jta/N)  (0.23781131207942963, 0.23781131207942963, ratio: 1.0)|(-0.13192138075828552, -0.13192138075828552)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.0664e-07, device='cuda:0') mean:  tensor(3.5412e-13, device='cuda:0') min:  tensor(-1.0431e-07, device='cuda:0') norm:  tensor(1.8238e-06, device='cuda:0') MSE:  tensor(2.2981e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(5.1122e-05, device='cuda:0') mean:  tensor(1.7013e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0028, device='cuda:0') MSE:  tensor(3.5531e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0099, device='cuda:0')
min of d_p_list:  tensor(-0.0091, device='cuda:0')
Epoch:  141  
Training Loss: 0.08401219546794891
Test Loss:  0.08898115158081055
Test Acc:  0.0
Valid Loss:  0.07520992308855057
Valid Acc:  0.0
std:  0.011337278137426098 
thres:  9.98925656080246e-05
Preserved_eigens number check:  512
 14%|█▍        | 141/1000 [34:42<3:35:36, 15.06s/it]Epoch:   142
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  504
Criterion check: 
Mean:  tensor(-5.0948, device='cuda:0') 
Std:  tensor(157.4049, device='cuda:0') 
ABS Max:  tensor(2846.5786, device='cuda:0') 
ABS Min:  tensor(0.0008, device='cuda:0')
Criterion check:  tensor([1.0000, 0.9998, 1.0009, 1.0000, 1.0004, 1.0000, 1.0006, 0.9999, 0.9996,
        1.0005], device='cuda:0') tensor(232, device='cuda:0')
max of Lambda2 tensor(110897.4141, device='cuda:0')
min of Lambda2 tensor(3.2761e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2281, device='cuda:0')
min of grad d_p:  tensor(-0.1262, device='cuda:0')
max|min: (J_L, Jta/N)  (0.22814632952213287, 0.22814629971981049, ratio: 0.9999998807907104)|(-0.12621165812015533, -0.12621162831783295)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.8234e-07, device='cuda:0') mean:  tensor(-1.3791e-11, device='cuda:0') min:  tensor(-1.0431e-07, device='cuda:0') norm:  tensor(1.7340e-06, device='cuda:0') MSE:  tensor(2.1849e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(2.7150e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0041, device='cuda:0') MSE:  tensor(5.1970e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0138, device='cuda:0')
min of d_p_list:  tensor(-0.0195, device='cuda:0')
Epoch:  142  
Training Loss: 0.07478339225053787
Test Loss:  0.0786190927028656
Test Acc:  0.0
Valid Loss:  0.06759543716907501
Valid Acc:  0.0
std:  0.01179046773175779 
thres:  9.173703640699387e-05
Preserved_eigens number check:  512
 14%|█▍        | 142/1000 [34:56<3:33:37, 14.94s/it]Epoch:   143
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  505
Criterion check: 
Mean:  tensor(-4.5957, device='cuda:0') 
Std:  tensor(101.1041, device='cuda:0') 
ABS Max:  tensor(2202.2214, device='cuda:0') 
ABS Min:  tensor(0.0006, device='cuda:0')
Criterion check:  tensor([1.0000, 0.9994, 1.0003, 1.0000, 0.9995, 1.0000, 1.0000, 1.0001, 1.0000,
        0.9998], device='cuda:0') tensor(222, device='cuda:0')
max of Lambda2 tensor(109269.1719, device='cuda:0')
min of Lambda2 tensor(2.6022e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2220, device='cuda:0')
min of grad d_p:  tensor(-0.1155, device='cuda:0')
max|min: (J_L, Jta/N)  (0.22200798988342285, 0.22200804948806763, ratio: 1.000000238418579)|(-0.11554846167564392, -0.11554845422506332)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.9407e-08, device='cuda:0') mean:  tensor(-6.0751e-12, device='cuda:0') min:  tensor(-1.7998e-07, device='cuda:0') norm:  tensor(1.6367e-06, device='cuda:0') MSE:  tensor(2.0624e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(8.4075e-05, device='cuda:0') mean:  tensor(2.4121e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0041, device='cuda:0') MSE:  tensor(5.1672e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0055, device='cuda:0')
min of d_p_list:  tensor(-0.0048, device='cuda:0')
Epoch:  143  
Training Loss: 0.07035213708877563
Test Loss:  0.07413441687822342
Test Acc:  0.0
Valid Loss:  0.0634530782699585
Valid Acc:  0.0
std:  0.010728524597580153 
thres:  8.408769220113755e-05
Preserved_eigens number check:  512
 14%|█▍        | 143/1000 [35:11<3:32:13, 14.86s/it]Epoch:   144
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  507
Criterion check: 
Mean:  tensor(-13.4534, device='cuda:0') 
Std:  tensor(275.5516, device='cuda:0') 
ABS Max:  tensor(5903.2197, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0119, 1.0002, 1.0000, 1.0005, 1.0000, 1.0000, 0.9998, 1.0001,
        0.9991], device='cuda:0') tensor(233, device='cuda:0')
max of Lambda2 tensor(109550.4688, device='cuda:0')
min of Lambda2 tensor(7.6705e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2120, device='cuda:0')
min of grad d_p:  tensor(-0.1107, device='cuda:0')
max|min: (J_L, Jta/N)  (0.21200445294380188, 0.21200443804264069, ratio: 0.9999999403953552)|(-0.11069603264331818, -0.11069604754447937)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.1921e-07, device='cuda:0') mean:  tensor(3.6667e-12, device='cuda:0') min:  tensor(-1.6952e-07, device='cuda:0') norm:  tensor(1.5766e-06, device='cuda:0') MSE:  tensor(1.9866e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(6.3354e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0103, device='cuda:0') MSE:  tensor(1.2951e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0037, device='cuda:0')
min of d_p_list:  tensor(-0.0047, device='cuda:0')
Epoch:  144  
Training Loss: 0.06511273980140686
Test Loss:  0.06865878403186798
Test Acc:  0.0
Valid Loss:  0.058827828615903854
Valid Acc:  0.0
std:  0.009507158432627795 
thres:  7.716746777296065e-05
Preserved_eigens number check:  512
 14%|█▍        | 144/1000 [35:26<3:31:36, 14.83s/it]Epoch:   145
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  505
Criterion check: 
Mean:  tensor(-2.1695, device='cuda:0') 
Std:  tensor(38.5238, device='cuda:0') 
ABS Max:  tensor(830.3458, device='cuda:0') 
ABS Min:  tensor(0.0007, device='cuda:0')
Criterion check:  tensor([1.0000, 0.9988, 1.0001, 1.0000, 0.9997, 1.0000, 1.0000, 1.0001, 0.9999,
        0.9997], device='cuda:0') tensor(226, device='cuda:0')
max of Lambda2 tensor(110316.7891, device='cuda:0')
min of Lambda2 tensor(1.5246e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.2025, device='cuda:0')
min of grad d_p:  tensor(-0.1054, device='cuda:0')
max|min: (J_L, Jta/N)  (0.20250624418258667, 0.20250630378723145, ratio: 1.000000238418579)|(-0.10535731911659241, -0.1053573340177536)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.3167e-07, device='cuda:0') mean:  tensor(4.6029e-12, device='cuda:0') min:  tensor(-1.4927e-07, device='cuda:0') norm:  tensor(1.4035e-06, device='cuda:0') MSE:  tensor(1.7685e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(9.6057e-05, device='cuda:0') mean:  tensor(3.1552e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0049, device='cuda:0') MSE:  tensor(6.1335e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0246, device='cuda:0')
min of d_p_list:  tensor(-0.0234, device='cuda:0')
Epoch:  145  
Training Loss: 0.06715001165866852
Test Loss:  0.0698564350605011
Test Acc:  0.0
Valid Loss:  0.06069362908601761
Valid Acc:  0.0
std:  0.006712889330963046 
thres:  7.228209525346756e-05
Preserved_eigens number check:  512
 14%|█▍        | 145/1000 [35:40<3:31:06, 14.81s/it]Epoch:   146
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  504
Criterion check: 
Mean:  tensor(-0.7109, device='cuda:0') 
Std:  tensor(38.6736, device='cuda:0') 
ABS Max:  tensor(438.2177, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 0.9999, 1.0000, 1.0013, 1.0000, 1.0002, 0.9998, 1.0000,
        0.9994], device='cuda:0') tensor(214, device='cuda:0')
max of Lambda2 tensor(115958.8047, device='cuda:0')
min of Lambda2 tensor(5.3232e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1970, device='cuda:0')
min of grad d_p:  tensor(-0.0956, device='cuda:0')
max|min: (J_L, Jta/N)  (0.1970292031764984, 0.19702927768230438, ratio: 1.0000003576278687)|(-0.09555689245462418, -0.09555685520172119)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.4142e-07, device='cuda:0') mean:  tensor(5.3140e-12, device='cuda:0') min:  tensor(-1.6952e-07, device='cuda:0') norm:  tensor(1.5765e-06, device='cuda:0') MSE:  tensor(1.9866e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(9.1807e-05, device='cuda:0') mean:  tensor(2.8508e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0045, device='cuda:0') MSE:  tensor(5.6775e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0155, device='cuda:0')
min of d_p_list:  tensor(-0.0107, device='cuda:0')
Epoch:  146  
Training Loss: 0.05999312922358513
Test Loss:  0.06276550143957138
Test Acc:  0.0
Valid Loss:  0.054048895835876465
Valid Acc:  0.0
std:  0.00496698585140705 
thres:  6.74782820045948e-05
Preserved_eigens number check:  512
 15%|█▍        | 146/1000 [35:55<3:30:34, 14.79s/it]Epoch:   147
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  506
Criterion check: 
Mean:  tensor(-7.7612, device='cuda:0') 
Std:  tensor(195.7733, device='cuda:0') 
ABS Max:  tensor(4363.9731, device='cuda:0') 
ABS Min:  tensor(0.0016, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0007, 0.9997, 1.0000, 0.9978, 1.0000, 1.0000, 0.9999, 1.0000,
        0.9994], device='cuda:0') tensor(217, device='cuda:0')
max of Lambda2 tensor(116557.1641, device='cuda:0')
min of Lambda2 tensor(8.5876e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1886, device='cuda:0')
min of grad d_p:  tensor(-0.0907, device='cuda:0')
max|min: (J_L, Jta/N)  (0.18858733773231506, 0.18858733773231506, ratio: 1.0)|(-0.09066721051931381, -0.0906672477722168)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.3236e-07, device='cuda:0') mean:  tensor(-3.2572e-11, device='cuda:0') min:  tensor(-1.0431e-07, device='cuda:0') norm:  tensor(1.3839e-06, device='cuda:0') MSE:  tensor(1.7438e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(4.8144e-05, device='cuda:0') mean:  tensor(1.3045e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0021, device='cuda:0') MSE:  tensor(2.6332e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0050, device='cuda:0')
min of d_p_list:  tensor(-0.0037, device='cuda:0')
Epoch:  147  
Training Loss: 0.05472811311483383
Test Loss:  0.05735618993639946
Test Acc:  0.0
Valid Loss:  0.04943151772022247
Valid Acc:  0.0
std:  0.005515687971780747 
thres:  6.3467226177454e-05
Preserved_eigens number check:  512
 15%|█▍        | 147/1000 [36:10<3:31:30, 14.88s/it]Epoch:   148
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  505
Criterion check: 
Mean:  tensor(3.3297, device='cuda:0') 
Std:  tensor(306.0314, device='cuda:0') 
ABS Max:  tensor(4530.3931, device='cuda:0') 
ABS Min:  tensor(0.0053, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0014, 0.9989, 0.9999, 1.0065, 1.0000, 1.0002, 1.0002, 0.9998,
        1.0000], device='cuda:0') tensor(253, device='cuda:0')
max of Lambda2 tensor(117072.0234, device='cuda:0')
min of Lambda2 tensor(4.1144e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1800, device='cuda:0')
min of grad d_p:  tensor(-0.0863, device='cuda:0')
max|min: (J_L, Jta/N)  (0.1800435185432434, 0.1800435185432434, ratio: 1.0)|(-0.08629587292671204, -0.08629586547613144)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.7555e-07, device='cuda:0') mean:  tensor(5.3295e-12, device='cuda:0') min:  tensor(-8.9407e-08, device='cuda:0') norm:  tensor(1.5235e-06, device='cuda:0') MSE:  tensor(1.9198e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(8.9269e-05, device='cuda:0') mean:  tensor(3.4204e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0055, device='cuda:0') MSE:  tensor(6.8739e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0100, device='cuda:0')
min of d_p_list:  tensor(-0.0086, device='cuda:0')
Epoch:  148  
Training Loss: 0.04899226501584053
Test Loss:  0.051306210458278656
Test Acc:  0.0
Valid Loss:  0.04448700696229935
Valid Acc:  0.0
std:  0.006678139627009694 
thres:  5.9195251762866975e-05
Preserved_eigens number check:  512
 15%|█▍        | 148/1000 [36:25<3:30:35, 14.83s/it]Epoch:   149
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  506
Criterion check: 
Mean:  tensor(6.6992, device='cuda:0') 
Std:  tensor(130.8826, device='cuda:0') 
ABS Max:  tensor(2908.6350, device='cuda:0') 
ABS Min:  tensor(9.9079e-05, device='cuda:0')
Criterion check:  tensor([1.0000, 0.9998, 0.9999, 1.0000, 1.0005, 1.0000, 1.0000, 1.0000, 1.0000,
        1.0000], device='cuda:0') tensor(224, device='cuda:0')
max of Lambda2 tensor(112509.3203, device='cuda:0')
min of Lambda2 tensor(1.3410e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1726, device='cuda:0')
min of grad d_p:  tensor(-0.0826, device='cuda:0')
max|min: (J_L, Jta/N)  (0.17256784439086914, 0.17256778478622437, ratio: 0.9999996423721313)|(-0.08263999968767166, -0.08263996988534927)

 check Jacobi res:  torch.Size([793601]) max:  tensor(7.6294e-08, device='cuda:0') mean:  tensor(-4.3633e-12, device='cuda:0') min:  tensor(-1.4551e-07, device='cuda:0') norm:  tensor(1.2624e-06, device='cuda:0') MSE:  tensor(1.5907e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(2.9651e-05, device='cuda:0') mean:  tensor(8.1405e-07, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0013, device='cuda:0') MSE:  tensor(1.6156e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0041, device='cuda:0')
min of d_p_list:  tensor(-0.0047, device='cuda:0')
Epoch:  149  
Training Loss: 0.04468781128525734
Test Loss:  0.046931277960538864
Test Acc:  0.0
Valid Loss:  0.04068082943558693
Valid Acc:  0.0
std:  0.007937271167553066 
thres:  5.511026605963707e-05
Preserved_eigens number check:  512
 15%|█▍        | 149/1000 [36:40<3:30:02, 14.81s/it]Epoch:   150
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  506
Criterion check: 
Mean:  tensor(-23.6920, device='cuda:0') 
Std:  tensor(600.0784, device='cuda:0') 
ABS Max:  tensor(13367.6055, device='cuda:0') 
ABS Min:  tensor(0.0020, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0003, 1.0000, 1.0000, 1.0002, 1.0000, 0.9999, 1.0000, 1.0000,
        0.9994], device='cuda:0') tensor(221, device='cuda:0')
max of Lambda2 tensor(111827.9297, device='cuda:0')
min of Lambda2 tensor(2.9249e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1650, device='cuda:0')
min of grad d_p:  tensor(-0.0794, device='cuda:0')
max|min: (J_L, Jta/N)  (0.164995476603508, 0.16499543190002441, ratio: 0.9999997019767761)|(-0.07938520610332489, -0.07938524335622787)

 check Jacobi res:  torch.Size([793601]) max:  tensor(7.4506e-08, device='cuda:0') mean:  tensor(-5.3030e-12, device='cuda:0') min:  tensor(-1.2205e-07, device='cuda:0') norm:  tensor(1.2783e-06, device='cuda:0') MSE:  tensor(1.6107e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(6.5546e-05, device='cuda:0') mean:  tensor(2.0085e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0031, device='cuda:0') MSE:  tensor(3.9118e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0037, device='cuda:0')
min of d_p_list:  tensor(-0.0038, device='cuda:0')
Epoch:  150  
Training Loss: 0.04133373498916626
Test Loss:  0.0433339923620224
Test Acc:  0.0
Valid Loss:  0.03777056932449341
Valid Acc:  0.0
std:  0.006731161474327284 
thres:  4.994701072573662e-05
Preserved_eigens number check:  512
 15%|█▌        | 150/1000 [36:55<3:31:48, 14.95s/it]Epoch:   151
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  504
Criterion check: 
Mean:  tensor(2.9264, device='cuda:0') 
Std:  tensor(109.7684, device='cuda:0') 
ABS Max:  tensor(2077.9653, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0003, 1.0002, 1.0000, 1.0003, 0.9999, 1.0000, 1.0000, 1.0000,
        0.9998], device='cuda:0') tensor(222, device='cuda:0')
max of Lambda2 tensor(110512.7812, device='cuda:0')
min of Lambda2 tensor(6.6290e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1576, device='cuda:0')
min of grad d_p:  tensor(-0.0739, device='cuda:0')
max|min: (J_L, Jta/N)  (0.15759342908859253, 0.15759341418743134, ratio: 0.9999998807907104)|(-0.07386921346187592, -0.07386921346187592)

 check Jacobi res:  torch.Size([793601]) max:  tensor(7.4506e-08, device='cuda:0') mean:  tensor(9.6135e-13, device='cuda:0') min:  tensor(-1.0084e-07, device='cuda:0') norm:  tensor(1.1241e-06, device='cuda:0') MSE:  tensor(1.4164e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(5.9374e-05, device='cuda:0') mean:  tensor(2.1946e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0035, device='cuda:0') MSE:  tensor(4.4435e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0170, device='cuda:0')
min of d_p_list:  tensor(-0.0130, device='cuda:0')
Epoch:  151  
Training Loss: 0.03971973806619644
Test Loss:  0.04186005890369415
Test Acc:  0.0
Valid Loss:  0.03646284341812134
Valid Acc:  0.0
std:  0.005440830917111946 
thres:  4.589233249425888e-05
Preserved_eigens number check:  512
 15%|█▌        | 151/1000 [37:10<3:30:38, 14.89s/it]Epoch:   152
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  506
Criterion check: 
Mean:  tensor(-0.2979, device='cuda:0') 
Std:  tensor(27.9249, device='cuda:0') 
ABS Max:  tensor(491.6471, device='cuda:0') 
ABS Min:  tensor(0.0005, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0003, 1.0002, 1.0000, 1.0000, 1.0000, 1.0000, 1.0001, 0.9999,
        0.9992], device='cuda:0') tensor(219, device='cuda:0')
max of Lambda2 tensor(109793.6641, device='cuda:0')
min of Lambda2 tensor(1.3088e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1516, device='cuda:0')
min of grad d_p:  tensor(-0.0747, device='cuda:0')
max|min: (J_L, Jta/N)  (0.1515573114156723, 0.1515573412179947, ratio: 1.000000238418579)|(-0.07466664910316467, -0.07466663420200348)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.3993e-08, device='cuda:0') mean:  tensor(3.2390e-12, device='cuda:0') min:  tensor(-1.0783e-07, device='cuda:0') norm:  tensor(1.1874e-06, device='cuda:0') MSE:  tensor(1.4962e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(2.7294e-05, device='cuda:0') mean:  tensor(9.6753e-07, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0015, device='cuda:0') MSE:  tensor(1.9329e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0030, device='cuda:0')
min of d_p_list:  tensor(-0.0021, device='cuda:0')
Epoch:  152  
Training Loss: 0.036567315459251404
Test Loss:  0.03851259499788284
Test Acc:  0.0
Valid Loss:  0.03361646831035614
Valid Acc:  0.0
std:  0.004264626937350001 
thres:  4.2260172963142397e-05
Preserved_eigens number check:  512
 15%|█▌        | 152/1000 [37:25<3:30:34, 14.90s/it]Epoch:   153
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  505
Criterion check: 
Mean:  tensor(0.4981, device='cuda:0') 
Std:  tensor(11.1506, device='cuda:0') 
ABS Max:  tensor(133.7152, device='cuda:0') 
ABS Min:  tensor(0.0004, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0001, 1.0000, 1.0000, 0.9999, 1.0000,
        0.9999], device='cuda:0') tensor(219, device='cuda:0')
max of Lambda2 tensor(110476.1172, device='cuda:0')
min of Lambda2 tensor(4.1702e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1447, device='cuda:0')
min of grad d_p:  tensor(-0.0710, device='cuda:0')
max|min: (J_L, Jta/N)  (0.14465638995170593, 0.14465638995170593, ratio: 1.0)|(-0.0710357055068016, -0.0710357055068016)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.5747e-08, device='cuda:0') mean:  tensor(-1.9030e-11, device='cuda:0') min:  tensor(-1.0782e-07, device='cuda:0') norm:  tensor(1.1127e-06, device='cuda:0') MSE:  tensor(1.4021e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(1.7205e-05, device='cuda:0') mean:  tensor(5.8550e-07, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0009, device='cuda:0') MSE:  tensor(1.1599e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0813, device='cuda:0')
min of d_p_list:  tensor(-0.0833, device='cuda:0')
Epoch:  153  
Training Loss: 0.05864503234624863
Test Loss:  0.05807925760746002
Test Acc:  0.0
Valid Loss:  0.057736072689294815
Valid Acc:  0.0
std:  0.00768690555093557 
thres:  4.419072642922402e-05
Preserved_eigens number check:  512
 15%|█▌        | 153/1000 [37:42<3:39:42, 15.56s/it]Epoch:   154
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  505
Criterion check: 
Mean:  tensor(4.6268, device='cuda:0') 
Std:  tensor(63.0641, device='cuda:0') 
ABS Max:  tensor(1075.2877, device='cuda:0') 
ABS Min:  tensor(1.8621e-05, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0003, 1.0004, 1.0000, 0.9999, 1.0000, 1.0000, 1.0001, 1.0004,
        1.0001], device='cuda:0') tensor(214, device='cuda:0')
max of Lambda2 tensor(103422.3281, device='cuda:0')
min of Lambda2 tensor(1.9443e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1786, device='cuda:0')
min of grad d_p:  tensor(-0.1132, device='cuda:0')
max|min: (J_L, Jta/N)  (0.17856363952159882, 0.17856363952159882, ratio: 1.0)|(-0.11324814707040787, -0.11324814707040787)

 check Jacobi res:  torch.Size([793601]) max:  tensor(9.6592e-06, device='cuda:0') mean:  tensor(2.6861e-09, device='cuda:0') min:  tensor(-2.9215e-05, device='cuda:0') norm:  tensor(0.0003, device='cuda:0') MSE:  tensor(3.9108e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(5.3518e-05, device='cuda:0') mean:  tensor(2.1529e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0033, device='cuda:0') MSE:  tensor(4.1754e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0064, device='cuda:0')
min of d_p_list:  tensor(-0.0055, device='cuda:0')
Epoch:  154  
Training Loss: 0.053657449781894684
Test Loss:  0.05297023057937622
Test Acc:  0.0
Valid Loss:  0.05174141749739647
Valid Acc:  0.0
std:  0.008587472963274483 
thres:  4.598465412855148e-05
Preserved_eigens number check:  512
 15%|█▌        | 154/1000 [37:58<3:41:59, 15.74s/it]Epoch:   155
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  502
Criterion check: 
Mean:  tensor(7.2702, device='cuda:0') 
Std:  tensor(180.4475, device='cuda:0') 
ABS Max:  tensor(3620.1536, device='cuda:0') 
ABS Min:  tensor(0.0059, device='cuda:0')
Criterion check:  tensor([1.0001, 1.0061, 1.0013, 1.0000, 0.9997, 1.0001, 0.9997, 1.0006, 0.9997,
        0.9993], device='cuda:0') tensor(256, device='cuda:0')
max of Lambda2 tensor(104395.3203, device='cuda:0')
min of Lambda2 tensor(1.2090e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1702, device='cuda:0')
min of grad d_p:  tensor(-0.1071, device='cuda:0')
max|min: (J_L, Jta/N)  (0.17015722393989563, 0.1701572686433792, ratio: 1.000000238418579)|(-0.10708273202180862, -0.10708273202180862)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.4703e-08, device='cuda:0') mean:  tensor(-1.8878e-11, device='cuda:0') min:  tensor(-1.1921e-07, device='cuda:0') norm:  tensor(1.3800e-06, device='cuda:0') MSE:  tensor(1.7389e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(8.9655e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0140, device='cuda:0') MSE:  tensor(1.7675e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0045, device='cuda:0')
min of d_p_list:  tensor(-0.0050, device='cuda:0')
Epoch:  155  
Training Loss: 0.05078825727105141
Test Loss:  0.04974745959043503
Test Acc:  0.0
Valid Loss:  0.04796402156352997
Valid Acc:  0.0
std:  0.008393919411915437 
thres:  4.787555858492851e-05
Preserved_eigens number check:  512
 16%|█▌        | 155/1000 [38:14<3:43:19, 15.86s/it]Epoch:   156
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  503
Criterion check: 
Mean:  tensor(-6.4740, device='cuda:0') 
Std:  tensor(559.7231, device='cuda:0') 
ABS Max:  tensor(10611.3447, device='cuda:0') 
ABS Min:  tensor(0.0174, device='cuda:0')
Criterion check:  tensor([1.0001, 1.0065, 1.0019, 1.0000, 0.9995, 1.0001, 1.0001, 1.0011, 1.0000,
        0.9999], device='cuda:0') tensor(245, device='cuda:0')
max of Lambda2 tensor(105379.7031, device='cuda:0')
min of Lambda2 tensor(3.9578e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1622, device='cuda:0')
min of grad d_p:  tensor(-0.1028, device='cuda:0')
max|min: (J_L, Jta/N)  (0.16220223903656006, 0.16220219433307648, ratio: 0.9999997019767761)|(-0.10278726369142532, -0.10278725624084473)

 check Jacobi res:  torch.Size([793601]) max:  tensor(7.4506e-08, device='cuda:0') mean:  tensor(1.2824e-11, device='cuda:0') min:  tensor(-8.5281e-08, device='cuda:0') norm:  tensor(1.2431e-06, device='cuda:0') MSE:  tensor(1.5665e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(8.5498e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0134, device='cuda:0') MSE:  tensor(1.6916e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0053, device='cuda:0')
min of d_p_list:  tensor(-0.0043, device='cuda:0')
Epoch:  156  
Training Loss: 0.04718179255723953
Test Loss:  0.04605136066675186
Test Acc:  0.0
Valid Loss:  0.04389509558677673
Valid Acc:  0.0
std:  0.0074177741538900875 
thres:  4.936796948313713e-05
Preserved_eigens number check:  512
 16%|█▌        | 156/1000 [38:29<3:38:57, 15.57s/it]Epoch:   157
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  504
Criterion check: 
Mean:  tensor(-7.6610, device='cuda:0') 
Std:  tensor(184.1440, device='cuda:0') 
ABS Max:  tensor(3769.1863, device='cuda:0') 
ABS Min:  tensor(0.0068, device='cuda:0')
Criterion check:  tensor([0.9999, 1.0015, 0.9999, 1.0001, 1.0002, 1.0001, 1.0001, 1.0003, 0.9999,
        1.0002], device='cuda:0') tensor(247, device='cuda:0')
max of Lambda2 tensor(106169.5156, device='cuda:0')
min of Lambda2 tensor(7.3324e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1548, device='cuda:0')
min of grad d_p:  tensor(-0.0988, device='cuda:0')
max|min: (J_L, Jta/N)  (0.15484975278377533, 0.15484976768493652, ratio: 1.0000001192092896)|(-0.09876057505607605, -0.09876057505607605)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.1921e-07, device='cuda:0') mean:  tensor(2.0351e-12, device='cuda:0') min:  tensor(-5.9605e-08, device='cuda:0') norm:  tensor(1.2139e-06, device='cuda:0') MSE:  tensor(1.5296e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(4.5951e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0071, device='cuda:0') MSE:  tensor(8.8964e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0264, device='cuda:0')
min of d_p_list:  tensor(-0.0376, device='cuda:0')
Epoch:  157  
Training Loss: 0.047928616404533386
Test Loss:  0.0471552312374115
Test Acc:  0.0
Valid Loss:  0.043503180146217346
Valid Acc:  0.0
std:  0.0041836832815692485 
thres:  5.164022967219353e-05
Preserved_eigens number check:  512
 16%|█▌        | 157/1000 [38:44<3:36:07, 15.38s/it]Epoch:   158
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  506
Criterion check: 
Mean:  tensor(-2.1268, device='cuda:0') 
Std:  tensor(91.1267, device='cuda:0') 
ABS Max:  tensor(1254.9817, device='cuda:0') 
ABS Min:  tensor(0.0010, device='cuda:0')
Criterion check:  tensor([0.9999, 0.9977, 0.9998, 1.0000, 1.0000, 1.0000, 1.0002, 1.0003, 1.0001,
        0.9994], device='cuda:0') tensor(225, device='cuda:0')
max of Lambda2 tensor(100412.1797, device='cuda:0')
min of Lambda2 tensor(1.0000e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1505, device='cuda:0')
min of grad d_p:  tensor(-0.1002, device='cuda:0')
max|min: (J_L, Jta/N)  (0.15052080154418945, 0.15052078664302826, ratio: 0.9999998807907104)|(-0.10020031780004501, -0.10020038485527039)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.9407e-08, device='cuda:0') mean:  tensor(1.1177e-11, device='cuda:0') min:  tensor(-7.0220e-08, device='cuda:0') norm:  tensor(1.0969e-06, device='cuda:0') MSE:  tensor(1.3821e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(3.5381e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0054, device='cuda:0') MSE:  tensor(6.8302e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0098, device='cuda:0')
min of d_p_list:  tensor(-0.0111, device='cuda:0')
Epoch:  158  
Training Loss: 0.04343850910663605
Test Loss:  0.04263969883322716
Test Acc:  0.0
Valid Loss:  0.03931669145822525
Valid Acc:  0.0
std:  0.0034487481476058444 
thres:  4.859892502427101e-05
Preserved_eigens number check:  512
 16%|█▌        | 158/1000 [38:59<3:33:00, 15.18s/it]Epoch:   159
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  505
Criterion check: 
Mean:  tensor(-164.4339, device='cuda:0') 
Std:  tensor(3731.3772, device='cuda:0') 
ABS Max:  tensor(84430.5000, device='cuda:0') 
ABS Min:  tensor(0.0014, device='cuda:0')
Criterion check:  tensor([1.0000, 0.9994, 1.0001, 1.0000, 1.0000, 1.0000, 1.0000, 1.0001, 1.0001,
        1.0001], device='cuda:0') tensor(216, device='cuda:0')
max of Lambda2 tensor(101729.4141, device='cuda:0')
min of Lambda2 tensor(2.7931e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.1442, device='cuda:0')
min of grad d_p:  tensor(-0.0927, device='cuda:0')
max|min: (J_L, Jta/N)  (0.14415901899337769, 0.14415906369686127, ratio: 1.0000003576278687)|(-0.09272587299346924, -0.09272590279579163)

 check Jacobi res:  torch.Size([793601]) max:  tensor(6.7055e-08, device='cuda:0') mean:  tensor(3.8882e-12, device='cuda:0') min:  tensor(-8.5322e-08, device='cuda:0') norm:  tensor(1.0647e-06, device='cuda:0') MSE:  tensor(1.3417e-12, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(2.5749e-05, device='cuda:0') mean:  tensor(1.0102e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0016, device='cuda:0') MSE:  tensor(1.9833e-09, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0087, device='cuda:0')
min of d_p_list:  tensor(-0.0107, device='cuda:0')
Epoch:  159  
Training Loss: 0.03948507830500603
Test Loss:  0.038390714675188065
Test Acc:  0.0
Valid Loss:  0.035457536578178406
Valid Acc:  0.0
std:  0.0039184595333129 
thres:  4.576445072889328e-05
Preserved_eigens number check:  512
 16%|█▌        | 159/1000 [39:13<3:30:45, 15.04s/it]