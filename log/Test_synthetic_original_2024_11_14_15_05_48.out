/nishome/yui/ModifiedNGD/utils/readData.py:18: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  return torch.tensor(x, dtype=torch.float32), torch.tensor(y, dtype=torch.float32)
/nishome/yui/anaconda3/envs/ng/lib/python3.12/site-packages/torch/autograd/graph.py:744: UserWarning: Using backward() with create_graph=True will create a reference cycle between the parameter and its gradient which can cause a memory leak. We recommend using autograd.grad when creating the graph to avoid this. If you have to use this function, make sure to reset the .grad fields of your parameters to None after use to break the cycle and avoid the leak. (Triggered internally at /opt/conda/conda-bld/pytorch_1716905971214/work/torch/csrc/autograd/engine.cpp:1203.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
Train info: 
 train data shape: torch.Size([512, 1]), 
 train lable shape: torch.Size([512, 1]), 
 positive / negative: 0.021206805482506752 / 0.978793203830719, 
 discrepancy norm error: 5.045955617788422e-07
Test info: 
 test data shape: torch.Size([128, 1]), 
 test lable shape: torch.Size([128, 1]), , 
 positive / negative: -0.030759211629629135 / 1.0307592153549194, 
 discrepancy norm error: 2.750667249529215e-07
Valid info: 
 valid data shape: torch.Size([128, 1]), valid lable shape: torch.Size([128, 1]), 
 positive / negative: 0.015859205275774002 / 0.9841408133506775, 
 discrepancy norm error: 2.3576444618811365e-07
torch.Size([512, 1]) torch.Size([512])
seed is  2191
---------------------------------------- MNGD ----------------------------------------
OUTPUT CHECK:  torch.Size([512]) tensor(0.0590, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2447, device='cuda:0', grad_fn=<MinBackward1>) 
TARGET:  torch.Size([512]) tensor(0.5000, device='cuda:0') tensor(-0.5000, device='cuda:0')
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  2
  0%|          | 0/1000 [00:00<?, ?it/s]Epoch:   1
Test train Loss:  0.05464249104261398
Test train Acc:  0.0
Test Loss:  0.0616748183965683
Test Acc:  0.0
Valid Loss:  0.05691187083721161
Valid Acc:  0.0
max of grad d_p:  tensor(0.0106, device='cuda:0')
min of grad d_p:  tensor(-0.0819, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.0594, device='cuda:0') mean:  tensor(-0.0002, device='cuda:0') min:  tensor(-0.0396, device='cuda:0') norm:  tensor(1.2835, device='cuda:0') MSE:  tensor(2.4099e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(3.6665e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0061, device='cuda:0') MSE:  tensor(1.1442e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0016, device='cuda:0')
min of d_p_list:  tensor(-0.0071, device='cuda:0')
Epoch:  1  
Training Loss: 0.054037512847571634
Test Loss:  0.061016131192445755
Test Acc:  0.0
Valid Loss:  0.05628456920385361
Valid Acc:  0.0
local minima detector shape:  (0,)
Preserved_eigens number check:  2
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  2
  0%|          | 1/1000 [00:03<56:25,  3.39s/it]Epoch:   2
max of grad d_p:  tensor(0.0099, device='cuda:0')
min of grad d_p:  tensor(-0.0810, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.0627, device='cuda:0') mean:  tensor(-0.0002, device='cuda:0') min:  tensor(-0.0397, device='cuda:0') norm:  tensor(1.3919, device='cuda:0') MSE:  tensor(2.6134e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(3.3907e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0056, device='cuda:0') MSE:  tensor(1.0581e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0695, device='cuda:0')
min of d_p_list:  tensor(-0.1353, device='cuda:0')
Epoch:  2  
Training Loss: 0.08960621058940887
Test Loss:  0.09220945835113525
Test Acc:  0.0
Valid Loss:  0.09127354621887207
Valid Acc:  0.0
local minima detector shape:  (1,)
Preserved_eigens number check:  2
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  5
  0%|          | 2/1000 [00:07<1:01:46,  3.71s/it]Epoch:   3
max of grad d_p:  tensor(0.1079, device='cuda:0')
min of grad d_p:  tensor(-0.6873, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.2250, device='cuda:0') mean:  tensor(-0.0001, device='cuda:0') min:  tensor(-0.0381, device='cuda:0') norm:  tensor(1.3196, device='cuda:0') MSE:  tensor(2.4776e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0017, device='cuda:0') mean:  tensor(4.6438e-06, device='cuda:0') min:  tensor(5.9686e-13, device='cuda:0') norm:  tensor(0.0091, device='cuda:0') MSE:  tensor(1.7151e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0017, device='cuda:0')
min of d_p_list:  tensor(-0.0054, device='cuda:0')
Epoch:  3  
Training Loss: 0.08857689797878265
Test Loss:  0.09091345965862274
Test Acc:  0.0
Valid Loss:  0.09020695090293884
Valid Acc:  0.0
local minima detector shape:  (2,)
Preserved_eigens number check:  5
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  7
  0%|          | 3/1000 [00:10<1:00:04,  3.61s/it]Epoch:   4
max of grad d_p:  tensor(0.1072, device='cuda:0')
min of grad d_p:  tensor(-0.7140, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.3005, device='cuda:0') mean:  tensor(-0.0002, device='cuda:0') min:  tensor(-0.0471, device='cuda:0') norm:  tensor(1.7388, device='cuda:0') MSE:  tensor(3.2647e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0154, device='cuda:0') mean:  tensor(3.8438e-05, device='cuda:0') min:  tensor(2.7285e-12, device='cuda:0') norm:  tensor(0.0846, device='cuda:0') MSE:  tensor(1.5887e-07, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0061, device='cuda:0')
min of d_p_list:  tensor(-0.0089, device='cuda:0')
Epoch:  4  
Training Loss: 0.08839734643697739
Test Loss:  0.09059389680624008
Test Acc:  0.0
Valid Loss:  0.09008248895406723
Valid Acc:  0.0
local minima detector shape:  (3,)
Preserved_eigens number check:  7
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  6
  0%|          | 4/1000 [00:14<1:02:30,  3.77s/it]Epoch:   5
max of grad d_p:  tensor(0.1073, device='cuda:0')
min of grad d_p:  tensor(-0.7599, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.2765, device='cuda:0') mean:  tensor(-0.0001, device='cuda:0') min:  tensor(-0.0414, device='cuda:0') norm:  tensor(1.5441, device='cuda:0') MSE:  tensor(2.8990e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0010, device='cuda:0') mean:  tensor(7.1692e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0141, device='cuda:0') MSE:  tensor(2.6563e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0026, device='cuda:0')
min of d_p_list:  tensor(-0.0013, device='cuda:0')
Epoch:  5  
Training Loss: 0.08808408677577972
Test Loss:  0.0902857780456543
Test Acc:  0.0
Valid Loss:  0.08977340161800385
Valid Acc:  0.0
local minima detector shape:  (4,)
Preserved_eigens number check:  6
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  7
  0%|          | 5/1000 [00:18<1:03:25,  3.82s/it]Epoch:   6
max of grad d_p:  tensor(0.1069, device='cuda:0')
min of grad d_p:  tensor(-0.7718, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.2300, device='cuda:0') mean:  tensor(-9.9948e-05, device='cuda:0') min:  tensor(-0.0344, device='cuda:0') norm:  tensor(1.2887, device='cuda:0') MSE:  tensor(2.4195e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0047, device='cuda:0') mean:  tensor(1.1958e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0258, device='cuda:0') MSE:  tensor(4.8465e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0013, device='cuda:0')
min of d_p_list:  tensor(-0.0075, device='cuda:0')
Epoch:  6  
Training Loss: 0.08738195896148682
Test Loss:  0.08937439322471619
Test Acc:  0.0
Valid Loss:  0.08904857933521271
Valid Acc:  0.0
std:  0.0007241574662766448 
thres:  8.840930014848709e-05
Preserved_eigens number check:  7
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  5
  1%|          | 6/1000 [00:22<1:03:40,  3.84s/it]Epoch:   7
max of grad d_p:  tensor(0.1070, device='cuda:0')
min of grad d_p:  tensor(-0.8081, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.3076, device='cuda:0') mean:  tensor(-0.0001, device='cuda:0') min:  tensor(-0.0429, device='cuda:0') norm:  tensor(1.6243, device='cuda:0') MSE:  tensor(3.0498e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0009, device='cuda:0') mean:  tensor(6.7238e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0127, device='cuda:0') MSE:  tensor(2.3785e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0188, device='cuda:0')
min of d_p_list:  tensor(-0.0150, device='cuda:0')
Epoch:  7  
Training Loss: 0.08901414275169373
Test Loss:  0.09122301638126373
Test Acc:  0.0
Valid Loss:  0.09078517556190491
Valid Acc:  0.0
std:  0.0005450048230971744 
thres:  8.829088658094406e-05
Preserved_eigens number check:  5
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  4
  1%|          | 7/1000 [00:26<1:04:43,  3.91s/it]Epoch:   8
max of grad d_p:  tensor(0.1075, device='cuda:0')
min of grad d_p:  tensor(-0.9028, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.3060, device='cuda:0') mean:  tensor(-7.1776e-05, device='cuda:0') min:  tensor(-0.0380, device='cuda:0') norm:  tensor(1.4710, device='cuda:0') MSE:  tensor(2.7618e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0035, device='cuda:0') mean:  tensor(1.1002e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0228, device='cuda:0') MSE:  tensor(4.2822e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0078, device='cuda:0')
min of d_p_list:  tensor(-0.0049, device='cuda:0')
Epoch:  8  
Training Loss: 0.08836788684129715
Test Loss:  0.09051897376775742
Test Acc:  0.0
Valid Loss:  0.09015537053346634
Valid Acc:  0.0
std:  0.0005292524303729125 
thres:  8.824908435344696e-05
Preserved_eigens number check:  4
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  9
  1%|          | 8/1000 [00:30<1:05:23,  3.96s/it]Epoch:   9
max of grad d_p:  tensor(0.1074, device='cuda:0')
min of grad d_p:  tensor(-0.9228, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.3175, device='cuda:0') mean:  tensor(-6.9689e-05, device='cuda:0') min:  tensor(-0.0384, device='cuda:0') norm:  tensor(1.4639, device='cuda:0') MSE:  tensor(2.7485e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0046, device='cuda:0') mean:  tensor(9.8857e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0217, device='cuda:0') MSE:  tensor(4.0659e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.1488, device='cuda:0')
min of d_p_list:  tensor(-0.2344, device='cuda:0')
Epoch:  9  
Training Loss: 0.19399972259998322
Test Loss:  0.1710837036371231
Test Acc:  0.0
Valid Loss:  0.1926906704902649
Valid Acc:  0.0
std:  0.04231832623893588 
thres:  0.00010936955958604813
Preserved_eigens number check:  9
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  4
  1%|          | 9/1000 [00:34<1:05:52,  3.99s/it]Epoch:   10
max of grad d_p:  tensor(0.2072, device='cuda:0')
min of grad d_p:  tensor(-2.5917, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.5271, device='cuda:0') mean:  tensor(4.6472e-05, device='cuda:0') min:  tensor(-0.0498, device='cuda:0') norm:  tensor(1.7799, device='cuda:0') MSE:  tensor(3.3419e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0051, device='cuda:0') mean:  tensor(1.3887e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0305, device='cuda:0') MSE:  tensor(5.7187e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0206, device='cuda:0')
min of d_p_list:  tensor(-0.0124, device='cuda:0')
Epoch:  10  
Training Loss: 0.19223085045814514
Test Loss:  0.16973662376403809
Test Acc:  0.0
Valid Loss:  0.19085389375686646
Valid Acc:  0.0
std:  0.05137667987220767 
thres:  0.0001301989123225212
Preserved_eigens number check:  4
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  5
  1%|          | 10/1000 [00:38<1:04:15,  3.89s/it]Epoch:   11
max of grad d_p:  tensor(0.1890, device='cuda:0')
min of grad d_p:  tensor(-2.6654, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.5446, device='cuda:0') mean:  tensor(5.9141e-05, device='cuda:0') min:  tensor(-0.0498, device='cuda:0') norm:  tensor(1.8044, device='cuda:0') MSE:  tensor(3.3878e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0245, device='cuda:0') mean:  tensor(2.7541e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0742, device='cuda:0') MSE:  tensor(1.3941e-07, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0089, device='cuda:0')
min of d_p_list:  tensor(-0.0286, device='cuda:0')
Epoch:  11  
Training Loss: 0.19303011894226074
Test Loss:  0.17035707831382751
Test Acc:  0.0
Valid Loss:  0.1914319396018982
Valid Acc:  0.0
std:  0.05114680530035735 
thres:  0.000151328544318676
Preserved_eigens number check:  5
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  8
  1%|          | 11/1000 [00:42<1:03:59,  3.88s/it]Epoch:   12
max of grad d_p:  tensor(0.1846, device='cuda:0')
min of grad d_p:  tensor(-2.7010, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.5592, device='cuda:0') mean:  tensor(8.6264e-05, device='cuda:0') min:  tensor(-0.0566, device='cuda:0') norm:  tensor(1.7508, device='cuda:0') MSE:  tensor(3.2871e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0223, device='cuda:0') mean:  tensor(2.3549e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0668, device='cuda:0') MSE:  tensor(1.2546e-07, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0016, device='cuda:0')
min of d_p_list:  tensor(-0.0027, device='cuda:0')
Epoch:  12  
Training Loss: 0.19218361377716064
Test Loss:  0.16962191462516785
Test Acc:  0.0
Valid Loss:  0.190567284822464
Valid Acc:  0.0
std:  0.04180249411132035 
thres:  0.00017196243852376939
Preserved_eigens number check:  8
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  6
  1%|          | 12/1000 [00:46<1:04:07,  3.89s/it]Epoch:   13
max of grad d_p:  tensor(0.1847, device='cuda:0')
min of grad d_p:  tensor(-2.6862, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.6338, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(-0.0651, device='cuda:0') norm:  tensor(2.0070, device='cuda:0') MSE:  tensor(3.7682e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0653, device='cuda:0') mean:  tensor(7.6523e-05, device='cuda:0') min:  tensor(7.2760e-12, device='cuda:0') norm:  tensor(0.2134, device='cuda:0') MSE:  tensor(4.0071e-07, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0081, device='cuda:0')
min of d_p_list:  tensor(-0.0055, device='cuda:0')
Epoch:  13  
Training Loss: 0.19188816845417023
Test Loss:  0.16927142441272736
Test Acc:  0.0
Valid Loss:  0.1902957260608673
Valid Acc:  0.0
std:  0.0007666121390774081 
thres:  0.000192666494846344
Preserved_eigens number check:  6
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  4
  1%|▏         | 13/1000 [00:50<1:03:42,  3.87s/it]Epoch:   14
max of grad d_p:  tensor(0.1866, device='cuda:0')
min of grad d_p:  tensor(-2.8173, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.5630, device='cuda:0') mean:  tensor(9.0783e-05, device='cuda:0') min:  tensor(-0.0553, device='cuda:0') norm:  tensor(1.7034, device='cuda:0') MSE:  tensor(3.1983e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.1265, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(8.1855e-12, device='cuda:0') norm:  tensor(0.3904, device='cuda:0') MSE:  tensor(7.3307e-07, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0035, device='cuda:0')
min of d_p_list:  tensor(-0.0034, device='cuda:0')
Epoch:  14  
Training Loss: 0.19048170745372772
Test Loss:  0.16842110455036163
Test Acc:  0.0
Valid Loss:  0.18902498483657837
Valid Acc:  0.0
std:  0.0008317432840617001 
thres:  0.0001919628918170929
Preserved_eigens number check:  4
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  6
  1%|▏         | 14/1000 [00:53<1:03:34,  3.87s/it]Epoch:   15
max of grad d_p:  tensor(0.1873, device='cuda:0')
min of grad d_p:  tensor(-2.8185, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.6837, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(-0.0672, device='cuda:0') norm:  tensor(2.0905, device='cuda:0') MSE:  tensor(3.9251e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0069, device='cuda:0') mean:  tensor(1.5272e-05, device='cuda:0') min:  tensor(3.6380e-12, device='cuda:0') norm:  tensor(0.0325, device='cuda:0') MSE:  tensor(6.0949e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0015, device='cuda:0')
min of d_p_list:  tensor(-0.0015, device='cuda:0')
Epoch:  15  
Training Loss: 0.18965628743171692
Test Loss:  0.16770541667938232
Test Acc:  0.0
Valid Loss:  0.188201442360878
Valid Acc:  0.0
std:  0.0012150663730693546 
thres:  0.00019144797921180726
Preserved_eigens number check:  6
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  9
  2%|▏         | 15/1000 [00:57<1:03:46,  3.88s/it]Epoch:   16
max of grad d_p:  tensor(0.1871, device='cuda:0')
min of grad d_p:  tensor(-2.8156, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.5290, device='cuda:0') mean:  tensor(8.1614e-05, device='cuda:0') min:  tensor(-0.0520, device='cuda:0') norm:  tensor(1.5973, device='cuda:0') MSE:  tensor(2.9990e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0092, device='cuda:0') mean:  tensor(1.7405e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0385, device='cuda:0') MSE:  tensor(7.2330e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0112, device='cuda:0')
min of d_p_list:  tensor(-0.0099, device='cuda:0')
Epoch:  16  
Training Loss: 0.18863269686698914
Test Loss:  0.1669902205467224
Test Acc:  0.0
Valid Loss:  0.18703359365463257
Valid Acc:  0.0
std:  0.0013369454609345522 
thres:  0.00019056849479675292
Preserved_eigens number check:  9
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  7
  2%|▏         | 16/1000 [01:01<1:02:35,  3.82s/it]Epoch:   17
max of grad d_p:  tensor(0.1915, device='cuda:0')
min of grad d_p:  tensor(-2.7850, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.6016, device='cuda:0') mean:  tensor(9.9687e-05, device='cuda:0') min:  tensor(-0.0618, device='cuda:0') norm:  tensor(1.8786, device='cuda:0') MSE:  tensor(3.5272e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0059, device='cuda:0') mean:  tensor(1.1690e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0262, device='cuda:0') MSE:  tensor(4.9188e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0035, device='cuda:0')
min of d_p_list:  tensor(-0.0014, device='cuda:0')
Epoch:  17  
Training Loss: 0.18774917721748352
Test Loss:  0.16608098149299622
Test Acc:  0.0
Valid Loss:  0.1861373484134674
Valid Acc:  0.0
std:  0.0014383471485779472 
thres:  0.0001896816074848175
Preserved_eigens number check:  7
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  4
  2%|▏         | 17/1000 [01:05<1:03:30,  3.88s/it]Epoch:   18
max of grad d_p:  tensor(0.1924, device='cuda:0')
min of grad d_p:  tensor(-2.7742, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.6383, device='cuda:0') mean:  tensor(9.1342e-05, device='cuda:0') min:  tensor(-0.0675, device='cuda:0') norm:  tensor(1.9929, device='cuda:0') MSE:  tensor(3.7418e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0124, device='cuda:0') mean:  tensor(1.5114e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0400, device='cuda:0') MSE:  tensor(7.5189e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0180, device='cuda:0')
min of d_p_list:  tensor(-0.0098, device='cuda:0')
Epoch:  18  
Training Loss: 0.18705642223358154
Test Loss:  0.16564282774925232
Test Acc:  0.0
Valid Loss:  0.18542605638504028
Valid Acc:  0.0
std:  0.0012407856046000008 
thres:  0.00018871525824069976
Preserved_eigens number check:  4
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  5
  2%|▏         | 18/1000 [01:09<1:03:55,  3.91s/it]Epoch:   19
max of grad d_p:  tensor(0.1957, device='cuda:0')
min of grad d_p:  tensor(-2.9503, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.6722, device='cuda:0') mean:  tensor(9.8866e-05, device='cuda:0') min:  tensor(-0.0641, device='cuda:0') norm:  tensor(1.9808, device='cuda:0') MSE:  tensor(3.7190e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0067, device='cuda:0') mean:  tensor(1.2958e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0291, device='cuda:0') MSE:  tensor(5.4684e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0476, device='cuda:0')
min of d_p_list:  tensor(-0.0126, device='cuda:0')
Epoch:  19  
Training Loss: 0.18968887627124786
Test Loss:  0.16767370700836182
Test Acc:  0.0
Valid Loss:  0.18785512447357178
Valid Acc:  0.0
std:  0.001039193684866468 
thres:  0.00018855669200420382
Preserved_eigens number check:  5
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  4
  2%|▏         | 19/1000 [01:13<1:04:09,  3.92s/it]Epoch:   20
max of grad d_p:  tensor(0.2029, device='cuda:0')
min of grad d_p:  tensor(-3.3614, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.7538, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(-0.0621, device='cuda:0') norm:  tensor(2.0350, device='cuda:0') MSE:  tensor(3.8208e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0758, device='cuda:0') mean:  tensor(0.0002, device='cuda:0') min:  tensor(7.2760e-12, device='cuda:0') norm:  tensor(0.3652, device='cuda:0') MSE:  tensor(6.8565e-07, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0169, device='cuda:0')
min of d_p_list:  tensor(-0.0115, device='cuda:0')
Epoch:  20  
Training Loss: 0.1882646530866623
Test Loss:  0.16660821437835693
Test Acc:  0.0
Valid Loss:  0.1863679438829422
Valid Acc:  0.0
std:  0.0008818690343146947 
thres:  0.00018827836513519286
Preserved_eigens number check:  4
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  5
  2%|▏         | 20/1000 [01:17<1:04:37,  3.96s/it]Epoch:   21
max of grad d_p:  tensor(0.2085, device='cuda:0')
min of grad d_p:  tensor(-3.3136, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.6142, device='cuda:0') mean:  tensor(7.1048e-05, device='cuda:0') min:  tensor(-0.0507, device='cuda:0') norm:  tensor(1.6386, device='cuda:0') MSE:  tensor(3.0765e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0037, device='cuda:0') mean:  tensor(9.1937e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0209, device='cuda:0') MSE:  tensor(3.9153e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0093, device='cuda:0')
min of d_p_list:  tensor(-0.0046, device='cuda:0')
Epoch:  21  
Training Loss: 0.1865132451057434
Test Loss:  0.16507157683372498
Test Acc:  0.0
Valid Loss:  0.18445441126823425
Valid Acc:  0.0
std:  0.0010936313416295338 
thres:  0.00018785447478294375
Preserved_eigens number check:  5
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  5
  2%|▏         | 21/1000 [01:21<1:03:26,  3.89s/it]Epoch:   22
max of grad d_p:  tensor(0.2109, device='cuda:0')
min of grad d_p:  tensor(-3.1457, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.5548, device='cuda:0') mean:  tensor(7.0759e-05, device='cuda:0') min:  tensor(-0.0495, device='cuda:0') norm:  tensor(1.5379, device='cuda:0') MSE:  tensor(2.8875e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0236, device='cuda:0') mean:  tensor(2.3918e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0657, device='cuda:0') MSE:  tensor(1.2343e-07, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0325, device='cuda:0')
min of d_p_list:  tensor(-0.0193, device='cuda:0')
Epoch:  22  
Training Loss: 0.18594101071357727
Test Loss:  0.16386906802654266
Test Acc:  0.0
Valid Loss:  0.18369431793689728
Valid Acc:  0.0
std:  0.001339888913549698 
thres:  0.00018749284148216247
Preserved_eigens number check:  5
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  9
  2%|▏         | 22/1000 [01:25<1:03:34,  3.90s/it]Epoch:   23
max of grad d_p:  tensor(0.2211, device='cuda:0')
min of grad d_p:  tensor(-3.3513, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.6555, device='cuda:0') mean:  tensor(5.3804e-05, device='cuda:0') min:  tensor(-0.0533, device='cuda:0') norm:  tensor(1.7436, device='cuda:0') MSE:  tensor(3.2737e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0307, device='cuda:0') mean:  tensor(3.7888e-05, device='cuda:0') min:  tensor(3.1832e-12, device='cuda:0') norm:  tensor(0.0832, device='cuda:0') MSE:  tensor(1.5614e-07, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0114, device='cuda:0')
min of d_p_list:  tensor(-0.0094, device='cuda:0')
Epoch:  23  
Training Loss: 0.18449652194976807
Test Loss:  0.16271597146987915
Test Acc:  0.0
Valid Loss:  0.1821112483739853
Valid Acc:  0.0
std:  0.001814021090854767 
thres:  0.00018698086142539976
Preserved_eigens number check:  9
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  8
  2%|▏         | 23/1000 [01:28<1:02:50,  3.86s/it]Epoch:   24
max of grad d_p:  tensor(0.2243, device='cuda:0')
min of grad d_p:  tensor(-3.2146, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.7452, device='cuda:0') mean:  tensor(7.8026e-05, device='cuda:0') min:  tensor(-0.0618, device='cuda:0') norm:  tensor(2.0412, device='cuda:0') MSE:  tensor(3.8325e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.2504, device='cuda:0') mean:  tensor(0.0003, device='cuda:0') min:  tensor(5.4570e-12, device='cuda:0') norm:  tensor(0.6987, device='cuda:0') MSE:  tensor(1.3119e-06, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0167, device='cuda:0')
min of d_p_list:  tensor(-0.0155, device='cuda:0')
Epoch:  24  
Training Loss: 0.18487632274627686
Test Loss:  0.16306807100772858
Test Acc:  0.0
Valid Loss:  0.18251904845237732
Valid Acc:  0.0
std:  0.0013354375276124497 
thres:  0.00018601835072040558
Preserved_eigens number check:  8
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  4
  2%|▏         | 24/1000 [01:32<1:02:58,  3.87s/it]Epoch:   25
max of grad d_p:  tensor(0.2200, device='cuda:0')
min of grad d_p:  tensor(-3.4322, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.7517, device='cuda:0') mean:  tensor(9.8380e-05, device='cuda:0') min:  tensor(-0.0605, device='cuda:0') norm:  tensor(1.9286, device='cuda:0') MSE:  tensor(3.6211e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0192, device='cuda:0') mean:  tensor(1.7378e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0502, device='cuda:0') MSE:  tensor(9.4280e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0072, device='cuda:0')
min of d_p_list:  tensor(-0.0148, device='cuda:0')
Epoch:  25  
Training Loss: 0.18389397859573364
Test Loss:  0.16204020380973816
Test Acc:  0.0
Valid Loss:  0.1814737617969513
Valid Acc:  0.0
std:  0.0009553523384678578 
thres:  0.00018514421582221987
Preserved_eigens number check:  4
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  4
  2%|▎         | 25/1000 [01:36<1:03:53,  3.93s/it]Epoch:   26
max of grad d_p:  tensor(0.2198, device='cuda:0')
min of grad d_p:  tensor(-3.3334, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.7517, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(-0.0621, device='cuda:0') norm:  tensor(1.9871, device='cuda:0') MSE:  tensor(3.7308e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0010, device='cuda:0') mean:  tensor(9.4923e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0191, device='cuda:0') MSE:  tensor(3.5879e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.1245, device='cuda:0')
min of d_p_list:  tensor(-0.0468, device='cuda:0')
Epoch:  26  
Training Loss: 0.19641855359077454
Test Loss:  0.17408740520477295
Test Acc:  0.0
Valid Loss:  0.19403859972953796
Valid Acc:  0.0
std:  0.004694186066969816 
thres:  0.0001871252775192261
Preserved_eigens number check:  4
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  6
  3%|▎         | 26/1000 [01:40<1:04:30,  3.97s/it]Epoch:   27
max of grad d_p:  tensor(0.2163, device='cuda:0')
min of grad d_p:  tensor(-4.3350, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.8254, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(-0.0446, device='cuda:0') norm:  tensor(1.8289, device='cuda:0') MSE:  tensor(3.4338e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0181, device='cuda:0') mean:  tensor(1.8654e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0430, device='cuda:0') MSE:  tensor(8.0746e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0717, device='cuda:0')
min of d_p_list:  tensor(-0.0472, device='cuda:0')
Epoch:  27  
Training Loss: 0.21921168267726898
Test Loss:  0.1943659484386444
Test Acc:  0.0
Valid Loss:  0.2153048813343048
Valid Acc:  0.0
std:  0.013541966619901796 
thres:  0.0001937794119119644
Preserved_eigens number check:  6
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  5
  3%|▎         | 27/1000 [01:44<1:03:38,  3.92s/it]Epoch:   28
max of grad d_p:  tensor(0.2696, device='cuda:0')
min of grad d_p:  tensor(-4.7711, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.8300, device='cuda:0') mean:  tensor(1.0466e-06, device='cuda:0') min:  tensor(-0.0457, device='cuda:0') norm:  tensor(2.0406, device='cuda:0') MSE:  tensor(3.8314e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0013, device='cuda:0') mean:  tensor(7.5957e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0142, device='cuda:0') MSE:  tensor(2.6675e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0141, device='cuda:0')
min of d_p_list:  tensor(-0.0034, device='cuda:0')
Epoch:  28  
Training Loss: 0.21797552704811096
Test Loss:  0.19337190687656403
Test Acc:  0.0
Valid Loss:  0.21411624550819397
Valid Acc:  0.0
std:  0.0154404370717225 
thres:  0.000200475212931633
Preserved_eigens number check:  5
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  3
  3%|▎         | 28/1000 [01:48<1:02:43,  3.87s/it]Epoch:   29
max of grad d_p:  tensor(0.2743, device='cuda:0')
min of grad d_p:  tensor(-4.6864, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.8966, device='cuda:0') mean:  tensor(-1.3890e-05, device='cuda:0') min:  tensor(-0.0505, device='cuda:0') norm:  tensor(2.2761, device='cuda:0') MSE:  tensor(4.2735e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0008, device='cuda:0') mean:  tensor(8.1109e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0169, device='cuda:0') MSE:  tensor(3.1716e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.1655, device='cuda:0')
min of d_p_list:  tensor(-0.1722, device='cuda:0')
Epoch:  29  
Training Loss: 0.5115689039230347
Test Loss:  0.45285290479660034
Test Acc:  0.0
Valid Loss:  0.49033838510513306
Valid Acc:  0.0
std:  0.12359804704386029 
thres:  0.00026581372916698455
Preserved_eigens number check:  3
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  9
  3%|▎         | 29/1000 [01:52<1:02:18,  3.85s/it]Epoch:   30
max of grad d_p:  tensor(0.5002, device='cuda:0')
min of grad d_p:  tensor(-13.6920, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(1.4527, device='cuda:0') mean:  tensor(0.0002, device='cuda:0') min:  tensor(-0.0524, device='cuda:0') norm:  tensor(2.3556, device='cuda:0') MSE:  tensor(4.4228e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0096, device='cuda:0') mean:  tensor(3.0834e-05, device='cuda:0') min:  tensor(7.9581e-13, device='cuda:0') norm:  tensor(0.0594, device='cuda:0') MSE:  tensor(1.1149e-07, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0050, device='cuda:0')
min of d_p_list:  tensor(-0.0177, device='cuda:0')
Epoch:  30  
Training Loss: 0.5091208219528198
Test Loss:  0.4507383108139038
Test Acc:  0.0
Valid Loss:  0.4879953861236572
Valid Acc:  0.0
std:  0.1467755988599724 
thres:  0.0003308590978384018
Preserved_eigens number check:  9
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  8
  3%|▎         | 30/1000 [01:56<1:02:03,  3.84s/it]Epoch:   31
max of grad d_p:  tensor(0.4987, device='cuda:0')
min of grad d_p:  tensor(-13.5040, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(1.1710, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(-0.0427, device='cuda:0') norm:  tensor(1.9053, device='cuda:0') MSE:  tensor(3.5773e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0111, device='cuda:0') mean:  tensor(1.3930e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0277, device='cuda:0') MSE:  tensor(5.1994e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0116, device='cuda:0')
min of d_p_list:  tensor(-0.0125, device='cuda:0')
Epoch:  31  
Training Loss: 0.5074843764305115
Test Loss:  0.4485745429992676
Test Acc:  0.0
Valid Loss:  0.48601025342941284
Valid Acc:  0.0
std:  0.14246769597060752 
thres:  0.0003930722624063492
Preserved_eigens number check:  8
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  6
  3%|▎         | 31/1000 [02:00<1:02:18,  3.86s/it]Epoch:   32
max of grad d_p:  tensor(0.4897, device='cuda:0')
min of grad d_p:  tensor(-13.5001, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(1.4632, device='cuda:0') mean:  tensor(0.0002, device='cuda:0') min:  tensor(-0.0522, device='cuda:0') norm:  tensor(2.3739, device='cuda:0') MSE:  tensor(4.4572e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.1082, device='cuda:0') mean:  tensor(4.2505e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1577, device='cuda:0') MSE:  tensor(2.9612e-07, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0076, device='cuda:0')
min of d_p_list:  tensor(-0.0240, device='cuda:0')
Epoch:  32  
Training Loss: 0.5047606229782104
Test Loss:  0.446409672498703
Test Acc:  0.0
Valid Loss:  0.4832892119884491
Valid Acc:  0.0
std:  0.11612439125176709 
thres:  0.0004501820504665375
Preserved_eigens number check:  6
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  5
  3%|▎         | 32/1000 [02:03<1:02:22,  3.87s/it]Epoch:   33
max of grad d_p:  tensor(0.4709, device='cuda:0')
min of grad d_p:  tensor(-13.3323, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(1.3380, device='cuda:0') mean:  tensor(0.0002, device='cuda:0') min:  tensor(-0.0465, device='cuda:0') norm:  tensor(2.1689, device='cuda:0') MSE:  tensor(4.0722e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0910, device='cuda:0') mean:  tensor(3.3792e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1270, device='cuda:0') MSE:  tensor(2.3841e-07, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0348, device='cuda:0')
min of d_p_list:  tensor(-0.0962, device='cuda:0')
Epoch:  33  
Training Loss: 0.49450087547302246
Test Loss:  0.43841037154197693
Test Acc:  0.0
Valid Loss:  0.4734194278717041
Valid Acc:  0.0
std:  0.005922943280951489 
thres:  0.0005054871201515198
Preserved_eigens number check:  5
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  3
  3%|▎         | 33/1000 [02:07<1:02:12,  3.86s/it]Epoch:   34
max of grad d_p:  tensor(0.3997, device='cuda:0')
min of grad d_p:  tensor(-13.4099, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(1.2760, device='cuda:0') mean:  tensor(0.0002, device='cuda:0') min:  tensor(-0.0377, device='cuda:0') norm:  tensor(1.9875, device='cuda:0') MSE:  tensor(3.7316e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0098, device='cuda:0') mean:  tensor(8.6487e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0192, device='cuda:0') MSE:  tensor(3.6034e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0132, device='cuda:0')
min of d_p_list:  tensor(-0.0444, device='cuda:0')
Epoch:  34  
Training Loss: 0.49178263545036316
Test Loss:  0.4361790418624878
Test Acc:  0.0
Valid Loss:  0.4708433747291565
Valid Acc:  0.0
std:  0.007041758425465742 
thres:  0.0005015298664569855
Preserved_eigens number check:  3
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  2
  3%|▎         | 34/1000 [02:11<1:01:25,  3.82s/it]Epoch:   35
max of grad d_p:  tensor(0.4036, device='cuda:0')
min of grad d_p:  tensor(-13.1552, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(1.2655, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(-0.0384, device='cuda:0') norm:  tensor(2.0031, device='cuda:0') MSE:  tensor(3.7609e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0093, device='cuda:0') mean:  tensor(8.5119e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0209, device='cuda:0') MSE:  tensor(3.9253e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0093, device='cuda:0')
min of d_p_list:  tensor(-0.0276, device='cuda:0')
Epoch:  35  
Training Loss: 0.4888325333595276
Test Loss:  0.43281883001327515
Test Acc:  0.0
Valid Loss:  0.4673151969909668
Valid Acc:  0.0
std:  0.007337690920885238 
thres:  0.0004974722087383271
Preserved_eigens number check:  2
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  5
  4%|▎         | 35/1000 [02:15<1:00:33,  3.76s/it]Epoch:   36
max of grad d_p:  tensor(0.3964, device='cuda:0')
min of grad d_p:  tensor(-12.9404, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(1.1784, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(-0.0354, device='cuda:0') norm:  tensor(1.8627, device='cuda:0') MSE:  tensor(3.4973e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0195, device='cuda:0') mean:  tensor(1.0135e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0306, device='cuda:0') MSE:  tensor(5.7447e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0044, device='cuda:0')
min of d_p_list:  tensor(-0.0188, device='cuda:0')
Epoch:  36  
Training Loss: 0.4863033890724182
Test Loss:  0.43033289909362793
Test Acc:  0.0
Valid Loss:  0.46476709842681885
Valid Acc:  0.0
std:  0.006387186015650965 
thres:  0.0004932360112667084
Preserved_eigens number check:  5
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  4
  4%|▎         | 36/1000 [02:19<1:01:20,  3.82s/it]Epoch:   37
max of grad d_p:  tensor(0.3977, device='cuda:0')
min of grad d_p:  tensor(-12.8316, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(1.4197, device='cuda:0') mean:  tensor(0.0002, device='cuda:0') min:  tensor(-0.0431, device='cuda:0') norm:  tensor(2.2544, device='cuda:0') MSE:  tensor(4.2327e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0131, device='cuda:0') mean:  tensor(8.0813e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0218, device='cuda:0') MSE:  tensor(4.0917e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0551, device='cuda:0')
min of d_p_list:  tensor(-0.0280, device='cuda:0')
Epoch:  37  
Training Loss: 0.4819878339767456
Test Loss:  0.42770087718963623
Test Acc:  0.0
Valid Loss:  0.46112367510795593
Valid Acc:  0.0
std:  0.004335102293075263 
thres:  0.0004886814534664154
Preserved_eigens number check:  4
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  8
  4%|▎         | 37/1000 [02:22<1:01:35,  3.84s/it]Epoch:   38
max of grad d_p:  tensor(0.3792, device='cuda:0')
min of grad d_p:  tensor(-13.2379, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(1.5294, device='cuda:0') mean:  tensor(0.0002, device='cuda:0') min:  tensor(-0.0430, device='cuda:0') norm:  tensor(2.3751, device='cuda:0') MSE:  tensor(4.4594e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0022, device='cuda:0') mean:  tensor(6.5830e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0120, device='cuda:0') MSE:  tensor(2.2539e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0086, device='cuda:0')
min of d_p_list:  tensor(-0.0453, device='cuda:0')
Epoch:  38  
Training Loss: 0.4798568785190582
Test Loss:  0.42600685358047485
Test Acc:  0.0
Valid Loss:  0.45905694365501404
Valid Acc:  0.0
std:  0.004360818285829638 
thres:  0.0004857526540756226
Preserved_eigens number check:  8
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  7
  4%|▍         | 38/1000 [02:26<1:01:47,  3.85s/it]Epoch:   39
max of grad d_p:  tensor(0.3842, device='cuda:0')
min of grad d_p:  tensor(-13.1200, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(1.4058, device='cuda:0') mean:  tensor(0.0002, device='cuda:0') min:  tensor(-0.0395, device='cuda:0') norm:  tensor(2.1850, device='cuda:0') MSE:  tensor(4.1024e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0174, device='cuda:0') mean:  tensor(1.0185e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0280, device='cuda:0') MSE:  tensor(5.2636e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0018, device='cuda:0')
min of d_p_list:  tensor(-0.0032, device='cuda:0')
Epoch:  39  
Training Loss: 0.47725749015808105
Test Loss:  0.424591600894928
Test Acc:  0.0
Valid Loss:  0.45689624547958374
Valid Acc:  0.0
std:  0.004211765569542785 
thres:  0.0004828476250171662
Preserved_eigens number check:  7
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  7
  4%|▍         | 39/1000 [02:30<1:02:36,  3.91s/it]Epoch:   40
max of grad d_p:  tensor(0.3800, device='cuda:0')
min of grad d_p:  tensor(-12.9797, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(1.1146, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(-0.0314, device='cuda:0') norm:  tensor(1.7163, device='cuda:0') MSE:  tensor(3.2224e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0197, device='cuda:0') mean:  tensor(1.2990e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0350, device='cuda:0') MSE:  tensor(6.5686e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0085, device='cuda:0')
min of d_p_list:  tensor(-0.0086, device='cuda:0')
Epoch:  40  
Training Loss: 0.47374123334884644
Test Loss:  0.4210019111633301
Test Acc:  0.0
Valid Loss:  0.4529954195022583
Valid Acc:  0.0
std:  0.004248590830188949 
thres:  0.00047982936501502995
Preserved_eigens number check:  7
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  6
  4%|▍         | 40/1000 [02:34<1:02:19,  3.90s/it]Epoch:   41
max of grad d_p:  tensor(0.3802, device='cuda:0')
min of grad d_p:  tensor(-12.9261, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(1.0087, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(-0.0279, device='cuda:0') norm:  tensor(1.5593, device='cuda:0') MSE:  tensor(2.9277e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0097, device='cuda:0') mean:  tensor(6.5988e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0164, device='cuda:0') MSE:  tensor(3.0804e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0044, device='cuda:0')
min of d_p_list:  tensor(-0.0139, device='cuda:0')
Epoch:  41  
Training Loss: 0.47139060497283936
Test Loss:  0.4188932776451111
Test Acc:  0.0
Valid Loss:  0.45065489411354065
Valid Acc:  0.0
std:  0.0038748955559015277 
thres:  0.0004768468081951142
Preserved_eigens number check:  6
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  5
  4%|▍         | 41/1000 [02:38<1:02:09,  3.89s/it]Epoch:   42
max of grad d_p:  tensor(0.3813, device='cuda:0')
min of grad d_p:  tensor(-12.8569, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(1.2961, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(-0.0359, device='cuda:0') norm:  tensor(2.0127, device='cuda:0') MSE:  tensor(3.7789e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0204, device='cuda:0') mean:  tensor(1.1937e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0347, device='cuda:0') MSE:  tensor(6.5155e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0196, device='cuda:0')
min of d_p_list:  tensor(-0.0702, device='cuda:0')
Epoch:  42  
Training Loss: 0.46898114681243896
Test Loss:  0.41725093126296997
Test Acc:  0.0
Valid Loss:  0.4480862021446228
Valid Acc:  0.0
std:  0.003916063803035064 
thres:  0.00047424547076225284
Preserved_eigens number check:  5
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  6
  4%|▍         | 42/1000 [02:42<1:01:53,  3.88s/it]Epoch:   43
max of grad d_p:  tensor(0.3803, device='cuda:0')
min of grad d_p:  tensor(-12.3529, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(1.1493, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(-0.0334, device='cuda:0') norm:  tensor(1.8261, device='cuda:0') MSE:  tensor(3.4286e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.1636, device='cuda:0') mean:  tensor(8.3312e-05, device='cuda:0') min:  tensor(1.0914e-11, device='cuda:0') norm:  tensor(0.2612, device='cuda:0') MSE:  tensor(4.9051e-07, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0020, device='cuda:0')
min of d_p_list:  tensor(-0.0078, device='cuda:0')
Epoch:  43  
Training Loss: 0.46628808975219727
Test Loss:  0.41563767194747925
Test Acc:  0.0
Valid Loss:  0.44575363397598267
Valid Acc:  0.0
std:  0.003786486190475949 
thres:  0.00047153171300888064
Preserved_eigens number check:  6
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  4
  4%|▍         | 43/1000 [02:46<1:00:22,  3.78s/it]Epoch:   44
max of grad d_p:  tensor(0.3799, device='cuda:0')
min of grad d_p:  tensor(-12.2793, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(1.1399, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(-0.0333, device='cuda:0') norm:  tensor(1.7971, device='cuda:0') MSE:  tensor(3.3742e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0044, device='cuda:0') mean:  tensor(5.9972e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0138, device='cuda:0') MSE:  tensor(2.5851e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0299, device='cuda:0')
min of d_p_list:  tensor(-0.0529, device='cuda:0')
Epoch:  44  
Training Loss: 0.4649609923362732
Test Loss:  0.4157726466655731
Test Acc:  0.0
Valid Loss:  0.44502195715904236
Valid Acc:  0.0
std:  0.0032198280330509844 
thres:  0.0004690724134445191
Preserved_eigens number check:  4
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  6
  4%|▍         | 44/1000 [02:50<1:01:25,  3.85s/it]Epoch:   45
max of grad d_p:  tensor(0.3852, device='cuda:0')
min of grad d_p:  tensor(-11.5458, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(1.2308, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(-0.0395, device='cuda:0') norm:  tensor(2.0245, device='cuda:0') MSE:  tensor(3.8012e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0175, device='cuda:0') mean:  tensor(1.0467e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0311, device='cuda:0') MSE:  tensor(5.8477e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0204, device='cuda:0')
min of d_p_list:  tensor(-0.0138, device='cuda:0')
Epoch:  45  
Training Loss: 0.46072643995285034
Test Loss:  0.41148847341537476
Test Acc:  0.0
Valid Loss:  0.44056183099746704
Valid Acc:  0.0
std:  0.0036281369215784886 
thres:  0.0004664694547653198
Preserved_eigens number check:  6
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  9
  4%|▍         | 45/1000 [02:53<1:00:57,  3.83s/it]Epoch:   46
max of grad d_p:  tensor(0.3968, device='cuda:0')
min of grad d_p:  tensor(-11.1754, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(1.3216, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(-0.0449, device='cuda:0') norm:  tensor(2.2310, device='cuda:0') MSE:  tensor(4.1888e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0110, device='cuda:0') mean:  tensor(7.8922e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0209, device='cuda:0') MSE:  tensor(3.9333e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0103, device='cuda:0')
min of d_p_list:  tensor(-0.0099, device='cuda:0')
Epoch:  46  
Training Loss: 0.46066880226135254
Test Loss:  0.41154780983924866
Test Acc:  0.0
Valid Loss:  0.4403042495250702
Valid Acc:  0.0
std:  0.0032328107596519893 
thres:  0.0004643250942230225
Preserved_eigens number check:  9
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  7
  5%|▍         | 46/1000 [02:57<1:01:52,  3.89s/it]Epoch:   47
max of grad d_p:  tensor(0.3904, device='cuda:0')
min of grad d_p:  tensor(-11.2817, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(1.3375, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(-0.0443, device='cuda:0') norm:  tensor(2.2392, device='cuda:0') MSE:  tensor(4.2042e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0191, device='cuda:0') mean:  tensor(1.0808e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0318, device='cuda:0') MSE:  tensor(5.9759e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0388, device='cuda:0')
min of d_p_list:  tensor(-0.0245, device='cuda:0')
Epoch:  47  
Training Loss: 0.46001139283180237
Test Loss:  0.4114678204059601
Test Acc:  0.0
Valid Loss:  0.43993163108825684
Valid Acc:  0.0
std:  0.0025726726850177103 
thres:  0.00046253114342689516
Preserved_eigens number check:  7
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  6
  5%|▍         | 47/1000 [03:01<1:02:05,  3.91s/it]Epoch:   48
max of grad d_p:  tensor(0.4038, device='cuda:0')
min of grad d_p:  tensor(-10.3707, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.8255, device='cuda:0') mean:  tensor(6.4676e-05, device='cuda:0') min:  tensor(-0.0304, device='cuda:0') norm:  tensor(1.4441, device='cuda:0') MSE:  tensor(2.7114e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0322, device='cuda:0') mean:  tensor(2.5164e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0657, device='cuda:0') MSE:  tensor(1.2343e-07, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0440, device='cuda:0')
min of d_p_list:  tensor(-0.0316, device='cuda:0')
Epoch:  48  
Training Loss: 0.47789356112480164
Test Loss:  0.42764967679977417
Test Acc:  0.0
Valid Loss:  0.4564375877380371
Valid Acc:  0.0
std:  0.0067534444900193375 
thres:  0.00046485223770141603
Preserved_eigens number check:  6
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  8
  5%|▍         | 48/1000 [03:05<1:02:50,  3.96s/it]Epoch:   49
max of grad d_p:  tensor(0.4001, device='cuda:0')
min of grad d_p:  tensor(-11.2000, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(1.1821, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(-0.0401, device='cuda:0') norm:  tensor(2.0148, device='cuda:0') MSE:  tensor(3.7829e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0268, device='cuda:0') mean:  tensor(1.6725e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0473, device='cuda:0') MSE:  tensor(8.8795e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0636, device='cuda:0')
min of d_p_list:  tensor(-0.0390, device='cuda:0')
Epoch:  49  
Training Loss: 0.6879287958145142
Test Loss:  0.6032388210296631
Test Acc:  0.0
Valid Loss:  0.6453368663787842
Valid Acc:  0.0
std:  0.08949665439203011 
thres:  0.0005094457983970641
Preserved_eigens number check:  8
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  4
  5%|▍         | 49/1000 [03:09<1:03:17,  3.99s/it]Epoch:   50
max of grad d_p:  tensor(0.5321, device='cuda:0')
min of grad d_p:  tensor(-11.8255, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.9489, device='cuda:0') mean:  tensor(1.3006e-05, device='cuda:0') min:  tensor(-0.0385, device='cuda:0') norm:  tensor(1.8115, device='cuda:0') MSE:  tensor(3.4013e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0015, device='cuda:0') mean:  tensor(7.1619e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0149, device='cuda:0') MSE:  tensor(2.8026e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0154, device='cuda:0')
min of d_p_list:  tensor(-0.0146, device='cuda:0')
Epoch:  50  
Training Loss: 0.6833468675613403
Test Loss:  0.5997759103775024
Test Acc:  0.0
Valid Loss:  0.6412005424499512
Valid Acc:  0.0
std:  0.10770727992886794 
thres:  0.0005539698839187623
Preserved_eigens number check:  4
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  5
  5%|▌         | 50/1000 [03:13<1:02:53,  3.97s/it]Epoch:   51
max of grad d_p:  tensor(0.5433, device='cuda:0')
min of grad d_p:  tensor(-11.6990, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(1.0474, device='cuda:0') mean:  tensor(1.7755e-05, device='cuda:0') min:  tensor(-0.0449, device='cuda:0') norm:  tensor(2.0055, device='cuda:0') MSE:  tensor(3.7655e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0027, device='cuda:0') mean:  tensor(7.0795e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0144, device='cuda:0') MSE:  tensor(2.7039e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0044, device='cuda:0')
min of d_p_list:  tensor(-0.0082, device='cuda:0')
Epoch:  51  
Training Loss: 0.6798398494720459
Test Loss:  0.5964493155479431
Test Acc:  0.0
Valid Loss:  0.6377984285354614
Valid Acc:  0.0
std:  0.10538999720204321 
thres:  0.0005978040933609009
Preserved_eigens number check:  5
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  9
  5%|▌         | 51/1000 [03:17<1:02:31,  3.95s/it]Epoch:   52
max of grad d_p:  tensor(0.5458, device='cuda:0')
min of grad d_p:  tensor(-11.7378, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(1.0163, device='cuda:0') mean:  tensor(1.1261e-05, device='cuda:0') min:  tensor(-0.0428, device='cuda:0') norm:  tensor(1.9623, device='cuda:0') MSE:  tensor(3.6843e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0017, device='cuda:0') mean:  tensor(6.5557e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0138, device='cuda:0') MSE:  tensor(2.5987e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0034, device='cuda:0')
min of d_p_list:  tensor(-0.0029, device='cuda:0')
Epoch:  52  
Training Loss: 0.6776567697525024
Test Loss:  0.5944001078605652
Test Acc:  0.0
Valid Loss:  0.6354491710662842
Valid Acc:  0.0
std:  0.08179361483641945 
thres:  0.0006413331687450408
Preserved_eigens number check:  9
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  5
  5%|▌         | 52/1000 [03:21<1:01:27,  3.89s/it]Epoch:   53
max of grad d_p:  tensor(0.5463, device='cuda:0')
min of grad d_p:  tensor(-11.5394, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(1.1361, device='cuda:0') mean:  tensor(8.0086e-06, device='cuda:0') min:  tensor(-0.0487, device='cuda:0') norm:  tensor(2.2455, device='cuda:0') MSE:  tensor(4.2160e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0203, device='cuda:0') mean:  tensor(1.3873e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0383, device='cuda:0') MSE:  tensor(7.1886e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0108, device='cuda:0')
min of d_p_list:  tensor(-0.0095, device='cuda:0')
Epoch:  53  
Training Loss: 0.6739844083786011
Test Loss:  0.5910077095031738
Test Acc:  0.0
Valid Loss:  0.63192218542099
Valid Acc:  0.0
std:  0.004780191946993375 
thres:  0.0006805513381958008
Preserved_eigens number check:  5
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  8
  5%|▌         | 53/1000 [03:25<1:00:55,  3.86s/it]Epoch:   54
max of grad d_p:  tensor(0.5540, device='cuda:0')
min of grad d_p:  tensor(-11.5490, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(1.2598, device='cuda:0') mean:  tensor(1.0542e-05, device='cuda:0') min:  tensor(-0.0550, device='cuda:0') norm:  tensor(2.4984, device='cuda:0') MSE:  tensor(4.6910e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0117, device='cuda:0') mean:  tensor(1.3612e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0311, device='cuda:0') MSE:  tensor(5.8338e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0061, device='cuda:0')
min of d_p_list:  tensor(-0.0067, device='cuda:0')
Epoch:  54  
Training Loss: 0.6704352498054504
Test Loss:  0.5877173542976379
Test Acc:  0.0
Valid Loss:  0.6285288333892822
Valid Acc:  0.0
std:  0.004493433169898593 
thres:  0.000677052628993988
Preserved_eigens number check:  8
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  5
  5%|▌         | 54/1000 [03:28<58:46,  3.73s/it]  Epoch:   55
max of grad d_p:  tensor(0.5578, device='cuda:0')
min of grad d_p:  tensor(-11.5400, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(1.1349, device='cuda:0') mean:  tensor(1.0222e-05, device='cuda:0') min:  tensor(-0.0498, device='cuda:0') norm:  tensor(2.2661, device='cuda:0') MSE:  tensor(4.2547e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0029, device='cuda:0') mean:  tensor(8.0592e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0156, device='cuda:0') MSE:  tensor(2.9224e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0194, device='cuda:0')
min of d_p_list:  tensor(-0.0112, device='cuda:0')
Epoch:  55  
Training Loss: 0.666684091091156
Test Loss:  0.5834584832191467
Test Acc:  0.0
Valid Loss:  0.6244498491287231
Valid Acc:  0.0
std:  0.0047605508803578245 
thres:  0.0006737200736999511
Preserved_eigens number check:  5
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  5
  6%|▌         | 55/1000 [03:32<58:31,  3.72s/it]Epoch:   56
max of grad d_p:  tensor(0.5728, device='cuda:0')
min of grad d_p:  tensor(-11.6083, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(0.9459, device='cuda:0') mean:  tensor(7.8623e-06, device='cuda:0') min:  tensor(-0.0423, device='cuda:0') norm:  tensor(1.8913, device='cuda:0') MSE:  tensor(3.5511e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0073, device='cuda:0') mean:  tensor(1.1522e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0241, device='cuda:0') MSE:  tensor(4.5283e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0082, device='cuda:0')
min of d_p_list:  tensor(-0.0056, device='cuda:0')
Epoch:  56  
Training Loss: 0.6629794836044312
Test Loss:  0.5809051990509033
Test Acc:  0.0
Valid Loss:  0.6211942434310913
Valid Acc:  0.0
std:  0.005183984106528062 
thres:  0.0006703480005264282
Preserved_eigens number check:  5
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  5
  6%|▌         | 56/1000 [03:36<59:26,  3.78s/it]Epoch:   57
max of grad d_p:  tensor(0.5778, device='cuda:0')
min of grad d_p:  tensor(-11.4585, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(1.0837, device='cuda:0') mean:  tensor(8.0130e-06, device='cuda:0') min:  tensor(-0.0493, device='cuda:0') norm:  tensor(2.1834, device='cuda:0') MSE:  tensor(4.0994e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0036, device='cuda:0') mean:  tensor(8.2475e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0172, device='cuda:0') MSE:  tensor(3.2300e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0126, device='cuda:0')
min of d_p_list:  tensor(-0.0113, device='cuda:0')
Epoch:  57  
Training Loss: 0.6593793630599976
Test Loss:  0.5776053071022034
Test Acc:  0.0
Valid Loss:  0.617732584476471
Valid Acc:  0.0
std:  0.0051855305856394335 
thres:  0.0006666925191879273
Preserved_eigens number check:  5
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  6
  6%|▌         | 57/1000 [03:40<59:46,  3.80s/it]Epoch:   58
max of grad d_p:  tensor(0.5867, device='cuda:0')
min of grad d_p:  tensor(-11.4630, device='cuda:0')

 check Jacobi res:  torch.Size([532609]) max:  tensor(1.0224, device='cuda:0') mean:  tensor(1.0302e-05, device='cuda:0') min:  tensor(-0.0477, device='cuda:0') norm:  tensor(2.0674, device='cuda:0') MSE:  tensor(3.8816e-06, device='cuda:0')
BAD Jacobian OCCURS!

 check NTK dimension reduction res:  torch.Size([532609, 1]) max:  tensor(0.0032, device='cuda:0') mean:  tensor(8.7970e-06, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0179, device='cuda:0') MSE:  tensor(3.3622e-08, device='cuda:0')
Shape check:  torch.Size([532609, 1])
max of d_p_list:  tensor(0.0016, device='cuda:0')
min of d_p_list:  tensor(-0.0035, device='cuda:0')
Epoch:  58  
Training Loss: 0.6558650135993958
Test Loss:  0.573654055595398
Test Acc:  0.0
Valid Loss:  0.6139308214187622
Valid Acc:  0.0
std:  0.005154597426389118 
thres:  0.0006630686402320863
Preserved_eigens number check:  6
max of Lambda2 tensor(1000., device='cuda:0')
min of Lambda2 tensor(0., device='cuda:0')
eigenvalues preserved:  6
  6%|▌         | 58/1000 [03:44<59:43,  3.80s/it]