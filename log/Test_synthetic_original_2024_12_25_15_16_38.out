/nishome/yui/ModifiedNGD/utils/readData.py:18: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  return torch.tensor(x, dtype=torch.float32), torch.tensor(y, dtype=torch.float32)
Train info: 
 train data shape: torch.Size([512, 1]), 
 train lable shape: torch.Size([512, 1]), 
 positive / negative: 0.014509063214063644 / 0.9854909181594849, 
 discrepancy norm error: 8.21854019165039
Test info: 
 test data shape: torch.Size([256, 1]), 
 test lable shape: torch.Size([256, 1]), , 
 positive / negative: -0.04019593074917793 / 1.0401959419250488, 
 discrepancy norm error: 5.910345554351807
Valid info: 
 valid data shape: torch.Size([256, 1]), valid lable shape: torch.Size([256, 1]), 
 positive / negative: 0.04114104062318802 / 0.9588589668273926, 
 discrepancy norm error: 5.461434364318848
torch.Size([512, 1]) torch.Size([512])
seed is  2191
---------------------------------------- NGD ----------------------------------------
<bound method Module.modules of Sequential(
  (0): Linear(in_features=1, out_features=512, bias=True)
  (1): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (2): ReLU()
  (3): Linear(in_features=512, out_features=512, bias=True)
  (4): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (5): ReLU()
  (6): Linear(in_features=512, out_features=512, bias=True)
  (7): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (8): ReLU()
  (9): Linear(in_features=512, out_features=512, bias=True)
  (10): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (11): ReLU()
  (12): Linear(in_features=512, out_features=1, bias=True)
)>
Learning rate is:  0.01
  0%|          | 0/1000 [00:00<?, ?it/s]/nishome/yui/anaconda3/envs/ng/lib/python3.12/site-packages/torch/autograd/graph.py:744: UserWarning: Using backward() with create_graph=True will create a reference cycle between the parameter and its gradient which can cause a memory leak. We recommend using autograd.grad when creating the graph to avoid this. If you have to use this function, make sure to reset the .grad fields of your parameters to None after use to break the cycle and avoid the leak. (Triggered internally at /opt/conda/conda-bld/pytorch_1716905971214/work/torch/csrc/autograd/engine.cpp:1203.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
Epoch:   1
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.5201, device='cuda:0') 
Std:  tensor(37.1448, device='cuda:0') 
ABS Max:  tensor(570.4353, device='cuda:0') 
ABS Min:  tensor(0.0011, device='cuda:0')
Criterion check:  tensor([1.0012, 1.0003, 1.0000, 0.9985, 1.0004, 0.9998, 1.0016, 1.0089, 0.9992,
        0.9977], device='cuda:0') tensor(223, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0024, device='cuda:0')
eigenvalues preserved:  512
Test train Loss:  0.25982871651649475
Test train Acc:  0.0
Test Loss:  0.26468369364738464
Test Acc:  0.0
Valid Loss:  0.232069194316864
Valid Acc:  0.0
max of grad d_p:  tensor(4.7787, device='cuda:0')
min of grad d_p:  tensor(-0.3868, device='cuda:0')
max|min: (J_L, Jta/N)  (4.778709411621094, 4.7787394523620605, ratio: 1.0000063180923462)|(-0.3867913782596588, -0.3867897093296051)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.8030e-05, device='cuda:0') mean:  tensor(-2.4766e-09, device='cuda:0') min:  tensor(-3.0041e-05, device='cuda:0') norm:  tensor(0.0003, device='cuda:0') MSE:  tensor(3.8010e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0043, device='cuda:0') mean:  tensor(2.4455e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0493, device='cuda:0') MSE:  tensor(6.2138e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0067, device='cuda:0')
min of d_p_list:  tensor(-0.0192, device='cuda:0')
Epoch:  1  
Training Loss: 0.2621269266237505
Test Loss:  0.26642686128616333
Test Acc:  0.0
Valid Loss:  0.2342473715543747
Valid Acc:  0.0
local minima detector shape:  (0,)
Preserved_eigens number check:  512
  0%|          | 1/1000 [00:14<4:01:20, 14.50s/it]Epoch:   2
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(6.5102, device='cuda:0') 
Std:  tensor(104.9020, device='cuda:0') 
ABS Max:  tensor(1597.6383, device='cuda:0') 
ABS Min:  tensor(0.0072, device='cuda:0')
Criterion check:  tensor([1.0138, 1.0007, 1.0033, 0.9891, 1.0070, 0.9995, 1.0007, 0.9787, 1.0007,
        1.1076], device='cuda:0') tensor(272, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0008, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(3.7774, device='cuda:0')
min of grad d_p:  tensor(-0.3600, device='cuda:0')
max|min: (J_L, Jta/N)  (3.7774219512939453, 3.7774126529693604, ratio: 0.9999975562095642)|(-0.3600010275840759, -0.3599894940853119)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.2636e-05, device='cuda:0') mean:  tensor(-1.5922e-09, device='cuda:0') min:  tensor(-1.3679e-05, device='cuda:0') norm:  tensor(0.0002, device='cuda:0') MSE:  tensor(2.8263e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0292, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(6.7958e-15, device='cuda:0') norm:  tensor(0.2423, device='cuda:0') MSE:  tensor(3.0533e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0462, device='cuda:0')
min of d_p_list:  tensor(-0.0157, device='cuda:0')
Epoch:  2  
Training Loss: 0.26353561878204346
Test Loss:  0.2678804397583008
Test Acc:  0.0
Valid Loss:  0.23628896474838257
Valid Acc:  0.0
local minima detector shape:  (1,)
Preserved_eigens number check:  512
  0%|          | 2/1000 [00:28<4:00:40, 14.47s/it]Epoch:   3
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.4319, device='cuda:0') 
Std:  tensor(23.5288, device='cuda:0') 
ABS Max:  tensor(366.5818, device='cuda:0') 
ABS Min:  tensor(0.0008, device='cuda:0')
Criterion check:  tensor([1.0033, 0.9916, 0.9998, 1.0241, 1.0003, 1.0013, 0.9998, 1.0003, 0.9984,
        1.0254], device='cuda:0') tensor(243, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0039, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(6.0972, device='cuda:0')
min of grad d_p:  tensor(-0.4148, device='cuda:0')
max|min: (J_L, Jta/N)  (6.097209930419922, 6.096778869628906, ratio: 0.9999293088912964)|(-0.41480743885040283, -0.4148179888725281)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(-6.1588e-09, device='cuda:0') min:  tensor(-0.0002, device='cuda:0') norm:  tensor(0.0047, device='cuda:0') MSE:  tensor(5.9652e-09, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0233, device='cuda:0') mean:  tensor(8.0821e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1827, device='cuda:0') MSE:  tensor(2.3027e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0067, device='cuda:0')
min of d_p_list:  tensor(-0.0019, device='cuda:0')
Epoch:  3  
Training Loss: 0.26250094175338745
Test Loss:  0.2660403251647949
Test Acc:  0.0
Valid Loss:  0.23592928051948547
Valid Acc:  0.0
local minima detector shape:  (2,)
Preserved_eigens number check:  512
  0%|          | 3/1000 [00:43<4:01:40, 14.54s/it]Epoch:   4
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(6.0305, device='cuda:0') 
Std:  tensor(80.3519, device='cuda:0') 
ABS Max:  tensor(1597.4376, device='cuda:0') 
ABS Min:  tensor(0.0014, device='cuda:0')
Criterion check:  tensor([1.0017, 0.9969, 0.9996, 0.9946, 0.9992, 1.0005, 0.9995, 1.0005, 1.0000,
        0.9991], device='cuda:0') tensor(215, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0009, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(7.0541, device='cuda:0')
min of grad d_p:  tensor(-0.3970, device='cuda:0')
max|min: (J_L, Jta/N)  (7.0540771484375, 7.054043769836426, ratio: 0.9999952912330627)|(-0.3969506323337555, -0.39694342017173767)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.3379e-05, device='cuda:0') mean:  tensor(-6.5801e-09, device='cuda:0') min:  tensor(-9.6560e-06, device='cuda:0') norm:  tensor(0.0002, device='cuda:0') MSE:  tensor(2.5945e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0127, device='cuda:0') mean:  tensor(4.7978e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0997, device='cuda:0') MSE:  tensor(1.2563e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1047, device='cuda:0')
min of d_p_list:  tensor(-0.0851, device='cuda:0')
Epoch:  4  
Training Loss: 0.25820159912109375
Test Loss:  0.2612094283103943
Test Acc:  0.0
Valid Loss:  0.2334325611591339
Valid Acc:  0.0
local minima detector shape:  (3,)
Preserved_eigens number check:  512
  0%|          | 4/1000 [00:58<4:02:39, 14.62s/it]Epoch:   5
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-1.5224, device='cuda:0') 
Std:  tensor(55.6949, device='cuda:0') 
ABS Max:  tensor(768.2176, device='cuda:0') 
ABS Min:  tensor(0.0020, device='cuda:0')
Criterion check:  tensor([0.9987, 0.9985, 1.0004, 1.0011, 0.9986, 0.9970, 1.0012, 1.0071, 1.0012,
        1.0083], device='cuda:0') tensor(266, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0015, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(2.5407, device='cuda:0')
min of grad d_p:  tensor(-0.9416, device='cuda:0')
max|min: (J_L, Jta/N)  (2.540724039077759, 2.540545701980591, ratio: 0.9999297857284546)|(-0.9416423439979553, -0.9412551522254944)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(-1.2574e-07, device='cuda:0') min:  tensor(-0.0004, device='cuda:0') norm:  tensor(0.0081, device='cuda:0') MSE:  tensor(1.0177e-08, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0024, device='cuda:0') mean:  tensor(2.4824e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0482, device='cuda:0') MSE:  tensor(6.0726e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0190, device='cuda:0')
min of d_p_list:  tensor(-0.0215, device='cuda:0')
Epoch:  5  
Training Loss: 0.2539865970611572
Test Loss:  0.2564934194087982
Test Acc:  0.0
Valid Loss:  0.22934046387672424
Valid Acc:  0.0
local minima detector shape:  (4,)
Preserved_eigens number check:  512
  0%|          | 5/1000 [01:13<4:03:30, 14.68s/it]Epoch:   6
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(0.1914, device='cuda:0') 
Std:  tensor(33.9384, device='cuda:0') 
ABS Max:  tensor(540.6778, device='cuda:0') 
ABS Min:  tensor(0.0009, device='cuda:0')
Criterion check:  tensor([1.0004, 0.9999, 0.9856, 1.0004, 1.0001, 1.0009, 1.0002, 0.9893, 0.9951,
        0.9537], device='cuda:0') tensor(253, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0018, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(2.3957, device='cuda:0')
min of grad d_p:  tensor(-0.9647, device='cuda:0')
max|min: (J_L, Jta/N)  (2.395699977874756, 2.3956780433654785, ratio: 0.9999908208847046)|(-0.9646919965744019, -0.9646927118301392)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.1935e-05, device='cuda:0') mean:  tensor(1.6496e-09, device='cuda:0') min:  tensor(-6.0610e-06, device='cuda:0') norm:  tensor(0.0001, device='cuda:0') MSE:  tensor(1.2684e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0179, device='cuda:0') mean:  tensor(0.0002, device='cuda:0') min:  tensor(1.6873e-13, device='cuda:0') norm:  tensor(0.3164, device='cuda:0') MSE:  tensor(3.9869e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0285, device='cuda:0')
min of d_p_list:  tensor(-0.1100, device='cuda:0')
Epoch:  6  
Training Loss: 0.24773433804512024
Test Loss:  0.24977561831474304
Test Acc:  0.0
Valid Loss:  0.22260870039463043
Valid Acc:  0.0
std:  0.005816659344800922 
thres:  0.00025719181895256043
Preserved_eigens number check:  512
  1%|          | 6/1000 [01:27<4:03:36, 14.70s/it]Epoch:   7
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(32.9044, device='cuda:0') 
Std:  tensor(651.3049, device='cuda:0') 
ABS Max:  tensor(14625.0693, device='cuda:0') 
ABS Min:  tensor(0.0039, device='cuda:0')
Criterion check:  tensor([1.0031, 1.0015, 1.0278, 0.9990, 0.9970, 0.9970, 1.0006, 1.0002, 0.9931,
        0.9976], device='cuda:0') tensor(267, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0014, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.6590, device='cuda:0')
min of grad d_p:  tensor(-0.7107, device='cuda:0')
max|min: (J_L, Jta/N)  (0.6589645147323608, 0.6584898233413696, ratio: 0.9992796182632446)|(-0.7106631994247437, -0.7103567123413086)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0021, device='cuda:0') mean:  tensor(-5.4426e-08, device='cuda:0') min:  tensor(-0.0038, device='cuda:0') norm:  tensor(0.0198, device='cuda:0') MSE:  tensor(2.4941e-08, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0040, device='cuda:0') mean:  tensor(3.7012e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0679, device='cuda:0') MSE:  tensor(8.5606e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0054, device='cuda:0')
min of d_p_list:  tensor(-0.0055, device='cuda:0')
Epoch:  7  
Training Loss: 0.24198018014431
Test Loss:  0.2445743978023529
Test Acc:  0.0
Valid Loss:  0.21618565917015076
Valid Acc:  0.0
std:  0.007312870867865815 
thres:  0.0002528807312250138
Preserved_eigens number check:  512
  1%|          | 7/1000 [01:42<4:03:09, 14.69s/it]Epoch:   8
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(1.4978, device='cuda:0') 
Std:  tensor(38.5992, device='cuda:0') 
ABS Max:  tensor(471.9454, device='cuda:0') 
ABS Min:  tensor(0.0012, device='cuda:0')
Criterion check:  tensor([1.0012, 1.0004, 0.9970, 0.9983, 1.0002, 0.9964, 0.9989, 1.0011, 0.9993,
        0.9991], device='cuda:0') tensor(247, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0009, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.6800, device='cuda:0')
min of grad d_p:  tensor(-0.7151, device='cuda:0')
max|min: (J_L, Jta/N)  (0.6800292730331421, 0.680026113986969, ratio: 0.9999953508377075)|(-0.7150554656982422, -0.7150568962097168)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.1658e-06, device='cuda:0') mean:  tensor(3.4006e-09, device='cuda:0') min:  tensor(-3.6061e-05, device='cuda:0') norm:  tensor(0.0002, device='cuda:0') MSE:  tensor(2.0845e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0047, device='cuda:0') mean:  tensor(1.9784e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0339, device='cuda:0') MSE:  tensor(4.2729e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0063, device='cuda:0')
min of d_p_list:  tensor(-0.0039, device='cuda:0')
Epoch:  8  
Training Loss: 0.23501361906528473
Test Loss:  0.2376970648765564
Test Acc:  0.0
Valid Loss:  0.20786988735198975
Valid Acc:  0.0
std:  0.008282089908429257 
thres:  0.0002473832666873932
Preserved_eigens number check:  512
  1%|          | 8/1000 [01:57<4:03:16, 14.71s/it]Epoch:   9
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(5.0689, device='cuda:0') 
Std:  tensor(221.5823, device='cuda:0') 
ABS Max:  tensor(3340.4490, device='cuda:0') 
ABS Min:  tensor(0.0229, device='cuda:0')
Criterion check:  tensor([0.9912, 0.9989, 0.9934, 1.0003, 1.0026, 1.0314, 0.9988, 1.0071, 1.0110,
        1.0010], device='cuda:0') tensor(280, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0023, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.7231, device='cuda:0')
min of grad d_p:  tensor(-0.7802, device='cuda:0')
max|min: (J_L, Jta/N)  (0.723130464553833, 0.723125159740448, ratio: 0.9999926686286926)|(-0.7802213430404663, -0.780220091342926)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.3918e-05, device='cuda:0') mean:  tensor(-2.5910e-09, device='cuda:0') min:  tensor(-1.5736e-05, device='cuda:0') norm:  tensor(0.0002, device='cuda:0') MSE:  tensor(2.7746e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0342, device='cuda:0') mean:  tensor(0.0002, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.3571, device='cuda:0') MSE:  tensor(4.4999e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0077, device='cuda:0')
min of d_p_list:  tensor(-0.0036, device='cuda:0')
Epoch:  9  
Training Loss: 0.22908902168273926
Test Loss:  0.23138436675071716
Test Acc:  0.0
Valid Loss:  0.20024897158145905
Valid Acc:  0.0
std:  0.008844203942469204 
thres:  0.00024156075119972228
Preserved_eigens number check:  512
  1%|          | 9/1000 [02:11<4:02:51, 14.70s/it]Epoch:   10
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(117.3668, device='cuda:0') 
Std:  tensor(4028.4282, device='cuda:0') 
ABS Max:  tensor(87851.4141, device='cuda:0') 
ABS Min:  tensor(0.1045, device='cuda:0')
Criterion check:  tensor([1.0490, 1.0151, 1.1128, 0.8582, 0.9713, 1.0430, 0.9789, 0.9920, 0.9612,
        0.8878], device='cuda:0') tensor(251, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0024, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(0.6932, device='cuda:0')
min of grad d_p:  tensor(-0.7225, device='cuda:0')
max|min: (J_L, Jta/N)  (0.6932222247123718, 0.6932186484336853, ratio: 0.9999948143959045)|(-0.7225293517112732, -0.7225288152694702)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.4573e-05, device='cuda:0') mean:  tensor(3.0254e-09, device='cuda:0') min:  tensor(-2.7835e-05, device='cuda:0') norm:  tensor(0.0003, device='cuda:0') MSE:  tensor(3.7293e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.3653, device='cuda:0') mean:  tensor(0.0029, device='cuda:0') min:  tensor(4.8174e-14, device='cuda:0') norm:  tensor(4.9724, device='cuda:0') MSE:  tensor(6.2657e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0523, device='cuda:0')
min of d_p_list:  tensor(-0.1238, device='cuda:0')
Epoch:  10  
Training Loss: 0.22663451731204987
Test Loss:  0.2298664152622223
Test Acc:  0.0
Valid Loss:  0.19577273726463318
Valid Acc:  0.0
std:  0.007872271289240408 
thres:  0.0002360903352499008
Preserved_eigens number check:  512
  1%|          | 10/1000 [02:26<4:02:43, 14.71s/it]Epoch:   11
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-5.0433, device='cuda:0') 
Std:  tensor(80.9104, device='cuda:0') 
ABS Max:  tensor(1315.8353, device='cuda:0') 
ABS Min:  tensor(0.0049, device='cuda:0')
Criterion check:  tensor([0.9987, 0.9919, 0.9930, 0.9993, 1.0080, 1.0069, 1.0019, 0.9995, 1.0264,
        0.9984], device='cuda:0') tensor(280, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0068, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(8.9553, device='cuda:0')
min of grad d_p:  tensor(-3.2645, device='cuda:0')
max|min: (J_L, Jta/N)  (8.955334663391113, 8.955318450927734, ratio: 0.9999982118606567)|(-3.2644741535186768, -3.2645010948181152)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.6941e-05, device='cuda:0') mean:  tensor(9.4764e-09, device='cuda:0') min:  tensor(-3.0279e-05, device='cuda:0') norm:  tensor(0.0006, device='cuda:0') MSE:  tensor(7.5649e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0693, device='cuda:0') mean:  tensor(0.0003, device='cuda:0') min:  tensor(7.1112e-13, device='cuda:0') norm:  tensor(0.5442, device='cuda:0') MSE:  tensor(6.8570e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0221, device='cuda:0')
min of d_p_list:  tensor(-0.0384, device='cuda:0')
Epoch:  11  
Training Loss: 0.22706305980682373
Test Loss:  0.229944109916687
Test Acc:  0.0
Valid Loss:  0.19368112087249756
Valid Acc:  0.0
std:  0.005836297255727898 
thres:  0.00023195607960224153
Preserved_eigens number check:  512
  1%|          | 11/1000 [02:41<4:03:02, 14.74s/it]Epoch:   12
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.4486, device='cuda:0') 
Std:  tensor(21.6730, device='cuda:0') 
ABS Max:  tensor(329.0208, device='cuda:0') 
ABS Min:  tensor(0.0018, device='cuda:0')
Criterion check:  tensor([1.0010, 0.9982, 1.0007, 1.0002, 0.9983, 0.9988, 1.0025, 0.9986, 0.9644,
        1.0016], device='cuda:0') tensor(192, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0021, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(8.5282, device='cuda:0')
min of grad d_p:  tensor(-5.3593, device='cuda:0')
max|min: (J_L, Jta/N)  (8.528207778930664, 8.528189659118652, ratio: 0.9999978542327881)|(-5.359291076660156, -5.359274387359619)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.6226e-05, device='cuda:0') mean:  tensor(9.8677e-12, device='cuda:0') min:  tensor(-1.6689e-05, device='cuda:0') norm:  tensor(0.0003, device='cuda:0') MSE:  tensor(3.6876e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0369, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.3030, device='cuda:0') MSE:  tensor(3.8179e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0135, device='cuda:0')
min of d_p_list:  tensor(-0.0168, device='cuda:0')
Epoch:  12  
Training Loss: 0.22467565536499023
Test Loss:  0.2279791235923767
Test Acc:  0.0
Valid Loss:  0.19112186133861542
Valid Acc:  0.0
std:  0.003548083936868599 
thres:  0.00022849517464637757
Preserved_eigens number check:  512
  1%|          | 12/1000 [02:56<4:03:11, 14.77s/it]Epoch:   13
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(1.0683, device='cuda:0') 
Std:  tensor(89.2337, device='cuda:0') 
ABS Max:  tensor(1417.9869, device='cuda:0') 
ABS Min:  tensor(0.0030, device='cuda:0')
Criterion check:  tensor([1.0104, 1.0412, 0.8524, 1.0077, 0.9832, 1.0053, 0.8948, 0.9622, 0.9861,
        1.0054], device='cuda:0') tensor(242, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0002, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(9.8806, device='cuda:0')
min of grad d_p:  tensor(-5.8898, device='cuda:0')
max|min: (J_L, Jta/N)  (9.880555152893066, 9.880509376525879, ratio: 0.9999953508377075)|(-5.8898491859436035, -5.889977931976318)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(6.3327e-09, device='cuda:0') min:  tensor(-2.2471e-05, device='cuda:0') norm:  tensor(0.0007, device='cuda:0') MSE:  tensor(8.6089e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.2147, device='cuda:0') mean:  tensor(0.0008, device='cuda:0') min:  tensor(2.5520e-13, device='cuda:0') norm:  tensor(1.9963, device='cuda:0') MSE:  tensor(2.5155e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0196, device='cuda:0')
min of d_p_list:  tensor(-0.0436, device='cuda:0')
Epoch:  13  
Training Loss: 0.22103241086006165
Test Loss:  0.22533777356147766
Test Acc:  0.0
Valid Loss:  0.18881571292877197
Valid Acc:  0.0
std:  0.002722219213352655 
thres:  0.00022569893300533294
Preserved_eigens number check:  512
  1%|▏         | 13/1000 [03:11<4:02:26, 14.74s/it]Epoch:   14
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(23.5558, device='cuda:0') 
Std:  tensor(527.9929, device='cuda:0') 
ABS Max:  tensor(11941.6484, device='cuda:0') 
ABS Min:  tensor(0.0006, device='cuda:0')
Criterion check:  tensor([1.0010, 0.9960, 1.0020, 0.9986, 1.0024, 1.0035, 1.0004, 0.9988, 1.0019,
        1.0009], device='cuda:0') tensor(250, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0030, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(9.0365, device='cuda:0')
min of grad d_p:  tensor(-7.2189, device='cuda:0')
max|min: (J_L, Jta/N)  (9.036450386047363, 9.038820266723633, ratio: 1.0002622604370117)|(-7.218891620635986, -7.220986366271973)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0021, device='cuda:0') mean:  tensor(-9.4703e-07, device='cuda:0') min:  tensor(-0.0097, device='cuda:0') norm:  tensor(0.0604, device='cuda:0') MSE:  tensor(7.6132e-08, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0252, device='cuda:0') mean:  tensor(0.0002, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.2852, device='cuda:0') MSE:  tensor(3.5938e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0061, device='cuda:0')
min of d_p_list:  tensor(-0.0048, device='cuda:0')
Epoch:  14  
Training Loss: 0.2223919928073883
Test Loss:  0.2279762327671051
Test Acc:  0.0
Valid Loss:  0.1906207799911499
Valid Acc:  0.0
std:  0.0023462949647637455 
thres:  0.00022435952723026277
Preserved_eigens number check:  512
  1%|▏         | 14/1000 [03:25<4:02:04, 14.73s/it]Epoch:   15
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.2431, device='cuda:0') 
Std:  tensor(28.0153, device='cuda:0') 
ABS Max:  tensor(318.4077, device='cuda:0') 
ABS Min:  tensor(0.0004, device='cuda:0')
Criterion check:  tensor([0.9962, 1.0094, 0.9988, 0.9994, 0.9873, 0.9991, 0.9989, 1.0004, 1.0087,
        0.9987], device='cuda:0') tensor(251, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0027, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(8.6923, device='cuda:0')
min of grad d_p:  tensor(-6.9359, device='cuda:0')
max|min: (J_L, Jta/N)  (8.6923246383667, 8.692307472229004, ratio: 0.9999980330467224)|(-6.935878276824951, -6.935823440551758)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.7684e-05, device='cuda:0') mean:  tensor(-1.4379e-08, device='cuda:0') min:  tensor(-5.4836e-05, device='cuda:0') norm:  tensor(0.0008, device='cuda:0') MSE:  tensor(9.6479e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0513, device='cuda:0') mean:  tensor(0.0003, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.5908, device='cuda:0') MSE:  tensor(7.4442e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0021, device='cuda:0')
min of d_p_list:  tensor(-0.0063, device='cuda:0')
Epoch:  15  
Training Loss: 0.22339490056037903
Test Loss:  0.22871190309524536
Test Acc:  0.0
Valid Loss:  0.1926122009754181
Valid Acc:  0.0
std:  0.002058222617155808 
thres:  0.0002237116038799286
Preserved_eigens number check:  512
  2%|▏         | 15/1000 [03:40<4:01:59, 14.74s/it]Epoch:   16
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.9610, device='cuda:0') 
Std:  tensor(1075.3872, device='cuda:0') 
ABS Max:  tensor(13882.3965, device='cuda:0') 
ABS Min:  tensor(0.0104, device='cuda:0')
Criterion check:  tensor([0.8341, 0.2726, 1.1949, 0.9960, 8.7867, 1.2003, 0.9571, 0.9490, 0.7435,
        0.8679], device='cuda:0') tensor(249, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0068, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(8.3856, device='cuda:0')
min of grad d_p:  tensor(-6.2459, device='cuda:0')
max|min: (J_L, Jta/N)  (8.385595321655273, 8.385551452636719, ratio: 0.9999947547912598)|(-6.245890140533447, -6.245968341827393)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(9.0463e-09, device='cuda:0') min:  tensor(-5.4359e-05, device='cuda:0') norm:  tensor(0.0016, device='cuda:0') MSE:  tensor(2.0210e-09, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(2.8947, device='cuda:0') mean:  tensor(0.0069, device='cuda:0') min:  tensor(2.0497e-12, device='cuda:0') norm:  tensor(26.6934, device='cuda:0') MSE:  tensor(3.3636e-05, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0186, device='cuda:0')
min of d_p_list:  tensor(-0.0040, device='cuda:0')
Epoch:  16  
Training Loss: 0.22289302945137024
Test Loss:  0.22828252613544464
Test Acc:  0.0
Valid Loss:  0.1948070377111435
Valid Acc:  0.0
std:  0.0011951048774853912 
thres:  0.0002228775978088379
Preserved_eigens number check:  512
**************************************************learning rate decay**************************************************
  2%|▏         | 16/1000 [03:55<4:01:38, 14.73s/it]Epoch:   17
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(0.2496, device='cuda:0') 
Std:  tensor(35.6410, device='cuda:0') 
ABS Max:  tensor(642.3350, device='cuda:0') 
ABS Min:  tensor(0.0033, device='cuda:0')
Criterion check:  tensor([1.0006, 1.0027, 1.0006, 0.9984, 0.9915, 1.0017, 1.0031, 1.0000, 0.9926,
        1.0010], device='cuda:0') tensor(188, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0031, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(7.4188, device='cuda:0')
min of grad d_p:  tensor(-4.8773, device='cuda:0')
max|min: (J_L, Jta/N)  (7.418773174285889, 7.41873025894165, ratio: 0.9999942183494568)|(-4.877289772033691, -4.877312183380127)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(1.2006e-08, device='cuda:0') min:  tensor(-2.4319e-05, device='cuda:0') norm:  tensor(0.0008, device='cuda:0') MSE:  tensor(1.0594e-09, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0353, device='cuda:0') mean:  tensor(0.0002, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.3189, device='cuda:0') MSE:  tensor(4.0185e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0065, device='cuda:0')
min of d_p_list:  tensor(-0.0081, device='cuda:0')
Epoch:  17  
Training Loss: 0.22083893418312073
Test Loss:  0.22661246359348297
Test Acc:  0.0
Valid Loss:  0.19535112380981445
Valid Acc:  0.0
local minima detector shape:  (0,)
Preserved_eigens number check:  512
  2%|▏         | 17/1000 [04:09<4:01:19, 14.73s/it]Epoch:   18
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(0.4828, device='cuda:0') 
Std:  tensor(7.2355, device='cuda:0') 
ABS Max:  tensor(79.0711, device='cuda:0') 
ABS Min:  tensor(0.0016, device='cuda:0')
Criterion check:  tensor([0.9995, 0.9981, 1.0001, 1.0000, 0.9953, 0.9990, 1.0008, 1.0010, 0.9985,
        1.0012], device='cuda:0') tensor(197, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0019, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(7.2868, device='cuda:0')
min of grad d_p:  tensor(-4.6717, device='cuda:0')
max|min: (J_L, Jta/N)  (7.286839485168457, 7.286825180053711, ratio: 0.9999980330467224)|(-4.671663284301758, -4.671761989593506)

 check Jacobi res:  torch.Size([793601]) max:  tensor(9.8705e-05, device='cuda:0') mean:  tensor(1.1402e-08, device='cuda:0') min:  tensor(-6.4850e-05, device='cuda:0') norm:  tensor(0.0004, device='cuda:0') MSE:  tensor(5.4122e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0321, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.2041, device='cuda:0') MSE:  tensor(2.5722e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0083, device='cuda:0')
min of d_p_list:  tensor(-0.0097, device='cuda:0')
Epoch:  18  
Training Loss: 0.2181301862001419
Test Loss:  0.22486335039138794
Test Acc:  0.0
Valid Loss:  0.19445794820785522
Valid Acc:  0.0
local minima detector shape:  (1,)
Preserved_eigens number check:  512
  2%|▏         | 18/1000 [04:24<4:01:07, 14.73s/it]Epoch:   19
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.0119, device='cuda:0') 
Std:  tensor(15.0248, device='cuda:0') 
ABS Max:  tensor(171.6609, device='cuda:0') 
ABS Min:  tensor(6.7057e-06, device='cuda:0')
Criterion check:  tensor([1.0002, 0.9904, 0.9990, 0.9836, 1.0037, 0.9952, 1.0022, 0.9984, 0.9947,
        1.0206], device='cuda:0') tensor(241, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0079, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(8.3272, device='cuda:0')
min of grad d_p:  tensor(-5.1360, device='cuda:0')
max|min: (J_L, Jta/N)  (8.327194213867188, 8.327225685119629, ratio: 1.0000038146972656)|(-5.135950565338135, -5.135946273803711)

 check Jacobi res:  torch.Size([793601]) max:  tensor(6.9618e-05, device='cuda:0') mean:  tensor(-5.4138e-09, device='cuda:0') min:  tensor(-3.1471e-05, device='cuda:0') norm:  tensor(0.0004, device='cuda:0') MSE:  tensor(4.5680e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0254, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.3154, device='cuda:0') MSE:  tensor(3.9740e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.6909, device='cuda:0')
min of d_p_list:  tensor(-0.9045, device='cuda:0')
Epoch:  19  
Training Loss: 0.20602039992809296
Test Loss:  0.20956650376319885
Test Acc:  0.0
Valid Loss:  0.1768081933259964
Valid Acc:  0.0
local minima detector shape:  (2,)
Preserved_eigens number check:  512
  2%|▏         | 19/1000 [04:39<4:00:56, 14.74s/it]Epoch:   20
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-25.5121, device='cuda:0') 
Std:  tensor(623.9227, device='cuda:0') 
ABS Max:  tensor(14069.9834, device='cuda:0') 
ABS Min:  tensor(0.0108, device='cuda:0')
Criterion check:  tensor([0.9997, 0.9971, 1.0006, 0.9949, 0.9974, 0.9969, 0.9991, 1.0035, 0.9999,
        1.0029], device='cuda:0') tensor(271, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0003, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(11.9911, device='cuda:0')
min of grad d_p:  tensor(-0.4032, device='cuda:0')
max|min: (J_L, Jta/N)  (11.991108894348145, 11.991143226623535, ratio: 1.0000028610229492)|(-0.4031694233417511, -0.4031691253185272)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.2915e-06, device='cuda:0') mean:  tensor(1.4975e-10, device='cuda:0') min:  tensor(-3.4332e-05, device='cuda:0') norm:  tensor(8.1926e-05, device='cuda:0') MSE:  tensor(1.0323e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0222, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.2273, device='cuda:0') MSE:  tensor(2.8643e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0062, device='cuda:0')
min of d_p_list:  tensor(-0.0074, device='cuda:0')
Epoch:  20  
Training Loss: 0.2066858410835266
Test Loss:  0.21455606818199158
Test Acc:  0.0
Valid Loss:  0.1815357655286789
Valid Acc:  0.0
local minima detector shape:  (3,)
Preserved_eigens number check:  512
  2%|▏         | 20/1000 [04:54<4:00:47, 14.74s/it]Epoch:   21
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(0.1022, device='cuda:0') 
Std:  tensor(59.2359, device='cuda:0') 
ABS Max:  tensor(567.7828, device='cuda:0') 
ABS Min:  tensor(0.0209, device='cuda:0')
Criterion check:  tensor([1.0004, 1.0037, 1.0046, 1.0093, 0.9931, 0.9885, 1.0003, 1.0003, 0.9844,
        1.0038], device='cuda:0') tensor(269, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(9.7187e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(11.7252, device='cuda:0')
min of grad d_p:  tensor(-0.4335, device='cuda:0')
max|min: (J_L, Jta/N)  (11.725170135498047, 11.72521686553955, ratio: 1.0000039339065552)|(-0.43353602290153503, -0.43353670835494995)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.9993e-06, device='cuda:0') mean:  tensor(-1.0802e-09, device='cuda:0') min:  tensor(-4.6730e-05, device='cuda:0') norm:  tensor(0.0001, device='cuda:0') MSE:  tensor(1.4272e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0107, device='cuda:0') mean:  tensor(8.1858e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1274, device='cuda:0') MSE:  tensor(1.6056e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0266, device='cuda:0')
min of d_p_list:  tensor(-0.0266, device='cuda:0')
Epoch:  21  
Training Loss: 0.2134479284286499
Test Loss:  0.22257891297340393
Test Acc:  0.0
Valid Loss:  0.18778398633003235
Valid Acc:  0.0
local minima detector shape:  (4,)
Preserved_eigens number check:  512
  2%|▏         | 21/1000 [05:08<4:00:35, 14.75s/it]Epoch:   22
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-9.7786, device='cuda:0') 
Std:  tensor(199.0324, device='cuda:0') 
ABS Max:  tensor(4431.3765, device='cuda:0') 
ABS Min:  tensor(0.0036, device='cuda:0')
Criterion check:  tensor([1.0022, 0.9985, 0.9838, 1.0119, 1.0002, 1.0047, 0.9994, 1.0015, 0.9973,
        1.0024], device='cuda:0') tensor(252, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0007, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(14.5792, device='cuda:0')
min of grad d_p:  tensor(-0.6792, device='cuda:0')
max|min: (J_L, Jta/N)  (14.579168319702148, 14.579071044921875, ratio: 0.9999933242797852)|(-0.6791874766349792, -0.6791800856590271)

 check Jacobi res:  torch.Size([793601]) max:  tensor(9.7275e-05, device='cuda:0') mean:  tensor(-9.7891e-10, device='cuda:0') min:  tensor(-1.0341e-05, device='cuda:0') norm:  tensor(0.0002, device='cuda:0') MSE:  tensor(2.3540e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0139, device='cuda:0') mean:  tensor(3.8600e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0779, device='cuda:0') MSE:  tensor(9.8140e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0117, device='cuda:0')
min of d_p_list:  tensor(-0.0128, device='cuda:0')
Epoch:  22  
Training Loss: 0.21672198176383972
Test Loss:  0.2275700718164444
Test Acc:  0.0
Valid Loss:  0.19133955240249634
Valid Acc:  0.0
std:  0.005015299599748416 
thres:  0.00021220126748085024
Preserved_eigens number check:  512
  2%|▏         | 22/1000 [05:23<4:00:07, 14.73s/it]Epoch:   23
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-8.1500, device='cuda:0') 
Std:  tensor(177.2529, device='cuda:0') 
ABS Max:  tensor(3983.6001, device='cuda:0') 
ABS Min:  tensor(0.0022, device='cuda:0')
Criterion check:  tensor([0.9988, 1.0006, 1.0539, 0.9992, 0.9998, 0.9966, 1.0006, 1.0004, 0.9973,
        0.9993], device='cuda:0') tensor(233, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0002, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(15.1475, device='cuda:0')
min of grad d_p:  tensor(-0.7164, device='cuda:0')
max|min: (J_L, Jta/N)  (15.147507667541504, 15.147439002990723, ratio: 0.9999954700469971)|(-0.7164498567581177, -0.7164440751075745)

 check Jacobi res:  torch.Size([793601]) max:  tensor(6.8665e-05, device='cuda:0') mean:  tensor(2.6833e-10, device='cuda:0') min:  tensor(-6.3777e-06, device='cuda:0') norm:  tensor(0.0001, device='cuda:0') MSE:  tensor(1.6935e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0117, device='cuda:0') mean:  tensor(2.0002e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0381, device='cuda:0') MSE:  tensor(4.7964e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0120, device='cuda:0')
min of d_p_list:  tensor(-0.0129, device='cuda:0')
Epoch:  23  
Training Loss: 0.21857628226280212
Test Loss:  0.23124994337558746
Test Acc:  0.0
Valid Loss:  0.1940084993839264
Valid Acc:  0.0
std:  0.005122793892533581 
thres:  0.00021229048669338228
Preserved_eigens number check:  512
  2%|▏         | 23/1000 [05:38<4:00:01, 14.74s/it]Epoch:   24
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(0.8728, device='cuda:0') 
Std:  tensor(43.1920, device='cuda:0') 
ABS Max:  tensor(617.7327, device='cuda:0') 
ABS Min:  tensor(0.0066, device='cuda:0')
Criterion check:  tensor([0.9992, 1.0001, 0.9461, 0.9940, 1.0019, 0.9935, 1.0011, 0.9998, 0.9976,
        1.0050], device='cuda:0') tensor(253, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0007, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(14.4446, device='cuda:0')
min of grad d_p:  tensor(-0.6623, device='cuda:0')
max|min: (J_L, Jta/N)  (14.444634437561035, 14.445558547973633, ratio: 1.0000640153884888)|(-0.6623457670211792, -0.66217440366745)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0017, device='cuda:0') mean:  tensor(1.2285e-07, device='cuda:0') min:  tensor(-0.0009, device='cuda:0') norm:  tensor(0.0121, device='cuda:0') MSE:  tensor(1.5284e-08, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0136, device='cuda:0') mean:  tensor(3.2187e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0592, device='cuda:0') MSE:  tensor(7.4618e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0372, device='cuda:0')
min of d_p_list:  tensor(-0.0107, device='cuda:0')
Epoch:  24  
Training Loss: 0.21972176432609558
Test Loss:  0.23283198475837708
Test Acc:  0.0
Valid Loss:  0.194558247923851
Valid Acc:  0.0
std:  0.004681442262032828 
thres:  0.0002150307595729828
Preserved_eigens number check:  512
  2%|▏         | 24/1000 [05:53<3:59:42, 14.74s/it]Epoch:   25
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(17.7050, device='cuda:0') 
Std:  tensor(321.4066, device='cuda:0') 
ABS Max:  tensor(5860.2290, device='cuda:0') 
ABS Min:  tensor(0.0202, device='cuda:0')
Criterion check:  tensor([1.0023, 1.0022, 0.9965, 0.9944, 1.0117, 0.9889, 1.0001, 0.9968, 0.9992,
        0.9974], device='cuda:0') tensor(257, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(4.0440e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(13.7166, device='cuda:0')
min of grad d_p:  tensor(-0.6783, device='cuda:0')
max|min: (J_L, Jta/N)  (13.716598510742188, 13.716562271118164, ratio: 0.9999973773956299)|(-0.6783088445663452, -0.6783075332641602)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.6240e-05, device='cuda:0') mean:  tensor(-7.6560e-10, device='cuda:0') min:  tensor(-2.1040e-05, device='cuda:0') norm:  tensor(8.4520e-05, device='cuda:0') MSE:  tensor(1.0650e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0393, device='cuda:0') mean:  tensor(0.0002, device='cuda:0') min:  tensor(3.7515e-13, device='cuda:0') norm:  tensor(0.3339, device='cuda:0') MSE:  tensor(4.2068e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0130, device='cuda:0')
min of d_p_list:  tensor(-0.0079, device='cuda:0')
Epoch:  25  
Training Loss: 0.21835047006607056
Test Loss:  0.23193584382534027
Test Acc:  0.0
Valid Loss:  0.19373825192451477
Valid Acc:  0.0
std:  0.0021794314655847213 
thres:  0.0002173636853694916
Preserved_eigens number check:  512
  2%|▎         | 25/1000 [06:07<3:59:24, 14.73s/it]Epoch:   26
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(-0.3566, device='cuda:0') 
Std:  tensor(17.5042, device='cuda:0') 
ABS Max:  tensor(228.2377, device='cuda:0') 
ABS Min:  tensor(0.0018, device='cuda:0')
Criterion check:  tensor([0.9998, 0.9997, 1.0004, 1.0006, 1.0040, 0.9993, 1.0000, 0.9826, 0.9999,
        1.0004], device='cuda:0') tensor(226, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(7.5027e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(14.0998, device='cuda:0')
min of grad d_p:  tensor(-0.7055, device='cuda:0')
max|min: (J_L, Jta/N)  (14.09976577758789, 14.101387023925781, ratio: 1.0001150369644165)|(-0.7055220603942871, -0.7053329944610596)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0028, device='cuda:0') mean:  tensor(2.6408e-08, device='cuda:0') min:  tensor(-0.0016, device='cuda:0') norm:  tensor(0.0167, device='cuda:0') MSE:  tensor(2.1024e-08, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0082, device='cuda:0') mean:  tensor(3.5102e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0643, device='cuda:0') MSE:  tensor(8.1016e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0075, device='cuda:0')
min of d_p_list:  tensor(-0.0057, device='cuda:0')
Epoch:  26  
Training Loss: 0.22191773355007172
Test Loss:  0.2360360026359558
Test Acc:  0.0
Valid Loss:  0.196696937084198
Valid Acc:  0.0
std:  0.0017209468450958452 
thres:  0.00021905764639377595
Preserved_eigens number check:  512
  3%|▎         | 26/1000 [06:22<3:59:01, 14.72s/it]Epoch:   27
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(0.4788, device='cuda:0') 
Std:  tensor(43.2233, device='cuda:0') 
ABS Max:  tensor(781.0717, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([0.9999, 0.9937, 1.0013, 1.0078, 1.0068, 1.0011, 0.9994, 0.9998, 1.0002,
        1.0038], device='cuda:0') tensor(255, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(9.7549e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(13.2417, device='cuda:0')
min of grad d_p:  tensor(-0.6692, device='cuda:0')
max|min: (J_L, Jta/N)  (13.241689682006836, 13.242273330688477, ratio: 1.0000441074371338)|(-0.6692492961883545, -0.6695630550384521)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(1.3823e-09, device='cuda:0') min:  tensor(-0.0037, device='cuda:0') norm:  tensor(0.0125, device='cuda:0') MSE:  tensor(1.5698e-08, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0046, device='cuda:0') mean:  tensor(2.2536e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0381, device='cuda:0') MSE:  tensor(4.7980e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0074, device='cuda:0')
min of d_p_list:  tensor(-0.0075, device='cuda:0')
Epoch:  27  
Training Loss: 0.22613200545310974
Test Loss:  0.24170973896980286
Test Acc:  0.0
Valid Loss:  0.20147185027599335
Valid Acc:  0.0
std:  0.0028875528701149443 
thres:  0.00022093965113162994
Preserved_eigens number check:  512
  3%|▎         | 27/1000 [06:37<3:58:48, 14.73s/it]Epoch:   28
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-90.7065, device='cuda:0') 
Std:  tensor(3372.8442, device='cuda:0') 
ABS Max:  tensor(71751.1484, device='cuda:0') 
ABS Min:  tensor(0.0178, device='cuda:0')
Criterion check:  tensor([0.9981, 0.9428, 0.9968, 1.0164, 0.9860, 1.0119, 0.9996, 0.5612, 1.0004,
        1.0270], device='cuda:0') tensor(276, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0007, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(13.2427, device='cuda:0')
min of grad d_p:  tensor(-0.6991, device='cuda:0')
max|min: (J_L, Jta/N)  (13.242691040039062, 13.242762565612793, ratio: 1.0000053644180298)|(-0.6990571022033691, -0.6990646123886108)

 check Jacobi res:  torch.Size([793601]) max:  tensor(7.8678e-06, device='cuda:0') mean:  tensor(1.4881e-09, device='cuda:0') min:  tensor(-7.1526e-05, device='cuda:0') norm:  tensor(0.0002, device='cuda:0') MSE:  tensor(2.1100e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0463, device='cuda:0') mean:  tensor(0.0003, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.4678, device='cuda:0') MSE:  tensor(5.8949e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0040, device='cuda:0')
min of d_p_list:  tensor(-0.0029, device='cuda:0')
Epoch:  28  
Training Loss: 0.2303747683763504
Test Loss:  0.24689480662345886
Test Acc:  0.0
Valid Loss:  0.20612983405590057
Valid Acc:  0.0
std:  0.004411006188744329 
thres:  0.0002232993483543396
Preserved_eigens number check:  512
  3%|▎         | 28/1000 [06:51<3:58:26, 14.72s/it]Epoch:   29
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(1.6367, device='cuda:0') 
Std:  tensor(65.0841, device='cuda:0') 
ABS Max:  tensor(1035.0853, device='cuda:0') 
ABS Min:  tensor(0.0007, device='cuda:0')
Criterion check:  tensor([0.9994, 1.0003, 1.0004, 1.0001, 0.9992, 0.9996, 1.0006, 0.9887, 1.0000,
        0.9994], device='cuda:0') tensor(228, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0003, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(13.1670, device='cuda:0')
min of grad d_p:  tensor(-0.7014, device='cuda:0')
max|min: (J_L, Jta/N)  (13.167047500610352, 13.167065620422363, ratio: 1.0000014305114746)|(-0.7014073133468628, -0.7014083862304688)

 check Jacobi res:  torch.Size([793601]) max:  tensor(9.6299e-06, device='cuda:0') mean:  tensor(-1.6340e-09, device='cuda:0') min:  tensor(-2.0236e-05, device='cuda:0') norm:  tensor(9.6602e-05, device='cuda:0') MSE:  tensor(1.2173e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0016, device='cuda:0') mean:  tensor(3.1540e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0520, device='cuda:0') MSE:  tensor(6.5586e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0025, device='cuda:0')
min of d_p_list:  tensor(-0.0019, device='cuda:0')
Epoch:  29  
Training Loss: 0.2339872121810913
Test Loss:  0.2513228952884674
Test Acc:  0.0
Valid Loss:  0.21024289727210999
Valid Acc:  0.0
std:  0.005621665290374808 
thres:  0.00022615243792533873
Preserved_eigens number check:  512
  3%|▎         | 29/1000 [07:06<3:57:59, 14.71s/it]Epoch:   30
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(4.3754, device='cuda:0') 
Std:  tensor(83.5827, device='cuda:0') 
ABS Max:  tensor(1776.1230, device='cuda:0') 
ABS Min:  tensor(0.0033, device='cuda:0')
Criterion check:  tensor([0.9997, 0.9994, 0.9985, 0.9962, 0.9985, 1.0011, 0.9992, 0.9946, 1.0005,
        1.0021], device='cuda:0') tensor(273, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(4.5313e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(13.0779, device='cuda:0')
min of grad d_p:  tensor(-0.6873, device='cuda:0')
max|min: (J_L, Jta/N)  (13.077930450439453, 13.077958106994629, ratio: 1.000002145767212)|(-0.6872967481613159, -0.6873007416725159)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.4107e-06, device='cuda:0') mean:  tensor(6.9301e-10, device='cuda:0') min:  tensor(-2.7657e-05, device='cuda:0') norm:  tensor(8.3275e-05, device='cuda:0') MSE:  tensor(1.0493e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0171, device='cuda:0') mean:  tensor(3.4291e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0601, device='cuda:0') MSE:  tensor(7.5756e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0045, device='cuda:0')
min of d_p_list:  tensor(-0.0031, device='cuda:0')
Epoch:  30  
Training Loss: 0.23648828268051147
Test Loss:  0.2544541358947754
Test Acc:  0.0
Valid Loss:  0.2130315601825714
Valid Acc:  0.0
std:  0.00525696753316373 
thres:  0.00022978000044822694
Preserved_eigens number check:  512
  3%|▎         | 30/1000 [07:21<3:57:31, 14.69s/it]Epoch:   31
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-3.6063, device='cuda:0') 
Std:  tensor(66.4136, device='cuda:0') 
ABS Max:  tensor(1267.4364, device='cuda:0') 
ABS Min:  tensor(0.0018, device='cuda:0')
Criterion check:  tensor([0.9988, 1.0037, 0.9990, 0.9875, 1.0009, 0.9985, 1.0006, 1.0011, 1.0001,
        0.9998], device='cuda:0') tensor(250, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0003, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(12.8906, device='cuda:0')
min of grad d_p:  tensor(-0.6682, device='cuda:0')
max|min: (J_L, Jta/N)  (12.890633583068848, 12.890643119812012, ratio: 1.0000007152557373)|(-0.6681618690490723, -0.6681624054908752)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.1586e-06, device='cuda:0') mean:  tensor(-1.7376e-09, device='cuda:0') min:  tensor(-9.5367e-06, device='cuda:0') norm:  tensor(9.5418e-05, device='cuda:0') MSE:  tensor(1.2023e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0128, device='cuda:0') mean:  tensor(5.4750e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1075, device='cuda:0') MSE:  tensor(1.3550e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0043, device='cuda:0')
min of d_p_list:  tensor(-0.0102, device='cuda:0')
Epoch:  31  
Training Loss: 0.23870494961738586
Test Loss:  0.2572409510612488
Test Acc:  0.0
Valid Loss:  0.2147604376077652
Valid Acc:  0.0
std:  0.004464434800952821 
thres:  0.00023313744366168976
Preserved_eigens number check:  512
  3%|▎         | 31/1000 [07:36<3:57:26, 14.70s/it]Epoch:   32
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(1.1656, device='cuda:0') 
Std:  tensor(47.5307, device='cuda:0') 
ABS Max:  tensor(951.8118, device='cuda:0') 
ABS Min:  tensor(0.0056, device='cuda:0')
Criterion check:  tensor([0.9992, 0.9977, 1.0010, 0.9922, 0.9992, 1.0003, 0.9996, 1.0017, 0.9998,
        0.9967], device='cuda:0') tensor(253, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0004, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(13.4550, device='cuda:0')
min of grad d_p:  tensor(-0.7044, device='cuda:0')
max|min: (J_L, Jta/N)  (13.454999923706055, 13.45506477355957, ratio: 1.000004768371582)|(-0.7044492959976196, -0.7044532299041748)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.8876e-06, device='cuda:0') mean:  tensor(1.2225e-09, device='cuda:0') min:  tensor(-6.4850e-05, device='cuda:0') norm:  tensor(0.0001, device='cuda:0') MSE:  tensor(1.4436e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0124, device='cuda:0') mean:  tensor(6.1466e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1028, device='cuda:0') MSE:  tensor(1.2949e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0031, device='cuda:0')
min of d_p_list:  tensor(-0.0086, device='cuda:0')
Epoch:  32  
Training Loss: 0.23626141250133514
Test Loss:  0.2551506757736206
Test Acc:  0.0
Valid Loss:  0.2119055688381195
Valid Acc:  0.0
std:  0.002821982630949671 
thres:  0.00023516332507133482
Preserved_eigens number check:  512
  3%|▎         | 32/1000 [07:50<3:57:17, 14.71s/it]Epoch:   33
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(-16.5028, device='cuda:0') 
Std:  tensor(649.1842, device='cuda:0') 
ABS Max:  tensor(13963.6953, device='cuda:0') 
ABS Min:  tensor(0.0084, device='cuda:0')
Criterion check:  tensor([1.0050, 1.0546, 0.9874, 0.8466, 0.9989, 1.0038, 0.9889, 1.0381, 1.0016,
        1.0239], device='cuda:0') tensor(270, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(1.0962e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(13.2481, device='cuda:0')
min of grad d_p:  tensor(-0.6598, device='cuda:0')
max|min: (J_L, Jta/N)  (13.24808120727539, 13.248018264770508, ratio: 0.999995231628418)|(-0.6597920656204224, -0.6597890853881836)

 check Jacobi res:  torch.Size([793601]) max:  tensor(6.2943e-05, device='cuda:0') mean:  tensor(-1.9769e-09, device='cuda:0') min:  tensor(-4.3511e-06, device='cuda:0') norm:  tensor(0.0001, device='cuda:0') MSE:  tensor(1.4801e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0104, device='cuda:0') mean:  tensor(5.7952e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1080, device='cuda:0') MSE:  tensor(1.3607e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0109, device='cuda:0')
min of d_p_list:  tensor(-0.0187, device='cuda:0')
Epoch:  33  
Training Loss: 0.23467451333999634
Test Loss:  0.2544023394584656
Test Acc:  0.0
Valid Loss:  0.21003641188144684
Valid Acc:  0.0
std:  0.0016388428957067418 
thres:  0.00023602327406406403
Preserved_eigens number check:  512
  3%|▎         | 33/1000 [08:05<3:57:25, 14.73s/it]Epoch:   34
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(4.7574, device='cuda:0') 
Std:  tensor(85.0479, device='cuda:0') 
ABS Max:  tensor(1592.9292, device='cuda:0') 
ABS Min:  tensor(0.0045, device='cuda:0')
Criterion check:  tensor([1.0013, 1.0061, 0.9969, 0.9909, 1.0027, 0.9966, 1.0004, 0.9988, 1.0007,
        1.0010], device='cuda:0') tensor(252, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0003, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(12.6991, device='cuda:0')
min of grad d_p:  tensor(-0.6587, device='cuda:0')
max|min: (J_L, Jta/N)  (12.69907283782959, 12.699067115783691, ratio: 0.9999995231628418)|(-0.6587004661560059, -0.6586999893188477)

 check Jacobi res:  torch.Size([793601]) max:  tensor(6.1989e-06, device='cuda:0') mean:  tensor(3.4214e-10, device='cuda:0') min:  tensor(-3.5465e-06, device='cuda:0') norm:  tensor(6.7449e-05, device='cuda:0') MSE:  tensor(8.4991e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0286, device='cuda:0') mean:  tensor(8.4695e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1634, device='cuda:0') MSE:  tensor(2.0588e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0074, device='cuda:0')
min of d_p_list:  tensor(-0.0070, device='cuda:0')
Epoch:  34  
Training Loss: 0.229407399892807
Test Loss:  0.24884577095508575
Test Acc:  0.0
Valid Loss:  0.20407843589782715
Valid Acc:  0.0
std:  0.0031259666384486464 
thres:  0.00023510731160640718
Preserved_eigens number check:  512
  3%|▎         | 34/1000 [08:20<3:57:23, 14.74s/it]Epoch:   35
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-3.1603, device='cuda:0') 
Std:  tensor(109.4415, device='cuda:0') 
ABS Max:  tensor(2361.9399, device='cuda:0') 
ABS Min:  tensor(0.0001, device='cuda:0')
Criterion check:  tensor([0.9997, 1.0051, 0.9981, 0.9694, 0.9976, 1.0004, 1.0011, 0.9176, 0.9997,
        1.0007], device='cuda:0') tensor(246, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0009, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(12.1364, device='cuda:0')
min of grad d_p:  tensor(-0.5611, device='cuda:0')
max|min: (J_L, Jta/N)  (12.136407852172852, 12.136354446411133, ratio: 0.9999955892562866)|(-0.561132550239563, -0.5611279606819153)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.3406e-05, device='cuda:0') mean:  tensor(-2.3452e-09, device='cuda:0') min:  tensor(-2.5898e-05, device='cuda:0') norm:  tensor(0.0001, device='cuda:0') MSE:  tensor(1.6237e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0125, device='cuda:0') mean:  tensor(3.7693e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0640, device='cuda:0') MSE:  tensor(8.0666e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1432, device='cuda:0')
min of d_p_list:  tensor(-0.0586, device='cuda:0')
Epoch:  35  
Training Loss: 0.27900075912475586
Test Loss:  0.3000777065753937
Test Acc:  0.0
Valid Loss:  0.24937237799167633
Valid Acc:  0.0
std:  0.017956190355292525 
thres:  0.00024360980689525606
Preserved_eigens number check:  512
  4%|▎         | 35/1000 [08:35<3:57:02, 14.74s/it]Epoch:   36
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(1.2781, device='cuda:0') 
Std:  tensor(64.4067, device='cuda:0') 
ABS Max:  tensor(1062.0383, device='cuda:0') 
ABS Min:  tensor(0.0029, device='cuda:0')
Criterion check:  tensor([1.0029, 0.9986, 0.9972, 0.9863, 1.0015, 0.9989, 1.0012, 0.9993, 1.0000,
        1.0003], device='cuda:0') tensor(261, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0006, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(8.5957, device='cuda:0')
min of grad d_p:  tensor(-0.5910, device='cuda:0')
max|min: (J_L, Jta/N)  (8.59568977355957, 8.595314025878906, ratio: 0.9999563097953796)|(-0.5910013914108276, -0.5909671783447266)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(-6.5215e-08, device='cuda:0') min:  tensor(-0.0014, device='cuda:0') norm:  tensor(0.0098, device='cuda:0') MSE:  tensor(1.2295e-08, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0392, device='cuda:0') mean:  tensor(5.3558e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1385, device='cuda:0') MSE:  tensor(1.7447e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0205, device='cuda:0')
min of d_p_list:  tensor(-0.0092, device='cuda:0')
Epoch:  36  
Training Loss: 0.26080232858657837
Test Loss:  0.27865517139434814
Test Acc:  0.0
Valid Loss:  0.23106905817985535
Valid Acc:  0.0
std:  0.018899683627543566 
thres:  0.00024802928268909455
Preserved_eigens number check:  512
  4%|▎         | 36/1000 [08:49<3:56:35, 14.73s/it]Epoch:   37
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(0.2634, device='cuda:0') 
Std:  tensor(16.6389, device='cuda:0') 
ABS Max:  tensor(227.8070, device='cuda:0') 
ABS Min:  tensor(0.0005, device='cuda:0')
Criterion check:  tensor([1.0002, 1.0007, 1.0015, 0.9998, 1.0024, 1.0005, 1.0006, 1.0002, 1.0002,
        0.9997], device='cuda:0') tensor(231, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0010, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(11.3714, device='cuda:0')
min of grad d_p:  tensor(-0.5926, device='cuda:0')
max|min: (J_L, Jta/N)  (11.37138557434082, 11.371356964111328, ratio: 0.9999974966049194)|(-0.5926262140274048, -0.5926259160041809)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.8610e-05, device='cuda:0') mean:  tensor(1.1003e-09, device='cuda:0') min:  tensor(-4.1127e-06, device='cuda:0') norm:  tensor(0.0001, device='cuda:0') MSE:  tensor(1.3011e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0114, device='cuda:0') mean:  tensor(4.6079e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0805, device='cuda:0') MSE:  tensor(1.0145e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0051, device='cuda:0')
min of d_p_list:  tensor(-0.0118, device='cuda:0')
Epoch:  37  
Training Loss: 0.24827052652835846
Test Loss:  0.2664840519428253
Test Acc:  0.0
Valid Loss:  0.21905329823493958
Valid Acc:  0.0
std:  0.01799289788776343 
thres:  0.0002504311054944992
Preserved_eigens number check:  512
  4%|▎         | 37/1000 [09:04<3:56:13, 14.72s/it]Epoch:   38
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(1.0700, device='cuda:0') 
Std:  tensor(206.9226, device='cuda:0') 
ABS Max:  tensor(2308.9617, device='cuda:0') 
ABS Min:  tensor(0.0082, device='cuda:0')
Criterion check:  tensor([0.9933, 1.0435, 1.0813, 0.9816, 0.9807, 0.9966, 0.9027, 0.9987, 1.1671,
        0.9957], device='cuda:0') tensor(265, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(2.5636e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(11.1100, device='cuda:0')
min of grad d_p:  tensor(-0.5815, device='cuda:0')
max|min: (J_L, Jta/N)  (11.110010147094727, 11.1100492477417, ratio: 1.0000035762786865)|(-0.5814752578735352, -0.5814791917800903)

 check Jacobi res:  torch.Size([793601]) max:  tensor(9.8348e-06, device='cuda:0') mean:  tensor(-3.3790e-10, device='cuda:0') min:  tensor(-4.4823e-05, device='cuda:0') norm:  tensor(0.0002, device='cuda:0') MSE:  tensor(2.9363e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0500, device='cuda:0') mean:  tensor(0.0003, device='cuda:0') min:  tensor(1.6676e-13, device='cuda:0') norm:  tensor(0.5904, device='cuda:0') MSE:  tensor(7.4392e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0231, device='cuda:0')
min of d_p_list:  tensor(-0.0285, device='cuda:0')
Epoch:  38  
Training Loss: 0.23510360717773438
Test Loss:  0.25065770745277405
Test Acc:  0.0
Valid Loss:  0.20802661776542664
Valid Acc:  0.0
std:  0.017918409840274215 
thres:  0.00025051692426204683
Preserved_eigens number check:  512
  4%|▍         | 38/1000 [09:19<3:55:45, 14.70s/it]Epoch:   39
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-21.4277, device='cuda:0') 
Std:  tensor(842.9266, device='cuda:0') 
ABS Max:  tensor(17382., device='cuda:0') 
ABS Min:  tensor(0.1465, device='cuda:0')
Criterion check:  tensor([0.9981, 1.1199, 1.0361, 0.9923, 1.0124, 0.9751, 0.9235, 0.9964, 1.0314,
        0.9393], device='cuda:0') tensor(278, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0001, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(12.3731, device='cuda:0')
min of grad d_p:  tensor(-0.5100, device='cuda:0')
max|min: (J_L, Jta/N)  (12.373055458068848, 12.374275207519531, ratio: 1.0000985860824585)|(-0.5099601149559021, -0.510001540184021)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0021, device='cuda:0') mean:  tensor(2.9457e-08, device='cuda:0') min:  tensor(-0.0012, device='cuda:0') norm:  tensor(0.0042, device='cuda:0') MSE:  tensor(5.2348e-09, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.7844, device='cuda:0') mean:  tensor(0.0031, device='cuda:0') min:  tensor(2.2022e-13, device='cuda:0') norm:  tensor(5.0960, device='cuda:0') MSE:  tensor(6.4214e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0080, device='cuda:0')
min of d_p_list:  tensor(-0.0142, device='cuda:0')
Epoch:  39  
Training Loss: 0.22416697442531586
Test Loss:  0.23937761783599854
Test Acc:  0.0
Valid Loss:  0.19806572794914246
Valid Acc:  0.0
std:  0.019227909306561757 
thres:  0.0002494688391685486
Preserved_eigens number check:  512
  4%|▍         | 39/1000 [09:33<3:55:54, 14.73s/it]Epoch:   40
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.3672, device='cuda:0') 
Std:  tensor(10.7376, device='cuda:0') 
ABS Max:  tensor(174.1923, device='cuda:0') 
ABS Min:  tensor(0.0014, device='cuda:0')
Criterion check:  tensor([0.9989, 1.0011, 1.0004, 0.9999, 1.0006, 1.0002, 0.9984, 1.0000, 0.9977,
        1.0004], device='cuda:0') tensor(216, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0002, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(10.9418, device='cuda:0')
min of grad d_p:  tensor(-0.5612, device='cuda:0')
max|min: (J_L, Jta/N)  (10.94180679321289, 10.941720008850098, ratio: 0.9999920725822449)|(-0.5612247586250305, -0.5612249970436096)

 check Jacobi res:  torch.Size([793601]) max:  tensor(9.3937e-05, device='cuda:0') mean:  tensor(1.0849e-09, device='cuda:0') min:  tensor(-9.2685e-06, device='cuda:0') norm:  tensor(0.0003, device='cuda:0') MSE:  tensor(3.1533e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0475, device='cuda:0') mean:  tensor(3.8375e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1322, device='cuda:0') MSE:  tensor(1.6657e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1291, device='cuda:0')
min of d_p_list:  tensor(-0.1020, device='cuda:0')
Epoch:  40  
Training Loss: 0.2382509708404541
Test Loss:  0.2566666007041931
Test Acc:  0.0
Valid Loss:  0.20483314990997314
Valid Acc:  0.0
std:  0.01241096052681153 
thres:  0.00024131888151168824
Preserved_eigens number check:  512
  4%|▍         | 40/1000 [09:48<3:56:18, 14.77s/it]Epoch:   41
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(2.9100, device='cuda:0') 
Std:  tensor(142.7503, device='cuda:0') 
ABS Max:  tensor(2361.2881, device='cuda:0') 
ABS Min:  tensor(0.0039, device='cuda:0')
Criterion check:  tensor([0.9987, 0.9974, 1.0012, 1.0656, 1.0088, 0.9975, 1.0000, 0.9709, 0.9963,
        1.0013], device='cuda:0') tensor(262, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0020, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(6.6924, device='cuda:0')
min of grad d_p:  tensor(-2.6700, device='cuda:0')
max|min: (J_L, Jta/N)  (6.692363262176514, 6.692307949066162, ratio: 0.9999917149543762)|(-2.669957160949707, -2.669983148574829)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.5313e-05, device='cuda:0') mean:  tensor(-2.7440e-09, device='cuda:0') min:  tensor(-1.5721e-05, device='cuda:0') norm:  tensor(0.0003, device='cuda:0') MSE:  tensor(3.2110e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0804, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(2.8466e-13, device='cuda:0') norm:  tensor(0.3425, device='cuda:0') MSE:  tensor(4.3162e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0123, device='cuda:0')
min of d_p_list:  tensor(-0.0307, device='cuda:0')
Epoch:  41  
Training Loss: 0.23075519502162933
Test Loss:  0.24772964417934418
Test Acc:  0.0
Valid Loss:  0.1957252472639084
Valid Acc:  0.0
std:  0.00801973093359871 
thres:  0.0002353094547986984
Preserved_eigens number check:  512
  4%|▍         | 41/1000 [10:03<3:57:41, 14.87s/it]Epoch:   42
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(6.4315, device='cuda:0') 
Std:  tensor(202.5321, device='cuda:0') 
ABS Max:  tensor(2678.4966, device='cuda:0') 
ABS Min:  tensor(0.0075, device='cuda:0')
Criterion check:  tensor([0.8501, 0.9932, 1.0554, 0.9346, 1.0505, 0.9599, 1.0222, 0.5463, 0.9778,
        1.0133], device='cuda:0') tensor(267, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0040, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(7.1228, device='cuda:0')
min of grad d_p:  tensor(-2.7222, device='cuda:0')
max|min: (J_L, Jta/N)  (7.122785568237305, 7.122779846191406, ratio: 0.9999992251396179)|(-2.7222278118133545, -2.7222020626068115)

 check Jacobi res:  torch.Size([793601]) max:  tensor(9.0187e-06, device='cuda:0') mean:  tensor(-1.9923e-09, device='cuda:0') min:  tensor(-2.5749e-05, device='cuda:0') norm:  tensor(0.0002, device='cuda:0') MSE:  tensor(2.2747e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(1.2977, device='cuda:0') mean:  tensor(0.0015, device='cuda:0') min:  tensor(6.3394e-14, device='cuda:0') norm:  tensor(4.2048, device='cuda:0') MSE:  tensor(5.2984e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0219, device='cuda:0')
min of d_p_list:  tensor(-0.0084, device='cuda:0')
Epoch:  42  
Training Loss: 0.23951373994350433
Test Loss:  0.25695401430130005
Test Acc:  0.0
Valid Loss:  0.20665176212787628
Valid Acc:  0.0
std:  0.005584456861244558 
thres:  0.0002335580974817276
Preserved_eigens number check:  512
  4%|▍         | 42/1000 [10:18<3:57:17, 14.86s/it]Epoch:   43
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(0.0185, device='cuda:0') 
Std:  tensor(37.2868, device='cuda:0') 
ABS Max:  tensor(630.7731, device='cuda:0') 
ABS Min:  tensor(0.0005, device='cuda:0')
Criterion check:  tensor([0.9907, 0.9993, 0.9961, 1.0010, 0.8588, 0.9980, 1.0008, 1.0004, 0.9909,
        0.9979], device='cuda:0') tensor(217, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0027, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(6.7391, device='cuda:0')
min of grad d_p:  tensor(-3.1939, device='cuda:0')
max|min: (J_L, Jta/N)  (6.739139556884766, 6.739169120788574, ratio: 1.0000044107437134)|(-3.1939339637756348, -3.1939191818237305)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.8908e-06, device='cuda:0') mean:  tensor(-3.1590e-09, device='cuda:0') min:  tensor(-2.9564e-05, device='cuda:0') norm:  tensor(0.0002, device='cuda:0') MSE:  tensor(2.0956e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0588, device='cuda:0') mean:  tensor(9.0976e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.2371, device='cuda:0') MSE:  tensor(2.9871e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0121, device='cuda:0')
min of d_p_list:  tensor(-0.0042, device='cuda:0')
Epoch:  43  
Training Loss: 0.24045616388320923
Test Loss:  0.256815105676651
Test Acc:  0.0
Valid Loss:  0.20776988565921783
Valid Acc:  0.0
std:  0.006251328488845249 
thres:  0.00023462860882282258
Preserved_eigens number check:  512
  4%|▍         | 43/1000 [10:33<3:56:29, 14.83s/it]Epoch:   44
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-1.7680, device='cuda:0') 
Std:  tensor(51.7405, device='cuda:0') 
ABS Max:  tensor(1095.6957, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([1.0002, 0.9988, 1.0082, 1.0039, 0.9511, 1.0007, 1.0016, 1.0002, 0.9981,
        1.0010], device='cuda:0') tensor(232, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0016, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(6.7484, device='cuda:0')
min of grad d_p:  tensor(-3.3058, device='cuda:0')
max|min: (J_L, Jta/N)  (6.74843692779541, 6.748469352722168, ratio: 1.000004768371582)|(-3.3058221340179443, -3.3058102130889893)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.7865e-05, device='cuda:0') mean:  tensor(1.1332e-08, device='cuda:0') min:  tensor(-3.2425e-05, device='cuda:0') norm:  tensor(0.0005, device='cuda:0') MSE:  tensor(5.8141e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0335, device='cuda:0') mean:  tensor(6.3772e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1484, device='cuda:0') MSE:  tensor(1.8696e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0175, device='cuda:0')
min of d_p_list:  tensor(-0.0058, device='cuda:0')
Epoch:  44  
Training Loss: 0.23827922344207764
Test Loss:  0.2540433406829834
Test Acc:  0.0
Valid Loss:  0.20696738362312317
Valid Acc:  0.0
std:  0.0034480608389715357 
thres:  0.00023745105862617495
Preserved_eigens number check:  512
  4%|▍         | 44/1000 [10:48<3:55:27, 14.78s/it]Epoch:   45
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(71.3422, device='cuda:0') 
Std:  tensor(7616.7056, device='cuda:0') 
ABS Max:  tensor(131751.9688, device='cuda:0') 
ABS Min:  tensor(0.0025, device='cuda:0')
Criterion check:  tensor([ 1.8892e+00,  1.1100e+00,  9.1893e-01,  1.0348e+00,  2.5203e-03,
         1.2992e+00,  7.6011e-01, -3.0075e+00,  9.8064e-01,  1.4401e+00],
       device='cuda:0') tensor(267, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0024, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(6.9496, device='cuda:0')
min of grad d_p:  tensor(-4.0361, device='cuda:0')
max|min: (J_L, Jta/N)  (6.949643611907959, 6.930944919586182, ratio: 0.9973093867301941)|(-4.036133766174316, -4.034968376159668)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0187, device='cuda:0') mean:  tensor(-1.5833e-06, device='cuda:0') min:  tensor(-0.0087, device='cuda:0') norm:  tensor(0.1416, device='cuda:0') MSE:  tensor(1.7848e-07, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(2.1034, device='cuda:0') mean:  tensor(0.0031, device='cuda:0') min:  tensor(1.5266e-15, device='cuda:0') norm:  tensor(8.9157, device='cuda:0') MSE:  tensor(1.1234e-05, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0124, device='cuda:0')
min of d_p_list:  tensor(-0.0895, device='cuda:0')
Epoch:  45  
Training Loss: 0.2268192619085312
Test Loss:  0.23850490152835846
Test Acc:  0.0
Valid Loss:  0.1940315067768097
Valid Acc:  0.0
std:  0.005398223148780558 
thres:  0.00023516471683979035
Preserved_eigens number check:  512
  4%|▍         | 45/1000 [11:02<3:55:33, 14.80s/it]Epoch:   46
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(9.8207, device='cuda:0') 
Std:  tensor(212.3526, device='cuda:0') 
ABS Max:  tensor(4554.5757, device='cuda:0') 
ABS Min:  tensor(0.0057, device='cuda:0')
Criterion check:  tensor([0.9983, 1.0004, 1.0128, 1.0039, 1.0017, 1.0072, 0.9943, 0.9990, 1.0001,
        0.9956], device='cuda:0') tensor(257, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0008, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(11.2506, device='cuda:0')
min of grad d_p:  tensor(-1.8871, device='cuda:0')
max|min: (J_L, Jta/N)  (11.250648498535156, 11.250641822814941, ratio: 0.9999994039535522)|(-1.8871192932128906, -1.8871004581451416)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.4050e-05, device='cuda:0') mean:  tensor(-5.1678e-10, device='cuda:0') min:  tensor(-1.8835e-05, device='cuda:0') norm:  tensor(0.0001, device='cuda:0') MSE:  tensor(1.5372e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0325, device='cuda:0') mean:  tensor(0.0002, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.2878, device='cuda:0') MSE:  tensor(3.6269e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0040, device='cuda:0')
min of d_p_list:  tensor(-0.0096, device='cuda:0')
Epoch:  46  
Training Loss: 0.22627203166484833
Test Loss:  0.23758941888809204
Test Acc:  0.0
Valid Loss:  0.19342811405658722
Valid Acc:  0.0
std:  0.00634539647365285 
thres:  0.00023426808416843415
Preserved_eigens number check:  512
  5%|▍         | 46/1000 [11:17<3:55:00, 14.78s/it]Epoch:   47
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-6.8463, device='cuda:0') 
Std:  tensor(213.2789, device='cuda:0') 
ABS Max:  tensor(4141.1714, device='cuda:0') 
ABS Min:  tensor(0.0364, device='cuda:0')
Criterion check:  tensor([0.9846, 1.0002, 0.9838, 1.0299, 1.0077, 1.0040, 0.9936, 1.0131, 0.9988,
        1.0359], device='cuda:0') tensor(254, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0015, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(11.4612, device='cuda:0')
min of grad d_p:  tensor(-1.4698, device='cuda:0')
max|min: (J_L, Jta/N)  (11.461231231689453, 11.461247444152832, ratio: 1.0000014305114746)|(-1.4697515964508057, -1.4697086811065674)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.1127e-06, device='cuda:0') mean:  tensor(-8.1826e-09, device='cuda:0') min:  tensor(-4.2915e-05, device='cuda:0') norm:  tensor(0.0003, device='cuda:0') MSE:  tensor(4.3614e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0150, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.2133, device='cuda:0') MSE:  tensor(2.6883e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0153, device='cuda:0')
min of d_p_list:  tensor(-0.0058, device='cuda:0')
Epoch:  47  
Training Loss: 0.22752779722213745
Test Loss:  0.23959729075431824
Test Acc:  0.0
Valid Loss:  0.1961355209350586
Valid Acc:  0.0
std:  0.006172556699831001 
thres:  0.0002318708956241608
Preserved_eigens number check:  512
  5%|▍         | 47/1000 [11:32<3:54:24, 14.76s/it]Epoch:   48
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-14.5202, device='cuda:0') 
Std:  tensor(706.1229, device='cuda:0') 
ABS Max:  tensor(10636.8389, device='cuda:0') 
ABS Min:  tensor(0.0089, device='cuda:0')
Criterion check:  tensor([0.9929, 0.9984, 1.0175, 1.0485, 0.9946, 0.9960, 1.0196, 0.9992, 0.9908,
        0.9702], device='cuda:0') tensor(239, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0012, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(11.5746, device='cuda:0')
min of grad d_p:  tensor(-1.6536, device='cuda:0')
max|min: (J_L, Jta/N)  (11.57455062866211, 11.574569702148438, ratio: 1.0000016689300537)|(-1.6535749435424805, -1.6535564661026)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.1130e-05, device='cuda:0') mean:  tensor(5.6683e-09, device='cuda:0') min:  tensor(-1.9073e-05, device='cuda:0') norm:  tensor(0.0002, device='cuda:0') MSE:  tensor(2.4877e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0609, device='cuda:0') mean:  tensor(0.0005, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.7813, device='cuda:0') MSE:  tensor(9.8449e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0062, device='cuda:0')
min of d_p_list:  tensor(-0.0098, device='cuda:0')
Epoch:  48  
Training Loss: 0.22613728046417236
Test Loss:  0.23800653219223022
Test Acc:  0.0
Valid Loss:  0.19548854231834412
Valid Acc:  0.0
std:  0.0046618388713590905 
thres:  0.0002290071189403534
Preserved_eigens number check:  512
  5%|▍         | 48/1000 [11:47<3:54:03, 14.75s/it]Epoch:   49
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(0.0255, device='cuda:0') 
Std:  tensor(30.5173, device='cuda:0') 
ABS Max:  tensor(390.2679, device='cuda:0') 
ABS Min:  tensor(0.0032, device='cuda:0')
Criterion check:  tensor([0.9960, 0.9996, 1.0256, 0.9998, 1.0014, 0.9982, 0.9880, 1.0008, 1.0006,
        1.0065], device='cuda:0') tensor(229, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0019, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(11.2351, device='cuda:0')
min of grad d_p:  tensor(-1.7430, device='cuda:0')
max|min: (J_L, Jta/N)  (11.235074043273926, 11.235172271728516, ratio: 1.0000087022781372)|(-1.7429596185684204, -1.74297034740448)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.2233e-05, device='cuda:0') mean:  tensor(7.1067e-09, device='cuda:0') min:  tensor(-9.8228e-05, device='cuda:0') norm:  tensor(0.0003, device='cuda:0') MSE:  tensor(3.9984e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0255, device='cuda:0') mean:  tensor(3.9245e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1073, device='cuda:0') MSE:  tensor(1.3514e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0054, device='cuda:0')
min of d_p_list:  tensor(-0.0038, device='cuda:0')
Epoch:  49  
Training Loss: 0.22579006850719452
Test Loss:  0.23812198638916016
Test Acc:  0.0
Valid Loss:  0.19540223479270935
Valid Acc:  0.0
std:  0.0006075198290858749 
thres:  0.00022650928795337678
Preserved_eigens number check:  512
  5%|▍         | 49/1000 [12:01<3:53:44, 14.75s/it]Epoch:   50
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(1.5553, device='cuda:0') 
Std:  tensor(74.3888, device='cuda:0') 
ABS Max:  tensor(1472.4197, device='cuda:0') 
ABS Min:  tensor(0.0067, device='cuda:0')
Criterion check:  tensor([1.0027, 0.9987, 0.9476, 0.9850, 0.9972, 1.0027, 1.0026, 0.9944, 1.0020,
        0.9968], device='cuda:0') tensor(264, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0005, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(11.8153, device='cuda:0')
min of grad d_p:  tensor(-1.5489, device='cuda:0')
max|min: (J_L, Jta/N)  (11.815278053283691, 11.815285682678223, ratio: 1.0000005960464478)|(-1.548871636390686, -1.5488847494125366)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.3113e-05, device='cuda:0') mean:  tensor(3.3235e-09, device='cuda:0') min:  tensor(-7.6294e-06, device='cuda:0') norm:  tensor(0.0001, device='cuda:0') MSE:  tensor(1.4498e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0464, device='cuda:0') mean:  tensor(4.6716e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1123, device='cuda:0') MSE:  tensor(1.4146e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0047, device='cuda:0')
min of d_p_list:  tensor(-0.0097, device='cuda:0')
Epoch:  50  
Training Loss: 0.2225094437599182
Test Loss:  0.23420968651771545
Test Acc:  0.0
Valid Loss:  0.19185137748718262
Valid Acc:  0.0
std:  0.0016753008647947363 
thres:  0.00022564732432365419
Preserved_eigens number check:  512
  5%|▌         | 50/1000 [12:16<3:53:23, 14.74s/it]Epoch:   51
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(0.1672, device='cuda:0') 
Std:  tensor(24.8767, device='cuda:0') 
ABS Max:  tensor(322.1911, device='cuda:0') 
ABS Min:  tensor(0.0058, device='cuda:0')
Criterion check:  tensor([1.0007, 0.9990, 0.9933, 1.0013, 0.9990, 1.0016, 1.0049, 1.0007, 0.9995,
        0.9889], device='cuda:0') tensor(249, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0001, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(11.7955, device='cuda:0')
min of grad d_p:  tensor(-1.2601, device='cuda:0')
max|min: (J_L, Jta/N)  (11.795476913452148, 11.795517921447754, ratio: 1.000003457069397)|(-1.260124921798706, -1.2601174116134644)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.0068e-06, device='cuda:0') mean:  tensor(-2.6064e-09, device='cuda:0') min:  tensor(-4.1008e-05, device='cuda:0') norm:  tensor(0.0001, device='cuda:0') MSE:  tensor(1.6511e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0423, device='cuda:0') mean:  tensor(6.6094e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1542, device='cuda:0') MSE:  tensor(1.9428e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0054, device='cuda:0')
min of d_p_list:  tensor(-0.0077, device='cuda:0')
Epoch:  51  
Training Loss: 0.21881677210330963
Test Loss:  0.23001351952552795
Test Acc:  0.0
Valid Loss:  0.18883520364761353
Valid Acc:  0.0
std:  0.0031363408706529027 
thres:  0.00022415627241134645
Preserved_eigens number check:  512
  5%|▌         | 51/1000 [12:31<3:53:03, 14.73s/it]Epoch:   52
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(0.0539, device='cuda:0') 
Std:  tensor(57.3014, device='cuda:0') 
ABS Max:  tensor(779.3724, device='cuda:0') 
ABS Min:  tensor(0.0312, device='cuda:0')
Criterion check:  tensor([1.0065, 1.0014, 1.0257, 0.9719, 1.0047, 0.9983, 1.0039, 0.9952, 1.0009,
        1.0025], device='cuda:0') tensor(247, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0007, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(12.4512, device='cuda:0')
min of grad d_p:  tensor(-1.1797, device='cuda:0')
max|min: (J_L, Jta/N)  (12.451196670532227, 12.451213836669922, ratio: 1.0000014305114746)|(-1.1797294616699219, -1.1797345876693726)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.0027e-05, device='cuda:0') mean:  tensor(9.5331e-09, device='cuda:0') min:  tensor(-1.7166e-05, device='cuda:0') norm:  tensor(0.0003, device='cuda:0') MSE:  tensor(3.8852e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.2470, device='cuda:0') mean:  tensor(0.0003, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.6734, device='cuda:0') MSE:  tensor(8.4857e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0131, device='cuda:0')
min of d_p_list:  tensor(-0.0113, device='cuda:0')
Epoch:  52  
Training Loss: 0.21579888463020325
Test Loss:  0.22685880959033966
Test Acc:  0.0
Valid Loss:  0.18726950883865356
Valid Acc:  0.0
std:  0.004003709358617695 
thres:  0.0002218104898929596
Preserved_eigens number check:  512
  5%|▌         | 52/1000 [12:46<3:52:41, 14.73s/it]Epoch:   53
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-8.6932, device='cuda:0') 
Std:  tensor(180.6728, device='cuda:0') 
ABS Max:  tensor(4070.8984, device='cuda:0') 
ABS Min:  tensor(0.0014, device='cuda:0')
Criterion check:  tensor([0.9982, 0.9987, 0.9976, 0.9900, 1.0000, 1.0005, 0.9987, 0.9992, 1.0028,
        1.0184], device='cuda:0') tensor(226, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0006, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(13.4894, device='cuda:0')
min of grad d_p:  tensor(-1.1235, device='cuda:0')
max|min: (J_L, Jta/N)  (13.489431381225586, 13.489483833312988, ratio: 1.0000039339065552)|(-1.1235382556915283, -1.1235368251800537)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.1875e-05, device='cuda:0') mean:  tensor(1.8973e-09, device='cuda:0') min:  tensor(-5.2452e-05, device='cuda:0') norm:  tensor(0.0002, device='cuda:0') MSE:  tensor(2.5648e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0086, device='cuda:0') mean:  tensor(6.8273e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1124, device='cuda:0') MSE:  tensor(1.4169e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0148, device='cuda:0')
min of d_p_list:  tensor(-0.0175, device='cuda:0')
Epoch:  53  
Training Loss: 0.21634550392627716
Test Loss:  0.22690598666667938
Test Acc:  0.0
Valid Loss:  0.18661344051361084
Valid Acc:  0.0
std:  0.003797831501178002 
thres:  0.00021985213458538055
Preserved_eigens number check:  512
  5%|▌         | 53/1000 [13:00<3:52:59, 14.76s/it]Epoch:   54
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-5.4336, device='cuda:0') 
Std:  tensor(90.0954, device='cuda:0') 
ABS Max:  tensor(1808.3105, device='cuda:0') 
ABS Min:  tensor(0.0070, device='cuda:0')
Criterion check:  tensor([0.9950, 1.0037, 0.9947, 1.0221, 1.0138, 0.9957, 0.9862, 1.0015, 0.9986,
        0.8081], device='cuda:0') tensor(234, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0009, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(12.6315, device='cuda:0')
min of grad d_p:  tensor(-1.0987, device='cuda:0')
max|min: (J_L, Jta/N)  (12.631454467773438, 12.631421089172363, ratio: 0.9999973773956299)|(-1.098650336265564, -1.0986449718475342)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.3379e-05, device='cuda:0') mean:  tensor(-5.2253e-09, device='cuda:0') min:  tensor(-1.0967e-05, device='cuda:0') norm:  tensor(0.0002, device='cuda:0') MSE:  tensor(2.3902e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0281, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.2102, device='cuda:0') MSE:  tensor(2.6490e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0059, device='cuda:0')
min of d_p_list:  tensor(-0.0040, device='cuda:0')
Epoch:  54  
Training Loss: 0.2134498655796051
Test Loss:  0.2239099144935608
Test Acc:  0.0
Valid Loss:  0.18388530611991882
Valid Acc:  0.0
std:  0.0030786843963084795 
thres:  0.00021738409399986268
Preserved_eigens number check:  512
  5%|▌         | 54/1000 [13:15<3:52:26, 14.74s/it]Epoch:   55
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(1.3135, device='cuda:0') 
Std:  tensor(70.7538, device='cuda:0') 
ABS Max:  tensor(1039.3304, device='cuda:0') 
ABS Min:  tensor(0.0047, device='cuda:0')
Criterion check:  tensor([1.0102, 1.0024, 0.9898, 0.8236, 0.9851, 0.9975, 1.0005, 1.0041, 0.9947,
        1.6277], device='cuda:0') tensor(269, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0012, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(12.7078, device='cuda:0')
min of grad d_p:  tensor(-1.0743, device='cuda:0')
max|min: (J_L, Jta/N)  (12.707804679870605, 12.707828521728516, ratio: 1.0000019073486328)|(-1.0743350982666016, -1.0743346214294434)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.2322e-05, device='cuda:0') mean:  tensor(1.4341e-09, device='cuda:0') min:  tensor(-2.3842e-05, device='cuda:0') norm:  tensor(7.5618e-05, device='cuda:0') MSE:  tensor(9.5284e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.3528, device='cuda:0') mean:  tensor(0.0006, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(1.2314, device='cuda:0') MSE:  tensor(1.5517e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0197, device='cuda:0')
min of d_p_list:  tensor(-0.0048, device='cuda:0')
Epoch:  55  
Training Loss: 0.21250462532043457
Test Loss:  0.22369208931922913
Test Acc:  0.0
Valid Loss:  0.18430081009864807
Valid Acc:  0.0
std:  0.0022321386197805258 
thres:  0.00021538313031196592
Preserved_eigens number check:  512
  6%|▌         | 55/1000 [13:30<3:52:06, 14.74s/it]Epoch:   56
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(9.8793, device='cuda:0') 
Std:  tensor(294.6530, device='cuda:0') 
ABS Max:  tensor(6552.6777, device='cuda:0') 
ABS Min:  tensor(0.0008, device='cuda:0')
Criterion check:  tensor([1.0018, 0.9989, 1.0040, 1.0076, 0.9982, 0.9975, 1.0030, 1.0012, 0.9986,
        1.0077], device='cuda:0') tensor(219, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0002, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(12.1934, device='cuda:0')
min of grad d_p:  tensor(-1.1450, device='cuda:0')
max|min: (J_L, Jta/N)  (12.193426132202148, 12.19334602355957, ratio: 0.9999934434890747)|(-1.1450213193893433, -1.1451021432876587)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.0824e-05, device='cuda:0') mean:  tensor(5.2248e-10, device='cuda:0') min:  tensor(-1.2252e-05, device='cuda:0') norm:  tensor(0.0002, device='cuda:0') MSE:  tensor(2.7201e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0235, device='cuda:0') mean:  tensor(5.5957e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1003, device='cuda:0') MSE:  tensor(1.2638e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0042, device='cuda:0')
min of d_p_list:  tensor(-0.0030, device='cuda:0')
Epoch:  56  
Training Loss: 0.2103084921836853
Test Loss:  0.22174063324928284
Test Acc:  0.0
Valid Loss:  0.18282032012939453
Valid Acc:  0.0
std:  0.0022088958704827976 
thres:  0.00021368147432804108
Preserved_eigens number check:  512
  6%|▌         | 56/1000 [13:45<3:52:03, 14.75s/it]Epoch:   57
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(1.7613, device='cuda:0') 
Std:  tensor(27.9112, device='cuda:0') 
ABS Max:  tensor(375.8068, device='cuda:0') 
ABS Min:  tensor(0.0067, device='cuda:0')
Criterion check:  tensor([0.9957, 0.9968, 0.9892, 1.0282, 0.9943, 1.0004, 0.9953, 1.0046, 0.9976,
        0.9979], device='cuda:0') tensor(240, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0017, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(11.9697, device='cuda:0')
min of grad d_p:  tensor(-1.4045, device='cuda:0')
max|min: (J_L, Jta/N)  (11.969736099243164, 11.96973705291748, ratio: 1.0000001192092896)|(-1.4044855833053589, -1.404484510421753)

 check Jacobi res:  torch.Size([793601]) max:  tensor(7.5102e-06, device='cuda:0') mean:  tensor(3.6390e-09, device='cuda:0') min:  tensor(-2.5667e-06, device='cuda:0') norm:  tensor(0.0001, device='cuda:0') MSE:  tensor(1.4693e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0396, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.2317, device='cuda:0') MSE:  tensor(2.9194e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0587, device='cuda:0')
min of d_p_list:  tensor(-0.0395, device='cuda:0')
Epoch:  57  
Training Loss: 0.2224215269088745
Test Loss:  0.2300611138343811
Test Acc:  0.0
Valid Loss:  0.19469159841537476
Valid Acc:  0.0
std:  0.0041840009419444844 
thres:  0.00021500600278377533
Preserved_eigens number check:  512
  6%|▌         | 57/1000 [13:59<3:51:51, 14.75s/it]Epoch:   58
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(0.6750, device='cuda:0') 
Std:  tensor(42.0226, device='cuda:0') 
ABS Max:  tensor(513.6365, device='cuda:0') 
ABS Min:  tensor(0.0015, device='cuda:0')
Criterion check:  tensor([ 0.9452,  1.0017,  0.9959,  1.0010,  1.0008, -1.3535,  0.9973,  1.0024,
         0.9991,  0.9983], device='cuda:0') tensor(281, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0004, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(7.0279, device='cuda:0')
min of grad d_p:  tensor(-4.2351, device='cuda:0')
max|min: (J_L, Jta/N)  (7.027861595153809, 7.027892112731934, ratio: 1.0000042915344238)|(-4.23512077331543, -4.235115051269531)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.5167e-06, device='cuda:0') mean:  tensor(1.1700e-09, device='cuda:0') min:  tensor(-3.0518e-05, device='cuda:0') norm:  tensor(7.7319e-05, device='cuda:0') MSE:  tensor(9.7428e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0249, device='cuda:0') mean:  tensor(6.0482e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1082, device='cuda:0') MSE:  tensor(1.3628e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0024, device='cuda:0')
min of d_p_list:  tensor(-0.0074, device='cuda:0')
Epoch:  58  
Training Loss: 0.21347489953041077
Test Loss:  0.22216665744781494
Test Acc:  0.0
Valid Loss:  0.18618986010551453
Valid Acc:  0.0
std:  0.0041576738533258715 
thres:  0.00021443188190460206
Preserved_eigens number check:  512
  6%|▌         | 58/1000 [14:14<3:51:39, 14.76s/it]Epoch:   59
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(-0.8774, device='cuda:0') 
Std:  tensor(15.4186, device='cuda:0') 
ABS Max:  tensor(260.5746, device='cuda:0') 
ABS Min:  tensor(0.0020, device='cuda:0')
Criterion check:  tensor([0.9925, 0.9995, 1.0004, 0.9995, 1.0009, 0.9996, 0.9996, 0.9945, 1.0011,
        1.0004], device='cuda:0') tensor(220, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(8.2052e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(7.4219, device='cuda:0')
min of grad d_p:  tensor(-4.4795, device='cuda:0')
max|min: (J_L, Jta/N)  (7.421905040740967, 7.421862602233887, ratio: 0.9999942779541016)|(-4.4794535636901855, -4.479457855224609)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.2439e-05, device='cuda:0') mean:  tensor(3.2169e-09, device='cuda:0') min:  tensor(-6.9439e-06, device='cuda:0') norm:  tensor(0.0003, device='cuda:0') MSE:  tensor(3.8371e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0112, device='cuda:0') mean:  tensor(6.3331e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1092, device='cuda:0') MSE:  tensor(1.3766e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0151, device='cuda:0')
min of d_p_list:  tensor(-0.0167, device='cuda:0')
Epoch:  59  
Training Loss: 0.20831869542598724
Test Loss:  0.21724677085876465
Test Acc:  0.0
Valid Loss:  0.17951644957065582
Valid Acc:  0.0
std:  0.0048491683984747454 
thres:  0.00021340564787387847
Preserved_eigens number check:  512
  6%|▌         | 59/1000 [14:29<3:51:08, 14.74s/it]Epoch:   60
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(7.3149, device='cuda:0') 
Std:  tensor(83.0562, device='cuda:0') 
ABS Max:  tensor(1474.8322, device='cuda:0') 
ABS Min:  tensor(0.0118, device='cuda:0')
Criterion check:  tensor([1.0604, 0.9995, 1.0004, 0.9984, 1.0002, 1.0068, 0.9996, 0.9900, 0.9992,
        0.9996], device='cuda:0') tensor(255, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0003, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(6.4983, device='cuda:0')
min of grad d_p:  tensor(-3.9406, device='cuda:0')
max|min: (J_L, Jta/N)  (6.498321533203125, 6.498300075531006, ratio: 0.9999967217445374)|(-3.9405770301818848, -3.9407100677490234)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(-5.0278e-09, device='cuda:0') min:  tensor(-1.9729e-05, device='cuda:0') norm:  tensor(0.0003, device='cuda:0') MSE:  tensor(4.2996e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0146, device='cuda:0') mean:  tensor(2.5222e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0423, device='cuda:0') MSE:  tensor(5.3256e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0448, device='cuda:0')
min of d_p_list:  tensor(-0.0065, device='cuda:0')
Epoch:  60  
Training Loss: 0.21471869945526123
Test Loss:  0.22454126179218292
Test Acc:  0.0
Valid Loss:  0.185547336935997
Valid Acc:  0.0
std:  0.004847762550754443 
thres:  0.00021384846270084383
Preserved_eigens number check:  512
  6%|▌         | 60/1000 [14:44<3:51:28, 14.77s/it]Epoch:   61
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-2.5830, device='cuda:0') 
Std:  tensor(69.7779, device='cuda:0') 
ABS Max:  tensor(1414.1710, device='cuda:0') 
ABS Min:  tensor(0.0024, device='cuda:0')
Criterion check:  tensor([0.9495, 1.0002, 0.9998, 1.0002, 0.9993, 1.0141, 0.9939, 0.9974, 0.9969,
        1.0611], device='cuda:0') tensor(257, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0016, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(5.7502, device='cuda:0')
min of grad d_p:  tensor(-3.3734, device='cuda:0')
max|min: (J_L, Jta/N)  (5.750236511230469, 5.750235080718994, ratio: 0.9999997615814209)|(-3.373448133468628, -3.373445749282837)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.6547e-06, device='cuda:0') mean:  tensor(-2.3099e-09, device='cuda:0') min:  tensor(-4.5300e-06, device='cuda:0') norm:  tensor(9.1219e-05, device='cuda:0') MSE:  tensor(1.1494e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0259, device='cuda:0') mean:  tensor(5.6854e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1499, device='cuda:0') MSE:  tensor(1.8889e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0074, device='cuda:0')
min of d_p_list:  tensor(-0.0022, device='cuda:0')
Epoch:  61  
Training Loss: 0.20925022661685944
Test Loss:  0.2186967432498932
Test Acc:  0.0
Valid Loss:  0.1806357502937317
Valid Acc:  0.0
std:  0.005017816404816038 
thres:  0.00021363680958747864
Preserved_eigens number check:  512
  6%|▌         | 61/1000 [14:58<3:51:14, 14.78s/it]Epoch:   62
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(2917.6030, device='cuda:0') 
Std:  tensor(65622.1953, device='cuda:0') 
ABS Max:  tensor(1484813.2500, device='cuda:0') 
ABS Min:  tensor(0.0429, device='cuda:0')
Criterion check:  tensor([2.6283, 1.0028, 0.9216, 0.9973, 1.0316, 1.0226, 1.1360, 1.1170, 0.9770,
        0.7346], device='cuda:0') tensor(280, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0002, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(5.2932, device='cuda:0')
min of grad d_p:  tensor(-3.3852, device='cuda:0')
max|min: (J_L, Jta/N)  (5.293212890625, 5.306955337524414, ratio: 1.0025962591171265)|(-3.385188102722168, -3.384204387664795)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0049, device='cuda:0') mean:  tensor(2.1410e-06, device='cuda:0') min:  tensor(-0.0137, device='cuda:0') norm:  tensor(0.1067, device='cuda:0') MSE:  tensor(1.3444e-07, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.6071, device='cuda:0') mean:  tensor(0.0016, device='cuda:0') min:  tensor(5.2287e-13, device='cuda:0') norm:  tensor(3.1038, device='cuda:0') MSE:  tensor(3.9110e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0028, device='cuda:0')
min of d_p_list:  tensor(-0.0030, device='cuda:0')
Epoch:  62  
Training Loss: 0.2050645649433136
Test Loss:  0.21444889903068542
Test Acc:  0.0
Valid Loss:  0.17709888517856598
Valid Acc:  0.0
std:  0.003519991518455765 
thres:  0.00021016541719436646
Preserved_eigens number check:  512
  6%|▌         | 62/1000 [15:13<3:50:50, 14.77s/it]Epoch:   63
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-2.4508, device='cuda:0') 
Std:  tensor(30.7123, device='cuda:0') 
ABS Max:  tensor(299.9293, device='cuda:0') 
ABS Min:  tensor(0.0106, device='cuda:0')
Criterion check:  tensor([0.9809, 1.0001, 0.9980, 0.9996, 1.0003, 1.0197, 0.9600, 1.0031, 0.9984,
        0.9815], device='cuda:0') tensor(248, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0004, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(5.3418, device='cuda:0')
min of grad d_p:  tensor(-3.5851, device='cuda:0')
max|min: (J_L, Jta/N)  (5.341811180114746, 5.341136455535889, ratio: 0.999873697757721)|(-3.5850892066955566, -3.583353281021118)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0007, device='cuda:0') mean:  tensor(-2.0569e-07, device='cuda:0') min:  tensor(-0.0017, device='cuda:0') norm:  tensor(0.0097, device='cuda:0') MSE:  tensor(1.2212e-08, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0371, device='cuda:0') mean:  tensor(5.9837e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1228, device='cuda:0') MSE:  tensor(1.5469e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0038, device='cuda:0')
min of d_p_list:  tensor(-0.0031, device='cuda:0')
Epoch:  63  
Training Loss: 0.2015339732170105
Test Loss:  0.21063080430030823
Test Acc:  0.0
Valid Loss:  0.17417684197425842
Valid Acc:  0.0
std:  0.004404173225640353 
thres:  0.0002077772319316864
Preserved_eigens number check:  512
  6%|▋         | 63/1000 [15:28<3:50:24, 14.75s/it]Epoch:   64
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-666.4503, device='cuda:0') 
Std:  tensor(14791.5859, device='cuda:0') 
ABS Max:  tensor(334627.0312, device='cuda:0') 
ABS Min:  tensor(0.0033, device='cuda:0')
Criterion check:  tensor([0.8361, 1.0026, 0.9941, 1.0000, 0.9986, 0.9735, 0.9954, 1.0063, 0.9979,
        1.0017], device='cuda:0') tensor(278, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0012, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(5.2838, device='cuda:0')
min of grad d_p:  tensor(-3.6695, device='cuda:0')
max|min: (J_L, Jta/N)  (5.283764362335205, 5.281614303588867, ratio: 0.9995930790901184)|(-3.669464111328125, -3.666132926940918)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0022, device='cuda:0') mean:  tensor(6.0698e-08, device='cuda:0') min:  tensor(-0.0033, device='cuda:0') norm:  tensor(0.0130, device='cuda:0') MSE:  tensor(1.6441e-08, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0125, device='cuda:0') mean:  tensor(7.6927e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1899, device='cuda:0') MSE:  tensor(2.3931e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0031, device='cuda:0')
min of d_p_list:  tensor(-0.0037, device='cuda:0')
Epoch:  64  
Training Loss: 0.19628360867500305
Test Loss:  0.20550860464572906
Test Acc:  0.0
Valid Loss:  0.16956445574760437
Valid Acc:  0.0
std:  0.006321791506169839 
thres:  0.0002053702145814896
Preserved_eigens number check:  512
  6%|▋         | 64/1000 [15:43<3:49:46, 14.73s/it]Epoch:   65
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(3.6707, device='cuda:0') 
Std:  tensor(79.7015, device='cuda:0') 
ABS Max:  tensor(844.1270, device='cuda:0') 
ABS Min:  tensor(0.0035, device='cuda:0')
Criterion check:  tensor([-2.3647,  1.0023,  0.9964,  1.0001,  1.0019,  1.0163,  1.5753,  0.9775,
         1.0064,  0.8644], device='cuda:0') tensor(277, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0015, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(5.1335, device='cuda:0')
min of grad d_p:  tensor(-4.2847, device='cuda:0')
max|min: (J_L, Jta/N)  (5.133452892303467, 5.1334381103515625, ratio: 0.9999971389770508)|(-4.284697532653809, -4.284828186035156)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(6.5395e-10, device='cuda:0') min:  tensor(-1.0371e-05, device='cuda:0') norm:  tensor(0.0002, device='cuda:0') MSE:  tensor(2.1878e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0852, device='cuda:0') mean:  tensor(0.0004, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.6835, device='cuda:0') MSE:  tensor(8.6128e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0064, device='cuda:0')
min of d_p_list:  tensor(-0.0119, device='cuda:0')
Epoch:  65  
Training Loss: 0.19344362616539001
Test Loss:  0.20255506038665771
Test Acc:  0.0
Valid Loss:  0.16654852032661438
Valid Acc:  0.0
std:  0.005729726561563466 
thres:  0.00020111519992351533
Preserved_eigens number check:  512
  6%|▋         | 65/1000 [15:57<3:49:38, 14.74s/it]Epoch:   66
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(1.8717, device='cuda:0') 
Std:  tensor(39.9244, device='cuda:0') 
ABS Max:  tensor(837.3232, device='cuda:0') 
ABS Min:  tensor(0.0028, device='cuda:0')
Criterion check:  tensor([0.9999, 1.0010, 0.9977, 1.0000, 0.9993, 0.9455, 1.0003, 1.0068, 0.9993,
        0.9905], device='cuda:0') tensor(268, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0001, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(5.8874, device='cuda:0')
min of grad d_p:  tensor(-3.4722, device='cuda:0')
max|min: (J_L, Jta/N)  (5.887361526489258, 5.887359142303467, ratio: 0.9999995827674866)|(-3.472212791442871, -3.4723193645477295)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(-5.5577e-09, device='cuda:0') min:  tensor(-1.9342e-05, device='cuda:0') norm:  tensor(0.0003, device='cuda:0') MSE:  tensor(3.9275e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0063, device='cuda:0') mean:  tensor(4.9798e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0803, device='cuda:0') MSE:  tensor(1.0119e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0863, device='cuda:0')
min of d_p_list:  tensor(-0.0416, device='cuda:0')
Epoch:  66  
Training Loss: 0.19127807021141052
Test Loss:  0.19976884126663208
Test Acc:  0.0
Valid Loss:  0.16435962915420532
Valid Acc:  0.0
std:  0.005101756812126574 
thres:  0.00019752076864242555
Preserved_eigens number check:  512
  7%|▋         | 66/1000 [16:12<3:49:33, 14.75s/it]Epoch:   67
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(180.9251, device='cuda:0') 
Std:  tensor(3713.9109, device='cuda:0') 
ABS Max:  tensor(83442.0469, device='cuda:0') 
ABS Min:  tensor(0.0542, device='cuda:0')
Criterion check:  tensor([1.0420, 0.9964, 1.0146, 0.9950, 0.9926, 1.0057, 0.9946, 0.9897, 0.9879,
        0.9871], device='cuda:0') tensor(291, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0026, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(4.0111, device='cuda:0')
min of grad d_p:  tensor(-1.5457, device='cuda:0')
max|min: (J_L, Jta/N)  (4.011063575744629, 4.0110764503479, ratio: 1.0000032186508179)|(-1.545706033706665, -1.545725703239441)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.9670e-05, device='cuda:0') mean:  tensor(-7.0405e-10, device='cuda:0') min:  tensor(-1.2875e-05, device='cuda:0') norm:  tensor(0.0001, device='cuda:0') MSE:  tensor(1.5641e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0280, device='cuda:0') mean:  tensor(8.4750e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1428, device='cuda:0') MSE:  tensor(1.7992e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0166, device='cuda:0')
min of d_p_list:  tensor(-0.0159, device='cuda:0')
Epoch:  67  
Training Loss: 0.19393503665924072
Test Loss:  0.20190520584583282
Test Acc:  0.0
Valid Loss:  0.16770794987678528
Valid Acc:  0.0
std:  0.0035018550544288958 
thres:  0.00019529486298561097
Preserved_eigens number check:  512
  7%|▋         | 67/1000 [16:27<3:49:14, 14.74s/it]Epoch:   68
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-1.6669, device='cuda:0') 
Std:  tensor(245.6584, device='cuda:0') 
ABS Max:  tensor(3790.1169, device='cuda:0') 
ABS Min:  tensor(0.0169, device='cuda:0')
Criterion check:  tensor([0.8537, 1.0030, 1.0126, 1.0020, 0.9225, 1.0309, 1.0341, 1.0448, 1.0186,
        0.9185], device='cuda:0') tensor(289, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0005, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(4.1405, device='cuda:0')
min of grad d_p:  tensor(-1.0492, device='cuda:0')
max|min: (J_L, Jta/N)  (4.140504360198975, 4.140457630157471, ratio: 0.9999887347221375)|(-1.0491690635681152, -1.0492762327194214)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(2.9230e-09, device='cuda:0') min:  tensor(-7.9274e-06, device='cuda:0') norm:  tensor(0.0003, device='cuda:0') MSE:  tensor(3.7873e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0087, device='cuda:0') mean:  tensor(3.4849e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0713, device='cuda:0') MSE:  tensor(8.9787e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0107, device='cuda:0')
min of d_p_list:  tensor(-0.0134, device='cuda:0')
Epoch:  68  
Training Loss: 0.1902572512626648
Test Loss:  0.1990642100572586
Test Acc:  0.0
Valid Loss:  0.16511651873588562
Valid Acc:  0.0
std:  0.00211343738471864 
thres:  0.00019303951859474185
Preserved_eigens number check:  512
  7%|▋         | 68/1000 [16:42<3:49:42, 14.79s/it]Epoch:   69
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-5.1339, device='cuda:0') 
Std:  tensor(72.7140, device='cuda:0') 
ABS Max:  tensor(1022.7090, device='cuda:0') 
ABS Min:  tensor(0.0030, device='cuda:0')
Criterion check:  tensor([0.9977, 0.9994, 0.9803, 1.0002, 1.0028, 0.9963, 0.9608, 0.9887, 0.9993,
        1.0065], device='cuda:0') tensor(250, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0016, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(4.6038, device='cuda:0')
min of grad d_p:  tensor(-0.7874, device='cuda:0')
max|min: (J_L, Jta/N)  (4.603764533996582, 4.60378360748291, ratio: 1.0000041723251343)|(-0.7874364256858826, -0.7874249219894409)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.9637e-06, device='cuda:0') mean:  tensor(-3.0705e-09, device='cuda:0') min:  tensor(-1.9073e-05, device='cuda:0') norm:  tensor(0.0002, device='cuda:0') MSE:  tensor(2.4583e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0444, device='cuda:0') mean:  tensor(0.0002, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.4374, device='cuda:0') MSE:  tensor(5.5117e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0307, device='cuda:0')
min of d_p_list:  tensor(-0.0146, device='cuda:0')
Epoch:  69  
Training Loss: 0.188175767660141
Test Loss:  0.19717484712600708
Test Acc:  0.0
Valid Loss:  0.1631516069173813
Valid Acc:  0.0
std:  0.002112705536328102 
thres:  0.0001914179503917694
Preserved_eigens number check:  512
  7%|▋         | 69/1000 [16:56<3:49:19, 14.78s/it]Epoch:   70
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-4.0134, device='cuda:0') 
Std:  tensor(73.4158, device='cuda:0') 
ABS Max:  tensor(1168.9230, device='cuda:0') 
ABS Min:  tensor(0.0072, device='cuda:0')
Criterion check:  tensor([0.9893, 0.9985, 1.0088, 1.0013, 0.9992, 0.9949, 0.9888, 1.0041, 0.9975,
        0.9969], device='cuda:0') tensor(243, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0006, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(4.2785, device='cuda:0')
min of grad d_p:  tensor(-0.6957, device='cuda:0')
max|min: (J_L, Jta/N)  (4.278537750244141, 4.278550624847412, ratio: 1.0000029802322388)|(-0.6956911683082581, -0.6957040429115295)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.9327e-05, device='cuda:0') mean:  tensor(8.1902e-09, device='cuda:0') min:  tensor(-0.0001, device='cuda:0') norm:  tensor(0.0004, device='cuda:0') MSE:  tensor(5.3492e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0652, device='cuda:0') mean:  tensor(0.0002, device='cuda:0') min:  tensor(3.7581e-13, device='cuda:0') norm:  tensor(0.2896, device='cuda:0') MSE:  tensor(3.6498e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0119, device='cuda:0')
min of d_p_list:  tensor(-0.0056, device='cuda:0')
Epoch:  70  
Training Loss: 0.1879081130027771
Test Loss:  0.19656217098236084
Test Acc:  0.0
Valid Loss:  0.1626167893409729
Valid Acc:  0.0
std:  0.0022092912156979126 
thres:  0.00019031084775924685
Preserved_eigens number check:  512
  7%|▋         | 70/1000 [17:11<3:48:35, 14.75s/it]Epoch:   71
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(16.0833, device='cuda:0') 
Std:  tensor(382.8319, device='cuda:0') 
ABS Max:  tensor(8598.1826, device='cuda:0') 
ABS Min:  tensor(0.0021, device='cuda:0')
Criterion check:  tensor([1.0417, 0.9984, 0.9969, 0.9993, 1.0062, 0.9968, 2.4294, 0.9950, 0.9962,
        1.0067], device='cuda:0') tensor(240, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0003, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(3.9825, device='cuda:0')
min of grad d_p:  tensor(-0.7453, device='cuda:0')
max|min: (J_L, Jta/N)  (3.982450485229492, 3.981720209121704, ratio: 0.9998166561126709)|(-0.745265543460846, -0.745583713054657)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0007, device='cuda:0') mean:  tensor(1.9953e-07, device='cuda:0') min:  tensor(-0.0027, device='cuda:0') norm:  tensor(0.0125, device='cuda:0') MSE:  tensor(1.5753e-08, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0138, device='cuda:0') mean:  tensor(7.0629e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1232, device='cuda:0') MSE:  tensor(1.5524e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0052, device='cuda:0')
min of d_p_list:  tensor(-0.0035, device='cuda:0')
Epoch:  71  
Training Loss: 0.18651717901229858
Test Loss:  0.19501934945583344
Test Acc:  0.0
Valid Loss:  0.16177302598953247
Valid Acc:  0.0
std:  0.0025817832855003844 
thres:  0.00018935866951942442
Preserved_eigens number check:  512
  7%|▋         | 71/1000 [17:26<3:48:04, 14.73s/it]Epoch:   72
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(8.6022, device='cuda:0') 
Std:  tensor(227.4258, device='cuda:0') 
ABS Max:  tensor(5084.3398, device='cuda:0') 
ABS Min:  tensor(0.0010, device='cuda:0')
Criterion check:  tensor([0.9549, 1.0001, 0.9985, 0.9991, 0.9963, 1.0008, 1.0111, 1.0493, 1.0011,
        0.9887], device='cuda:0') tensor(256, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0010, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(3.8588, device='cuda:0')
min of grad d_p:  tensor(-0.7510, device='cuda:0')
max|min: (J_L, Jta/N)  (3.8588478565216064, 3.858847141265869, ratio: 0.9999998211860657)|(-0.7510297894477844, -0.7510221600532532)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.5154e-05, device='cuda:0') mean:  tensor(-1.9500e-09, device='cuda:0') min:  tensor(-9.1195e-06, device='cuda:0') norm:  tensor(0.0001, device='cuda:0') MSE:  tensor(1.7640e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0140, device='cuda:0') mean:  tensor(5.2837e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0862, device='cuda:0') MSE:  tensor(1.0863e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0113, device='cuda:0')
min of d_p_list:  tensor(-0.0172, device='cuda:0')
Epoch:  72  
Training Loss: 0.18805423378944397
Test Loss:  0.19682347774505615
Test Acc:  0.0
Valid Loss:  0.16395436227321625
Valid Acc:  0.0
std:  0.0011974700466419403 
thres:  0.0001881825089454651
Preserved_eigens number check:  512
**************************************************learning rate decay**************************************************
  7%|▋         | 72/1000 [17:41<3:47:57, 14.74s/it]Epoch:   73
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(0.6816, device='cuda:0') 
Std:  tensor(12.0501, device='cuda:0') 
ABS Max:  tensor(132.3635, device='cuda:0') 
ABS Min:  tensor(0.0012, device='cuda:0')
Criterion check:  tensor([0.9827, 0.9999, 1.0107, 0.9981, 0.9983, 1.0003, 1.0219, 1.0099, 0.9993,
        1.0000], device='cuda:0') tensor(236, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0016, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(3.8223, device='cuda:0')
min of grad d_p:  tensor(-1.0629, device='cuda:0')
max|min: (J_L, Jta/N)  (3.822333574295044, 3.822314739227295, ratio: 0.9999950528144836)|(-1.0628576278686523, -1.0629570484161377)

 check Jacobi res:  torch.Size([793601]) max:  tensor(9.9421e-05, device='cuda:0') mean:  tensor(-4.9654e-09, device='cuda:0') min:  tensor(-1.2726e-05, device='cuda:0') norm:  tensor(0.0002, device='cuda:0') MSE:  tensor(2.5636e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0110, device='cuda:0') mean:  tensor(9.2357e-05, device='cuda:0') min:  tensor(8.4404e-13, device='cuda:0') norm:  tensor(0.2270, device='cuda:0') MSE:  tensor(2.8606e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0399, device='cuda:0')
min of d_p_list:  tensor(-0.0100, device='cuda:0')
Epoch:  73  
Training Loss: 0.18795287609100342
Test Loss:  0.19683407247066498
Test Acc:  0.0
Valid Loss:  0.1646350473165512
Valid Acc:  0.0
local minima detector shape:  (0,)
Preserved_eigens number check:  512
  7%|▋         | 73/1000 [17:56<3:48:55, 14.82s/it]Epoch:   74
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(19.5186, device='cuda:0') 
Std:  tensor(272.9870, device='cuda:0') 
ABS Max:  tensor(4847.0776, device='cuda:0') 
ABS Min:  tensor(0.0503, device='cuda:0')
Criterion check:  tensor([1.3812, 1.0127, 0.9884, 0.9937, 0.9924, 1.0019, 0.9696, 1.1677, 1.0132,
        0.9133], device='cuda:0') tensor(274, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0008, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(3.2256, device='cuda:0')
min of grad d_p:  tensor(-1.0947, device='cuda:0')
max|min: (J_L, Jta/N)  (3.225621223449707, 3.225619077682495, ratio: 0.9999993443489075)|(-1.0947190523147583, -1.0947206020355225)

 check Jacobi res:  torch.Size([793601]) max:  tensor(5.4985e-06, device='cuda:0') mean:  tensor(1.9497e-09, device='cuda:0') min:  tensor(-1.9558e-06, device='cuda:0') norm:  tensor(9.3097e-05, device='cuda:0') MSE:  tensor(1.1731e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.3574, device='cuda:0') mean:  tensor(0.0008, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(1.7561, device='cuda:0') MSE:  tensor(2.2128e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0033, device='cuda:0')
min of d_p_list:  tensor(-0.0032, device='cuda:0')
Epoch:  74  
Training Loss: 0.18495984375476837
Test Loss:  0.19396907091140747
Test Acc:  0.0
Valid Loss:  0.16153421998023987
Valid Acc:  0.0
local minima detector shape:  (1,)
Preserved_eigens number check:  512
  7%|▋         | 74/1000 [18:11<3:49:16, 14.86s/it]Epoch:   75
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(0.4261, device='cuda:0') 
Std:  tensor(13.2680, device='cuda:0') 
ABS Max:  tensor(139.0402, device='cuda:0') 
ABS Min:  tensor(0.0033, device='cuda:0')
Criterion check:  tensor([0.9885, 1.0003, 0.9990, 0.9996, 0.9997, 1.0026, 0.9323, 0.9987, 1.0012,
        0.9950], device='cuda:0') tensor(241, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0003, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(3.2602, device='cuda:0')
min of grad d_p:  tensor(-1.1275, device='cuda:0')
max|min: (J_L, Jta/N)  (3.2602367401123047, 3.2602434158325195, ratio: 1.0000020265579224)|(-1.1275453567504883, -1.1275944709777832)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.9114e-05, device='cuda:0') mean:  tensor(-2.0266e-09, device='cuda:0') min:  tensor(-6.6757e-06, device='cuda:0') norm:  tensor(0.0001, device='cuda:0') MSE:  tensor(1.4777e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0116, device='cuda:0') mean:  tensor(9.0178e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1985, device='cuda:0') MSE:  tensor(2.5007e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0296, device='cuda:0')
min of d_p_list:  tensor(-0.0115, device='cuda:0')
Epoch:  75  
Training Loss: 0.1808372288942337
Test Loss:  0.18991638720035553
Test Acc:  0.0
Valid Loss:  0.15693572163581848
Valid Acc:  0.0
local minima detector shape:  (2,)
Preserved_eigens number check:  512
  8%|▊         | 75/1000 [18:25<3:48:11, 14.80s/it]Epoch:   76
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(0.7295, device='cuda:0') 
Std:  tensor(30.8538, device='cuda:0') 
ABS Max:  tensor(363.0308, device='cuda:0') 
ABS Min:  tensor(0.0045, device='cuda:0')
Criterion check:  tensor([0.9983, 1.0001, 1.0016, 1.0004, 1.0032, 0.9959, 0.9151, 0.9817, 0.9989,
        1.0545], device='cuda:0') tensor(260, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0003, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(3.3497, device='cuda:0')
min of grad d_p:  tensor(-1.6614, device='cuda:0')
max|min: (J_L, Jta/N)  (3.3496780395507812, 3.349679708480835, ratio: 1.0000004768371582)|(-1.6614470481872559, -1.6614618301391602)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.4782e-05, device='cuda:0') mean:  tensor(-2.1305e-09, device='cuda:0') min:  tensor(-5.8413e-06, device='cuda:0') norm:  tensor(0.0001, device='cuda:0') MSE:  tensor(1.4296e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0030, device='cuda:0') mean:  tensor(6.3120e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1025, device='cuda:0') MSE:  tensor(1.2920e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0029, device='cuda:0')
min of d_p_list:  tensor(-0.0035, device='cuda:0')
Epoch:  76  
Training Loss: 0.17995548248291016
Test Loss:  0.18904751539230347
Test Acc:  0.0
Valid Loss:  0.1561254858970642
Valid Acc:  0.0
local minima detector shape:  (3,)
Preserved_eigens number check:  512
  8%|▊         | 76/1000 [18:40<3:47:34, 14.78s/it]Epoch:   77
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-64.4938, device='cuda:0') 
Std:  tensor(1481.7487, device='cuda:0') 
ABS Max:  tensor(33513.9570, device='cuda:0') 
ABS Min:  tensor(0.0012, device='cuda:0')
Criterion check:  tensor([1.0021, 1.0010, 0.9996, 0.9995, 0.9970, 1.0049, 0.9385, 0.9767, 1.0034,
        1.0109], device='cuda:0') tensor(268, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0004, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(3.3562, device='cuda:0')
min of grad d_p:  tensor(-1.8263, device='cuda:0')
max|min: (J_L, Jta/N)  (3.3562474250793457, 3.356278419494629, ratio: 1.0000091791152954)|(-1.8263318538665771, -1.8262590169906616)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.3441e-05, device='cuda:0') mean:  tensor(4.4456e-09, device='cuda:0') min:  tensor(-7.2837e-05, device='cuda:0') norm:  tensor(0.0002, device='cuda:0') MSE:  tensor(2.6309e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0119, device='cuda:0') mean:  tensor(6.2872e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1034, device='cuda:0') MSE:  tensor(1.3024e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0182, device='cuda:0')
min of d_p_list:  tensor(-0.0169, device='cuda:0')
Epoch:  77  
Training Loss: 0.18007473647594452
Test Loss:  0.18939344584941864
Test Acc:  0.0
Valid Loss:  0.15639814734458923
Valid Acc:  0.0
local minima detector shape:  (4,)
Preserved_eigens number check:  512
  8%|▊         | 77/1000 [18:55<3:46:55, 14.75s/it]Epoch:   78
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-74.0899, device='cuda:0') 
Std:  tensor(1362.1537, device='cuda:0') 
ABS Max:  tensor(29859.2363, device='cuda:0') 
ABS Min:  tensor(0.0209, device='cuda:0')
Criterion check:  tensor([0.9958, 0.9996, 1.0102, 0.9984, 1.0052, 0.9995, 1.0235, 1.2322, 1.0066,
        1.0161], device='cuda:0') tensor(258, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0003, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(3.5278, device='cuda:0')
min of grad d_p:  tensor(-1.9749, device='cuda:0')
max|min: (J_L, Jta/N)  (3.5277748107910156, 3.5277745723724365, ratio: 0.9999999403953552)|(-1.9749301671981812, -1.9749536514282227)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.3484e-05, device='cuda:0') mean:  tensor(-2.6775e-09, device='cuda:0') min:  tensor(-7.0333e-06, device='cuda:0') norm:  tensor(0.0001, device='cuda:0') MSE:  tensor(1.3937e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0264, device='cuda:0') mean:  tensor(5.0322e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0918, device='cuda:0') MSE:  tensor(1.1564e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0032, device='cuda:0')
min of d_p_list:  tensor(-0.0020, device='cuda:0')
Epoch:  78  
Training Loss: 0.1789565086364746
Test Loss:  0.1881498247385025
Test Acc:  0.0
Valid Loss:  0.1552373766899109
Valid Acc:  0.0
std:  0.0020890425995387543 
thres:  0.00018095676004886626
Preserved_eigens number check:  512
  8%|▊         | 78/1000 [19:09<3:46:25, 14.74s/it]Epoch:   79
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(15.2971, device='cuda:0') 
Std:  tensor(487.1838, device='cuda:0') 
ABS Max:  tensor(9268.9541, device='cuda:0') 
ABS Min:  tensor(0.0053, device='cuda:0')
Criterion check:  tensor([0.9862, 1.0029, 1.0560, 0.9975, 1.0031, 0.9933, 0.9699, 1.5300, 1.0014,
        0.9984], device='cuda:0') tensor(289, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0005, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(3.4961, device='cuda:0')
min of grad d_p:  tensor(-1.9770, device='cuda:0')
max|min: (J_L, Jta/N)  (3.496053695678711, 3.496070384979248, ratio: 1.000004768371582)|(-1.9770208597183228, -1.9769243001937866)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.2308e-05, device='cuda:0') mean:  tensor(2.9604e-09, device='cuda:0') min:  tensor(-9.6560e-05, device='cuda:0') norm:  tensor(0.0002, device='cuda:0') MSE:  tensor(2.2512e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.1016, device='cuda:0') mean:  tensor(0.0002, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.3546, device='cuda:0') MSE:  tensor(4.4680e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0051, device='cuda:0')
min of d_p_list:  tensor(-0.0247, device='cuda:0')
Epoch:  79  
Training Loss: 0.1780955195426941
Test Loss:  0.18705421686172485
Test Acc:  0.0
Valid Loss:  0.1544148325920105
Valid Acc:  0.0
std:  0.0009548532466767751 
thres:  0.0001795838952064514
Preserved_eigens number check:  512
  8%|▊         | 79/1000 [19:24<3:45:39, 14.70s/it]Epoch:   80
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(4.1330, device='cuda:0') 
Std:  tensor(51.6237, device='cuda:0') 
ABS Max:  tensor(684.0095, device='cuda:0') 
ABS Min:  tensor(0.0014, device='cuda:0')
Criterion check:  tensor([1.0076, 0.9979, 1.0018, 0.9998, 1.0135, 1.0043, 0.9887, 0.9663, 1.0023,
        0.9996], device='cuda:0') tensor(255, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0008, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(3.7094, device='cuda:0')
min of grad d_p:  tensor(-1.9389, device='cuda:0')
max|min: (J_L, Jta/N)  (3.709432601928711, 3.709421157836914, ratio: 0.9999969005584717)|(-1.938931941986084, -1.9388996362686157)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.1444e-05, device='cuda:0') mean:  tensor(-2.4502e-09, device='cuda:0') min:  tensor(-3.2306e-05, device='cuda:0') norm:  tensor(0.0001, device='cuda:0') MSE:  tensor(1.5485e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0084, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1863, device='cuda:0') MSE:  tensor(2.3469e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0019, device='cuda:0')
min of d_p_list:  tensor(-0.0139, device='cuda:0')
Epoch:  80  
Training Loss: 0.17612437903881073
Test Loss:  0.18488523364067078
Test Acc:  0.0
Valid Loss:  0.15256527066230774
Valid Acc:  0.0
std:  0.0014500992823066408 
thres:  0.00017864132523536682
Preserved_eigens number check:  512
  8%|▊         | 80/1000 [19:39<3:45:23, 14.70s/it]Epoch:   81
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-67.1904, device='cuda:0') 
Std:  tensor(1365.8489, device='cuda:0') 
ABS Max:  tensor(24061.0703, device='cuda:0') 
ABS Min:  tensor(0.1058, device='cuda:0')
Criterion check:  tensor([0.8632, 0.9830, 0.9603, 0.9733, 1.0281, 1.0944, 1.0081, 0.8279, 1.0786,
        1.1297], device='cuda:0') tensor(254, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0007, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(3.7919, device='cuda:0')
min of grad d_p:  tensor(-2.0612, device='cuda:0')
max|min: (J_L, Jta/N)  (3.7918813228607178, 3.7918639183044434, ratio: 0.9999954104423523)|(-2.0611908435821533, -2.0609614849090576)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.7405e-05, device='cuda:0') mean:  tensor(-6.0213e-09, device='cuda:0') min:  tensor(-0.0002, device='cuda:0') norm:  tensor(0.0006, device='cuda:0') MSE:  tensor(7.1542e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.2829, device='cuda:0') mean:  tensor(0.0013, device='cuda:0') min:  tensor(4.0133e-13, device='cuda:0') norm:  tensor(2.5748, device='cuda:0') MSE:  tensor(3.2445e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0084, device='cuda:0')
min of d_p_list:  tensor(-0.0031, device='cuda:0')
Epoch:  81  
Training Loss: 0.17544642090797424
Test Loss:  0.18415898084640503
Test Acc:  0.0
Valid Loss:  0.15200012922286987
Valid Acc:  0.0
std:  0.0017278898561736864 
thres:  0.00017773951292037965
Preserved_eigens number check:  512
  8%|▊         | 81/1000 [19:53<3:45:05, 14.70s/it]Epoch:   82
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-1.0830, device='cuda:0') 
Std:  tensor(44.4868, device='cuda:0') 
ABS Max:  tensor(872.9697, device='cuda:0') 
ABS Min:  tensor(0.0018, device='cuda:0')
Criterion check:  tensor([0.9987, 0.9989, 1.0022, 0.9998, 1.0024, 1.0029, 0.9931, 0.9926, 0.9990,
        0.9998], device='cuda:0') tensor(239, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0011, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(3.6920, device='cuda:0')
min of grad d_p:  tensor(-2.0267, device='cuda:0')
max|min: (J_L, Jta/N)  (3.692000389099121, 3.6920037269592285, ratio: 1.0000009536743164)|(-2.026747703552246, -2.0267276763916016)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.1658e-06, device='cuda:0') mean:  tensor(3.7287e-09, device='cuda:0') min:  tensor(-2.0027e-05, device='cuda:0') norm:  tensor(0.0002, device='cuda:0') MSE:  tensor(2.0900e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0263, device='cuda:0') mean:  tensor(6.5299e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1190, device='cuda:0') MSE:  tensor(1.5001e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0125, device='cuda:0')
min of d_p_list:  tensor(-0.0343, device='cuda:0')
Epoch:  82  
Training Loss: 0.1781570315361023
Test Loss:  0.18715731799602509
Test Acc:  0.0
Valid Loss:  0.15468400716781616
Valid Acc:  0.0
std:  0.0013351817155796016 
thres:  0.0001773559719324112
Preserved_eigens number check:  512
  8%|▊         | 82/1000 [20:08<3:44:43, 14.69s/it]Epoch:   83
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(5579.4102, device='cuda:0') 
Std:  tensor(129555.5391, device='cuda:0') 
ABS Max:  tensor(2930087.5000, device='cuda:0') 
ABS Min:  tensor(0.0181, device='cuda:0')
Criterion check:  tensor([ 1.3352,  0.9859,  1.0256,  1.0949,  1.0136,  0.8234, -0.2192, -0.3495,
         1.1167,  1.0167], device='cuda:0') tensor(278, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0017, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(4.1662, device='cuda:0')
min of grad d_p:  tensor(-1.7225, device='cuda:0')
max|min: (J_L, Jta/N)  (4.1662163734436035, 4.166255950927734, ratio: 1.000009536743164)|(-1.7225308418273926, -1.722432255744934)

 check Jacobi res:  torch.Size([793601]) max:  tensor(9.7156e-06, device='cuda:0') mean:  tensor(2.8028e-09, device='cuda:0') min:  tensor(-9.8586e-05, device='cuda:0') norm:  tensor(0.0002, device='cuda:0') MSE:  tensor(2.2143e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0434, device='cuda:0') mean:  tensor(0.0003, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.6350, device='cuda:0') MSE:  tensor(8.0016e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0181, device='cuda:0')
min of d_p_list:  tensor(-0.0074, device='cuda:0')
Epoch:  83  
Training Loss: 0.17783328890800476
Test Loss:  0.1866610050201416
Test Acc:  0.0
Valid Loss:  0.15512092411518097
Valid Acc:  0.0
std:  0.0011249302476634962 
thres:  0.0001771313279867172
Preserved_eigens number check:  512
  8%|▊         | 83/1000 [20:23<3:44:21, 14.68s/it]Epoch:   84
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(7.9727, device='cuda:0') 
Std:  tensor(137.1331, device='cuda:0') 
ABS Max:  tensor(3014.6099, device='cuda:0') 
ABS Min:  tensor(0.0183, device='cuda:0')
Criterion check:  tensor([0.9954, 0.9977, 0.9992, 0.9991, 1.0064, 1.0004, 0.9828, 0.9988, 0.9983,
        1.0942], device='cuda:0') tensor(267, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0014, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(3.9394, device='cuda:0')
min of grad d_p:  tensor(-2.0955, device='cuda:0')
max|min: (J_L, Jta/N)  (3.939434766769409, 3.9394302368164062, ratio: 0.9999988675117493)|(-2.0955276489257812, -2.0955324172973633)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.7684e-06, device='cuda:0') mean:  tensor(-2.6304e-09, device='cuda:0') min:  tensor(-8.3223e-06, device='cuda:0') norm:  tensor(0.0001, device='cuda:0') MSE:  tensor(1.3982e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0273, device='cuda:0') mean:  tensor(8.3756e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1687, device='cuda:0') MSE:  tensor(2.1258e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0042, device='cuda:0')
min of d_p_list:  tensor(-0.0078, device='cuda:0')
Epoch:  84  
Training Loss: 0.17477339506149292
Test Loss:  0.18349292874336243
Test Acc:  0.0
Valid Loss:  0.15224890410900116
Valid Acc:  0.0
std:  0.0013228923176178621 
thres:  0.000176466903090477
Preserved_eigens number check:  512
  8%|▊         | 84/1000 [20:38<3:47:03, 14.87s/it]Epoch:   85
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.6279, device='cuda:0') 
Std:  tensor(14.8329, device='cuda:0') 
ABS Max:  tensor(259.6176, device='cuda:0') 
ABS Min:  tensor(0.0043, device='cuda:0')
Criterion check:  tensor([0.9947, 0.9988, 1.0009, 0.9992, 1.0024, 1.0039, 0.9989, 0.9989, 1.0005,
        0.9999], device='cuda:0') tensor(227, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0003, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(4.0326, device='cuda:0')
min of grad d_p:  tensor(-1.9894, device='cuda:0')
max|min: (J_L, Jta/N)  (4.032555103302002, 4.032557964324951, ratio: 1.0000007152557373)|(-1.9893903732299805, -1.9893742799758911)

 check Jacobi res:  torch.Size([793601]) max:  tensor(7.9426e-06, device='cuda:0') mean:  tensor(3.1413e-10, device='cuda:0') min:  tensor(-1.6093e-05, device='cuda:0') norm:  tensor(0.0001, device='cuda:0') MSE:  tensor(1.4446e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0302, device='cuda:0') mean:  tensor(5.5217e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1519, device='cuda:0') MSE:  tensor(1.9141e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0082, device='cuda:0')
min of d_p_list:  tensor(-0.0047, device='cuda:0')
Epoch:  85  
Training Loss: 0.17395728826522827
Test Loss:  0.18258525431156158
Test Acc:  0.0
Valid Loss:  0.1517149955034256
Valid Acc:  0.0
std:  0.0016728304027014116 
thres:  0.0001760334849357605
Preserved_eigens number check:  512
  8%|▊         | 85/1000 [20:53<3:45:55, 14.81s/it]Epoch:   86
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-1.5282, device='cuda:0') 
Std:  tensor(35.7412, device='cuda:0') 
ABS Max:  tensor(695.8408, device='cuda:0') 
ABS Min:  tensor(0.0007, device='cuda:0')
Criterion check:  tensor([0.9934, 0.9979, 0.9974, 1.0012, 1.0041, 1.0021, 0.9745, 1.0052, 1.0000,
        0.9982], device='cuda:0') tensor(236, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0001, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(3.9717, device='cuda:0')
min of grad d_p:  tensor(-2.3908, device='cuda:0')
max|min: (J_L, Jta/N)  (3.9717230796813965, 3.971714735031128, ratio: 0.9999979138374329)|(-2.390846014022827, -2.3908908367156982)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.4823e-05, device='cuda:0') mean:  tensor(-2.5437e-09, device='cuda:0') min:  tensor(-9.2089e-06, device='cuda:0') norm:  tensor(0.0002, device='cuda:0') MSE:  tensor(2.0282e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0233, device='cuda:0') mean:  tensor(5.4127e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1324, device='cuda:0') MSE:  tensor(1.6685e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0759, device='cuda:0')
min of d_p_list:  tensor(-0.0254, device='cuda:0')
Epoch:  86  
Training Loss: 0.1739274561405182
Test Loss:  0.18257930874824524
Test Acc:  0.0
Valid Loss:  0.1493866741657257
Valid Acc:  0.0
std:  0.0018772890082097333 
thres:  0.0001757296919822693
Preserved_eigens number check:  512
  9%|▊         | 86/1000 [21:07<3:45:22, 14.79s/it]Epoch:   87
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(2.7753, device='cuda:0') 
Std:  tensor(78.9521, device='cuda:0') 
ABS Max:  tensor(1343.6184, device='cuda:0') 
ABS Min:  tensor(0.0014, device='cuda:0')
Criterion check:  tensor([1.0007, 0.9996, 1.0046, 1.0003, 1.0002, 0.9971, 1.0032, 0.9958, 0.9967,
        1.0361], device='cuda:0') tensor(237, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(2.8898e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(3.3926, device='cuda:0')
min of grad d_p:  tensor(-3.2687, device='cuda:0')
max|min: (J_L, Jta/N)  (3.3926401138305664, 3.3926377296447754, ratio: 0.9999992847442627)|(-3.2686710357666016, -3.268651247024536)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.0696e-06, device='cuda:0') mean:  tensor(-4.4110e-10, device='cuda:0') min:  tensor(-1.9789e-05, device='cuda:0') norm:  tensor(8.8251e-05, device='cuda:0') MSE:  tensor(1.1120e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0600, device='cuda:0') mean:  tensor(6.9727e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1331, device='cuda:0') MSE:  tensor(1.6767e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0353, device='cuda:0')
min of d_p_list:  tensor(-0.0245, device='cuda:0')
Epoch:  87  
Training Loss: 0.17683136463165283
Test Loss:  0.18540392816066742
Test Acc:  0.0
Valid Loss:  0.14917051792144775
Valid Acc:  0.0
std:  0.0015869024462904096 
thres:  0.00017546455860137938
Preserved_eigens number check:  512
  9%|▊         | 87/1000 [21:22<3:44:27, 14.75s/it]Epoch:   88
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(-5.8869, device='cuda:0') 
Std:  tensor(107.6249, device='cuda:0') 
ABS Max:  tensor(1907.5953, device='cuda:0') 
ABS Min:  tensor(0.0014, device='cuda:0')
Criterion check:  tensor([1.0016, 1.0002, 1.0022, 0.9972, 0.9995, 1.0059, 0.9869, 0.9950, 1.0104,
        0.9993], device='cuda:0') tensor(232, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(4.0196e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(3.8407, device='cuda:0')
min of grad d_p:  tensor(-0.6271, device='cuda:0')
max|min: (J_L, Jta/N)  (3.8406739234924316, 3.8395702838897705, ratio: 0.9997126460075378)|(-0.6271497011184692, -0.6264870762825012)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0011, device='cuda:0') mean:  tensor(-1.2616e-07, device='cuda:0') min:  tensor(-0.0008, device='cuda:0') norm:  tensor(0.0117, device='cuda:0') MSE:  tensor(1.4696e-08, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0284, device='cuda:0') mean:  tensor(9.6301e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1952, device='cuda:0') MSE:  tensor(2.4600e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0045, device='cuda:0')
min of d_p_list:  tensor(-0.0055, device='cuda:0')
Epoch:  88  
Training Loss: 0.17591115832328796
Test Loss:  0.18443793058395386
Test Acc:  0.0
Valid Loss:  0.14951887726783752
Valid Acc:  0.0
std:  0.0011349843804524355 
thres:  0.00017508013248443606
Preserved_eigens number check:  512
  9%|▉         | 88/1000 [21:37<3:43:55, 14.73s/it]Epoch:   89
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.2480, device='cuda:0') 
Std:  tensor(22.4896, device='cuda:0') 
ABS Max:  tensor(208.4618, device='cuda:0') 
ABS Min:  tensor(0.0062, device='cuda:0')
Criterion check:  tensor([1.0046, 1.0020, 0.9935, 1.0011, 1.0004, 0.9863, 1.0225, 0.7357, 1.0035,
        0.9985], device='cuda:0') tensor(256, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0015, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(3.8958, device='cuda:0')
min of grad d_p:  tensor(-0.6313, device='cuda:0')
max|min: (J_L, Jta/N)  (3.8957839012145996, 3.8957626819610596, ratio: 0.9999945759773254)|(-0.6312564015388489, -0.6312646865844727)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.1219e-05, device='cuda:0') mean:  tensor(3.5095e-09, device='cuda:0') min:  tensor(-4.8429e-05, device='cuda:0') norm:  tensor(0.0002, device='cuda:0') MSE:  tensor(2.4383e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0088, device='cuda:0') mean:  tensor(3.8624e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0907, device='cuda:0') MSE:  tensor(1.1424e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0066, device='cuda:0')
min of d_p_list:  tensor(-0.0261, device='cuda:0')
Epoch:  89  
Training Loss: 0.17324349284172058
Test Loss:  0.18178898096084595
Test Acc:  0.0
Valid Loss:  0.14829382300376892
Valid Acc:  0.0
std:  0.0013602929750242995 
thres:  0.0001747741520404816
Preserved_eigens number check:  512
  9%|▉         | 89/1000 [21:51<3:43:35, 14.73s/it]Epoch:   90
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.7706, device='cuda:0') 
Std:  tensor(27.5964, device='cuda:0') 
ABS Max:  tensor(462.6959, device='cuda:0') 
ABS Min:  tensor(0.0057, device='cuda:0')
Criterion check:  tensor([1.0009, 0.9996, 0.9982, 0.9998, 1.0007, 0.9993, 0.9956, 1.0440, 1.0015,
        0.9986], device='cuda:0') tensor(241, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0005, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(4.1543, device='cuda:0')
min of grad d_p:  tensor(-0.6791, device='cuda:0')
max|min: (J_L, Jta/N)  (4.154349327087402, 4.1543474197387695, ratio: 0.9999995231628418)|(-0.6791411638259888, -0.6791372895240784)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.6741e-05, device='cuda:0') mean:  tensor(-4.3780e-10, device='cuda:0') min:  tensor(-7.6513e-06, device='cuda:0') norm:  tensor(0.0001, device='cuda:0') MSE:  tensor(1.6159e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0056, device='cuda:0') mean:  tensor(4.1719e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0773, device='cuda:0') MSE:  tensor(9.7428e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0043, device='cuda:0')
min of d_p_list:  tensor(-0.0159, device='cuda:0')
Epoch:  90  
Training Loss: 0.17219278216362
Test Loss:  0.18079639971256256
Test Acc:  0.0
Valid Loss:  0.1482209712266922
Valid Acc:  0.0
std:  0.0017102919368825306 
thres:  0.0001744212508201599
Preserved_eigens number check:  512
  9%|▉         | 90/1000 [22:06<3:43:12, 14.72s/it]Epoch:   91
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-1.5590, device='cuda:0') 
Std:  tensor(24.7946, device='cuda:0') 
ABS Max:  tensor(438.8825, device='cuda:0') 
ABS Min:  tensor(0.0061, device='cuda:0')
Criterion check:  tensor([0.9986, 0.9986, 1.0007, 1.0020, 0.9998, 0.9995, 0.9986, 0.9951, 0.9998,
        0.9990], device='cuda:0') tensor(228, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0031, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(4.3449, device='cuda:0')
min of grad d_p:  tensor(-0.6911, device='cuda:0')
max|min: (J_L, Jta/N)  (4.344869613647461, 4.34451961517334, ratio: 0.9999194741249084)|(-0.6910500526428223, -0.6909967660903931)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(-5.3219e-08, device='cuda:0') min:  tensor(-0.0001, device='cuda:0') norm:  tensor(0.0040, device='cuda:0') MSE:  tensor(5.0973e-09, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0067, device='cuda:0') mean:  tensor(4.1599e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0642, device='cuda:0') MSE:  tensor(8.0932e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0721, device='cuda:0')
min of d_p_list:  tensor(-0.0353, device='cuda:0')
Epoch:  91  
Training Loss: 0.16779059171676636
Test Loss:  0.1758023500442505
Test Acc:  0.0
Valid Loss:  0.14297589659690857
Valid Acc:  0.0
std:  0.003187948510107971 
thres:  0.00017319387793540955
Preserved_eigens number check:  512
  9%|▉         | 91/1000 [22:21<3:43:34, 14.76s/it]Epoch:   92
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.3961, device='cuda:0') 
Std:  tensor(56.2518, device='cuda:0') 
ABS Max:  tensor(817.9886, device='cuda:0') 
ABS Min:  tensor(0.0033, device='cuda:0')
Criterion check:  tensor([0.9993, 0.9983, 0.9995, 0.9998, 0.9987, 1.0145, 0.9983, 1.0002, 1.0045,
        1.0008], device='cuda:0') tensor(256, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0001, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(3.9457, device='cuda:0')
min of grad d_p:  tensor(-0.7337, device='cuda:0')
max|min: (J_L, Jta/N)  (3.945678234100342, 3.945478677749634, ratio: 0.9999493956565857)|(-0.733672559261322, -0.7334343791007996)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0004, device='cuda:0') mean:  tensor(2.7860e-08, device='cuda:0') min:  tensor(-0.0002, device='cuda:0') norm:  tensor(0.0095, device='cuda:0') MSE:  tensor(1.1955e-08, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0023, device='cuda:0') mean:  tensor(4.0717e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0679, device='cuda:0') MSE:  tensor(8.5569e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0133, device='cuda:0')
min of d_p_list:  tensor(-0.0230, device='cuda:0')
Epoch:  92  
Training Loss: 0.1666993796825409
Test Loss:  0.17464768886566162
Test Acc:  0.0
Valid Loss:  0.14356133341789246
Valid Acc:  0.0
std:  0.0034418266314519405 
thres:  0.00017116748094558716
Preserved_eigens number check:  512
  9%|▉         | 92/1000 [22:36<3:43:23, 14.76s/it]Epoch:   93
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-276.3203, device='cuda:0') 
Std:  tensor(5883.9360, device='cuda:0') 
ABS Max:  tensor(132434.6250, device='cuda:0') 
ABS Min:  tensor(0.0125, device='cuda:0')
Criterion check:  tensor([1.0155, 1.0004, 0.9503, 0.9878, 0.9901, 0.9753, 0.9994, 1.0286, 1.0124,
        0.9917], device='cuda:0') tensor(266, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0004, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(4.1740, device='cuda:0')
min of grad d_p:  tensor(-0.7175, device='cuda:0')
max|min: (J_L, Jta/N)  (4.173974990844727, 4.175844669342041, ratio: 1.0004479885101318)|(-0.7175170183181763, -0.7176001071929932)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0006, device='cuda:0') mean:  tensor(-2.3820e-08, device='cuda:0') min:  tensor(-0.0215, device='cuda:0') norm:  tensor(0.0376, device='cuda:0') MSE:  tensor(4.7316e-08, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.1028, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.2609, device='cuda:0') MSE:  tensor(3.2877e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0683, device='cuda:0')
min of d_p_list:  tensor(-0.0682, device='cuda:0')
Epoch:  93  
Training Loss: 0.17955917119979858
Test Loss:  0.18922275304794312
Test Acc:  0.0
Valid Loss:  0.15274578332901
Valid Acc:  0.0
std:  0.0045713727363744525 
thres:  0.0001718970835208893
Preserved_eigens number check:  512
  9%|▉         | 93/1000 [22:51<3:43:10, 14.76s/it]Epoch:   94
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-55.3095, device='cuda:0') 
Std:  tensor(1044.8809, device='cuda:0') 
ABS Max:  tensor(22743.9883, device='cuda:0') 
ABS Min:  tensor(0.0288, device='cuda:0')
Criterion check:  tensor([0.9988, 1.0019, 0.7641, 0.9929, 0.9982, 1.0204, 0.9971, 1.0024, 0.9849,
        1.0205], device='cuda:0') tensor(264, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0020, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(4.5331, device='cuda:0')
min of grad d_p:  tensor(-0.8516, device='cuda:0')
max|min: (J_L, Jta/N)  (4.533052921295166, 4.532991886138916, ratio: 0.9999865293502808)|(-0.8515514135360718, -0.851539671421051)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(-1.0482e-08, device='cuda:0') min:  tensor(-3.3677e-05, device='cuda:0') norm:  tensor(0.0007, device='cuda:0') MSE:  tensor(9.3937e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.1397, device='cuda:0') mean:  tensor(0.0002, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.3838, device='cuda:0') MSE:  tensor(4.8363e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0053, device='cuda:0')
min of d_p_list:  tensor(-0.0108, device='cuda:0')
Epoch:  94  
Training Loss: 0.17662999033927917
Test Loss:  0.1855984628200531
Test Acc:  0.0
Valid Loss:  0.15126875042915344
Valid Acc:  0.0
std:  0.004955424488507201 
thres:  0.000172574383020401
Preserved_eigens number check:  512
  9%|▉         | 94/1000 [23:05<3:42:30, 14.74s/it]Epoch:   95
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-1.2659, device='cuda:0') 
Std:  tensor(29.4463, device='cuda:0') 
ABS Max:  tensor(377.7912, device='cuda:0') 
ABS Min:  tensor(0.0046, device='cuda:0')
Criterion check:  tensor([1.0017, 1.0005, 1.0096, 1.0013, 1.0001, 0.9801, 1.0004, 1.0001, 0.9988,
        0.9963], device='cuda:0') tensor(235, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0015, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(4.4717, device='cuda:0')
min of grad d_p:  tensor(-0.8140, device='cuda:0')
max|min: (J_L, Jta/N)  (4.47166109085083, 4.471566200256348, ratio: 0.99997878074646)|(-0.8139930963516235, -0.8139098286628723)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0003, device='cuda:0') mean:  tensor(-2.4161e-08, device='cuda:0') min:  tensor(-8.3625e-05, device='cuda:0') norm:  tensor(0.0019, device='cuda:0') MSE:  tensor(2.4497e-09, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0608, device='cuda:0') mean:  tensor(0.0002, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.4577, device='cuda:0') MSE:  tensor(5.7676e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0211, device='cuda:0')
min of d_p_list:  tensor(-0.0071, device='cuda:0')
Epoch:  95  
Training Loss: 0.17464250326156616
Test Loss:  0.18348808586597443
Test Acc:  0.0
Valid Loss:  0.15034058690071106
Valid Acc:  0.0
std:  0.005014228449780899 
thres:  0.00017306432723999024
Preserved_eigens number check:  512
 10%|▉         | 95/1000 [23:20<3:41:55, 14.71s/it]Epoch:   96
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-10.5647, device='cuda:0') 
Std:  tensor(184.4101, device='cuda:0') 
ABS Max:  tensor(3789.3147, device='cuda:0') 
ABS Min:  tensor(0.0020, device='cuda:0')
Criterion check:  tensor([0.9994, 0.9982, 0.9870, 0.9981, 1.0006, 1.0015, 0.9975, 1.0005, 1.0004,
        0.9936], device='cuda:0') tensor(238, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0002, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(4.4368, device='cuda:0')
min of grad d_p:  tensor(-0.8419, device='cuda:0')
max|min: (J_L, Jta/N)  (4.436829566955566, 4.4368391036987305, ratio: 1.000002145767212)|(-0.8418522477149963, -0.8418561220169067)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.7732e-05, device='cuda:0') mean:  tensor(1.7499e-09, device='cuda:0') min:  tensor(-9.5367e-06, device='cuda:0') norm:  tensor(8.8907e-05, device='cuda:0') MSE:  tensor(1.1203e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0099, device='cuda:0') mean:  tensor(2.5963e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0471, device='cuda:0') MSE:  tensor(5.9300e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0055, device='cuda:0')
min of d_p_list:  tensor(-0.0104, device='cuda:0')
Epoch:  96  
Training Loss: 0.17166100442409515
Test Loss:  0.18050363659858704
Test Acc:  0.0
Valid Loss:  0.1483173668384552
Valid Acc:  0.0
std:  0.00440166887406694 
thres:  0.000173838409781456
Preserved_eigens number check:  512
 10%|▉         | 96/1000 [23:35<3:41:28, 14.70s/it]Epoch:   97
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(2.6930, device='cuda:0') 
Std:  tensor(46.4492, device='cuda:0') 
ABS Max:  tensor(994.1410, device='cuda:0') 
ABS Min:  tensor(0.0022, device='cuda:0')
Criterion check:  tensor([1.0006, 0.9987, 0.9848, 0.9995, 1.0006, 0.9971, 1.0003, 0.9995, 1.0001,
        1.0009], device='cuda:0') tensor(232, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0001, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(4.5390, device='cuda:0')
min of grad d_p:  tensor(-0.8813, device='cuda:0')
max|min: (J_L, Jta/N)  (4.539017200469971, 4.539030075073242, ratio: 1.0000028610229492)|(-0.8813332319259644, -0.8813402056694031)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.6941e-05, device='cuda:0') mean:  tensor(5.3779e-09, device='cuda:0') min:  tensor(-1.2875e-05, device='cuda:0') norm:  tensor(0.0002, device='cuda:0') MSE:  tensor(2.5459e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0127, device='cuda:0') mean:  tensor(2.2446e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0412, device='cuda:0') MSE:  tensor(5.1876e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0147, device='cuda:0')
min of d_p_list:  tensor(-0.0332, device='cuda:0')
Epoch:  97  
Training Loss: 0.16814333200454712
Test Loss:  0.1765662282705307
Test Acc:  0.0
Valid Loss:  0.14624714851379395
Valid Acc:  0.0
std:  0.003947774179327606 
thres:  0.00017412720024585724
Preserved_eigens number check:  512
 10%|▉         | 97/1000 [23:49<3:41:01, 14.69s/it]Epoch:   98
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.1150, device='cuda:0') 
Std:  tensor(21.0434, device='cuda:0') 
ABS Max:  tensor(270.2570, device='cuda:0') 
ABS Min:  tensor(0.0008, device='cuda:0')
Criterion check:  tensor([0.9999, 0.9994, 1.0293, 1.0017, 0.9915, 0.9909, 0.9993, 1.0061, 1.0140,
        0.9961], device='cuda:0') tensor(269, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0020, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(4.6203, device='cuda:0')
min of grad d_p:  tensor(-0.9305, device='cuda:0')
max|min: (J_L, Jta/N)  (4.62031364440918, 4.620373725891113, ratio: 1.000012993812561)|(-0.9304925799369812, -0.9304951429367065)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.8448e-05, device='cuda:0') mean:  tensor(8.1660e-09, device='cuda:0') min:  tensor(-0.0002, device='cuda:0') norm:  tensor(0.0005, device='cuda:0') MSE:  tensor(6.6656e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0084, device='cuda:0') mean:  tensor(5.4750e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0930, device='cuda:0') MSE:  tensor(1.1723e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0039, device='cuda:0')
min of d_p_list:  tensor(-0.0244, device='cuda:0')
Epoch:  98  
Training Loss: 0.1674436628818512
Test Loss:  0.17566299438476562
Test Acc:  0.0
Valid Loss:  0.1459234207868576
Valid Acc:  0.0
std:  0.0035701781397006146 
thres:  0.00017170409858226776
Preserved_eigens number check:  512
 10%|▉         | 98/1000 [24:04<3:40:48, 14.69s/it]Epoch:   99
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(1.0818, device='cuda:0') 
Std:  tensor(20.2013, device='cuda:0') 
ABS Max:  tensor(276.6535, device='cuda:0') 
ABS Min:  tensor(0.0022, device='cuda:0')
Criterion check:  tensor([0.9995, 1.0002, 0.9712, 0.9993, 0.9981, 1.0024, 1.0008, 1.0031, 0.6659,
        1.0018], device='cuda:0') tensor(254, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0003, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(4.8124, device='cuda:0')
min of grad d_p:  tensor(-0.9768, device='cuda:0')
max|min: (J_L, Jta/N)  (4.812412738800049, 4.812415599822998, ratio: 1.0000005960464478)|(-0.9767734408378601, -0.9767661094665527)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.1723e-05, device='cuda:0') mean:  tensor(-5.0456e-09, device='cuda:0') min:  tensor(-1.0014e-05, device='cuda:0') norm:  tensor(0.0002, device='cuda:0') MSE:  tensor(2.2061e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0053, device='cuda:0') mean:  tensor(2.3650e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0455, device='cuda:0') MSE:  tensor(5.7280e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0046, device='cuda:0')
min of d_p_list:  tensor(-0.0218, device='cuda:0')
Epoch:  99  
Training Loss: 0.16603118181228638
Test Loss:  0.17399689555168152
Test Acc:  0.0
Valid Loss:  0.14464837312698364
Valid Acc:  0.0
std:  0.003136287180248412 
thres:  0.0001695843368768692
Preserved_eigens number check:  512
 10%|▉         | 99/1000 [24:18<3:40:05, 14.66s/it]Epoch:   100
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(0.4962, device='cuda:0') 
Std:  tensor(28.7477, device='cuda:0') 
ABS Max:  tensor(424.4896, device='cuda:0') 
ABS Min:  tensor(0.0006, device='cuda:0')
Criterion check:  tensor([0.9962, 0.9992, 1.0028, 0.9999, 1.0227, 1.0016, 1.0013, 1.0045, 0.9841,
        1.0026], device='cuda:0') tensor(242, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0002, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(4.9783, device='cuda:0')
min of grad d_p:  tensor(-0.9530, device='cuda:0')
max|min: (J_L, Jta/N)  (4.978251934051514, 4.978323459625244, ratio: 1.0000144243240356)|(-0.9529851675033569, -0.9529738426208496)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.9252e-05, device='cuda:0') mean:  tensor(-1.3437e-08, device='cuda:0') min:  tensor(-0.0002, device='cuda:0') norm:  tensor(0.0008, device='cuda:0') MSE:  tensor(1.0703e-09, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0028, device='cuda:0') mean:  tensor(3.7934e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0656, device='cuda:0') MSE:  tensor(8.2613e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0116, device='cuda:0')
min of d_p_list:  tensor(-0.0054, device='cuda:0')
Epoch:  100  
Training Loss: 0.166256844997406
Test Loss:  0.17435768246650696
Test Acc:  0.0
Valid Loss:  0.14479337632656097
Valid Acc:  0.0
std:  0.0020300142124089855 
thres:  0.0001679072052240372
Preserved_eigens number check:  512
 10%|█         | 100/1000 [24:33<3:39:59, 14.67s/it]Epoch:   101
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(3.8750, device='cuda:0') 
Std:  tensor(266.4705, device='cuda:0') 
ABS Max:  tensor(4139.9307, device='cuda:0') 
ABS Min:  tensor(0.0178, device='cuda:0')
Criterion check:  tensor([0.9984, 1.0286, 0.8651, 0.9990, 1.0765, 1.0196, 0.9965, 0.9062, 1.1333,
        0.9918], device='cuda:0') tensor(277, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0007, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(4.9063, device='cuda:0')
min of grad d_p:  tensor(-0.9681, device='cuda:0')
max|min: (J_L, Jta/N)  (4.906254768371582, 4.906241416931152, ratio: 0.9999972581863403)|(-0.9681306481361389, -0.9681290984153748)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.3351e-05, device='cuda:0') mean:  tensor(1.1882e-09, device='cuda:0') min:  tensor(-4.7922e-05, device='cuda:0') norm:  tensor(0.0002, device='cuda:0') MSE:  tensor(2.4140e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0781, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.2599, device='cuda:0') MSE:  tensor(3.2755e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0217, device='cuda:0')
min of d_p_list:  tensor(-0.0067, device='cuda:0')
Epoch:  101  
Training Loss: 0.16846641898155212
Test Loss:  0.17704609036445618
Test Acc:  0.0
Valid Loss:  0.1472705602645874
Valid Acc:  0.0
std:  0.0009783071987069126 
thres:  0.00016726828813552858
Preserved_eigens number check:  512
 10%|█         | 101/1000 [24:48<3:40:09, 14.69s/it]Epoch:   102
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-6.3956, device='cuda:0') 
Std:  tensor(340.7774, device='cuda:0') 
ABS Max:  tensor(7362.4360, device='cuda:0') 
ABS Min:  tensor(0.0105, device='cuda:0')
Criterion check:  tensor([1.0044, 1.0060, 1.1112, 1.0011, 0.9968, 1.0076, 0.9951, 0.9733, 0.9524,
        0.9902], device='cuda:0') tensor(276, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0020, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(4.5523, device='cuda:0')
min of grad d_p:  tensor(-0.9444, device='cuda:0')
max|min: (J_L, Jta/N)  (4.552335739135742, 4.552917003631592, ratio: 1.0001276731491089)|(-0.9444007277488708, -0.9446765184402466)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0011, device='cuda:0') mean:  tensor(9.3095e-08, device='cuda:0') min:  tensor(-0.0006, device='cuda:0') norm:  tensor(0.0055, device='cuda:0') MSE:  tensor(6.9445e-09, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0906, device='cuda:0') mean:  tensor(0.0002, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.4223, device='cuda:0') MSE:  tensor(5.3219e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0165, device='cuda:0')
min of d_p_list:  tensor(-0.0315, device='cuda:0')
Epoch:  102  
Training Loss: 0.16317760944366455
Test Loss:  0.17081589996814728
Test Acc:  0.0
Valid Loss:  0.1414567232131958
Valid Acc:  0.0
std:  0.001778858912462735 
thres:  0.00016627514362335205
Preserved_eigens number check:  512
 10%|█         | 102/1000 [25:03<3:40:00, 14.70s/it]Epoch:   103
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-7.5428, device='cuda:0') 
Std:  tensor(211.1955, device='cuda:0') 
ABS Max:  tensor(4456.7251, device='cuda:0') 
ABS Min:  tensor(0.0328, device='cuda:0')
Criterion check:  tensor([0.9970, 0.9873, 0.4213, 0.9944, 0.9975, 1.0238, 1.0004, 1.0041, 1.1099,
        0.9001], device='cuda:0') tensor(253, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0003, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(5.1830, device='cuda:0')
min of grad d_p:  tensor(-0.9835, device='cuda:0')
max|min: (J_L, Jta/N)  (5.1829633712768555, 5.185649394989014, ratio: 1.0005182027816772)|(-0.9834849834442139, -0.9834801554679871)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0041, device='cuda:0') mean:  tensor(1.0927e-07, device='cuda:0') min:  tensor(-0.0027, device='cuda:0') norm:  tensor(0.0161, device='cuda:0') MSE:  tensor(2.0261e-08, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0215, device='cuda:0') mean:  tensor(8.3407e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1604, device='cuda:0') MSE:  tensor(2.0210e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0025, device='cuda:0')
min of d_p_list:  tensor(-0.0029, device='cuda:0')
Epoch:  103  
Training Loss: 0.16311797499656677
Test Loss:  0.17078502476215363
Test Acc:  0.0
Valid Loss:  0.14152956008911133
Valid Acc:  0.0
std:  0.0020337972611120846 
thres:  0.00016541000604629517
Preserved_eigens number check:  512
 10%|█         | 103/1000 [25:17<3:39:43, 14.70s/it]Epoch:   104
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(3.5874, device='cuda:0') 
Std:  tensor(162.5548, device='cuda:0') 
ABS Max:  tensor(3051.6074, device='cuda:0') 
ABS Min:  tensor(0.0007, device='cuda:0')
Criterion check:  tensor([0.9942, 1.0186, 0.2610, 1.0020, 0.9987, 1.0029, 1.0000, 1.0226, 0.9619,
        0.9954], device='cuda:0') tensor(256, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(3.3005e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(5.1047, device='cuda:0')
min of grad d_p:  tensor(-0.9748, device='cuda:0')
max|min: (J_L, Jta/N)  (5.104724407196045, 5.104761123657227, ratio: 1.000007152557373)|(-0.9748229384422302, -0.9748262763023376)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.4484e-05, device='cuda:0') mean:  tensor(1.5270e-09, device='cuda:0') min:  tensor(-0.0001, device='cuda:0') norm:  tensor(0.0003, device='cuda:0') MSE:  tensor(4.3954e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0660, device='cuda:0') mean:  tensor(5.5033e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1572, device='cuda:0') MSE:  tensor(1.9812e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0025, device='cuda:0')
min of d_p_list:  tensor(-0.0069, device='cuda:0')
Epoch:  104  
Training Loss: 0.1622210443019867
Test Loss:  0.1697518527507782
Test Acc:  0.0
Valid Loss:  0.14051330089569092
Valid Acc:  0.0
std:  0.002347843461624506 
thres:  0.00016464797854423525
Preserved_eigens number check:  512
 10%|█         | 104/1000 [25:32<3:39:35, 14.70s/it]Epoch:   105
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-6.8699, device='cuda:0') 
Std:  tensor(124.0232, device='cuda:0') 
ABS Max:  tensor(2725.5605, device='cuda:0') 
ABS Min:  tensor(0.0351, device='cuda:0')
Criterion check:  tensor([0.9998, 0.9953, 0.7607, 1.0002, 1.0002, 0.9954, 0.9973, 0.9900, 0.9902,
        1.0015], device='cuda:0') tensor(251, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0018, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(5.2033, device='cuda:0')
min of grad d_p:  tensor(-0.9848, device='cuda:0')
max|min: (J_L, Jta/N)  (5.203253746032715, 5.203210353851318, ratio: 0.9999916553497314)|(-0.9847662448883057, -0.9847588539123535)

 check Jacobi res:  torch.Size([793601]) max:  tensor(9.2864e-05, device='cuda:0') mean:  tensor(-7.6195e-10, device='cuda:0') min:  tensor(-1.8716e-05, device='cuda:0') norm:  tensor(0.0003, device='cuda:0') MSE:  tensor(3.7054e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0091, device='cuda:0') mean:  tensor(2.7801e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0558, device='cuda:0') MSE:  tensor(7.0323e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0453, device='cuda:0')
min of d_p_list:  tensor(-0.0498, device='cuda:0')
Epoch:  105  
Training Loss: 0.16108755767345428
Test Loss:  0.16926780343055725
Test Acc:  0.0
Valid Loss:  0.14066043496131897
Valid Acc:  0.0
std:  0.0025418766227693016 
thres:  0.0001636141210794449
Preserved_eigens number check:  512
 10%|█         | 105/1000 [25:47<3:39:17, 14.70s/it]Epoch:   106
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(0.8166, device='cuda:0') 
Std:  tensor(18.1842, device='cuda:0') 
ABS Max:  tensor(258.3655, device='cuda:0') 
ABS Min:  tensor(0.0026, device='cuda:0')
Criterion check:  tensor([1.0003, 0.9973, 0.9960, 1.0284, 0.9995, 0.9978, 0.9993, 1.0015, 0.9985,
        0.9967], device='cuda:0') tensor(213, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0029, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(5.9334, device='cuda:0')
min of grad d_p:  tensor(-1.0046, device='cuda:0')
max|min: (J_L, Jta/N)  (5.933442115783691, 5.933434963226318, ratio: 0.9999988079071045)|(-1.004563570022583, -1.0045573711395264)

 check Jacobi res:  torch.Size([793601]) max:  tensor(7.1526e-06, device='cuda:0') mean:  tensor(-2.7620e-09, device='cuda:0') min:  tensor(-1.9103e-05, device='cuda:0') norm:  tensor(0.0001, device='cuda:0') MSE:  tensor(1.4867e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0019, device='cuda:0') mean:  tensor(1.5010e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0236, device='cuda:0') MSE:  tensor(2.9791e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0046, device='cuda:0')
min of d_p_list:  tensor(-0.0025, device='cuda:0')
Epoch:  106  
Training Loss: 0.16031795740127563
Test Loss:  0.16805598139762878
Test Acc:  0.0
Valid Loss:  0.13957113027572632
Valid Acc:  0.0
std:  0.0011265965262102383 
thres:  0.0001619844287633896
Preserved_eigens number check:  512
 11%|█         | 106/1000 [26:01<3:38:53, 14.69s/it]Epoch:   107
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(0.2465, device='cuda:0') 
Std:  tensor(79.2326, device='cuda:0') 
ABS Max:  tensor(1479.9730, device='cuda:0') 
ABS Min:  tensor(0.0387, device='cuda:0')
Criterion check:  tensor([1.0020, 1.0007, 1.0090, 1.0469, 1.0000, 1.0039, 1.0028, 1.0013, 1.0091,
        1.0238], device='cuda:0') tensor(265, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0015, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(5.9670, device='cuda:0')
min of grad d_p:  tensor(-1.0222, device='cuda:0')
max|min: (J_L, Jta/N)  (5.967036247253418, 5.965880393981934, ratio: 0.99980628490448)|(-1.0222291946411133, -1.0219852924346924)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0012, device='cuda:0') mean:  tensor(-4.5416e-07, device='cuda:0') min:  tensor(-0.0052, device='cuda:0') norm:  tensor(0.0168, device='cuda:0') MSE:  tensor(2.1114e-08, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0127, device='cuda:0') mean:  tensor(8.5449e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1355, device='cuda:0') MSE:  tensor(1.7072e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0035, device='cuda:0')
min of d_p_list:  tensor(-0.0072, device='cuda:0')
Epoch:  107  
Training Loss: 0.15981104969978333
Test Loss:  0.16721944510936737
Test Acc:  0.0
Valid Loss:  0.138691708445549
Valid Acc:  0.0
std:  0.0012148456840982863 
thres:  0.00016131111681461335
Preserved_eigens number check:  512
 11%|█         | 107/1000 [26:16<3:38:53, 14.71s/it]Epoch:   108
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(3.6078, device='cuda:0') 
Std:  tensor(138.3006, device='cuda:0') 
ABS Max:  tensor(2301.6946, device='cuda:0') 
ABS Min:  tensor(0.0006, device='cuda:0')
Criterion check:  tensor([0.9971, 1.0048, 0.9860, 1.0260, 1.0012, 1.0020, 0.9925, 0.9169, 0.9458,
        0.9394], device='cuda:0') tensor(272, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0007, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(6.1781, device='cuda:0')
min of grad d_p:  tensor(-1.0406, device='cuda:0')
max|min: (J_L, Jta/N)  (6.178130149841309, 6.178127288818359, ratio: 0.9999995231628418)|(-1.0406138896942139, -1.0406142473220825)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.4544e-05, device='cuda:0') mean:  tensor(6.5704e-10, device='cuda:0') min:  tensor(-7.6629e-06, device='cuda:0') norm:  tensor(7.1064e-05, device='cuda:0') MSE:  tensor(8.9546e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0293, device='cuda:0') mean:  tensor(8.6056e-05, device='cuda:0') min:  tensor(3.6816e-13, device='cuda:0') norm:  tensor(0.1462, device='cuda:0') MSE:  tensor(1.8421e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0418, device='cuda:0')
min of d_p_list:  tensor(-0.0352, device='cuda:0')
Epoch:  108  
Training Loss: 0.16099819540977478
Test Loss:  0.16961075365543365
Test Acc:  0.0
Valid Loss:  0.1397455781698227
Valid Acc:  0.0
std:  0.0008140934095617335 
thres:  0.00016088716089725493
Preserved_eigens number check:  512
**************************************************learning rate decay**************************************************
 11%|█         | 108/1000 [26:31<3:38:39, 14.71s/it]Epoch:   109
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-2.5278, device='cuda:0') 
Std:  tensor(60.5316, device='cuda:0') 
ABS Max:  tensor(1334.4572, device='cuda:0') 
ABS Min:  tensor(0.0008, device='cuda:0')
Criterion check:  tensor([0.9998, 1.0001, 0.9996, 0.9999, 1.0006, 0.9991, 1.0002, 0.9971, 0.9973,
        1.0010], device='cuda:0') tensor(230, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0004, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(5.3037, device='cuda:0')
min of grad d_p:  tensor(-0.9486, device='cuda:0')
max|min: (J_L, Jta/N)  (5.303664207458496, 5.303670883178711, ratio: 1.000001311302185)|(-0.9485998749732971, -0.948592483997345)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.3351e-05, device='cuda:0') mean:  tensor(1.0175e-09, device='cuda:0') min:  tensor(-1.0125e-05, device='cuda:0') norm:  tensor(0.0002, device='cuda:0') MSE:  tensor(2.2792e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0201, device='cuda:0') mean:  tensor(3.8809e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0689, device='cuda:0') MSE:  tensor(8.6767e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0022, device='cuda:0')
min of d_p_list:  tensor(-0.0023, device='cuda:0')
Epoch:  109  
Training Loss: 0.16053952276706696
Test Loss:  0.1688709706068039
Test Acc:  0.0
Valid Loss:  0.139322429895401
Valid Acc:  0.0
local minima detector shape:  (0,)
Preserved_eigens number check:  512
 11%|█         | 109/1000 [26:46<3:38:35, 14.72s/it]Epoch:   110
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-2.3906, device='cuda:0') 
Std:  tensor(37.6835, device='cuda:0') 
ABS Max:  tensor(605.0357, device='cuda:0') 
ABS Min:  tensor(0.0006, device='cuda:0')
Criterion check:  tensor([1.0003, 1.0006, 1.0039, 1.0008, 0.9995, 1.0012, 0.9997, 1.0037, 1.0060,
        1.0170], device='cuda:0') tensor(252, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0023, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(5.3408, device='cuda:0')
min of grad d_p:  tensor(-0.9540, device='cuda:0')
max|min: (J_L, Jta/N)  (5.3408074378967285, 5.340787410736084, ratio: 0.9999962449073792)|(-0.9539681673049927, -0.9539294838905334)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(-3.6791e-09, device='cuda:0') min:  tensor(-0.0016, device='cuda:0') norm:  tensor(0.0060, device='cuda:0') MSE:  tensor(7.5128e-09, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0087, device='cuda:0') mean:  tensor(3.6743e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0640, device='cuda:0') MSE:  tensor(8.0703e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0017, device='cuda:0')
min of d_p_list:  tensor(-0.0057, device='cuda:0')
Epoch:  110  
Training Loss: 0.15998655557632446
Test Loss:  0.1680133193731308
Test Acc:  0.0
Valid Loss:  0.13876023888587952
Valid Acc:  0.0
local minima detector shape:  (1,)
Preserved_eigens number check:  512
 11%|█         | 110/1000 [27:00<3:38:36, 14.74s/it]Epoch:   111
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-2.3265, device='cuda:0') 
Std:  tensor(36.9318, device='cuda:0') 
ABS Max:  tensor(427.0065, device='cuda:0') 
ABS Min:  tensor(0.0002, device='cuda:0')
Criterion check:  tensor([1.0014, 0.9954, 1.0002, 1.0011, 0.9993, 0.9949, 1.0013, 1.0054, 1.0099,
        0.9984], device='cuda:0') tensor(254, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0023, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(5.3465, device='cuda:0')
min of grad d_p:  tensor(-0.9449, device='cuda:0')
max|min: (J_L, Jta/N)  (5.3465046882629395, 5.346642017364502, ratio: 1.0000256299972534)|(-0.944939374923706, -0.945392370223999)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0035, device='cuda:0') mean:  tensor(5.2257e-07, device='cuda:0') min:  tensor(-0.0003, device='cuda:0') norm:  tensor(0.0155, device='cuda:0') MSE:  tensor(1.9535e-08, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0093, device='cuda:0') mean:  tensor(5.5917e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1150, device='cuda:0') MSE:  tensor(1.4491e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0142, device='cuda:0')
min of d_p_list:  tensor(-0.0494, device='cuda:0')
Epoch:  111  
Training Loss: 0.1600438505411148
Test Loss:  0.16772428154945374
Test Acc:  0.0
Valid Loss:  0.13849709928035736
Valid Acc:  0.0
local minima detector shape:  (2,)
Preserved_eigens number check:  512
 11%|█         | 111/1000 [27:15<3:38:01, 14.71s/it]Epoch:   112
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-1.7846, device='cuda:0') 
Std:  tensor(43.1529, device='cuda:0') 
ABS Max:  tensor(716.9993, device='cuda:0') 
ABS Min:  tensor(0.0094, device='cuda:0')
Criterion check:  tensor([0.9997, 0.9995, 1.0031, 1.0025, 0.9999, 1.0089, 1.0007, 0.9989, 0.9923,
        1.0019], device='cuda:0') tensor(254, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0012, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(5.7816, device='cuda:0')
min of grad d_p:  tensor(-0.8993, device='cuda:0')
max|min: (J_L, Jta/N)  (5.781579971313477, 5.776003837585449, ratio: 0.9990355372428894)|(-0.8992859125137329, -0.8970802426338196)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0056, device='cuda:0') mean:  tensor(-8.8298e-07, device='cuda:0') min:  tensor(-0.0041, device='cuda:0') norm:  tensor(0.0394, device='cuda:0') MSE:  tensor(4.9590e-08, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0878, device='cuda:0') mean:  tensor(0.0002, device='cuda:0') min:  tensor(6.0663e-14, device='cuda:0') norm:  tensor(0.3740, device='cuda:0') MSE:  tensor(4.7123e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0038, device='cuda:0')
min of d_p_list:  tensor(-0.0189, device='cuda:0')
Epoch:  112  
Training Loss: 0.1587481051683426
Test Loss:  0.16614970564842224
Test Acc:  0.0
Valid Loss:  0.13728004693984985
Valid Acc:  0.0
local minima detector shape:  (3,)
Preserved_eigens number check:  512
 11%|█         | 112/1000 [27:30<3:37:31, 14.70s/it]Epoch:   113
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(2.5239, device='cuda:0') 
Std:  tensor(32.7553, device='cuda:0') 
ABS Max:  tensor(567.2436, device='cuda:0') 
ABS Min:  tensor(0.0070, device='cuda:0')
Criterion check:  tensor([0.9994, 0.9994, 1.0018, 1.0019, 1.0004, 1.0011, 0.9994, 1.0007, 0.9881,
        0.9972], device='cuda:0') tensor(221, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0002, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(5.8662, device='cuda:0')
min of grad d_p:  tensor(-0.9014, device='cuda:0')
max|min: (J_L, Jta/N)  (5.866168022155762, 5.866116523742676, ratio: 0.999991238117218)|(-0.9013649821281433, -0.9013614058494568)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(2.9083e-09, device='cuda:0') min:  tensor(-1.6361e-05, device='cuda:0') norm:  tensor(0.0004, device='cuda:0') MSE:  tensor(5.5166e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0017, device='cuda:0') mean:  tensor(1.7902e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0305, device='cuda:0') MSE:  tensor(3.8493e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0018, device='cuda:0')
min of d_p_list:  tensor(-0.0014, device='cuda:0')
Epoch:  113  
Training Loss: 0.1582910716533661
Test Loss:  0.1656600832939148
Test Acc:  0.0
Valid Loss:  0.13687902688980103
Valid Acc:  0.0
local minima detector shape:  (4,)
Preserved_eigens number check:  512
 11%|█▏        | 113/1000 [27:45<3:38:34, 14.78s/it]Epoch:   114
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(6.3376, device='cuda:0') 
Std:  tensor(86.0416, device='cuda:0') 
ABS Max:  tensor(1629.3878, device='cuda:0') 
ABS Min:  tensor(0.0157, device='cuda:0')
Criterion check:  tensor([1.0017, 0.9983, 1.0121, 1.0016, 1.0000, 0.9962, 0.9996, 0.9987, 1.0227,
        1.0005], device='cuda:0') tensor(273, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0025, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(5.8453, device='cuda:0')
min of grad d_p:  tensor(-0.8923, device='cuda:0')
max|min: (J_L, Jta/N)  (5.845296859741211, 5.8436079025268555, ratio: 0.9997110366821289)|(-0.8923388123512268, -0.8931795358657837)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0030, device='cuda:0') mean:  tensor(1.6187e-07, device='cuda:0') min:  tensor(-0.0004, device='cuda:0') norm:  tensor(0.0171, device='cuda:0') MSE:  tensor(2.1499e-08, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0424, device='cuda:0') mean:  tensor(5.6373e-05, device='cuda:0') min:  tensor(1.4174e-13, device='cuda:0') norm:  tensor(0.1149, device='cuda:0') MSE:  tensor(1.4476e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0250, device='cuda:0')
min of d_p_list:  tensor(-0.0160, device='cuda:0')
Epoch:  114  
Training Loss: 0.1591554582118988
Test Loss:  0.16659337282180786
Test Acc:  0.0
Valid Loss:  0.13821019232273102
Valid Acc:  0.0
std:  0.0006859983025539579 
thres:  0.00015924500823020934
Preserved_eigens number check:  512
**************************************************learning rate decay**************************************************
 11%|█▏        | 114/1000 [28:00<3:39:31, 14.87s/it]Epoch:   115
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(5.7026, device='cuda:0') 
Std:  tensor(228.0595, device='cuda:0') 
ABS Max:  tensor(2456.8896, device='cuda:0') 
ABS Min:  tensor(0.0352, device='cuda:0')
Criterion check:  tensor([1.0070, 0.9993, 1.0319, 0.9872, 0.9998, 0.9871, 0.9995, 0.9692, 1.1753,
        1.0310], device='cuda:0') tensor(255, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0003, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(5.8204, device='cuda:0')
min of grad d_p:  tensor(-0.8667, device='cuda:0')
max|min: (J_L, Jta/N)  (5.820362091064453, 5.820397853851318, ratio: 1.0000061988830566)|(-0.8666977882385254, -0.8667008876800537)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.0742e-05, device='cuda:0') mean:  tensor(-2.1386e-10, device='cuda:0') min:  tensor(-0.0002, device='cuda:0') norm:  tensor(0.0005, device='cuda:0') MSE:  tensor(6.7156e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0395, device='cuda:0') mean:  tensor(0.0002, device='cuda:0') min:  tensor(6.6411e-14, device='cuda:0') norm:  tensor(0.3063, device='cuda:0') MSE:  tensor(3.8591e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.8156, device='cuda:0')
min of d_p_list:  tensor(-0.8945, device='cuda:0')
Epoch:  115  
Training Loss: 0.17522932589054108
Test Loss:  0.18448716402053833
Test Acc:  0.0
Valid Loss:  0.1534872204065323
Valid Acc:  0.0
local minima detector shape:  (0,)
Preserved_eigens number check:  512
 12%|█▏        | 115/1000 [28:14<3:38:35, 14.82s/it]Epoch:   116
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(11.6283, device='cuda:0') 
Std:  tensor(183.4425, device='cuda:0') 
ABS Max:  tensor(3145.5205, device='cuda:0') 
ABS Min:  tensor(0.0030, device='cuda:0')
Criterion check:  tensor([1.0007, 1.0036, 1.0019, 0.9991, 1.0114, 0.9994, 0.9970, 1.0001, 0.9993,
        1.0173], device='cuda:0') tensor(241, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0003, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(6.3146, device='cuda:0')
min of grad d_p:  tensor(-2.4401, device='cuda:0')
max|min: (J_L, Jta/N)  (6.314645290374756, 6.31463098526001, ratio: 0.9999977350234985)|(-2.440121650695801, -2.440122365951538)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.4305e-05, device='cuda:0') mean:  tensor(-2.7404e-09, device='cuda:0') min:  tensor(-5.8562e-06, device='cuda:0') norm:  tensor(9.9966e-05, device='cuda:0') MSE:  tensor(1.2597e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0058, device='cuda:0') mean:  tensor(4.4163e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0774, device='cuda:0') MSE:  tensor(9.7586e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0098, device='cuda:0')
min of d_p_list:  tensor(-0.0132, device='cuda:0')
Epoch:  116  
Training Loss: 0.17649982869625092
Test Loss:  0.18615448474884033
Test Acc:  0.0
Valid Loss:  0.1533520519733429
Valid Acc:  0.0
local minima detector shape:  (1,)
Preserved_eigens number check:  512
 12%|█▏        | 116/1000 [28:29<3:37:49, 14.78s/it]Epoch:   117
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(20.5865, device='cuda:0') 
Std:  tensor(613.1646, device='cuda:0') 
ABS Max:  tensor(12320.5693, device='cuda:0') 
ABS Min:  tensor(0.0089, device='cuda:0')
Criterion check:  tensor([0.9972, 1.0095, 1.0013, 1.0044, 1.3155, 1.0011, 0.9951, 0.9951, 0.9953,
        1.0106], device='cuda:0') tensor(270, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(2.7240e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(6.3425, device='cuda:0')
min of grad d_p:  tensor(-2.4103, device='cuda:0')
max|min: (J_L, Jta/N)  (6.3424530029296875, 6.3424458503723145, ratio: 0.9999988675117493)|(-2.410339832305908, -2.4103457927703857)

 check Jacobi res:  torch.Size([793601]) max:  tensor(7.1526e-06, device='cuda:0') mean:  tensor(3.2375e-10, device='cuda:0') min:  tensor(-3.0398e-06, device='cuda:0') norm:  tensor(5.5980e-05, device='cuda:0') MSE:  tensor(7.0539e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0714, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.2329, device='cuda:0') MSE:  tensor(2.9353e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0161, device='cuda:0')
min of d_p_list:  tensor(-0.0226, device='cuda:0')
Epoch:  117  
Training Loss: 0.18025794625282288
Test Loss:  0.18961885571479797
Test Acc:  0.0
Valid Loss:  0.15643584728240967
Valid Acc:  0.0
local minima detector shape:  (2,)
Preserved_eigens number check:  512
 12%|█▏        | 117/1000 [28:44<3:36:40, 14.72s/it]Epoch:   118
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(0.4837, device='cuda:0') 
Std:  tensor(9.5230, device='cuda:0') 
ABS Max:  tensor(91.7789, device='cuda:0') 
ABS Min:  tensor(0.0043, device='cuda:0')
Criterion check:  tensor([1.0000, 1.0006, 1.0003, 0.9997, 1.0076, 0.9994, 0.9993, 1.0013, 1.0031,
        1.0012], device='cuda:0') tensor(239, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0007, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(6.4778, device='cuda:0')
min of grad d_p:  tensor(-2.4863, device='cuda:0')
max|min: (J_L, Jta/N)  (6.477839469909668, 6.477853775024414, ratio: 1.0000022649765015)|(-2.486252784729004, -2.4862680435180664)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.5259e-05, device='cuda:0') mean:  tensor(7.4394e-10, device='cuda:0') min:  tensor(-1.4305e-05, device='cuda:0') norm:  tensor(0.0001, device='cuda:0') MSE:  tensor(1.4357e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0166, device='cuda:0') mean:  tensor(1.9482e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0362, device='cuda:0') MSE:  tensor(4.5652e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0143, device='cuda:0')
min of d_p_list:  tensor(-0.0387, device='cuda:0')
Epoch:  118  
Training Loss: 0.1835942566394806
Test Loss:  0.19268262386322021
Test Acc:  0.0
Valid Loss:  0.15884077548980713
Valid Acc:  0.0
local minima detector shape:  (3,)
Preserved_eigens number check:  512
 12%|█▏        | 118/1000 [28:58<3:35:32, 14.66s/it]Epoch:   119
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.6404, device='cuda:0') 
Std:  tensor(38.9267, device='cuda:0') 
ABS Max:  tensor(777.1646, device='cuda:0') 
ABS Min:  tensor(0.0032, device='cuda:0')
Criterion check:  tensor([0.9991, 1.0027, 1.0003, 1.0003, 1.0036, 1.0005, 0.9974, 1.0016, 1.0000,
        0.9966], device='cuda:0') tensor(232, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0016, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(6.6307, device='cuda:0')
min of grad d_p:  tensor(-2.4977, device='cuda:0')
max|min: (J_L, Jta/N)  (6.630746841430664, 6.63100004196167, ratio: 1.0000381469726562)|(-2.4976933002471924, -2.4978713989257812)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(3.0413e-08, device='cuda:0') min:  tensor(-0.0003, device='cuda:0') norm:  tensor(0.0027, device='cuda:0') MSE:  tensor(3.4505e-09, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0077, device='cuda:0') mean:  tensor(2.4182e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0398, device='cuda:0') MSE:  tensor(5.0204e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0049, device='cuda:0')
min of d_p_list:  tensor(-0.0089, device='cuda:0')
Epoch:  119  
Training Loss: 0.18610809743404388
Test Loss:  0.1948930025100708
Test Acc:  0.0
Valid Loss:  0.16056779026985168
Valid Acc:  0.0
local minima detector shape:  (4,)
Preserved_eigens number check:  512
 12%|█▏        | 119/1000 [29:13<3:34:54, 14.64s/it]Epoch:   120
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(-8.1516, device='cuda:0') 
Std:  tensor(287.2189, device='cuda:0') 
ABS Max:  tensor(5410.5024, device='cuda:0') 
ABS Min:  tensor(0.0295, device='cuda:0')
Criterion check:  tensor([1.0012, 0.9981, 0.9957, 1.0048, 1.0957, 0.9972, 1.0005, 0.9977, 0.9509,
        1.0073], device='cuda:0') tensor(285, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(1.2202e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(6.6296, device='cuda:0')
min of grad d_p:  tensor(-2.5886, device='cuda:0')
max|min: (J_L, Jta/N)  (6.629622459411621, 6.6296234130859375, ratio: 1.0000001192092896)|(-2.588566303253174, -2.5885424613952637)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.9802e-06, device='cuda:0') mean:  tensor(1.5783e-10, device='cuda:0') min:  tensor(-2.3842e-05, device='cuda:0') norm:  tensor(6.2947e-05, device='cuda:0') MSE:  tensor(7.9318e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0614, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.2386, device='cuda:0') MSE:  tensor(3.0070e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0018, device='cuda:0')
min of d_p_list:  tensor(-0.0027, device='cuda:0')
Epoch:  120  
Training Loss: 0.1882161796092987
Test Loss:  0.19686388969421387
Test Acc:  0.0
Valid Loss:  0.16200487315654755
Valid Acc:  0.0
std:  0.0041706611188077804 
thres:  0.0001829352617263794
Preserved_eigens number check:  512
 12%|█▏        | 120/1000 [29:27<3:33:09, 14.53s/it]Epoch:   121
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.2518, device='cuda:0') 
Std:  tensor(107.2649, device='cuda:0') 
ABS Max:  tensor(1561.2473, device='cuda:0') 
ABS Min:  tensor(0.0136, device='cuda:0')
Criterion check:  tensor([1.0001, 1.0012, 0.9986, 0.9996, 0.9693, 0.9996, 0.9974, 1.0020, 1.0028,
        1.0036], device='cuda:0') tensor(248, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0001, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(6.6227, device='cuda:0')
min of grad d_p:  tensor(-2.6105, device='cuda:0')
max|min: (J_L, Jta/N)  (6.622673988342285, 6.622733116149902, ratio: 1.0000089406967163)|(-2.6105124950408936, -2.6103572845458984)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.6272e-05, device='cuda:0') mean:  tensor(-7.8851e-10, device='cuda:0') min:  tensor(-0.0002, device='cuda:0') norm:  tensor(0.0004, device='cuda:0') MSE:  tensor(4.4971e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0116, device='cuda:0') mean:  tensor(2.7506e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0489, device='cuda:0') MSE:  tensor(6.1576e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0042, device='cuda:0')
min of d_p_list:  tensor(-0.0034, device='cuda:0')
Epoch:  121  
Training Loss: 0.18999922275543213
Test Loss:  0.19893968105316162
Test Acc:  0.0
Valid Loss:  0.16350869834423065
Valid Acc:  0.0
std:  0.003435406525620238 
thres:  0.00018563514053821563
Preserved_eigens number check:  512
 12%|█▏        | 121/1000 [29:42<3:32:33, 14.51s/it]Epoch:   122
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(0.5328, device='cuda:0') 
Std:  tensor(26.1719, device='cuda:0') 
ABS Max:  tensor(477.3128, device='cuda:0') 
ABS Min:  tensor(0.0032, device='cuda:0')
Criterion check:  tensor([1.0010, 0.9980, 1.0000, 1.0009, 1.0007, 1.0004, 1.0006, 0.9998, 0.9984,
        0.9949], device='cuda:0') tensor(229, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0016, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(6.6269, device='cuda:0')
min of grad d_p:  tensor(-2.5913, device='cuda:0')
max|min: (J_L, Jta/N)  (6.626875877380371, 6.626985549926758, ratio: 1.0000165700912476)|(-2.5913000106811523, -2.591313362121582)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.2458e-05, device='cuda:0') mean:  tensor(-1.5305e-08, device='cuda:0') min:  tensor(-0.0001, device='cuda:0') norm:  tensor(0.0008, device='cuda:0') MSE:  tensor(1.0372e-09, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0011, device='cuda:0') mean:  tensor(1.9637e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0300, device='cuda:0') MSE:  tensor(3.7864e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0139, device='cuda:0')
min of d_p_list:  tensor(-0.0181, device='cuda:0')
Epoch:  122  
Training Loss: 0.19128113985061646
Test Loss:  0.20060428977012634
Test Acc:  0.0
Valid Loss:  0.16479086875915527
Valid Acc:  0.0
std:  0.0027448504664281097 
thres:  0.00018783977925777436
Preserved_eigens number check:  512
 12%|█▏        | 122/1000 [29:56<3:32:23, 14.51s/it]Epoch:   123
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(16.1502, device='cuda:0') 
Std:  tensor(226.3799, device='cuda:0') 
ABS Max:  tensor(3372.7605, device='cuda:0') 
ABS Min:  tensor(0.0048, device='cuda:0')
Criterion check:  tensor([1.0029, 1.0042, 1.0017, 1.0017, 0.9269, 0.9986, 0.9989, 0.9998, 0.9974,
        1.0154], device='cuda:0') tensor(259, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0002, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(6.6077, device='cuda:0')
min of grad d_p:  tensor(-2.6773, device='cuda:0')
max|min: (J_L, Jta/N)  (6.6077046394348145, 6.607699871063232, ratio: 0.9999992847442627)|(-2.6772890090942383, -2.677288055419922)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.7684e-06, device='cuda:0') mean:  tensor(6.2649e-10, device='cuda:0') min:  tensor(-5.0291e-06, device='cuda:0') norm:  tensor(7.2447e-05, device='cuda:0') MSE:  tensor(9.1289e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0257, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1968, device='cuda:0') MSE:  tensor(2.4795e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0049, device='cuda:0')
min of d_p_list:  tensor(-0.0102, device='cuda:0')
Epoch:  123  
Training Loss: 0.19175037741661072
Test Loss:  0.20109954476356506
Test Acc:  0.0
Valid Loss:  0.16512912511825562
Valid Acc:  0.0
std:  0.0020801382091811473 
thres:  0.0001894710034132004
Preserved_eigens number check:  512
 12%|█▏        | 123/1000 [30:11<3:32:11, 14.52s/it]Epoch:   124
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.1326, device='cuda:0') 
Std:  tensor(5.4131, device='cuda:0') 
ABS Max:  tensor(59.6814, device='cuda:0') 
ABS Min:  tensor(0.0007, device='cuda:0')
Criterion check:  tensor([0.9993, 1.0013, 0.9999, 1.0002, 0.9616, 1.0002, 1.0006, 0.9999, 0.9982,
        0.9995], device='cuda:0') tensor(214, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0009, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(6.6782, device='cuda:0')
min of grad d_p:  tensor(-2.7381, device='cuda:0')
max|min: (J_L, Jta/N)  (6.678235054016113, 6.678228378295898, ratio: 0.9999989867210388)|(-2.738147735595703, -2.7381317615509033)

 check Jacobi res:  torch.Size([793601]) max:  tensor(6.6757e-06, device='cuda:0') mean:  tensor(8.8154e-10, device='cuda:0') min:  tensor(-1.5974e-05, device='cuda:0') norm:  tensor(7.4027e-05, device='cuda:0') MSE:  tensor(9.3280e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0171, device='cuda:0') mean:  tensor(7.0415e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1147, device='cuda:0') MSE:  tensor(1.4452e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0150, device='cuda:0')
min of d_p_list:  tensor(-0.0181, device='cuda:0')
Epoch:  124  
Training Loss: 0.192383274435997
Test Loss:  0.20188602805137634
Test Acc:  0.0
Valid Loss:  0.16569295525550842
Valid Acc:  0.0
std:  0.0014786136378975342 
thres:  0.00019072603881359102
Preserved_eigens number check:  512
 12%|█▏        | 124/1000 [30:25<3:32:04, 14.53s/it]Epoch:   125
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.6650, device='cuda:0') 
Std:  tensor(72.1729, device='cuda:0') 
ABS Max:  tensor(1080.2227, device='cuda:0') 
ABS Min:  tensor(0.0058, device='cuda:0')
Criterion check:  tensor([1.0028, 0.9963, 0.9996, 1.0003, 1.0072, 0.9987, 0.9988, 0.9967, 0.9930,
        1.0069], device='cuda:0') tensor(237, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0001, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(6.6955, device='cuda:0')
min of grad d_p:  tensor(-2.7978, device='cuda:0')
max|min: (J_L, Jta/N)  (6.695466995239258, 6.695474147796631, ratio: 1.000001072883606)|(-2.7977583408355713, -2.797853946685791)

 check Jacobi res:  torch.Size([793601]) max:  tensor(9.5606e-05, device='cuda:0') mean:  tensor(-1.6255e-09, device='cuda:0') min:  tensor(-1.1936e-05, device='cuda:0') norm:  tensor(0.0002, device='cuda:0') MSE:  tensor(2.6354e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0293, device='cuda:0') mean:  tensor(4.0256e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0708, device='cuda:0') MSE:  tensor(8.9216e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0108, device='cuda:0')
min of d_p_list:  tensor(-0.0055, device='cuda:0')
Epoch:  125  
Training Loss: 0.1928194761276245
Test Loss:  0.2024436593055725
Test Acc:  0.0
Valid Loss:  0.16607263684272766
Valid Acc:  0.0
std:  0.0009773955438995895 
thres:  0.00019164669811725616
Preserved_eigens number check:  512
 12%|█▎        | 125/1000 [30:40<3:31:38, 14.51s/it]Epoch:   126
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(5.1043, device='cuda:0') 
Std:  tensor(219.1008, device='cuda:0') 
ABS Max:  tensor(4542.1616, device='cuda:0') 
ABS Min:  tensor(0.0033, device='cuda:0')
Criterion check:  tensor([1.0023, 0.9982, 0.9997, 1.0000, 0.9958, 1.0002, 1.0027, 1.0008, 0.9950,
        1.0002], device='cuda:0') tensor(240, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0005, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(6.6999, device='cuda:0')
min of grad d_p:  tensor(-2.7186, device='cuda:0')
max|min: (J_L, Jta/N)  (6.6999311447143555, 6.699916362762451, ratio: 0.9999977946281433)|(-2.718592405319214, -2.7185909748077393)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.4782e-05, device='cuda:0') mean:  tensor(1.7289e-09, device='cuda:0') min:  tensor(-5.2378e-06, device='cuda:0') norm:  tensor(8.4422e-05, device='cuda:0') MSE:  tensor(1.0638e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.1657, device='cuda:0') mean:  tensor(8.5684e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.2566, device='cuda:0') MSE:  tensor(3.2340e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0086, device='cuda:0')
min of d_p_list:  tensor(-0.0047, device='cuda:0')
Epoch:  126  
Training Loss: 0.19283181428909302
Test Loss:  0.20250749588012695
Test Acc:  0.0
Valid Loss:  0.16614161431789398
Valid Acc:  0.0
std:  0.000610265607713953 
thres:  0.00019221321642398835
Preserved_eigens number check:  512
 13%|█▎        | 126/1000 [30:54<3:31:26, 14.51s/it]Epoch:   127
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(2.8289, device='cuda:0') 
Std:  tensor(57.1204, device='cuda:0') 
ABS Max:  tensor(1259.2881, device='cuda:0') 
ABS Min:  tensor(0.0005, device='cuda:0')
Criterion check:  tensor([0.9995, 0.9988, 0.9999, 1.0002, 1.0680, 1.0004, 1.0010, 1.0016, 0.9991,
        0.9985], device='cuda:0') tensor(208, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0009, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(6.6643, device='cuda:0')
min of grad d_p:  tensor(-2.7578, device='cuda:0')
max|min: (J_L, Jta/N)  (6.664334297180176, 6.664168834686279, ratio: 0.9999751448631287)|(-2.7577707767486572, -2.7577130794525146)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0002, device='cuda:0') mean:  tensor(-3.0929e-09, device='cuda:0') min:  tensor(-5.7697e-05, device='cuda:0') norm:  tensor(0.0011, device='cuda:0') MSE:  tensor(1.4180e-09, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0504, device='cuda:0') mean:  tensor(5.1088e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1014, device='cuda:0') MSE:  tensor(1.2775e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0088, device='cuda:0')
min of d_p_list:  tensor(-0.0062, device='cuda:0')
Epoch:  127  
Training Loss: 0.19264793395996094
Test Loss:  0.20237061381340027
Test Acc:  0.0
Valid Loss:  0.16594386100769043
Valid Acc:  0.0
std:  0.0004021710904025927 
thres:  0.00019248657524585726
Preserved_eigens number check:  512
**************************************************learning rate decay**************************************************
 13%|█▎        | 127/1000 [31:09<3:31:15, 14.52s/it]Epoch:   128
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(24211.2363, device='cuda:0') 
Std:  tensor(563600.1250, device='cuda:0') 
ABS Max:  tensor(12749665., device='cuda:0') 
ABS Min:  tensor(0.1201, device='cuda:0')
Criterion check:  tensor([1.4243, 0.8139, 0.9767, 0.8691, 8.6941, 0.8835, 1.0066, 1.0721, 2.3260,
        0.9246], device='cuda:0') tensor(254, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(8.8445e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(6.6355, device='cuda:0')
min of grad d_p:  tensor(-2.8185, device='cuda:0')
max|min: (J_L, Jta/N)  (6.635469436645508, 6.635469913482666, ratio: 1.0000001192092896)|(-2.8185105323791504, -2.8184969425201416)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.5241e-06, device='cuda:0') mean:  tensor(6.0940e-10, device='cuda:0') min:  tensor(-1.3590e-05, device='cuda:0') norm:  tensor(4.1705e-05, device='cuda:0') MSE:  tensor(5.2552e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(5.3050, device='cuda:0') mean:  tensor(0.0042, device='cuda:0') min:  tensor(5.0397e-13, device='cuda:0') norm:  tensor(9.2304, device='cuda:0') MSE:  tensor(1.1631e-05, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0140, device='cuda:0')
min of d_p_list:  tensor(-0.0092, device='cuda:0')
Epoch:  128  
Training Loss: 0.1927264928817749
Test Loss:  0.20248064398765564
Test Acc:  0.0
Valid Loss:  0.16606195271015167
Valid Acc:  0.0
local minima detector shape:  (0,)
Preserved_eigens number check:  512
 13%|█▎        | 128/1000 [31:23<3:31:48, 14.57s/it]Epoch:   129
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(1.6179, device='cuda:0') 
Std:  tensor(199.3529, device='cuda:0') 
ABS Max:  tensor(2566.5669, device='cuda:0') 
ABS Min:  tensor(0.0071, device='cuda:0')
Criterion check:  tensor([1.0004, 1.0066, 1.0052, 0.9962, 1.1282, 0.9984, 0.9847, 1.0128, 1.0678,
        1.0334], device='cuda:0') tensor(251, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0005, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(6.6235, device='cuda:0')
min of grad d_p:  tensor(-2.8602, device='cuda:0')
max|min: (J_L, Jta/N)  (6.623544216156006, 6.623530864715576, ratio: 0.9999979734420776)|(-2.8602089881896973, -2.8601722717285156)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.3351e-05, device='cuda:0') mean:  tensor(3.0359e-09, device='cuda:0') min:  tensor(-3.6716e-05, device='cuda:0') norm:  tensor(0.0001, device='cuda:0') MSE:  tensor(1.4348e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0644, device='cuda:0') mean:  tensor(7.9294e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1517, device='cuda:0') MSE:  tensor(1.9113e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0064, device='cuda:0')
min of d_p_list:  tensor(-0.0037, device='cuda:0')
Epoch:  129  
Training Loss: 0.192702978849411
Test Loss:  0.2024625837802887
Test Acc:  0.0
Valid Loss:  0.166029691696167
Valid Acc:  0.0
local minima detector shape:  (1,)
Preserved_eigens number check:  512
 13%|█▎        | 129/1000 [31:38<3:31:26, 14.57s/it]Epoch:   130
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-28.0510, device='cuda:0') 
Std:  tensor(3003.5371, device='cuda:0') 
ABS Max:  tensor(62443.2148, device='cuda:0') 
ABS Min:  tensor(0.0154, device='cuda:0')
Criterion check:  tensor([0.9098, 1.1232, 1.0314, 0.9729, 0.4280, 1.0218, 0.9729, 1.2301, 1.3761,
        0.7043], device='cuda:0') tensor(275, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0001, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(6.6316, device='cuda:0')
min of grad d_p:  tensor(-2.7296, device='cuda:0')
max|min: (J_L, Jta/N)  (6.631599426269531, 6.631613254547119, ratio: 1.0000020265579224)|(-2.729597568511963, -2.7297065258026123)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(-2.2640e-09, device='cuda:0') min:  tensor(-1.3828e-05, device='cuda:0') norm:  tensor(0.0002, device='cuda:0') MSE:  tensor(2.3010e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(2.3841, device='cuda:0') mean:  tensor(0.0021, device='cuda:0') min:  tensor(1.5330e-12, device='cuda:0') norm:  tensor(4.2987, device='cuda:0') MSE:  tensor(5.4167e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0673, device='cuda:0')
min of d_p_list:  tensor(-0.0273, device='cuda:0')
Epoch:  130  
Training Loss: 0.19268320500850677
Test Loss:  0.20247779786586761
Test Acc:  0.0
Valid Loss:  0.16617052257061005
Valid Acc:  0.0
local minima detector shape:  (2,)
Preserved_eigens number check:  512
 13%|█▎        | 130/1000 [31:53<3:31:31, 14.59s/it]Epoch:   131
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(22.6487, device='cuda:0') 
Std:  tensor(388.5533, device='cuda:0') 
ABS Max:  tensor(8008.1479, device='cuda:0') 
ABS Min:  tensor(0.0004, device='cuda:0')
Criterion check:  tensor([0.9980, 0.9851, 0.9963, 1.0000, 1.0438, 0.9994, 1.0037, 1.0060, 0.9878,
        0.9734], device='cuda:0') tensor(234, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0004, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(6.4821, device='cuda:0')
min of grad d_p:  tensor(-2.7866, device='cuda:0')
max|min: (J_L, Jta/N)  (6.482072830200195, 6.482081413269043, ratio: 1.000001311302185)|(-2.786602735519409, -2.786593437194824)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.7237e-06, device='cuda:0') mean:  tensor(1.2148e-09, device='cuda:0') min:  tensor(-9.2983e-06, device='cuda:0') norm:  tensor(8.3744e-05, device='cuda:0') MSE:  tensor(1.0552e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0164, device='cuda:0') mean:  tensor(4.4897e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0903, device='cuda:0') MSE:  tensor(1.1379e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0076, device='cuda:0')
min of d_p_list:  tensor(-0.0080, device='cuda:0')
Epoch:  131  
Training Loss: 0.1924399882555008
Test Loss:  0.20217175781726837
Test Acc:  0.0
Valid Loss:  0.1659049093723297
Valid Acc:  0.0
local minima detector shape:  (3,)
Preserved_eigens number check:  512
 13%|█▎        | 131/1000 [32:07<3:31:18, 14.59s/it]Epoch:   132
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(2.0069, device='cuda:0') 
Std:  tensor(44.3608, device='cuda:0') 
ABS Max:  tensor(804.3825, device='cuda:0') 
ABS Min:  tensor(0.0039, device='cuda:0')
Criterion check:  tensor([0.9980, 1.0052, 1.0016, 1.0006, 0.9958, 1.0000, 0.9967, 1.0042, 1.0063,
        0.9998], device='cuda:0') tensor(241, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0002, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(6.4895, device='cuda:0')
min of grad d_p:  tensor(-2.6809, device='cuda:0')
max|min: (J_L, Jta/N)  (6.489540100097656, 6.489555358886719, ratio: 1.000002384185791)|(-2.680872917175293, -2.6807634830474854)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.5607e-06, device='cuda:0') mean:  tensor(1.7666e-09, device='cuda:0') min:  tensor(-0.0001, device='cuda:0') norm:  tensor(0.0001, device='cuda:0') MSE:  tensor(1.8338e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0285, device='cuda:0') mean:  tensor(3.2519e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0612, device='cuda:0') MSE:  tensor(7.7162e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0105, device='cuda:0')
min of d_p_list:  tensor(-0.0224, device='cuda:0')
Epoch:  132  
Training Loss: 0.19235345721244812
Test Loss:  0.20206928253173828
Test Acc:  0.0
Valid Loss:  0.16576571762561798
Valid Acc:  0.0
local minima detector shape:  (4,)
Preserved_eigens number check:  512
 13%|█▎        | 132/1000 [32:22<3:31:08, 14.60s/it]Epoch:   133
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-1.1943, device='cuda:0') 
Std:  tensor(49.0722, device='cuda:0') 
ABS Max:  tensor(1032.8820, device='cuda:0') 
ABS Min:  tensor(0.0067, device='cuda:0')
Criterion check:  tensor([0.9980, 1.0036, 1.0012, 0.9991, 0.9801, 1.0005, 0.9965, 1.0019, 1.0059,
        1.0070], device='cuda:0') tensor(238, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0006, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(6.5066, device='cuda:0')
min of grad d_p:  tensor(-2.6705, device='cuda:0')
max|min: (J_L, Jta/N)  (6.506557464599609, 6.506572723388672, ratio: 1.000002384185791)|(-2.6704916954040527, -2.6704118251800537)

 check Jacobi res:  torch.Size([793601]) max:  tensor(9.9614e-06, device='cuda:0') mean:  tensor(1.9709e-09, device='cuda:0') min:  tensor(-7.9870e-05, device='cuda:0') norm:  tensor(0.0001, device='cuda:0') MSE:  tensor(1.6479e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0586, device='cuda:0') mean:  tensor(3.7228e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0986, device='cuda:0') MSE:  tensor(1.2420e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0224, device='cuda:0')
min of d_p_list:  tensor(-0.0271, device='cuda:0')
Epoch:  133  
Training Loss: 0.19191008806228638
Test Loss:  0.20159372687339783
Test Acc:  0.0
Valid Loss:  0.16527166962623596
Valid Acc:  0.0
std:  0.0002878091091163563 
thres:  0.00019241794347763061
Preserved_eigens number check:  512
 13%|█▎        | 133/1000 [32:36<3:31:00, 14.60s/it]Epoch:   134
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.2268, device='cuda:0') 
Std:  tensor(23.0346, device='cuda:0') 
ABS Max:  tensor(459.9046, device='cuda:0') 
ABS Min:  tensor(0.0053, device='cuda:0')
Criterion check:  tensor([1.0015, 0.9968, 1.0003, 1.0005, 1.0006, 0.9999, 1.0003, 0.9954, 0.9889,
        1.0043], device='cuda:0') tensor(230, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0005, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(6.6224, device='cuda:0')
min of grad d_p:  tensor(-2.5541, device='cuda:0')
max|min: (J_L, Jta/N)  (6.6224284172058105, 6.624207973480225, ratio: 1.0002686977386475)|(-2.5540781021118164, -2.5534284114837646)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0005, device='cuda:0') mean:  tensor(1.6769e-09, device='cuda:0') min:  tensor(-0.0018, device='cuda:0') norm:  tensor(0.0089, device='cuda:0') MSE:  tensor(1.1231e-08, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0447, device='cuda:0') mean:  tensor(6.0403e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1181, device='cuda:0') MSE:  tensor(1.4887e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0086, device='cuda:0')
min of d_p_list:  tensor(-0.0257, device='cuda:0')
Epoch:  134  
Training Loss: 0.1918698251247406
Test Loss:  0.2015368789434433
Test Acc:  0.0
Valid Loss:  0.16530627012252808
Valid Acc:  0.0
std:  0.00031449322926708367 
thres:  0.00019225131273269654
Preserved_eigens number check:  512
 13%|█▎        | 134/1000 [32:53<3:41:22, 15.34s/it]Epoch:   135
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.5734, device='cuda:0') 
Std:  tensor(17.3961, device='cuda:0') 
ABS Max:  tensor(222.2541, device='cuda:0') 
ABS Min:  tensor(0.0044, device='cuda:0')
Criterion check:  tensor([1.0014, 0.9985, 0.9997, 1.0009, 1.0023, 1.0000, 0.9999, 0.9977, 0.9961,
        0.9999], device='cuda:0') tensor(221, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0007, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(6.6515, device='cuda:0')
min of grad d_p:  tensor(-2.4939, device='cuda:0')
max|min: (J_L, Jta/N)  (6.651535987854004, 6.651525020599365, ratio: 0.9999983310699463)|(-2.4939067363739014, -2.4940037727355957)

 check Jacobi res:  torch.Size([793601]) max:  tensor(9.7036e-05, device='cuda:0') mean:  tensor(-1.6685e-09, device='cuda:0') min:  tensor(-1.1198e-05, device='cuda:0') norm:  tensor(0.0002, device='cuda:0') MSE:  tensor(2.3229e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0645, device='cuda:0') mean:  tensor(2.9056e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0938, device='cuda:0') MSE:  tensor(1.1820e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0065, device='cuda:0')
min of d_p_list:  tensor(-0.0194, device='cuda:0')
Epoch:  135  
Training Loss: 0.19141298532485962
Test Loss:  0.20102214813232422
Test Acc:  0.0
Valid Loss:  0.16494223475456238
Valid Acc:  0.0
std:  0.0003709717650051728 
thres:  0.0001919972687959671
Preserved_eigens number check:  512
 14%|█▎        | 135/1000 [33:14<4:04:18, 16.95s/it]Epoch:   136
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(8.8629, device='cuda:0') 
Std:  tensor(223.8843, device='cuda:0') 
ABS Max:  tensor(5024.2700, device='cuda:0') 
ABS Min:  tensor(5.6424e-05, device='cuda:0')
Criterion check:  tensor([0.9988, 0.9995, 0.9996, 0.9996, 1.0008, 1.0000, 0.9987, 1.0028, 1.0063,
        0.9971], device='cuda:0') tensor(221, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0004, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(6.7119, device='cuda:0')
min of grad d_p:  tensor(-2.5009, device='cuda:0')
max|min: (J_L, Jta/N)  (6.711928367614746, 6.711941242218018, ratio: 1.0000019073486328)|(-2.500887870788574, -2.500898838043213)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.0967e-05, device='cuda:0') mean:  tensor(-7.1595e-10, device='cuda:0') min:  tensor(-1.2875e-05, device='cuda:0') norm:  tensor(8.5605e-05, device='cuda:0') MSE:  tensor(1.0787e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0233, device='cuda:0') mean:  tensor(3.8310e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0671, device='cuda:0') MSE:  tensor(8.4532e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0026, device='cuda:0')
min of d_p_list:  tensor(-0.0045, device='cuda:0')
Epoch:  136  
Training Loss: 0.19139519333839417
Test Loss:  0.20102301239967346
Test Acc:  0.0
Valid Loss:  0.1649477332830429
Valid Acc:  0.0
std:  0.0003567282733831885 
thres:  0.00019178830981254576
Preserved_eigens number check:  512
 14%|█▎        | 136/1000 [33:29<3:54:46, 16.30s/it]Epoch:   137
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(1.1931, device='cuda:0') 
Std:  tensor(32.2046, device='cuda:0') 
ABS Max:  tensor(630.5468, device='cuda:0') 
ABS Min:  tensor(0.0040, device='cuda:0')
Criterion check:  tensor([1.0024, 1.0052, 0.9985, 1.0011, 1.0148, 0.9994, 1.0019, 0.9988, 1.0034,
        0.9877], device='cuda:0') tensor(271, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0004, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(6.7134, device='cuda:0')
min of grad d_p:  tensor(-2.5273, device='cuda:0')
max|min: (J_L, Jta/N)  (6.713376522064209, 6.713345050811768, ratio: 0.9999952912330627)|(-2.527275800704956, -2.5273597240448)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.3923e-05, device='cuda:0') mean:  tensor(8.9227e-10, device='cuda:0') min:  tensor(-6.7949e-06, device='cuda:0') norm:  tensor(0.0001, device='cuda:0') MSE:  tensor(1.6106e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0085, device='cuda:0') mean:  tensor(2.4393e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0497, device='cuda:0') MSE:  tensor(6.2676e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0033, device='cuda:0')
min of d_p_list:  tensor(-0.0077, device='cuda:0')
Epoch:  137  
Training Loss: 0.19125160574913025
Test Loss:  0.2008773684501648
Test Acc:  0.0
Valid Loss:  0.16481155157089233
Valid Acc:  0.0
std:  0.0002691169425294388 
thres:  0.0001915679395198822
Preserved_eigens number check:  512
 14%|█▎        | 137/1000 [33:44<3:47:00, 15.78s/it]Epoch:   138
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(2.1820, device='cuda:0') 
Std:  tensor(38.1372, device='cuda:0') 
ABS Max:  tensor(812.8777, device='cuda:0') 
ABS Min:  tensor(0.0003, device='cuda:0')
Criterion check:  tensor([0.9983, 1.0021, 1.0000, 0.9998, 0.9956, 1.0004, 0.9984, 1.0019, 0.9997,
        0.9953], device='cuda:0') tensor(229, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0010, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(6.7298, device='cuda:0')
min of grad d_p:  tensor(-2.5279, device='cuda:0')
max|min: (J_L, Jta/N)  (6.729815483093262, 6.730318546295166, ratio: 1.0000747442245483)|(-2.527919292449951, -2.5186100006103516)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0018, device='cuda:0') mean:  tensor(4.4805e-07, device='cuda:0') min:  tensor(-0.0093, device='cuda:0') norm:  tensor(0.0438, device='cuda:0') MSE:  tensor(5.5129e-08, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0310, device='cuda:0') mean:  tensor(0.0002, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.3074, device='cuda:0') MSE:  tensor(3.8738e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0154, device='cuda:0')
min of d_p_list:  tensor(-0.0032, device='cuda:0')
Epoch:  138  
Training Loss: 0.19132471084594727
Test Loss:  0.20098894834518433
Test Acc:  0.0
Valid Loss:  0.16487297415733337
Valid Acc:  0.0
std:  0.00021710868681608627 
thres:  0.0001914508640766144
Preserved_eigens number check:  512
**************************************************learning rate decay**************************************************
 14%|█▍        | 138/1000 [33:58<3:41:23, 15.41s/it]Epoch:   139
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(3.3805, device='cuda:0') 
Std:  tensor(55.4593, device='cuda:0') 
ABS Max:  tensor(683.5023, device='cuda:0') 
ABS Min:  tensor(0.0041, device='cuda:0')
Criterion check:  tensor([0.9969, 1.0019, 1.0018, 1.0009, 0.9871, 1.0001, 0.9987, 1.0033, 1.0033,
        1.0091], device='cuda:0') tensor(240, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0001, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(6.7033, device='cuda:0')
min of grad d_p:  tensor(-2.5162, device='cuda:0')
max|min: (J_L, Jta/N)  (6.703295707702637, 6.7032952308654785, ratio: 0.9999999403953552)|(-2.516185998916626, -2.5160791873931885)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.1235e-05, device='cuda:0') mean:  tensor(2.3043e-09, device='cuda:0') min:  tensor(-0.0001, device='cuda:0') norm:  tensor(0.0002, device='cuda:0') MSE:  tensor(2.3630e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0775, device='cuda:0') mean:  tensor(6.6815e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1356, device='cuda:0') MSE:  tensor(1.7088e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0037, device='cuda:0')
min of d_p_list:  tensor(-0.0112, device='cuda:0')
Epoch:  139  
Training Loss: 0.1913442760705948
Test Loss:  0.20101825892925262
Test Acc:  0.0
Valid Loss:  0.16490456461906433
Valid Acc:  0.0
local minima detector shape:  (0,)
Preserved_eigens number check:  512
 14%|█▍        | 139/1000 [34:13<3:37:52, 15.18s/it]Epoch:   140
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.4313, device='cuda:0') 
Std:  tensor(35.2440, device='cuda:0') 
ABS Max:  tensor(412.0693, device='cuda:0') 
ABS Min:  tensor(0.0046, device='cuda:0')
Criterion check:  tensor([1.0007, 1.0007, 1.0000, 1.0006, 1.0026, 0.9997, 1.0042, 0.9960, 1.0042,
        0.9722], device='cuda:0') tensor(246, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0009, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(6.7384, device='cuda:0')
min of grad d_p:  tensor(-2.4205, device='cuda:0')
max|min: (J_L, Jta/N)  (6.738363265991211, 6.738361358642578, ratio: 0.9999997019767761)|(-2.4205453395843506, -2.420511484146118)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.9073e-06, device='cuda:0') mean:  tensor(9.1006e-10, device='cuda:0') min:  tensor(-3.3855e-05, device='cuda:0') norm:  tensor(6.3346e-05, device='cuda:0') MSE:  tensor(7.9821e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0608, device='cuda:0') mean:  tensor(4.5470e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1076, device='cuda:0') MSE:  tensor(1.3559e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0067, device='cuda:0')
min of d_p_list:  tensor(-0.0046, device='cuda:0')
Epoch:  140  
Training Loss: 0.19138634204864502
Test Loss:  0.20106327533721924
Test Acc:  0.0
Valid Loss:  0.16497153043746948
Valid Acc:  0.0
local minima detector shape:  (1,)
Preserved_eigens number check:  512
 14%|█▍        | 140/1000 [34:28<3:35:54, 15.06s/it]Epoch:   141
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-1.5996, device='cuda:0') 
Std:  tensor(58.9757, device='cuda:0') 
ABS Max:  tensor(987.3613, device='cuda:0') 
ABS Min:  tensor(0.0028, device='cuda:0')
Criterion check:  tensor([0.9995, 0.9960, 0.9993, 1.0003, 1.0014, 1.0000, 1.0039, 0.9950, 0.9905,
        1.0065], device='cuda:0') tensor(250, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0006, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(6.7305, device='cuda:0')
min of grad d_p:  tensor(-2.3968, device='cuda:0')
max|min: (J_L, Jta/N)  (6.730525970458984, 6.730541706085205, ratio: 1.000002384185791)|(-2.396761894226074, -2.3966867923736572)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.1384e-05, device='cuda:0') mean:  tensor(1.5742e-09, device='cuda:0') min:  tensor(-7.5102e-05, device='cuda:0') norm:  tensor(0.0002, device='cuda:0') MSE:  tensor(2.1174e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0036, device='cuda:0') mean:  tensor(4.3545e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0652, device='cuda:0') MSE:  tensor(8.2112e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0113, device='cuda:0')
min of d_p_list:  tensor(-0.0285, device='cuda:0')
Epoch:  141  
Training Loss: 0.19116327166557312
Test Loss:  0.20081335306167603
Test Acc:  0.0
Valid Loss:  0.16479873657226562
Valid Acc:  0.0
local minima detector shape:  (2,)
Preserved_eigens number check:  512
 14%|█▍        | 141/1000 [34:42<3:33:54, 14.94s/it]Epoch:   142
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(-0.6761, device='cuda:0') 
Std:  tensor(12.5122, device='cuda:0') 
ABS Max:  tensor(147.3623, device='cuda:0') 
ABS Min:  tensor(0.0060, device='cuda:0')
Criterion check:  tensor([1.0003, 1.0037, 1.0005, 1.0001, 0.9954, 0.9998, 1.0001, 0.9967, 1.0038,
        1.0014], device='cuda:0') tensor(235, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(3.5494e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(6.7530, device='cuda:0')
min of grad d_p:  tensor(-2.5014, device='cuda:0')
max|min: (J_L, Jta/N)  (6.752996921539307, 6.753015518188477, ratio: 1.0000027418136597)|(-2.5014193058013916, -2.501410961151123)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.2766e-06, device='cuda:0') mean:  tensor(-1.2108e-09, device='cuda:0') min:  tensor(-1.8597e-05, device='cuda:0') norm:  tensor(8.7820e-05, device='cuda:0') MSE:  tensor(1.1066e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0913, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(1.0637e-12, device='cuda:0') norm:  tensor(0.2171, device='cuda:0') MSE:  tensor(2.7356e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0157, device='cuda:0')
min of d_p_list:  tensor(-0.0063, device='cuda:0')
Epoch:  142  
Training Loss: 0.19126150012016296
Test Loss:  0.2009393721818924
Test Acc:  0.0
Valid Loss:  0.16487275063991547
Valid Acc:  0.0
local minima detector shape:  (3,)
Preserved_eigens number check:  512
 14%|█▍        | 142/1000 [34:57<3:32:31, 14.86s/it]Epoch:   143
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(4.8651, device='cuda:0') 
Std:  tensor(70.2370, device='cuda:0') 
ABS Max:  tensor(1483.5626, device='cuda:0') 
ABS Min:  tensor(0.0055, device='cuda:0')
Criterion check:  tensor([1.0000, 0.9999, 1.0005, 0.9998, 1.0028, 1.0004, 1.0009, 1.0036, 1.0092,
        1.0279], device='cuda:0') tensor(250, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0004, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(6.7604, device='cuda:0')
min of grad d_p:  tensor(-2.4214, device='cuda:0')
max|min: (J_L, Jta/N)  (6.760412216186523, 6.7603840827941895, ratio: 0.9999958276748657)|(-2.4213662147521973, -2.4214730262756348)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(1.1564e-09, device='cuda:0') min:  tensor(-6.3777e-06, device='cuda:0') norm:  tensor(0.0002, device='cuda:0') MSE:  tensor(2.0400e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0728, device='cuda:0') mean:  tensor(9.0281e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1716, device='cuda:0') MSE:  tensor(2.1625e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0096, device='cuda:0')
min of d_p_list:  tensor(-0.0098, device='cuda:0')
Epoch:  143  
Training Loss: 0.19118016958236694
Test Loss:  0.20085802674293518
Test Acc:  0.0
Valid Loss:  0.16479730606079102
Valid Acc:  0.0
local minima detector shape:  (4,)
Preserved_eigens number check:  512
 14%|█▍        | 143/1000 [35:12<3:31:51, 14.83s/it]Epoch:   144
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-12.7652, device='cuda:0') 
Std:  tensor(193.2839, device='cuda:0') 
ABS Max:  tensor(4176.7056, device='cuda:0') 
ABS Min:  tensor(5.8232e-05, device='cuda:0')
Criterion check:  tensor([1.0032, 0.9943, 0.9992, 1.0002, 1.0003, 0.9993, 1.0127, 0.9944, 0.9821,
        0.9705], device='cuda:0') tensor(247, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0012, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(6.7655, device='cuda:0')
min of grad d_p:  tensor(-2.4137, device='cuda:0')
max|min: (J_L, Jta/N)  (6.765450954437256, 6.765442371368408, ratio: 0.9999987483024597)|(-2.4136581420898438, -2.413663864135742)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.5831e-06, device='cuda:0') mean:  tensor(-2.3565e-10, device='cuda:0') min:  tensor(-1.2713e-06, device='cuda:0') norm:  tensor(3.6962e-05, device='cuda:0') MSE:  tensor(4.6576e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0008, device='cuda:0') mean:  tensor(1.4458e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0229, device='cuda:0') MSE:  tensor(2.8809e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0077, device='cuda:0')
min of d_p_list:  tensor(-0.0128, device='cuda:0')
Epoch:  144  
Training Loss: 0.19118517637252808
Test Loss:  0.20087799429893494
Test Acc:  0.0
Valid Loss:  0.16478344798088074
Valid Acc:  0.0
std:  8.275260524201957e-05 
thres:  0.0001912352919578552
Preserved_eigens number check:  512
**************************************************learning rate decay**************************************************
 14%|█▍        | 144/1000 [35:26<3:31:21, 14.81s/it]Epoch:   145
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.3021, device='cuda:0') 
Std:  tensor(35.6393, device='cuda:0') 
ABS Max:  tensor(461.2856, device='cuda:0') 
ABS Min:  tensor(0.0009, device='cuda:0')
Criterion check:  tensor([0.9984, 1.0040, 1.0012, 0.9997, 0.9929, 1.0007, 1.0006, 1.0003, 1.0011,
        1.0016], device='cuda:0') tensor(235, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0012, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(6.7364, device='cuda:0')
min of grad d_p:  tensor(-2.4894, device='cuda:0')
max|min: (J_L, Jta/N)  (6.736385345458984, 6.736358165740967, ratio: 0.9999959468841553)|(-2.489377498626709, -2.4893698692321777)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.7180e-05, device='cuda:0') mean:  tensor(-7.2361e-10, device='cuda:0') min:  tensor(-7.6294e-06, device='cuda:0') norm:  tensor(7.6486e-05, device='cuda:0') MSE:  tensor(9.6379e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0222, device='cuda:0') mean:  tensor(1.9217e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0420, device='cuda:0') MSE:  tensor(5.2925e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0067, device='cuda:0')
min of d_p_list:  tensor(-0.0248, device='cuda:0')
Epoch:  145  
Training Loss: 0.19119220972061157
Test Loss:  0.20087237656116486
Test Acc:  0.0
Valid Loss:  0.1647932529449463
Valid Acc:  0.0
local minima detector shape:  (0,)
Preserved_eigens number check:  512
 14%|█▍        | 145/1000 [35:41<3:30:51, 14.80s/it]Epoch:   146
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(7.1975, device='cuda:0') 
Std:  tensor(294.4184, device='cuda:0') 
ABS Max:  tensor(5787.1313, device='cuda:0') 
ABS Min:  tensor(0.0034, device='cuda:0')
Criterion check:  tensor([1.0048, 0.9929, 0.9987, 0.9982, 1.0171, 0.9985, 0.9961, 0.9831, 0.9733,
        1.0204], device='cuda:0') tensor(265, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(7.0706e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(6.7646, device='cuda:0')
min of grad d_p:  tensor(-2.4049, device='cuda:0')
max|min: (J_L, Jta/N)  (6.764605522155762, 6.764595031738281, ratio: 0.9999984502792358)|(-2.404869318008423, -2.404874324798584)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.0490e-05, device='cuda:0') mean:  tensor(1.7263e-09, device='cuda:0') min:  tensor(-5.9083e-06, device='cuda:0') norm:  tensor(0.0001, device='cuda:0') MSE:  tensor(1.8611e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.1314, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.2457, device='cuda:0') MSE:  tensor(3.0966e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0053, device='cuda:0')
min of d_p_list:  tensor(-0.0041, device='cuda:0')
Epoch:  146  
Training Loss: 0.19116666913032532
Test Loss:  0.2008470594882965
Test Acc:  0.0
Valid Loss:  0.16478750109672546
Valid Acc:  0.0
local minima detector shape:  (1,)
Preserved_eigens number check:  512
 15%|█▍        | 146/1000 [35:56<3:31:44, 14.88s/it]Epoch:   147
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-9.9338, device='cuda:0') 
Std:  tensor(202.8574, device='cuda:0') 
ABS Max:  tensor(4535.1880, device='cuda:0') 
ABS Min:  tensor(0.0028, device='cuda:0')
Criterion check:  tensor([0.9990, 0.9973, 0.9996, 1.0002, 1.0032, 1.0006, 0.9989, 1.0008, 1.0000,
        1.0114], device='cuda:0') tensor(239, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0012, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(6.7632, device='cuda:0')
min of grad d_p:  tensor(-2.4146, device='cuda:0')
max|min: (J_L, Jta/N)  (6.763248443603516, 6.763247966766357, ratio: 0.9999999403953552)|(-2.414632797241211, -2.4146478176116943)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.5020e-05, device='cuda:0') mean:  tensor(-1.5817e-10, device='cuda:0') min:  tensor(-2.9206e-06, device='cuda:0') norm:  tensor(7.4836e-05, device='cuda:0') MSE:  tensor(9.4299e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0465, device='cuda:0') mean:  tensor(3.1183e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0801, device='cuda:0') MSE:  tensor(1.0098e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0018, device='cuda:0')
min of d_p_list:  tensor(-0.0018, device='cuda:0')
Epoch:  147  
Training Loss: 0.19112172722816467
Test Loss:  0.20079904794692993
Test Acc:  0.0
Valid Loss:  0.16475412249565125
Valid Acc:  0.0
local minima detector shape:  (2,)
Preserved_eigens number check:  512
 15%|█▍        | 147/1000 [36:11<3:30:49, 14.83s/it]Epoch:   148
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(1.5821, device='cuda:0') 
Std:  tensor(24.9822, device='cuda:0') 
ABS Max:  tensor(398.3429, device='cuda:0') 
ABS Min:  tensor(0.0009, device='cuda:0')
Criterion check:  tensor([0.9973, 1.0022, 1.0015, 0.9998, 0.9920, 1.0005, 0.9982, 1.0033, 0.9991,
        0.9707], device='cuda:0') tensor(221, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(3.9142e-06, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(6.7646, device='cuda:0')
min of grad d_p:  tensor(-2.4086, device='cuda:0')
max|min: (J_L, Jta/N)  (6.764646530151367, 6.766833782196045, ratio: 1.0003232955932617)|(-2.4085779190063477, -2.405348300933838)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0010, device='cuda:0') mean:  tensor(2.0444e-07, device='cuda:0') min:  tensor(-0.0032, device='cuda:0') norm:  tensor(0.0191, device='cuda:0') MSE:  tensor(2.4025e-08, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.1411, device='cuda:0') mean:  tensor(7.0614e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.2106, device='cuda:0') MSE:  tensor(2.6542e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0052, device='cuda:0')
min of d_p_list:  tensor(-0.0059, device='cuda:0')
Epoch:  148  
Training Loss: 0.19108128547668457
Test Loss:  0.2007514238357544
Test Acc:  0.0
Valid Loss:  0.1647264063358307
Valid Acc:  0.0
local minima detector shape:  (3,)
Preserved_eigens number check:  512
 15%|█▍        | 148/1000 [36:26<3:30:17, 14.81s/it]Epoch:   149
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-16.6286, device='cuda:0') 
Std:  tensor(157.8323, device='cuda:0') 
ABS Max:  tensor(2150.5088, device='cuda:0') 
ABS Min:  tensor(0.0201, device='cuda:0')
Criterion check:  tensor([0.9895, 0.9966, 0.9911, 1.0021, 1.0510, 0.9991, 0.9841, 0.9987, 1.0491,
        1.3194], device='cuda:0') tensor(262, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0001, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(6.7692, device='cuda:0')
min of grad d_p:  tensor(-2.4145, device='cuda:0')
max|min: (J_L, Jta/N)  (6.769182205200195, 6.769195079803467, ratio: 1.0000019073486328)|(-2.4145491123199463, -2.4146368503570557)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.7738e-05, device='cuda:0') mean:  tensor(-1.0205e-09, device='cuda:0') min:  tensor(-1.2875e-05, device='cuda:0') norm:  tensor(0.0002, device='cuda:0') MSE:  tensor(2.0311e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.1171, device='cuda:0') mean:  tensor(0.0004, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.6800, device='cuda:0') MSE:  tensor(8.5683e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0337, device='cuda:0')
min of d_p_list:  tensor(-0.0963, device='cuda:0')
Epoch:  149  
Training Loss: 0.19103708863258362
Test Loss:  0.20071455836296082
Test Acc:  0.0
Valid Loss:  0.1645611822605133
Valid Acc:  0.0
local minima detector shape:  (4,)
Preserved_eigens number check:  512
 15%|█▍        | 149/1000 [36:41<3:32:03, 14.95s/it]Epoch:   150
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  511
Criterion check: 
Mean:  tensor(6.4437, device='cuda:0') 
Std:  tensor(132.7475, device='cuda:0') 
ABS Max:  tensor(2402.5430, device='cuda:0') 
ABS Min:  tensor(0.0004, device='cuda:0')
Criterion check:  tensor([0.9964, 1.0021, 1.0018, 1.0011, 0.9765, 0.9995, 1.0074, 0.9937, 0.9614,
        0.9446], device='cuda:0') tensor(242, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(5.8347e-05, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(6.7919, device='cuda:0')
min of grad d_p:  tensor(-2.4594, device='cuda:0')
max|min: (J_L, Jta/N)  (6.7919416427612305, 6.791978359222412, ratio: 1.0000053644180298)|(-2.4593708515167236, -2.4593796730041504)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.8215e-06, device='cuda:0') mean:  tensor(-1.5480e-09, device='cuda:0') min:  tensor(-3.6716e-05, device='cuda:0') norm:  tensor(0.0002, device='cuda:0') MSE:  tensor(2.6523e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0783, device='cuda:0') mean:  tensor(5.8878e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1345, device='cuda:0') MSE:  tensor(1.6943e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0055, device='cuda:0')
min of d_p_list:  tensor(-0.0035, device='cuda:0')
Epoch:  150  
Training Loss: 0.1909995675086975
Test Loss:  0.2006746083498001
Test Acc:  0.0
Valid Loss:  0.1645749807357788
Valid Acc:  0.0
std:  5.92572177772774e-05 
thres:  0.00019108126759529115
Preserved_eigens number check:  512
**************************************************learning rate decay**************************************************
 15%|█▌        | 150/1000 [36:56<3:30:53, 14.89s/it]Epoch:   151
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(4.8037, device='cuda:0') 
Std:  tensor(275.6787, device='cuda:0') 
ABS Max:  tensor(4283.5298, device='cuda:0') 
ABS Min:  tensor(0.0184, device='cuda:0')
Criterion check:  tensor([1.0146, 0.9934, 0.9966, 1.0008, 1.0457, 0.9989, 1.0182, 0.9641, 0.9698,
        0.9282], device='cuda:0') tensor(275, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0008, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(6.7919, device='cuda:0')
min of grad d_p:  tensor(-2.4635, device='cuda:0')
max|min: (J_L, Jta/N)  (6.791866302490234, 6.791840076446533, ratio: 0.9999961256980896)|(-2.463484287261963, -2.4635939598083496)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0001, device='cuda:0') mean:  tensor(6.8997e-10, device='cuda:0') min:  tensor(-5.9605e-06, device='cuda:0') norm:  tensor(0.0002, device='cuda:0') MSE:  tensor(2.2825e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0966, device='cuda:0') mean:  tensor(5.5324e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.1525, device='cuda:0') MSE:  tensor(1.9215e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0042, device='cuda:0')
min of d_p_list:  tensor(-0.0069, device='cuda:0')
Epoch:  151  
Training Loss: 0.19096434116363525
Test Loss:  0.2006365954875946
Test Acc:  0.0
Valid Loss:  0.16457118093967438
Valid Acc:  0.0
local minima detector shape:  (0,)
Preserved_eigens number check:  512
 15%|█▌        | 151/1000 [37:11<3:30:49, 14.90s/it]Epoch:   152
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-32.3550, device='cuda:0') 
Std:  tensor(602.0709, device='cuda:0') 
ABS Max:  tensor(12274.9502, device='cuda:0') 
ABS Min:  tensor(0.0329, device='cuda:0')
Criterion check:  tensor([0.9829, 1.0257, 1.0021, 1.0025, 0.9718, 1.0035, 0.9441, 1.0242, 0.8430,
        0.8669], device='cuda:0') tensor(268, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0008, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(6.7948, device='cuda:0')
min of grad d_p:  tensor(-2.4653, device='cuda:0')
max|min: (J_L, Jta/N)  (6.794775009155273, 6.794790744781494, ratio: 1.0000022649765015)|(-2.4653351306915283, -2.4653420448303223)

 check Jacobi res:  torch.Size([793601]) max:  tensor(6.9141e-06, device='cuda:0') mean:  tensor(9.6863e-11, device='cuda:0') min:  tensor(-1.5736e-05, device='cuda:0') norm:  tensor(3.7599e-05, device='cuda:0') MSE:  tensor(4.7378e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(1.6244, device='cuda:0') mean:  tensor(0.0015, device='cuda:0') min:  tensor(1.3982e-13, device='cuda:0') norm:  tensor(3.2322, device='cuda:0') MSE:  tensor(4.0728e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.1486, device='cuda:0')
min of d_p_list:  tensor(-0.0621, device='cuda:0')
Epoch:  152  
Training Loss: 0.1911354959011078
Test Loss:  0.20083406567573547
Test Acc:  0.0
Valid Loss:  0.16476693749427795
Valid Acc:  0.0
local minima detector shape:  (1,)
Preserved_eigens number check:  512
 15%|█▌        | 152/1000 [37:28<3:39:59, 15.56s/it]Epoch:   153
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-19.9550, device='cuda:0') 
Std:  tensor(814.7986, device='cuda:0') 
ABS Max:  tensor(16308.3545, device='cuda:0') 
ABS Min:  tensor(0.0279, device='cuda:0')
Criterion check:  tensor([0.9837, 1.2309, 1.0163, 0.9940, 1.0219, 0.9885, 0.9498, 1.1126, 1.0181,
        1.1492], device='cuda:0') tensor(260, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0012, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(6.7651, device='cuda:0')
min of grad d_p:  tensor(-2.4536, device='cuda:0')
max|min: (J_L, Jta/N)  (6.765079021453857, 6.765091419219971, ratio: 1.0000017881393433)|(-2.453620433807373, -2.4536209106445312)

 check Jacobi res:  torch.Size([793601]) max:  tensor(4.1164e-06, device='cuda:0') mean:  tensor(-1.4892e-09, device='cuda:0') min:  tensor(-1.2398e-05, device='cuda:0') norm:  tensor(5.8557e-05, device='cuda:0') MSE:  tensor(7.3786e-11, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.2634, device='cuda:0') mean:  tensor(0.0004, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.6940, device='cuda:0') MSE:  tensor(8.7453e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0138, device='cuda:0')
min of d_p_list:  tensor(-0.0333, device='cuda:0')
Epoch:  153  
Training Loss: 0.19103220105171204
Test Loss:  0.20071165263652802
Test Acc:  0.0
Valid Loss:  0.16468504071235657
Valid Acc:  0.0
local minima detector shape:  (2,)
Preserved_eigens number check:  512
 15%|█▌        | 153/1000 [37:43<3:40:00, 15.58s/it]Epoch:   154
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.6937, device='cuda:0') 
Std:  tensor(80.8498, device='cuda:0') 
ABS Max:  tensor(1029.9130, device='cuda:0') 
ABS Min:  tensor(0.0022, device='cuda:0')
Criterion check:  tensor([0.9911, 0.9856, 0.9971, 1.0056, 0.9827, 1.0008, 0.9907, 0.9786, 1.0280,
        1.0428], device='cuda:0') tensor(270, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0005, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(6.7631, device='cuda:0')
min of grad d_p:  tensor(-2.4611, device='cuda:0')
max|min: (J_L, Jta/N)  (6.763143539428711, 6.76313591003418, ratio: 0.9999988675117493)|(-2.4610657691955566, -2.4610629081726074)

 check Jacobi res:  torch.Size([793601]) max:  tensor(8.1062e-06, device='cuda:0') mean:  tensor(2.2485e-09, device='cuda:0') min:  tensor(-3.3379e-06, device='cuda:0') norm:  tensor(0.0001, device='cuda:0') MSE:  tensor(1.5639e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0497, device='cuda:0') mean:  tensor(0.0001, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.2250, device='cuda:0') MSE:  tensor(2.8348e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0067, device='cuda:0')
min of d_p_list:  tensor(-0.0124, device='cuda:0')
Epoch:  154  
Training Loss: 0.1909782439470291
Test Loss:  0.20065559446811676
Test Acc:  0.0
Valid Loss:  0.16464336216449738
Valid Acc:  0.0
local minima detector shape:  (3,)
Preserved_eigens number check:  512
 15%|█▌        | 154/1000 [38:00<3:44:13, 15.90s/it]Epoch:   155
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-1.7540, device='cuda:0') 
Std:  tensor(44.2485, device='cuda:0') 
ABS Max:  tensor(660.7831, device='cuda:0') 
ABS Min:  tensor(0.0004, device='cuda:0')
Criterion check:  tensor([0.9948, 0.9979, 0.9997, 1.0004, 0.9995, 1.0005, 0.9948, 0.9959, 0.9683,
        1.0191], device='cuda:0') tensor(251, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0004, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(6.7660, device='cuda:0')
min of grad d_p:  tensor(-2.4675, device='cuda:0')
max|min: (J_L, Jta/N)  (6.766019821166992, 6.765981197357178, ratio: 0.9999942779541016)|(-2.4675097465515137, -2.467526912689209)

 check Jacobi res:  torch.Size([793601]) max:  tensor(3.8624e-05, device='cuda:0') mean:  tensor(-7.5669e-10, device='cuda:0') min:  tensor(-4.7386e-06, device='cuda:0') norm:  tensor(9.7290e-05, device='cuda:0') MSE:  tensor(1.2259e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0456, device='cuda:0') mean:  tensor(3.3005e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0876, device='cuda:0') MSE:  tensor(1.1040e-07, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0050, device='cuda:0')
min of d_p_list:  tensor(-0.0027, device='cuda:0')
Epoch:  155  
Training Loss: 0.19094198942184448
Test Loss:  0.20061618089675903
Test Acc:  0.0
Valid Loss:  0.16461250185966492
Valid Acc:  0.0
local minima detector shape:  (4,)
Preserved_eigens number check:  512
 16%|█▌        | 155/1000 [38:15<3:39:42, 15.60s/it]Epoch:   156
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-12.4628, device='cuda:0') 
Std:  tensor(181.2621, device='cuda:0') 
ABS Max:  tensor(2858.2419, device='cuda:0') 
ABS Min:  tensor(0.0106, device='cuda:0')
Criterion check:  tensor([1.0009, 0.9599, 1.0040, 1.0034, 0.9933, 0.9977, 1.0414, 0.9761, 0.9037,
        0.7723], device='cuda:0') tensor(274, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0008, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(6.7653, device='cuda:0')
min of grad d_p:  tensor(-2.4555, device='cuda:0')
max|min: (J_L, Jta/N)  (6.765348434448242, 6.765337944030762, ratio: 0.9999984502792358)|(-2.4555416107177734, -2.4555368423461914)

 check Jacobi res:  torch.Size([793601]) max:  tensor(1.0520e-05, device='cuda:0') mean:  tensor(1.1301e-09, device='cuda:0') min:  tensor(-7.2345e-06, device='cuda:0') norm:  tensor(0.0002, device='cuda:0') MSE:  tensor(2.3889e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0025, device='cuda:0') mean:  tensor(2.4820e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0436, device='cuda:0') MSE:  tensor(5.4999e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0449, device='cuda:0')
min of d_p_list:  tensor(-0.0142, device='cuda:0')
Epoch:  156  
Training Loss: 0.19097039103507996
Test Loss:  0.20065094530582428
Test Acc:  0.0
Valid Loss:  0.16465485095977783
Valid Acc:  0.0
std:  6.845584655767693e-05 
thres:  0.00019101166427135468
Preserved_eigens number check:  512
**************************************************learning rate decay**************************************************
 16%|█▌        | 156/1000 [38:30<3:36:42, 15.41s/it]Epoch:   157
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.1623, device='cuda:0') 
Std:  tensor(7.8007, device='cuda:0') 
ABS Max:  tensor(147.9481, device='cuda:0') 
ABS Min:  tensor(4.4794e-05, device='cuda:0')
Criterion check:  tensor([1.0003, 1.0004, 1.0001, 0.9998, 0.9990, 1.0001, 0.9995, 1.0001, 1.0062,
        1.0020], device='cuda:0') tensor(205, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0007, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(6.7615, device='cuda:0')
min of grad d_p:  tensor(-2.4472, device='cuda:0')
max|min: (J_L, Jta/N)  (6.761484146118164, 6.761470794677734, ratio: 0.9999980330467224)|(-2.4472293853759766, -2.447258234024048)

 check Jacobi res:  torch.Size([793601]) max:  tensor(2.8849e-05, device='cuda:0') mean:  tensor(-2.2263e-10, device='cuda:0') min:  tensor(-6.0946e-06, device='cuda:0') norm:  tensor(9.7830e-05, device='cuda:0') MSE:  tensor(1.2327e-10, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.0090, device='cuda:0') mean:  tensor(1.8480e-05, device='cuda:0') min:  tensor(0., device='cuda:0') norm:  tensor(0.0318, device='cuda:0') MSE:  tensor(4.0116e-08, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0028, device='cuda:0')
min of d_p_list:  tensor(-0.0044, device='cuda:0')
Epoch:  157  
Training Loss: 0.19093438982963562
Test Loss:  0.20061148703098297
Test Acc:  0.0
Valid Loss:  0.16461879014968872
Valid Acc:  0.0
local minima detector shape:  (0,)
Preserved_eigens number check:  512
 16%|█▌        | 157/1000 [38:45<3:33:46, 15.22s/it]Epoch:   158
shape check:  torch.Size([512, 793601]) torch.Size([512])
Rank check:  512
Criterion check: 
Mean:  tensor(-0.7721, device='cuda:0') 
Std:  tensor(85.0513, device='cuda:0') 
ABS Max:  tensor(1311.7958, device='cuda:0') 
ABS Min:  tensor(0.0137, device='cuda:0')
Criterion check:  tensor([1.0013, 0.9651, 1.0051, 0.9966, 1.0391, 0.9989, 1.0161, 1.0205, 1.0738,
        1.0992], device='cuda:0') tensor(275, device='cuda:0')
max of Lambda2 tensor(1000000., device='cuda:0')
min of Lambda2 tensor(0.0002, device='cuda:0')
eigenvalues preserved:  512
max of grad d_p:  tensor(6.7614, device='cuda:0')
min of grad d_p:  tensor(-2.4468, device='cuda:0')
max|min: (J_L, Jta/N)  (6.761384963989258, 6.760626792907715, ratio: 0.9998878836631775)|(-2.4468328952789307, -2.4482669830322266)

 check Jacobi res:  torch.Size([793601]) max:  tensor(0.0014, device='cuda:0') mean:  tensor(-1.6255e-07, device='cuda:0') min:  tensor(-0.0002, device='cuda:0') norm:  tensor(0.0048, device='cuda:0') MSE:  tensor(6.0982e-09, device='cuda:0')

 check NTK dimension reduction res:  torch.Size([793601, 1]) max:  tensor(0.1130, device='cuda:0') mean:  tensor(0.0005, device='cuda:0') min:  tensor(3.0036e-13, device='cuda:0') norm:  tensor(0.9267, device='cuda:0') MSE:  tensor(1.1677e-06, device='cuda:0')
Shape check:  torch.Size([793601, 1])
max of d_p_list:  tensor(0.0054, device='cuda:0')
min of d_p_list:  tensor(-0.0034, device='cuda:0')
Epoch:  158  
Training Loss: 0.1909080147743225
Test Loss:  0.20058178901672363
Test Acc:  0.0
Valid Loss:  0.16459247469902039
Valid Acc:  0.0
local minima detector shape:  (1,)
Preserved_eigens number check:  512
 16%|█▌        | 158/1000 [38:59<3:31:04, 15.04s/it]